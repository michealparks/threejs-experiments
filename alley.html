<title>ThreeJS Experiments: Alley | Micheal Parks</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel='stylesheet' href='css/index.css' />

<a id='back' class='button' href='/threejs-experiments'>Back</a>

<script type='module'>
  if (window !== window.top) window.back.style.display = 'none'
</script>

<canvas></canvas>

<script type='module'>
import {
  THREE,
  renderer,
  camera,
  scene,
  setAnimationLoop,
  orbitControls,
  initXR
} from './js/core.js'

import { loadModel } from './js/loaders.js'
import { COLORS, SHADOW_MAP } from './js/constants.js'

const main = async () => {
  camera.near = 0.1
  camera.far = 50.0
  camera.position.set(7, 5, 2)
  
  const controls = orbitControls()
  controls.autoRotate = false

  const wall = await loadModel({
    src: 'assets/gltf/construction_fliers_1.glb',
    anisotropy: renderer.capabilities.getMaxAnisotropy()
  })
  wall.rotation.set(0.0, -Math.PI / 4, 0.0)
  scene.add(wall)

  {
    const intensity = 10.0
    const light = new THREE.SpotLight(COLORS.warmLight, intensity)
    light.castShadow = true
    light.angle = 60

    light.shadow.mapSize.width = SHADOW_MAP.width
    light.shadow.mapSize.height = SHADOW_MAP.height
    light.shadow.radius = 16

    light.position.set(5, 10, 10)
    scene.add(light)

  }

  const frame = () => {
    controls.update()
  }

  initXR()
  setAnimationLoop({ frame })
}

main()
</script>
