import{S as t,i as s,s as e}from"../../../chunks/index-1236a393.js";import{O as a,I as o,c as r,d as n,m as i,s as c,n as l,o as m,l as p,j as d,u}from"../../../chunks/index-096e168f.js";import{r as y,a as f}from"../../../chunks/util-21cdfddc.js";import{c as h}from"../../../chunks/util-three-3b80600c.js";const w=100,A=new a,b=[],g=(t,s)=>{const e=3*t,[a,o]=f(1.25);s.p[e+0]=a,s.p[e+1]=y(.1,.75),s.p[e+2]=o,s.s[t]=1,s.sv[t]=y(-.1,-.03),s.pv[e+0]=y(-.01,.05),s.pv[e+1]=y(.01,.05),s.pv[e+2]=y(-.01,.05)},j=(t,s)=>{for(const e of s){if(e.matrixAutoUpdate=!0,e.position.set(0,0,0),Array.isArray(e.material))throw new TypeError("Material can not be array");const s=new o(e.geometry.clone(),e.material.clone(),w),a={mesh:s,p:new Float32Array(300),r:new Float32Array(300),s:new Float32Array(w),pv:new Float32Array(300),sv:new Float32Array(300)};s.position.set(0,.5,0);let r=0;for(;r<w;)g(r,a),r+=1;b.push(a),t.add(s)}},v=()=>{for(const t of b){const{mesh:s,p:e,s:a,pv:o,sv:r}=t;let n=0;for(;n<w;){const i=3*n;a[n]+=r[n],a[n]<=0&&g(n,t),e[i+0]+=o[i+0],e[i+1]+=o[i+1],e[i+2]+=o[i+2],A.position.set(e[i],e[i+1],e[i+2]),A.scale.set(a[n],a[n],a[n]),A.updateMatrix(),s.setMatrixAt(n,A.matrix),n+=1}s.instanceMatrix.needsUpdate=!0}};function x(t){return(async()=>{r.position.set(20,4,18),r.lookAt(0,0,0);const t=n(),s=i();s.color.setHSL(.6,1,.6),s.groundColor.setHSL(.095,1,.75),c.add(s),s.position.set(0,50,0);const e=l();e.color.setHSL(.1,1,.95),e.position.set(-1,1.75,1).multiplyScalar(30),c.add(e);const a=h(void 0,64);c.add(a);const o={h:0,s:0,l:0};a.material instanceof m&&a.material.color.getHSL(o);let{l:y}=o,f=1e-4,w=1e-4;const{scene:A}=await p("FloatingRockScene.glb");j(A.getObjectByName("Fire"),[A.getObjectByName("Ember1"),A.getObjectByName("Ember2"),A.getObjectByName("Ember3")]),c.add(A),u((()=>{y-=w,(y<0||y>1)&&(f=-f,w=f,y<=0&&(y=0),y>=1&&(y=1)),t.intensity=y,a.material instanceof m&&a.material.color.setHSL(o.h,o.s,y),v()})),d()})(),[]}class S extends t{constructor(t){super(),s(this,t,x,null,e,{})}}export{S as default};
