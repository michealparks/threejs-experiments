import{s as t}from"./boolean_attributes.386354a9.js";import{S as e,i as a}from"./index.34db41e6.js";import{O as s,I as o,b6 as r,as as n,au as i,D as c,aG as l,b7 as m}from"./trzy.7fd33118.js";import{r as p,a as d}from"./util.21cdfddc.js";import{c as u}from"./util-three.39569779.js";const y=100,f=new s,b=[],w=(t,e)=>{const a=3*t,[s,o]=d(1.25);e.p[a+0]=s,e.p[a+1]=p(.1,.75),e.p[a+2]=o,e.s[t]=1,e.sv[t]=p(-.1,-.03),e.pv[a+0]=p(-.01,.05),e.pv[a+1]=p(.01,.05),e.pv[a+2]=p(-.01,.05)},g=(t,e)=>{for(const a of e){if(a.matrixAutoUpdate=!0,a.position.set(0,0,0),Array.isArray(a.material))throw new TypeError("Material can not be array");const e=new o(a.geometry.clone(),a.material.clone(),y),s={mesh:e,p:new Float32Array(300),r:new Float32Array(300),s:new Float32Array(y),pv:new Float32Array(300),sv:new Float32Array(300)};e.position.set(0,.5,0);let r=0;for(;r<y;)w(r,s),r+=1;b.push(s),t.add(e)}},v=()=>{for(const t of b){const{mesh:e,p:a,s:s,pv:o,sv:r}=t;let n=0;for(;n<y;){const i=3*n;s[n]+=r[n],s[n]<=0&&w(n,t),a[i+0]+=o[i+0],a[i+1]+=o[i+1],a[i+2]+=o[i+2],f.position.set(a[i],a[i+1],a[i+2]),f.scale.set(s[n],s[n],s[n]),f.updateMatrix(),e.setMatrixAt(n,f.matrix),n+=1}e.instanceMatrix.needsUpdate=!0}};function A(t){const{scene:e,camera:a,update:s}=r();return(async()=>{a.current.position.set(20,4,18),a.current.lookAt(0,0,0);const t=new n(void 0,1);e.add(t);const o=new i;o.color.setHSL(.6,1,.6),o.groundColor.setHSL(.095,1,.75),e.add(o),o.position.set(0,50,0);const r=new c;r.color.setHSL(.1,1,.95),r.position.set(-1,1.75,1).multiplyScalar(30),e.add(r);const p=u(void 0,64);e.add(p);const d={h:0,s:0,l:0};p.material instanceof l&&p.material.color.getHSL(d);let{l:y}=d,f=1e-4,b=1e-4;const{scene:w}=await m("glb/FloatingRockScene.glb");g(w.getObjectByName("Fire"),[w.getObjectByName("Ember1"),w.getObjectByName("Ember2"),w.getObjectByName("Ember3")]),e.add(w),s((()=>{y-=b,(y<0||y>1)&&(f=-f,b=f,y<=0&&(y=0),y>=1&&(y=1)),t.intensity=y,p.material instanceof l&&p.material.color.setHSL(d.h,d.s,y),v()}))})(),[]}class j extends e{constructor(e){super(),a(this,e,A,null,t,{})}}export{j as default};
