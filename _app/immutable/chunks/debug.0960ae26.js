var t=Object.defineProperty,e=(e,i,n)=>(((e,i,n)=>{i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n})(e,"symbol"!=typeof i?i+"":i,n),n);import{v as i,T as n}from"./trzy.81d23169.js";function s(t,e){for(var i=0;i<e.length;i++){const n=e[i];if("string"!=typeof n&&!Array.isArray(n))for(const e in n)if("default"!==e&&!(e in t)){const i=Object.getOwnPropertyDescriptor(n,e);i&&Object.defineProperty(t,e,i.get?i:{enumerable:!0,get:()=>n[e]})}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"&&self;function o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var r={};
/*! Tweakpane 3.1.9 (c) 2016 cocopon, licensed under the MIT license. */!function(t){class e{constructor(t){const[e,i]=t.split("-"),n=e.split(".");this.major=parseInt(n[0],10),this.minor=parseInt(n[1],10),this.patch=parseInt(n[2],10),this.prerelease=i??null}toString(){const t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}class i{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class n{constructor(t){this.target=t}}class s extends n{constructor(t,e,i,n){super(t),this.value=e,this.presetKey=i,this.last=n??!0}}class o extends n{constructor(t,e,i){super(t),this.value=e,this.presetKey=i}}class r extends n{constructor(t,e){super(t),this.expanded=e}}class a extends n{constructor(t,e){super(t),this.index=e}}function l(t){return null==t}function h(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function d(t,e){let i=t;do{const t=Object.getOwnPropertyDescriptor(i,e);if(t&&(void 0!==t.set||!0===t.writable))return!0;i=Object.getPrototypeOf(i)}while(null!==i);return!1}const c={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class p{static alreadyDisposed(){return new p({type:"alreadydisposed"})}static notBindable(){return new p({type:"notbindable"})}static propertyNotFound(t){return new p({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new p({type:"shouldneverhappen"})}constructor(t){var e;this.message=null!==(e=c[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}}class u{constructor(t,e,i){this.obj_=t,this.key_=e,this.presetKey_=i??e}static isBindable(t){return!(null===t||"object"!=typeof t&&"function"!=typeof t)}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const i=this.read();if(!u.isBindable(i))throw p.notBindable();if(!(t in i))throw p.propertyNotFound(t);i[t]=e}}class v extends i{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const i=e.bind(this);return this.controller_.valueController.emitter.on(t,(()=>{i(new n(this))})),this}}class m{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter((t=>t.handler!==e))),this}emit(t,e){const i=this.observers_[t];i&&i.forEach((t=>{t.handler(e)}))}}const g="tp";function _(t){return(e,i)=>[g,"-",t,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function b(t,e){return i=>e(t(i))}function f(t){return t.rawValue}function w(t,e){t.emitter.on("change",b(f,e)),e(t.rawValue)}function x(t,e,i){w(t.value(e),i)}function y(t,e,i){i?t.classList.add(e):t.classList.remove(e)}function C(t,e){return i=>{y(t,e,i)}}function E(t,e){w(t,(t=>{e.textContent=t??""}))}const P=_("btn");class k{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(P()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(P("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElement("div");n.classList.add(P("t")),E(e.props.value("title"),n),this.buttonElement.appendChild(n)}}class z{constructor(t,e){this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new k(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class L{constructor(t,e){var i;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(i=null==e?void 0:e.equals)&&void 0!==i?i:(t,e)=>t===e,this.emitter=new m,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(t):t,s=this.rawValue_;this.equals_(s,n)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:n,sender:this}))}}class M{constructor(t){this.emitter=new m,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},n=this.value_;n===t&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:i,previousRawValue:n,rawValue:this.value_,sender:this}))}}function V(t,e){const i=null==e?void 0:e.constraint,n=null==e?void 0:e.equals;return i||n?new L(t,e):new M(t)}class T{constructor(t){this.emitter=new m,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,i)=>Object.assign(e,{[i]:V(t[i])})),{})}static fromObject(t){const e=this.createCore(t);return new T(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function A(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function S(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function O(t){return null!==t&&"object"==typeof t}function I(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function D(t){return{custom:e=>I(e)(t),boolean:I((t=>"boolean"==typeof t?t:void 0))(t),number:I((t=>"number"==typeof t?t:void 0))(t),string:I((t=>"string"==typeof t?t:void 0))(t),function:I((t=>"function"==typeof t?t:void 0))(t),constant:e=>I((t=>t===e?e:void 0))(t),raw:I((t=>t))(t),object:e=>I((t=>{if(O(t))return A(t,e)}))(t),array:e=>I((t=>{if(Array.isArray(t))return S(t,e)}))(t)}}const R={optional:D(!0),required:D(!1)};function F(t,e){const i=R.required.object(e)(t);return i.succeeded?i.value:void 0}function U(t){console.warn([`Missing '${t.key}' of ${t.target} in ${t.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function N(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}class B{constructor(t){this.value_=t}static create(t){return[new B(t),(e,i)=>{t.setRawValue(e,i)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const j=_("");function H(t,e){return C(t,j(void 0,e))}class K extends T{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=B.create(V(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,i,n;const s=t??{};return new K(T.createCore({disabled:null!==(e=s.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=s.hidden)&&void 0!==i&&i,parent:null!==(n=s.parent)&&void 0!==n?n:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){w(this.globalDisabled_,H(t,"disabled")),x(this,"hidden",H(t,"hidden"))}bindDisabled(t){w(this.globalDisabled_,(e=>{t.disabled=e}))}bindTabIndex(t){w(this.globalDisabled_,(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}getGlobalDisabled_(){const t=this.get("parent");return!!t&&t.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const i=t.previousRawValue;null==i||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function $(){return["veryfirst","first","last","verylast"]}const Y=_(""),q={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class G{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{$().forEach((t=>{e.classList.remove(Y(void 0,q[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(Y(void 0,q[t]))}))})),this.viewProps.handleDispose((()=>{N(e)}))}get parent(){return this.parent_}set parent(t){this.parent_=t,"parent"in this.viewProps.valMap_?this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null):U({key:"parent",target:K.name,place:"BladeController.parent"})}}const Z="http://www.w3.org/2000/svg";function X(t){t.offsetHeight}function W(t,e){const i=t.style.transition;t.style.transition="none",e(),t.style.transition=i}function Q(t){return void 0!==t.ontouchstart}function J(){return globalThis}function tt(){return J().document}function et(t){const e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d",{willReadFrequently:!0}):null}const it={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function nt(t,e){const i=t.createElementNS(Z,"svg");return i.innerHTML=it[e],i}function st(t,e,i){t.insertBefore(e,t.children[i])}function ot(t){t.parentElement&&t.parentElement.removeChild(t)}function rt(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function at(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function lt(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const ht=_("lbl");function dt(t,e){const i=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,n)=>{n>0&&i.appendChild(t.createElement("br")),i.appendChild(e)})),i}class ct{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ht()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(ht("l")),x(e.props,"label",(e=>{l(e)?this.element.classList.add(ht(void 0,"nol")):(this.element.classList.remove(ht(void 0,"nol")),at(i),i.appendChild(dt(t,e)))})),this.element.appendChild(i),this.labelElement=i;const n=t.createElement("div");n.classList.add(ht("v")),this.element.appendChild(n),this.valueElement=n}}class pt extends G{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new ct(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const ut={id:"button",type:"blade",accept(t){const e=R,i=F(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return i?{params:i}:null},controller:t=>new pt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:new z(t.document,{props:T.fromObject({title:t.params.title}),viewProps:t.viewProps})}),api:t=>t.controller instanceof pt&&t.controller.valueController instanceof z?new v(t.controller):null};class vt extends G{constructor(t){super(t),this.value=t.value}}function mt(){return new T({positions:V([],{equals:h})})}class gt extends T{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=T.createCore(e);return new gt(i)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!l(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const i=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};x(this,"expanded",i),x(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function _t(t,e){let i=0;return W(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),X(e),i=e.clientHeight,t.set("temporaryExpanded",null),X(e)})),i}function bt(t,e){e.style.height=t.styleHeight}function ft(t,e){t.value("expanded").emitter.on("beforechange",(()=>{if(t.set("completed",!1),l(t.get("expandedHeight"))){const i=_t(t,e);i>0&&t.set("expandedHeight",i)}t.set("shouldFixHeight",!0),X(e)})),t.emitter.on("change",(()=>{bt(t,e)})),bt(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&t.cleanUpTransition()}))}class wt extends i{constructor(t,e){super(t),this.rackApi_=e}}function xt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function yt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function Ct(t,e){const i=e??{};return t.addBlade(Object.assign(Object.assign({},i),{view:"separator"}))}function Et(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}class Pt{constructor(t){this.emitter=new m,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw p.shouldNeverHappen();const i=void 0!==e?e:this.items_.length;this.items_.splice(i,0,t),this.cache_.add(t);const n=this.extract_(t);n&&(n.emitter.on("add",this.onSubListAdd_),n.emitter.on("remove",this.onSubListRemove_),n.allItems().forEach((t=>{this.cache_.add(t)}))),this.emitter.emit("add",{index:i,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const i=this.extract_(t);i&&(i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}class kt extends i{constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new m,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new s(this,e,this.controller_.binding.target.presetKey,t.options.last)})}}class zt extends pt{constructor(t,e){super(t,e),this.binding=e.binding}}class Lt extends i{constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new m,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new o(this,e,this.controller_.binding.target.presetKey)})}}class Mt extends pt{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function Vt(t){return t instanceof St?t.apiSet_:t instanceof wt?t.rackApi_.apiSet_:null}function Tt(t,e){const i=t.find((t=>t.controller_===e));if(!i)throw p.shouldNeverHappen();return i}function At(t,e,i){if(!u.isBindable(t))throw p.notBindable();return new u(t,e,i)}class St extends i{constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new m,this.apiSet_=new Pt(Vt),this.pool_=e;const i=this.controller_.rack;i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),i.emitter.on("inputchange",this.onRackInputChange_),i.emitter.on("monitorupdate",this.onRackMonitorUpdate_),i.children.forEach((t=>{this.setUpApi_(t)}))}get children(){return this.controller_.rack.children.map((t=>Tt(this.apiSet_,t)))}addInput(t,e,i){const n=i??{},s=this.controller_.view.element.ownerDocument,o=this.pool_.createInput(s,At(t,e,n.presetKey),n),r=new kt(o);return this.add(r,n.index)}addMonitor(t,e,i){const n=i??{},s=this.controller_.view.element.ownerDocument,o=this.pool_.createMonitor(s,At(t,e),n),r=new Lt(o);return this.add(r,n.index)}addFolder(t){return yt(this,t)}addButton(t){return xt(this,t)}addSeparator(t){return Ct(this,t)}addTab(t){return Et(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const i=this.apiSet_.find((e=>e.controller_===t.controller_));return i&&this.apiSet_.remove(i),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,i=this.pool_.createBlade(e,t),n=this.pool_.createBladeApi(i);return this.add(n,t.index)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}setUpApi_(t){this.apiSet_.find((e=>e.controller_===t))||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=Tt(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof zt){const i=Tt(this.apiSet_,e),n=e.binding;this.emitter_.emit("change",{event:new s(i,n.target.read(),n.target.presetKey,t.options.last)})}else if(e instanceof vt){const i=Tt(this.apiSet_,e);this.emitter_.emit("change",{event:new s(i,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof Mt))throw p.shouldNeverHappen();const e=Tt(this.apiSet_,t.bladeController),i=t.bladeController.binding;this.emitter_.emit("update",{event:new o(e,i.target.read(),i.target.presetKey)})}}class Ot extends wt{constructor(t,e){super(t,new St(t.rackController,e)),this.emitter_=new m,this.controller_.foldable.value("expanded").emitter.on("change",(t=>{this.emitter_.emit("fold",{event:new r(this,t.sender.rawValue)})})),this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})}))}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,i){return this.rackApi_.addInput(t,e,i)}addMonitor(t,e,i){return this.rackApi_.addMonitor(t,e,i)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class It extends G{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class Dt{constructor(t,e){const i=_(e.viewName);this.element=t.createElement("div"),this.element.classList.add(i()),e.viewProps.bindClassModifiers(this.element)}}function Rt(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(n instanceof zt&&n.binding===e)return n}return null}function Ft(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(n instanceof Mt&&n.binding===e)return n}return null}function Ut(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(n instanceof vt&&n.value===e)return n}return null}function Nt(t){return t instanceof Ht?t.rack:t instanceof It?t.rackController.rack:null}function Bt(t){const e=Nt(t);return e?e.bcSet_:null}class jt{constructor(t){var e,i;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new m,this.blade_=null!==(e=t.blade)&&void 0!==e?e:null,null===(i=this.blade_)||void 0===i||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=t.viewProps,this.bcSet_=new Pt(Bt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){var i;null===(i=t.parent)||void 0===i||i.remove(t),d(t,"parent")?t.parent=this:(t.parent_=this,U({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(t,e)}remove(t){d(t,"parent")?t.parent=null:(t.parent_=null,U({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter((e=>e instanceof t))}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const i=t.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),i instanceof zt)i.binding.emitter.on("change",this.onChildInputChange_);else if(i instanceof Mt)i.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(i instanceof vt)i.value.emitter.on("change",this.onChildValueChange_);else{const t=Nt(i);if(t){const e=t.emitter;e.on("layout",this.onDescendantLayout_),e.on("inputchange",this.onDescendantInputChange_),e.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const i=t.item;if(i instanceof zt)i.binding.emitter.off("change",this.onChildInputChange_);else if(i instanceof Mt)i.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(i instanceof vt)i.value.emitter.off("change",this.onChildValueChange_);else{const t=Nt(i);if(t){const e=t.emitter;e.off("layout",this.onDescendantLayout_),e.off("inputchange",this.onDescendantInputChange_),e.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter((t=>!t.viewProps.get("hidden"))),e=t[0],i=t[t.length-1];this.bcSet_.items.forEach((t=>{const n=[];t===e&&(n.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&n.push("veryfirst")),t===i&&(n.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&n.push("verylast")),t.blade.set("positions",n)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((t=>t.viewProps.get("disposed"))).forEach((t=>{this.bcSet_.remove(t)}))}onChildInputChange_(t){const e=Rt(this.find(zt),t.sender);if(!e)throw p.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=Ft(this.find(Mt),t.sender);if(!e)throw p.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=Ut(this.find(vt),t.sender);if(!e)throw p.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Ht extends G{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Dt(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const i=new jt({blade:e.root?void 0:e.blade,viewProps:e.viewProps});i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),this.rack=i,this.viewProps.handleDispose((()=>{for(let t=this.rack.children.length-1;t>=0;t--)this.rack.children[t].viewProps.set("disposed",!0)}))}onRackAdd_(t){t.isRoot&&st(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.isRoot&&ot(t.bladeController.view.element)}}const Kt=_("cnt");class $t{constructor(t,e){var i;this.className_=_(null!==(i=e.viewName)&&void 0!==i?i:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),Kt()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),x(this.foldable_,"completed",C(this.element,this.className_(void 0,"cpl")));const n=t.createElement("button");n.classList.add(this.className_("b")),x(e.props,"title",(t=>{l(t)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const s=t.createElement("div");s.classList.add(this.className_("i")),this.element.appendChild(s);const o=t.createElement("div");o.classList.add(this.className_("t")),E(e.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const r=t.createElement("div");r.classList.add(this.className_("m")),this.buttonElement.appendChild(r);const a=e.containerElement;a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}}class Yt extends It{constructor(t,e){var i;const n=gt.create(null===(i=e.expanded)||void 0===i||i),s=new Ht(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:s,view:new $t(t,{containerElement:s.view.element,foldable:n,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=n,ft(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const qt={id:"folder",type:"blade",accept(t){const e=R,i=F(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return i?{params:i}:null},controller:t=>new Yt(t.document,{blade:t.blade,expanded:t.params.expanded,props:T.fromObject({title:t.params.title}),viewProps:t.viewProps}),api:t=>t.controller instanceof Yt?new Ot(t.controller,t.pool):null};class Gt extends vt{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new ct(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Zt extends i{}const Xt=_("spr");class Wt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Xt()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("hr");i.classList.add(Xt("r")),this.element.appendChild(i)}}class Qt extends G{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Wt(t,{viewProps:e.viewProps})}))}}const Jt={id:"separator",type:"blade",accept(t){const e=F(t,{view:R.required.constant("separator")});return e?{params:e}:null},controller:t=>new Qt(t.document,{blade:t.blade,viewProps:t.viewProps}),api:t=>t.controller instanceof Qt?new Zt(t.controller):null},te=_("tbi");class ee{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(te()),e.viewProps.bindClassModifiers(this.element),x(e.props,"selected",(t=>{t?this.element.classList.add(te(void 0,"sel")):this.element.classList.remove(te(void 0,"sel"))}));const i=t.createElement("button");i.classList.add(te("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElement("div");n.classList.add(te("t")),E(e.props.value("title"),n),this.buttonElement.appendChild(n),this.titleElement=n}}class ie{constructor(t,e){this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new ee(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ne{constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new ie(t,{props:e.itemProps,viewProps:K.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Ht(t,{blade:mt(),viewProps:K.create()}),this.props=e.props,x(this.props,"selected",(t=>{this.itemController.props.set("selected",t),this.contentController.viewProps.set("hidden",!t)}))}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class se{constructor(t,e){this.controller_=t,this.rackApi_=e}get title(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,i){return this.rackApi_.addInput(t,e,i)}addMonitor(t,e,i){return this.rackApi_.addMonitor(t,e,i)}addBlade(t){return this.rackApi_.addBlade(t)}}class oe extends wt{constructor(t,e){super(t,new St(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new m,this.pageApiMap_=new Map,this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})})),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((t=>{this.setUpPageApi_(t)}))}get pages(){return this.controller_.pageSet.items.map((t=>{const e=this.pageApiMap_.get(t);if(!e)throw p.shouldNeverHappen();return e}))}addPage(t){const e=this.controller_.view.element.ownerDocument,i=new ne(e,{itemProps:T.fromObject({selected:!1,title:t.title}),props:T.fromObject({selected:!1})});this.controller_.add(i,t.index);const n=this.pageApiMap_.get(i);if(!n)throw p.shouldNeverHappen();return n}removePage(t){this.controller_.remove(t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find((e=>e.controller_===t.contentController));if(!e)throw p.shouldNeverHappen();const i=new se(t,e);this.pageApiMap_.set(t,i)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw p.shouldNeverHappen();this.pageApiMap_.delete(t.item)}onSelect_(t){this.emitter_.emit("select",{event:new a(this,t.rawValue)})}}const re=-1;class ae{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=V(!0),this.selectedIndex=V(re),this.items_=[]}add(t,e){const i=e??this.items_.length;this.items_.splice(i,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=re,void(this.empty.rawValue=!0);const t=this.items_.findIndex((t=>t.rawValue));t<0?(this.items_.forEach(((t,e)=>{t.rawValue=0===e})),this.selectedIndex.rawValue=0):(this.items_.forEach(((e,i)=>{e.rawValue=i===t})),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex((e=>e===t.sender));this.items_.forEach(((t,i)=>{t.rawValue=i===e})),this.selectedIndex.rawValue=e}else this.keepSelection_()}}const le=_("tab");class he{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(le(),Kt()),e.viewProps.bindClassModifiers(this.element),w(e.empty,C(this.element,le(void 0,"nop")));const i=t.createElement("div");i.classList.add(le("t")),this.element.appendChild(i),this.itemsElement=i;const n=t.createElement("div");n.classList.add(le("i")),this.element.appendChild(n);const s=e.contentsElement;s.classList.add(le("c")),this.element.appendChild(s),this.contentsElement=s}}class de extends It{constructor(t,e){const i=new Ht(t,{blade:e.blade,viewProps:e.viewProps}),n=new ae;super({blade:e.blade,rackController:i,view:new he(t,{contentsElement:i.view.element,empty:n.empty,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new Pt((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=n}get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,e)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}onPageAdd_(t){const e=t.item;st(this.view.itemsElement,e.itemController.view.element,t.index),e.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(e.contentController,t.index),this.tab.add(e.props.value("selected"))}onPageRemove_(t){const e=t.item;ot(e.itemController.view.element),e.itemController.viewProps.set("parent",null),this.rackController.rack.remove(e.contentController),this.tab.remove(e.props.value("selected"))}}const ce={id:"tab",type:"blade",accept(t){const e=R,i=F(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return i&&0!==i.pages.length?{params:i}:null},controller(t){const e=new de(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((i=>{const n=new ne(t.document,{itemProps:T.fromObject({selected:!1,title:i.title}),props:T.fromObject({selected:!1})});e.add(n)})),e},api:t=>t.controller instanceof de?new oe(t.controller,t.pool):null};function pe(t,e){const i=t.accept(e.params);if(!i)return null;const n=R.optional.boolean(e.params.disabled).value,s=R.optional.boolean(e.params.hidden).value;return t.controller({blade:mt(),document:e.document,params:Object.assign(Object.assign({},i.params),{disabled:n,hidden:s}),viewProps:K.create({disabled:n,hidden:s})})}class ue{constructor(){this.disabled=!1,this.emitter=new m}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class ve{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new m,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class me{constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new m,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}read(){const t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}function ge(t,e){for(;t.length<e;)t.push(void 0)}function _e(t){const e=[];return ge(e,t),V(e)}function be(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function fe(t,e){const i=[...be(t),e];return i.length>t.length?i.splice(0,i.length-t.length):ge(i,t.length),i}class we{constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new m,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(void 0===t)return;const e=this.value.rawValue,i=this.reader_(t);this.value.rawValue=fe(e,i),this.emitter.emit("update",{rawValue:i,sender:this})}onTick_(t){this.read()}}class xe{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function ye(t,e){if(t instanceof e)return t;if(t instanceof xe){const i=t.constraints.reduce(((t,i)=>t||(i instanceof e?i:null)),null);if(i)return i}return null}class Ce{constructor(t){this.values=T.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(t,i),e)}}class Ee{constructor(t){this.values=T.fromObject({options:t})}get options(){return this.values.get("options")}constrain(t){const e=this.values.get("options");return 0===e.length||e.filter((e=>e.value===t)).length>0?t:e[0].value}}class Pe{constructor(t){this.values=T.fromObject({max:t.max,min:t.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(t){const e=this.values.get("max"),i=this.values.get("min");let n=t;return l(i)||(n=Math.max(n,i)),l(e)||(n=Math.min(n,e)),n}}class ke{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}const ze=_("lst");class Le{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(ze()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("select");i.classList.add(ze("s")),x(this.props_,"options",(e=>{rt(i),e.forEach(((e,n)=>{const s=t.createElement("option");s.dataset.index=String(n),s.textContent=e.text,s.value=String(e.value),i.appendChild(s)}))})),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const n=t.createElement("div");n.classList.add(ze("m")),n.appendChild(nt(t,"dropdown")),this.element.appendChild(n),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Me{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Le(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=t.currentTarget.selectedOptions.item(0);if(!e)return;const i=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[i].value}}const Ve=_("pop");class Te{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ve()),e.viewProps.bindClassModifiers(this.element),w(e.shows,C(this.element,Ve(void 0,"v")))}}class Ae{constructor(t,e){this.shows=V(!1),this.viewProps=e.viewProps,this.view=new Te(t,{shows:this.shows,viewProps:this.viewProps})}}const Se=_("txt");class Oe{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Se()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const i=t.createElement("input");i.classList.add(Se("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class Ie{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Oe(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);l(i)||(this.value.rawValue=i),this.view.refresh()}}function De(t){return String(t)}function Re(t){return"false"!==t&&!!t}function Fe(t){return De(t)}class Ue{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const Ne={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class Be{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=Ne[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const je={"+":t=>t,"-":t=>-t,"~":t=>~t};class He{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=je[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Ke(t){return(e,i)=>{for(let n=0;n<t.length;n++){const s=t[n](e,i);if(""!==s)return s}return""}}function $e(t,e){var i;const n=t.substr(e).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Ye(t,e){const i=t.substr(e,1);return i.match(/^[1-9]$/)?i:""}function qe(t,e){var i;const n=t.substr(e).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Ge(t,e){const i=qe(t,e);if(""!==i)return i;const n=t.substr(e,1);if("-"!==n&&"+"!==n)return"";const s=qe(t,e+=1);return""===s?"":n+s}function Ze(t,e){const i=t.substr(e,1);if(e+=1,"e"!==i.toLowerCase())return"";const n=Ge(t,e);return""===n?"":i+n}function Xe(t,e){const i=t.substr(e,1);if("0"===i)return i;const n=Ye(t,e);return e+=n.length,""===n?"":n+qe(t,e)}function We(t,e){const i=Xe(t,e);if(e+=i.length,""===i)return"";const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const s=qe(t,e);return i+n+s+Ze(t,e+=s.length)}function Qe(t,e){const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const n=qe(t,e);return e+=n.length,""===n?"":i+n+Ze(t,e)}function Je(t,e){const i=Xe(t,e);return e+=i.length,""===i?"":i+Ze(t,e)}const ti=Ke([We,Qe,Je]);function ei(t,e){var i;const n=t.substr(e).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function ii(t,e){const i=t.substr(e,2);if(e+=i.length,"0b"!==i.toLowerCase())return"";const n=ei(t,e);return""===n?"":i+n}function ni(t,e){var i;const n=t.substr(e).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function si(t,e){const i=t.substr(e,2);if(e+=i.length,"0o"!==i.toLowerCase())return"";const n=ni(t,e);return""===n?"":i+n}function oi(t,e){var i;const n=t.substr(e).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}function ri(t,e){const i=t.substr(e,2);if(e+=i.length,"0x"!==i.toLowerCase())return"";const n=oi(t,e);return""===n?"":i+n}const ai=Ke([ii,si,ri]),li=Ke([ai,ti]);function hi(t,e){const i=li(t,e);return e+=i.length,""===i?null:{evaluable:new Ue(i),cursor:e}}function di(t,e){const i=t.substr(e,1);if(e+=i.length,"("!==i)return null;const n=gi(t,e);if(!n)return null;e=n.cursor,e+=$e(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:n.evaluable,cursor:e}}function ci(t,e){var i;return null!==(i=hi(t,e))&&void 0!==i?i:di(t,e)}function pi(t,e){const i=ci(t,e);if(i)return i;const n=t.substr(e,1);if(e+=n.length,"+"!==n&&"-"!==n&&"~"!==n)return null;const s=pi(t,e);return s?{cursor:e=s.cursor,evaluable:new He(n,s.evaluable)}:null}function ui(t,e,i){i+=$e(e,i).length;const n=t.filter((t=>e.startsWith(t,i)))[0];return n?(i+=n.length,{cursor:i+=$e(e,i).length,operator:n}):null}function vi(t,e){return(i,n)=>{const s=t(i,n);if(!s)return null;n=s.cursor;let o=s.evaluable;for(;;){const s=ui(e,i,n);if(!s)break;n=s.cursor;const r=t(i,n);if(!r)return null;n=r.cursor,o=new Be(s.operator,o,r.evaluable)}return o?{cursor:n,evaluable:o}:null}}const mi=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>vi(t,e)),pi);function gi(t,e){return e+=$e(t,e).length,mi(t,e)}function _i(t){const e=gi(t,0);return e&&e.cursor+$e(t,e.cursor).length===t.length?e.evaluable:null}function bi(t){var e;const i=_i(t);return null!==(e=null==i?void 0:i.evaluate())&&void 0!==e?e:null}function fi(t){if("number"==typeof t)return t;if("string"==typeof t){const e=bi(t);if(!l(e))return e}return 0}function wi(t){return String(t)}function xi(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}const yi=xi(0);function Ci(t){return yi(t)+"%"}function Ei(t){return String(t)}function Pi(t){return t}function ki({primary:t,secondary:e,forward:i,backward:n}){let s=!1;function o(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(n=>{o((()=>{e.setRawValue(i(t,e),n.options)}))})),e.emitter.on("change",(s=>{o((()=>{t.setRawValue(n(t,e),s.options)})),o((()=>{e.setRawValue(i(t,e),s.options)}))})),o((()=>{e.setRawValue(i(t,e),{forceEmit:!1,last:!0})}))}function zi(t,e){const i=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function Li(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Mi(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Vi(t){return"ArrowUp"===t||"ArrowDown"===t}function Ti(t){return Vi(t)||"ArrowLeft"===t||"ArrowRight"===t}function Ai(t,e){var i,n;const s=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:t.pageX-((null!==(i=s&&s.scrollX)&&void 0!==i?i:0)+o.left),y:t.pageY-((null!==(n=s&&s.scrollY)&&void 0!==n?n:0)+o.top)}}class Si{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new m,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Ai(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Ai(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Ai(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const i=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Oi(t,e,i,n,s){return n+(t-e)/(i-e)*(s-n)}function Ii(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Di(t,e,i){return Math.min(Math.max(t,e),i)}function Ri(t,e){return(t%e+e)%e}const Fi=_("txt");class Ui{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Fi(),Fi(void 0,"num")),e.arrayPosition&&this.element.classList.add(Fi(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(Fi("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Fi()),this.inputElement.classList.add(Fi("i"));const n=t.createElement("div");n.classList.add(Fi("k")),this.element.appendChild(n),this.knobElement=n;const s=t.createElementNS(Z,"svg");s.classList.add(Fi("g")),this.knobElement.appendChild(s);const o=t.createElementNS(Z,"path");o.classList.add(Fi("gb")),s.appendChild(o),this.guideBodyElem_=o;const r=t.createElementNS(Z,"path");r.classList.add(Fi("gh")),s.appendChild(r),this.guideHeadElem_=r;const a=t.createElement("div");a.classList.add(_("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(Fi(void 0,"drg"));this.element.classList.add(Fi(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),n=Di(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Ni{constructor(t,e){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=null!==(i=e.sliderProps)&&void 0!==i?i:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=V(null),this.view=new Ui(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new Si(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,i;const n=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("minValue"),s=null===(i=this.sliderProps_)||void 0===i?void 0:i.get("maxValue");let o=t;return void 0!==n&&(o=Math.max(o,n)),void 0!==s&&(o=Math.min(o,s)),o}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);l(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()}onInputKeyDown_(t){const e=zi(this.baseStep_,Li(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==zi(this.baseStep_,Li(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Bi=_("sld");class ji{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Bi()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Bi("t")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const n=t.createElement("div");n.classList.add(Bi("k")),this.trackElement.appendChild(n),this.knobElement=n,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=Di(Oi(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}}class Hi{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new ji(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(Oi(Di(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=zi(this.baseStep_,Mi(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){0!==zi(this.baseStep_,Mi(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ki=_("sldtxt");class $i{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ki());const i=t.createElement("div");i.classList.add(Ki("s")),this.sliderView_=e.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Ki("t")),this.textView_=e.textView,n.appendChild(this.textView_.element),this.element.appendChild(n)}}class Yi{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new Hi(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new Ni(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new $i(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function qi(t,e){t.write(e)}function Gi(t){const e=R;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function Zi(t){if("inline"===t||"popup"===t)return t}function Xi(t){const e=R;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function Wi(t){if(Array.isArray(t))return t;const e=[];return Object.keys(t).forEach((i=>{e.push({text:i,value:t[i]})})),e}function Qi(t){return l(t)?null:new Ee(Wi(t))}function Ji(t){const e=t?ye(t,ke):null;return e?e.step:null}function tn(t,e){const i=t&&ye(t,ke);return i?Ii(i.step):Math.max(Ii(e),2)}function en(t){return Ji(t)??1}function nn(t,e){var i;const n=t&&ye(t,ke),s=Math.abs(null!==(i=null==n?void 0:n.step)&&void 0!==i?i:e);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}const sn=_("ckb");class on{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(sn()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("label");i.classList.add(sn("l")),this.element.appendChild(i);const n=t.createElement("input");n.classList.add(sn("i")),n.type="checkbox",i.appendChild(n),this.inputElement=n,e.viewProps.bindDisabled(this.inputElement);const s=t.createElement("div");s.classList.add(sn("w")),i.appendChild(s);const o=nt(t,"check");s.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class rn{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new on(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked}}function an(t){const e=[],i=Qi(t.options);return i&&e.push(i),new xe(e)}const ln={id:"input-bool",type:"input",accept:(t,e)=>{if("boolean"!=typeof t)return null;const i=F(e,{options:R.optional.custom(Gi)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Re,constraint:t=>an(t.params),writer:t=>qi},controller:t=>{const e=t.document,i=t.value,n=t.constraint,s=n&&ye(n,Ee);return s?new Me(e,{props:new T({options:s.values.value("options")}),value:i,viewProps:t.viewProps}):new rn(e,{value:i,viewProps:t.viewProps})}},hn=_("col");class dn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(hn()),e.foldable.bindExpandedClass(this.element,hn(void 0,"expanded")),x(e.foldable,"completed",C(this.element,hn(void 0,"cpl")));const i=t.createElement("div");i.classList.add(hn("h")),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(hn("s")),i.appendChild(n),this.swatchElement=n;const s=t.createElement("div");if(s.classList.add(hn("t")),i.appendChild(s),this.textElement=s,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(hn("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}function cn(t,e,i){const n=Di(t/255,0,1),s=Di(e/255,0,1),o=Di(i/255,0,1),r=Math.max(n,s,o),a=Math.min(n,s,o),l=r-a;let h=0,d=0;const c=(a+r)/2;return 0!==l&&(d=l/(1-Math.abs(r+a-1)),h=n===r?(s-o)/l:s===r?2+(o-n)/l:4+(n-s)/l,h=h/6+(h<0?1:0)),[360*h,100*d,100*c]}function pn(t,e,i){const n=(t%360+360)%360,s=Di(e/100,0,1),o=Di(i/100,0,1),r=(1-Math.abs(2*o-1))*s,a=r*(1-Math.abs(n/60%2-1)),l=o-r/2;let h,d,c;return[h,d,c]=n>=0&&n<60?[r,a,0]:n>=60&&n<120?[a,r,0]:n>=120&&n<180?[0,r,a]:n>=180&&n<240?[0,a,r]:n>=240&&n<300?[a,0,r]:[r,0,a],[255*(h+l),255*(d+l),255*(c+l)]}function un(t,e,i){const n=Di(t/255,0,1),s=Di(e/255,0,1),o=Di(i/255,0,1),r=Math.max(n,s,o),a=r-Math.min(n,s,o);let l;return l=0===a?0:r===n?((s-o)/a%6+6)%6*60:r===s?60*((o-n)/a+2):60*((n-s)/a+4),[l,100*(0===r?0:a/r),100*r]}function vn(t,e,i){const n=Ri(t,360),s=Di(e/100,0,1),o=Di(i/100,0,1),r=o*s,a=r*(1-Math.abs(n/60%2-1)),l=o-r;let h,d,c;return[h,d,c]=n>=0&&n<60?[r,a,0]:n>=60&&n<120?[a,r,0]:n>=120&&n<180?[0,r,a]:n>=180&&n<240?[0,a,r]:n>=240&&n<300?[a,0,r]:[r,0,a],[255*(h+l),255*(d+l),255*(c+l)]}function mn(t,e,i){const n=i+e*(100-Math.abs(2*i-100))/200;return[t,0!==n?e*(100-Math.abs(2*i-100))/n:0,i+e*(100-Math.abs(2*i-100))/200]}function gn(t,e,i){const n=100-Math.abs(i*(200-e)/100-100);return[t,0!==n?e*i/n:0,i*(200-e)/200]}function _n(t){return[t[0],t[1],t[2]]}function bn(t,e){return[t[0],t[1],t[2],e]}const fn={hsl:{hsl:(t,e,i)=>[t,e,i],hsv:mn,rgb:pn},hsv:{hsl:gn,hsv:(t,e,i)=>[t,e,i],rgb:vn},rgb:{hsl:cn,hsv:un,rgb:(t,e,i)=>[t,e,i]}};function wn(t,e){return["float"===e?1:"rgb"===t?255:360,"float"===e?1:"rgb"===t?255:100,"float"===e?1:"rgb"===t?255:100]}function xn(t,e){return t===e?e:Ri(t,e)}function yn(t,e,i){var n;const s=wn(e,i);return["rgb"===e?Di(t[0],0,s[0]):xn(t[0],s[0]),Di(t[1],0,s[1]),Di(t[2],0,s[2]),Di(null!==(n=t[3])&&void 0!==n?n:1,0,1)]}function Cn(t,e,i,n){const s=wn(e,i),o=wn(e,n);return t.map(((t,e)=>t/s[e]*o[e]))}function En(t,e,i){const n=Cn(t,e.mode,e.type,"int");return Cn(fn[e.mode][i.mode](...n),i.mode,"int",i.type)}function Pn(t,e){return"object"==typeof t&&!l(t)&&e in t&&"number"==typeof t[e]}class kn{static black(t="int"){return new kn([0,0,0],"rgb",t)}static fromObject(t,e="int"){const i="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new kn(i,"rgb",e)}static toRgbaObject(t,e="int"){return t.toRgbaObject(e)}static isRgbColorObject(t){return Pn(t,"r")&&Pn(t,"g")&&Pn(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&Pn(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode!==e.mode)return!1;const i=t.comps_,n=e.comps_;for(let s=0;s<i.length;s++)if(i[s]!==n[s])return!1;return!0}constructor(t,e,i="int"){this.mode=e,this.type=i,this.comps_=yn(t,e,i)}getComponents(t,e="int"){return bn(En(_n(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:e}),this.comps_[3])}toRgbaObject(t="int"){const e=this.getComponents("rgb",t);return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const zn=_("colp");class Ln{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(zn()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(zn("hsv"));const n=t.createElement("div");n.classList.add(zn("sv")),this.svPaletteView_=e.svPaletteView,n.appendChild(this.svPaletteView_.element),i.appendChild(n);const s=t.createElement("div");s.classList.add(zn("h")),this.hPaletteView_=e.hPaletteView,s.appendChild(this.hPaletteView_.element),i.appendChild(s),this.element.appendChild(i);const o=t.createElement("div");if(o.classList.add(zn("rgb")),this.textView_=e.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const i=t.createElement("div");i.classList.add(zn("a"));const n=t.createElement("div");n.classList.add(zn("ap")),n.appendChild(this.alphaViews_.palette.element),i.appendChild(n);const s=t.createElement("div");s.classList.add(zn("at")),s.appendChild(this.alphaViews_.text.element),i.appendChild(s),this.element.appendChild(i)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((t=>t.inputElement))];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function Mn(t){return"int"===t?"int":"float"===t?"float":void 0}function Vn(t){const e=R;return F(t,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Mn)}),expanded:e.optional.boolean,picker:e.optional.custom(Zi)})}function Tn(t){return t?.1:1}function An(t){var e;return null===(e=t.color)||void 0===e?void 0:e.type}function Sn(t,e){return t.alpha===e.alpha&&t.mode===e.mode&&t.notation===e.notation&&t.type===e.type}function On(t,e){const i=t.match(/^(.+)%$/);return Math.min(i?.01*parseFloat(i[1])*e:parseFloat(t),e)}const In={deg:t=>t,grad:t=>360*t/400,rad:t=>360*t/(2*Math.PI),turn:t=>360*t};function Dn(t){const e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);const i=parseFloat(e[1]),n=e[2];return In[n](i)}function Rn(t){const e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[On(e[1],255),On(e[2],255),On(e[3],255)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function Fn(t){return e=>{const i=Rn(e);return i?new kn(i,"rgb",t):null}}function Un(t){const e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[On(e[1],255),On(e[2],255),On(e[3],255),On(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function Nn(t){return e=>{const i=Un(e);return i?new kn(i,"rgb",t):null}}function Bn(t){const e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[Dn(e[1]),On(e[2],100),On(e[3],100)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function jn(t){return e=>{const i=Bn(e);return i?new kn(i,"hsl",t):null}}function Hn(t){const e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[Dn(e[1]),On(e[2],100),On(e[3],100),On(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function Kn(t){return e=>{const i=Hn(e);return i?new kn(i,"hsl",t):null}}function $n(t){const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const i=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]:null}function Yn(t){const e=$n(t);return e?new kn(e,"rgb","int"):null}function qn(t){const e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Oi(parseInt(e[4]+e[4],16),0,255,0,1)];const i=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16),Oi(parseInt(i[4],16),0,255,0,1)]:null}function Gn(t){const e=qn(t);return e?new kn(e,"rgb","int"):null}function Zn(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const i=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function Xn(t){return e=>{const i=Zn(e);return i?new kn(i,"rgb",t):null}}function Wn(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const i=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function Qn(t){return e=>{const i=Wn(e);return i?new kn(i,"rgb",t):null}}const Jn=[{parser:$n,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:qn,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Rn,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Un,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Bn,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Hn,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Zn,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Wn,result:{alpha:!0,mode:"rgb",notation:"object"}}];function ts(t){return Jn.reduce(((e,{parser:i,result:n})=>e||(i(t)?n:null)),null)}function es(t,e="int"){const i=ts(t);return i?"hex"===i.notation&&"float"!==e?Object.assign(Object.assign({},i),{type:"int"}):"func"===i.notation?Object.assign(Object.assign({},i),{type:e}):null:null}const is={int:[Yn,Gn,Fn("int"),Nn("int"),jn("int"),Kn("int"),Xn("int"),Qn("int")],float:[Fn("float"),Nn("float"),jn("float"),Kn("float"),Xn("float"),Qn("float")]};function ns(t){const e=is[t];return i=>"string"!=typeof i?kn.black(t):e.reduce(((t,e)=>t||e(i)),null)??kn.black(t)}function ss(t){const e=is[t];return t=>e.reduce(((e,i)=>e||i(t)),null)}function os(t){const e=Di(Math.floor(t),0,255).toString(16);return 1===e.length?`0${e}`:e}function rs(t,e="#"){return`${e}${_n(t.getComponents("rgb")).map(os).join("")}`}function as(t,e="#"){const i=t.getComponents("rgb");return`${e}${[i[0],i[1],i[2],255*i[3]].map(os).join("")}`}function ls(t,e){const i=xi("float"===e?2:0);return`rgb(${_n(t.getComponents("rgb",e)).map((t=>i(t))).join(", ")})`}function hs(t){return e=>ls(e,t)}function ds(t,e){const i=xi(2),n=xi("float"===e?2:0);return`rgba(${t.getComponents("rgb",e).map(((t,e)=>(3===e?i:n)(t))).join(", ")})`}function cs(t){return e=>ds(e,t)}function ps(t){const e=[xi(0),Ci,Ci];return`hsl(${_n(t.getComponents("hsl")).map(((t,i)=>e[i](t))).join(", ")})`}function us(t){const e=[xi(0),Ci,Ci,xi(2)];return`hsla(${t.getComponents("hsl").map(((t,i)=>e[i](t))).join(", ")})`}function vs(t,e){const i=xi("float"===e?2:0),n=["r","g","b"];return`{${_n(t.getComponents("rgb",e)).map(((t,e)=>`${n[e]}: ${i(t)}`)).join(", ")}}`}function ms(t){return e=>vs(e,t)}function gs(t,e){const i=xi(2),n=xi("float"===e?2:0),s=["r","g","b","a"];return`{${t.getComponents("rgb",e).map(((t,e)=>{const o=3===e?i:n;return`${s[e]}: ${o(t)}`})).join(", ")}}`}function _s(t){return e=>gs(e,t)}const bs=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:rs},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:as},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:ps},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:us},...["int","float"].reduce(((t,e)=>[...t,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:hs(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:cs(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:ms(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:_s(e)}]),[])];function fs(t){return bs.reduce(((e,i)=>e||(Sn(i.format,t)?i.stringifier:null)),null)}const ws=_("apl");class xs{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(ws()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(ws("b")),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(ws("c")),i.appendChild(n),this.colorElem_=n;const s=t.createElement("div");s.classList.add(ws("m")),this.element.appendChild(s),this.markerElem_=s;const o=t.createElement("div");o.classList.add(ws("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),i=new kn([e[0],e[1],e[2],0],"rgb"),n=new kn([e[0],e[1],e[2],255],"rgb"),s=["to right",ds(i),ds(n)];this.colorElem_.style.background=`linear-gradient(${s.join(",")})`,this.previewElem_.style.backgroundColor=ds(t);const o=Oi(e[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}}class ys{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new xs(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=t.point.x/t.bounds.width,n=this.value.rawValue,[s,o,r]=n.getComponents("hsv");this.value.setRawValue(new kn([s,o,r,i],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=zi(Tn(!0),Mi(t));if(0===e)return;const i=this.value.rawValue,[n,s,o,r]=i.getComponents("hsv");this.value.setRawValue(new kn([n,s,o,r+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==zi(Tn(!0),Mi(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Cs=_("coltxt");function Es(t){const e=t.createElement("select"),i=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(i.reduce(((e,i)=>{const n=t.createElement("option");return n.textContent=i.text,n.value=i.value,e.appendChild(n),e}),t.createDocumentFragment())),e}class Ps{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Cs()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Cs("m")),this.modeElem_=Es(t),this.modeElem_.classList.add(Cs("ms")),i.appendChild(this.modeSelectElement),e.viewProps.bindDisabled(this.modeElem_);const n=t.createElement("div");n.classList.add(Cs("mm")),n.appendChild(nt(t,"dropdown")),i.appendChild(n),this.element.appendChild(i);const s=t.createElement("div");s.classList.add(Cs("w")),this.element.appendChild(s),this.textsElem_=s,this.textViews_=e.textViews,this.applyTextViews_(),w(e.colorMode,(t=>{this.modeElem_.value=t}))}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){rt(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach((e=>{const i=t.createElement("div");i.classList.add(Cs("c")),i.appendChild(e.element),this.textsElem_.appendChild(i)}))}}function ks(t){return xi("float"===t?2:0)}function zs(t,e,i){const n=wn(t,e)[i];return new Ce({min:0,max:n})}function Ls(t,e,i){return new Ni(t,{arrayPosition:0===i?"fst":2===i?"lst":"mid",baseStep:Tn(!1),parser:e.parser,props:T.fromObject({draggingScale:"float"===e.colorType?.01:1,formatter:ks(e.colorType)}),value:V(0,{constraint:zs(e.colorMode,e.colorType,i)}),viewProps:e.viewProps})}class Ms{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=V(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new Ps(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},i=[Ls(t,e,0),Ls(t,e,1),Ls(t,e,2)];return i.forEach(((t,e)=>{ki({primary:this.value,secondary:t.value,forward:t=>t.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[e],backward:(t,i)=>{const n=this.colorMode.rawValue,s=t.rawValue.getComponents(n,this.colorType_);return s[e]=i.rawValue,new kn(bn(_n(s),s[3]),n,this.colorType_)}})})),i}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Vs=_("hpl");class Ts{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Vs()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(Vs("c")),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Vs("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=ls(new kn([e,100,100],"hsv"));const i=Oi(e,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}}class As{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Ts(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=Oi(Di(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),n=this.value.rawValue,[,s,o,r]=n.getComponents("hsv");this.value.setRawValue(new kn([i,s,o,r],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=zi(Tn(!1),Mi(t));if(0===e)return;const i=this.value.rawValue,[n,s,o,r]=i.getComponents("hsv");this.value.setRawValue(new kn([n+e,s,o,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==zi(Tn(!1),Mi(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ss=_("svp"),Os=64;class Is{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Ss()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("canvas");i.height=Os,i.width=Os,i.classList.add(Ss("c")),this.element.appendChild(i),this.canvasElement=i;const n=t.createElement("div");n.classList.add(Ss("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const t=et(this.canvasElement);if(!t)return;const e=this.value.rawValue.getComponents("hsv"),i=this.canvasElement.width,n=this.canvasElement.height,s=t.getImageData(0,0,i,n),o=s.data;for(let l=0;l<n;l++)for(let t=0;t<i;t++){const s=Oi(t,0,i,0,100),r=Oi(l,0,n,100,0),a=vn(e[0],s,r),h=4*(l*i+t);o[h]=a[0],o[h+1]=a[1],o[h+2]=a[2],o[h+3]=255}t.putImageData(s,0,0);const r=Oi(e[1],0,100,0,100);this.markerElem_.style.left=`${r}%`;const a=Oi(e[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class Ds{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Is(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=Oi(t.point.x,0,t.bounds.width,0,100),n=Oi(t.point.y,0,t.bounds.height,100,0),[s,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new kn([s,i,n,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){Ti(t.key)&&t.preventDefault();const[e,i,n,s]=this.value.rawValue.getComponents("hsv"),o=Tn(!1),r=zi(o,Mi(t)),a=zi(o,Li(t));0===r&&0===a||this.value.setRawValue(new kn([e,i+r,n+a,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=Tn(!1),i=zi(e,Mi(t)),n=zi(e,Li(t));0===i&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Rs{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new As(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Ds(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new ys(t,{value:this.value,viewProps:this.viewProps}),text:new Ni(t,{parser:bi,baseStep:.1,props:T.fromObject({draggingScale:.01,formatter:xi(2)}),value:V(0,{constraint:new Ce({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&ki({primary:this.value,secondary:this.alphaIcs_.text.value,forward:t=>t.rawValue.getComponents()[3],backward:(t,e)=>{const i=t.rawValue.getComponents();return i[3]=e.rawValue,new kn(i,t.rawValue.mode)}}),this.textC_=new Ms(t,{colorType:e.colorType,parser:bi,value:this.value,viewProps:this.viewProps}),this.view=new Ln(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}get textController(){return this.textC_}}const Fs=_("colsw");class Us{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(Fs()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Fs("sw")),this.element.appendChild(i),this.swatchElem_=i;const n=t.createElement("button");n.classList.add(Fs("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=as(t)}onValueChange_(){this.update_()}}class Ns{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Us(t,{value:this.value,viewProps:this.viewProps})}}class Bs{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=gt.create(e.expanded),this.swatchC_=new Ns(t,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Ie(t,{parser:e.parser,props:T.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new dn(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new Ae(t,{viewProps:this.viewProps}):null;const n=new Rs(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});n.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(n.view.element),ki({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ft(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=lt(t);i&&e.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!Q(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function js(t,e){return kn.isColorObject(t)?kn.fromObject(t,e):kn.black(e)}function Hs(t){return _n(t.getComponents("rgb")).reduce(((t,e)=>t<<8|255&Math.floor(e)),0)}function Ks(t){return t.getComponents("rgb").reduce(((t,e,i)=>t<<8|255&Math.floor(3===i?255*e:e)),0)>>>0}function $s(t){return new kn([t>>16&255,t>>8&255,255&t],"rgb")}function Ys(t){return new kn([t>>24&255,t>>16&255,t>>8&255,Oi(255&t,0,255,0,1)],"rgb")}function qs(t){return"number"!=typeof t?kn.black():$s(t)}function Gs(t){return"number"!=typeof t?kn.black():Ys(t)}function Zs(t){const e=fs(t);return e?(t,i)=>{qi(t,e(i))}:null}function Xs(t){const e=t?Ks:Hs;return(t,i)=>{qi(t,e(i))}}function Ws(t,e,i){const n=e.toRgbaObject(i);t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b),t.writeProperty("a",n.a)}function Qs(t,e,i){const n=e.toRgbaObject(i);t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b)}function Js(t,e){return(i,n)=>{t?Ws(i,n,e):Qs(i,n,e)}}function to(t){var e;return!!((null==t?void 0:t.alpha)||null!==(e=null==t?void 0:t.color)&&void 0!==e&&e.alpha)}function eo(t){return t?t=>as(t,"0x"):t=>rs(t,"0x")}function io(t){return"color"in t||"view"in t&&"color"===t.view}const no={id:"input-color-number",type:"input",accept:(t,e)=>{if("number"!=typeof t||!io(e))return null;const i=Vn(e);return i?{initialValue:t,params:i}:null},binding:{reader:t=>to(t.params)?Gs:qs,equals:kn.equals,writer:t=>Xs(to(t.params))},controller:t=>{const e=to(t.params),i="expanded"in t.params?t.params.expanded:void 0,n="picker"in t.params?t.params.picker:void 0;return new Bs(t.document,{colorType:"int",expanded:i??!1,formatter:eo(e),parser:ss("int"),pickerLayout:n??"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};function so(t){return kn.isRgbaColorObject(t)}function oo(t){return e=>js(e,t)}function ro(t,e){return i=>t?gs(i,e):vs(i,e)}const ao={id:"input-color-object",type:"input",accept:(t,e)=>{if(!kn.isColorObject(t))return null;const i=Vn(e);return i?{initialValue:t,params:i}:null},binding:{reader:t=>oo(An(t.params)),equals:kn.equals,writer:t=>Js(so(t.initialValue),An(t.params))},controller:t=>{var e;const i=kn.isRgbaColorObject(t.initialValue),n="expanded"in t.params?t.params.expanded:void 0,s="picker"in t.params?t.params.picker:void 0,o=null!==(e=An(t.params))&&void 0!==e?e:"int";return new Bs(t.document,{colorType:o,expanded:n??!1,formatter:ro(i,o),parser:ss(o),pickerLayout:s??"popup",supportsAlpha:i,value:t.value,viewProps:t.viewProps})}},lo={id:"input-color-string",type:"input",accept:(t,e)=>{if("string"!=typeof t||"view"in e&&"text"===e.view)return null;const i=es(t,An(e));if(!i||!fs(i))return null;const n=Vn(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>{var e;return ns(null!==(e=An(t.params))&&void 0!==e?e:"int")},equals:kn.equals,writer:t=>{const e=es(t.initialValue,An(t.params));if(!e)throw p.shouldNeverHappen();const i=Zs(e);if(!i)throw p.notBindable();return i}},controller:t=>{const e=es(t.initialValue,An(t.params));if(!e)throw p.shouldNeverHappen();const i=fs(e);if(!i)throw p.shouldNeverHappen();const n="expanded"in t.params?t.params.expanded:void 0,s="picker"in t.params?t.params.picker:void 0;return new Bs(t.document,{colorType:e.type,expanded:n??!1,formatter:i,parser:ss(e.type),pickerLayout:s??"popup",supportsAlpha:e.alpha,value:t.value,viewProps:t.viewProps})}};class ho{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var i,n;return null!==(n=null===(i=this.components[e])||void 0===i?void 0:i.constrain(t))&&void 0!==n?n:t}));return this.asm_.fromComponents(e)}}const co=_("pndtxt");class po{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(co()),this.textViews.forEach((e=>{const i=t.createElement("div");i.classList.add(co("a")),i.appendChild(e.element),this.element.appendChild(i)}))}}function uo(t,e,i){return new Ni(t,{arrayPosition:0===i?"fst":i===e.axes.length-1?"lst":"mid",baseStep:e.axes[i].baseStep,parser:e.parser,props:e.axes[i].textProps,value:V(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}class vo{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((i,n)=>uo(t,e,n))),this.acs_.forEach(((t,i)=>{ki({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[i],backward:(t,n)=>{const s=e.assembly.toComponents(t.rawValue);return s[i]=n.rawValue,e.assembly.fromComponents(s)}})})),this.view=new po(t,{textViews:this.acs_.map((t=>t.view))})}}function mo(t,e){return"step"in t&&!l(t.step)?new ke(t.step,e):null}function go(t){return l(t.max)||l(t.min)?l(t.max)&&l(t.min)?null:new Pe({max:t.max,min:t.min}):new Ce({max:t.max,min:t.min})}function _o(t){const e=ye(t,Ce);if(e)return[e.values.get("min"),e.values.get("max")];const i=ye(t,Pe);return i?[i.minValue,i.maxValue]:[void 0,void 0]}function bo(t,e){const i=[],n=mo(t,e);n&&i.push(n);const s=go(t);s&&i.push(s);const o=Qi(t.options);return o&&i.push(o),new xe(i)}const fo={id:"input-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;const i=R,n=F(e,{format:i.optional.function,max:i.optional.number,min:i.optional.number,options:i.optional.custom(Gi),step:i.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:t=>fi,constraint:t=>bo(t.params,t.initialValue),writer:t=>qi},controller:t=>{var e;const i=t.value,n=t.constraint,s=n&&ye(n,Ee);if(s)return new Me(t.document,{props:new T({options:s.values.value("options")}),value:i,viewProps:t.viewProps});const o=null!==(e="format"in t.params?t.params.format:void 0)&&void 0!==e?e:xi(tn(n,i.rawValue)),r=n&&ye(n,Ce);return r?new Yi(t.document,{baseStep:en(n),parser:bi,sliderProps:new T({maxValue:r.values.value("max"),minValue:r.values.value("min")}),textProps:T.fromObject({draggingScale:nn(n,i.rawValue),formatter:o}),value:i,viewProps:t.viewProps}):new Ni(t.document,{baseStep:en(n),parser:bi,props:T.fromObject({draggingScale:nn(n,i.rawValue),formatter:o}),value:i,viewProps:t.viewProps})}};class wo{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(l(t))return!1;const e=t.x,i=t.y;return!("number"!=typeof e||"number"!=typeof i)}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const xo={toComponents:t=>t.getComponents(),fromComponents:t=>new wo(...t)},yo=_("p2d");class Co{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(yo()),e.viewProps.bindClassModifiers(this.element),w(e.expanded,C(this.element,yo(void 0,"expanded")));const i=t.createElement("div");i.classList.add(yo("h")),this.element.appendChild(i);const n=t.createElement("button");n.classList.add(yo("b")),n.appendChild(nt(t,"p2dpad")),e.viewProps.bindDisabled(n),i.appendChild(n),this.buttonElement=n;const s=t.createElement("div");if(s.classList.add(yo("t")),i.appendChild(s),this.textElement=s,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(yo("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const Eo=_("p2dp");class Po{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(Eo()),"popup"===e.layout&&this.element.classList.add(Eo(void 0,"p")),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Eo("p")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const n=t.createElementNS(Z,"svg");n.classList.add(Eo("g")),this.padElement.appendChild(n),this.svgElem_=n;const s=t.createElementNS(Z,"line");s.classList.add(Eo("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const o=t.createElementNS(Z,"line");o.classList.add(Eo("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const r=t.createElementNS(Z,"line");r.classList.add(Eo("l")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(r),this.lineElem_=r;const a=t.createElement("div");a.classList.add(Eo("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),i=this.maxValue_,n=Oi(t,-i,+i,0,100),s=Oi(e,-i,+i,0,100),o=this.invertsY_?100-s:s;this.lineElem_.setAttributeNS(null,"x2",`${n}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${n}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function ko(t,e,i){return[zi(e[0],Mi(t)),zi(e[1],Li(t))*(i?1:-1)]}class zo{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new Po(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=this.maxValue_,n=Oi(t.point.x,0,t.bounds.width,-i,+i),s=Oi(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-i,+i);this.value.setRawValue(new wo(n,s),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){Ti(t.key)&&t.preventDefault();const[e,i]=ko(t,this.baseSteps_,this.invertsY_);0===e&&0===i||this.value.setRawValue(new wo(this.value.rawValue.x+e,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,i]=ko(t,this.baseSteps_,this.invertsY_);0===e&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Lo{constructor(t,e){var i,n;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=gt.create(e.expanded),this.popC_="popup"===e.pickerLayout?new Ae(t,{viewProps:this.viewProps}):null;const s=new zo(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=s,this.textC_=new vo(t,{assembly:xo,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Co(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("blur",this.onPadButtonBlur_),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),ki({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ft(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=lt(t);i&&e.contains(i)||i&&i===this.view.buttonElement&&!Q(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}class Mo{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(l(t))return!1;const e=t.x,i=t.y,n=t.z;return!("number"!=typeof e||"number"!=typeof i||"number"!=typeof n)}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Vo={toComponents:t=>t.getComponents(),fromComponents:t=>new Mo(...t)};function To(t){return Mo.isObject(t)?new Mo(t.x,t.y,t.z):new Mo}function Ao(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function So(t,e){return new ho({assembly:Vo,components:[mr("x"in t?t.x:void 0,e.x),mr("y"in t?t.y:void 0,e.y),mr("z"in t?t.z:void 0,e.z)]})}function Oo(t,e){return{baseStep:en(e),constraint:e,textProps:T.fromObject({draggingScale:nn(e,t),formatter:xi(tn(e,t))})}}const Io={id:"input-point3d",type:"input",accept:(t,e)=>{if(!Mo.isObject(t))return null;const i=R,n=F(e,{x:i.optional.custom(Xi),y:i.optional.custom(Xi),z:i.optional.custom(Xi)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>To,constraint:t=>So(t.params,t.initialValue),equals:Mo.equals,writer:t=>Ao},controller:t=>{const e=t.value,i=t.constraint;if(!(i instanceof ho))throw p.shouldNeverHappen();return new vo(t.document,{assembly:Vo,axes:[Oo(e.rawValue.x,i.components[0]),Oo(e.rawValue.y,i.components[1]),Oo(e.rawValue.z,i.components[2])],parser:bi,value:e,viewProps:t.viewProps})}};class Do{constructor(t=0,e=0,i=0,n=0){this.x=t,this.y=e,this.z=i,this.w=n}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(l(t))return!1;const e=t.x,i=t.y,n=t.z,s=t.w;return!("number"!=typeof e||"number"!=typeof i||"number"!=typeof n||"number"!=typeof s)}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Ro={toComponents:t=>t.getComponents(),fromComponents:t=>new Do(...t)};function Fo(t){return Do.isObject(t)?new Do(t.x,t.y,t.z,t.w):new Do}function Uo(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function No(t,e){return new ho({assembly:Ro,components:[mr("x"in t?t.x:void 0,e.x),mr("y"in t?t.y:void 0,e.y),mr("z"in t?t.z:void 0,e.z),mr("w"in t?t.w:void 0,e.w)]})}function Bo(t,e){return{baseStep:en(e),constraint:e,textProps:T.fromObject({draggingScale:nn(e,t),formatter:xi(tn(e,t))})}}const jo={id:"input-point4d",type:"input",accept:(t,e)=>{if(!Do.isObject(t))return null;const i=R,n=F(e,{x:i.optional.custom(Xi),y:i.optional.custom(Xi),z:i.optional.custom(Xi),w:i.optional.custom(Xi)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Fo,constraint:t=>No(t.params,t.initialValue),equals:Do.equals,writer:t=>Uo},controller:t=>{const e=t.value,i=t.constraint;if(!(i instanceof ho))throw p.shouldNeverHappen();return new vo(t.document,{assembly:Ro,axes:e.rawValue.getComponents().map(((t,e)=>Bo(t,i.components[e]))),parser:bi,value:e,viewProps:t.viewProps})}};function Ho(t){const e=[],i=Qi(t.options);return i&&e.push(i),new xe(e)}const Ko={id:"input-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;const i=F(e,{options:R.optional.custom(Gi)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Ei,constraint:t=>Ho(t.params),writer:t=>qi},controller:t=>{const e=t.document,i=t.value,n=t.constraint,s=n&&ye(n,Ee);return s?new Me(e,{props:new T({options:s.values.value("options")}),value:i,viewProps:t.viewProps}):new Ie(e,{parser:t=>t,props:T.fromObject({formatter:Pi}),value:i,viewProps:t.viewProps})}},$o={monitor:{defaultInterval:200,defaultLineCount:3}},Yo=_("mll");class qo{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Yo()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("textarea");i.classList.add(Yo("i")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,i.readOnly=!0,e.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,i=[];this.value.rawValue.forEach((t=>{void 0!==t&&i.push(this.formatter_(t))})),t.textContent=i.join("\n"),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class Go{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new qo(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const Zo=_("sgl");class Xo{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Zo()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(Zo("i")),i.readOnly=!0,i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class Wo{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Xo(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const Qo={id:"monitor-bool",type:"monitor",accept:(t,e)=>{if("boolean"!=typeof t)return null;const i=F(e,{lineCount:R.optional.number});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Re},controller:t=>{var e;return 1===t.value.rawValue.length?new Wo(t.document,{formatter:Fe,value:t.value,viewProps:t.viewProps}):new Go(t.document,{formatter:Fe,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:$o.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}},Jo=_("grl");class tr{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Jo()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=t.createElementNS(Z,"svg");i.classList.add(Jo("g")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(Z,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const s=t.createElement("div");s.classList.add(Jo("t"),_("tt")()),this.element.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,i=this.props_.get("minValue"),n=this.props_.get("maxValue"),s=[];this.value.rawValue.forEach(((o,r)=>{if(void 0===o)return;const a=Oi(r,0,e,0,t.width),l=Oi(o,i,n,t.height,0);s.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const o=this.tooltipElem_,r=this.value.rawValue[this.cursor_.rawValue];if(void 0===r)return void o.classList.remove(Jo("t","a"));const a=Oi(this.cursor_.rawValue,0,e,0,t.width),l=Oi(r,i,n,t.height,0);o.style.left=`${a}px`,o.style.top=`${l}px`,o.textContent=`${this.formatter_(r)}`,o.classList.contains(Jo("t","a"))||(o.classList.add(Jo("t","a"),Jo("t","in")),X(o),o.classList.remove(Jo("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class er{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=V(-1),this.view=new tr(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),Q(t)){const t=new Si(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(Oi(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.rawValue=Math.floor(Oi(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function ir(t){return"format"in t&&!l(t.format)?t.format:xi(2)}function nr(t){var e;return 1===t.value.rawValue.length?new Wo(t.document,{formatter:ir(t.params),value:t.value,viewProps:t.viewProps}):new Go(t.document,{formatter:ir(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:$o.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}function sr(t){var e,i,n;return new er(t.document,{formatter:ir(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:$o.monitor.defaultLineCount,props:T.fromObject({maxValue:null!==(i="max"in t.params?t.params.max:null)&&void 0!==i?i:100,minValue:null!==(n="min"in t.params?t.params.min:null)&&void 0!==n?n:0}),value:t.value,viewProps:t.viewProps})}function or(t){return"view"in t&&"graph"===t.view}const rr={id:"monitor-number",type:"monitor",accept:(t,e)=>{if("number"!=typeof t)return null;const i=R,n=F(e,{format:i.optional.function,lineCount:i.optional.number,max:i.optional.number,min:i.optional.number,view:i.optional.string});return n?{initialValue:t,params:n}:null},binding:{defaultBufferSize:t=>or(t)?64:1,reader:t=>fi},controller:t=>or(t.params)?sr(t):nr(t)},ar={id:"monitor-string",type:"monitor",accept:(t,e)=>{if("string"!=typeof t)return null;const i=R,n=F(e,{lineCount:i.optional.number,multiline:i.optional.boolean});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Ei},controller:t=>{var e;const i=t.value;return i.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new Go(t.document,{formatter:Pi,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:$o.monitor.defaultLineCount,value:i,viewProps:t.viewProps}):new Wo(t.document,{formatter:Pi,value:i,viewProps:t.viewProps})}};function lr(t,e){var i;const n=t.accept(e.target.read(),e.params);if(l(n))return null;const s=R,o={target:e.target,initialValue:n.initialValue,params:n.params},r=t.binding.reader(o),a=t.binding.constraint?t.binding.constraint(o):void 0,h=V(r(n.initialValue),{constraint:a,equals:t.binding.equals}),d=new me({reader:r,target:e.target,value:h,writer:t.binding.writer(o)}),c=s.optional.boolean(e.params.disabled).value,p=s.optional.boolean(e.params.hidden).value,u=t.controller({constraint:a,document:e.document,initialValue:n.initialValue,params:n.params,value:d.value,viewProps:K.create({disabled:c,hidden:p})});return new zt(e.document,{binding:d,blade:mt(),props:T.fromObject({label:"label"in e.params?null!==(i=s.optional.string(e.params.label).value)&&void 0!==i?i:null:e.target.key}),valueController:u})}function hr(t,e){return 0===e?new ue:new ve(t,e??$o.monitor.defaultInterval)}function dr(t,e){var i,n,s;const o=R,r=t.accept(e.target.read(),e.params);if(l(r))return null;const a={target:e.target,initialValue:r.initialValue,params:r.params},h=t.binding.reader(a),d=null!==(n=null!==(i=o.optional.number(e.params.bufferSize).value)&&void 0!==i?i:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(r.params))&&void 0!==n?n:1,c=o.optional.number(e.params.interval).value,p=new we({reader:h,target:e.target,ticker:hr(e.document,c),value:_e(d)}),u=o.optional.boolean(e.params.disabled).value,v=o.optional.boolean(e.params.hidden).value,m=t.controller({document:e.document,params:r.params,value:p.value,viewProps:K.create({disabled:u,hidden:v})});return new Mt(e.document,{binding:p,blade:mt(),props:T.fromObject({label:"label"in e.params?null!==(s=o.optional.string(e.params.label).value)&&void 0!==s?s:null:e.target.key}),valueController:m})}class cr{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,i){if(l(e.read()))throw new p({context:{key:e.key},type:"nomatchingcontroller"});const n=this.pluginsMap_.inputs.reduce(((n,s)=>n??lr(s,{document:t,target:e,params:i})),null);if(n)return n;throw new p({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,i){const n=this.pluginsMap_.monitors.reduce(((n,s)=>n??dr(s,{document:t,params:i,target:e})),null);if(n)return n;throw new p({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const i=this.pluginsMap_.blades.reduce(((i,n)=>i??pe(n,{document:t,params:e})),null);if(!i)throw new p({type:"nomatchingview",context:{params:e}});return i}createBladeApi(t){if(t instanceof zt)return new kt(t);if(t instanceof Mt)return new Lt(t);if(t instanceof Ht)return new St(t,this);const e=this.pluginsMap_.blades.reduce(((e,i)=>e??i.api({controller:t,pool:this})),null);if(!e)throw p.shouldNeverHappen();return e}}function pr(){const t=new cr;return[xr,Io,jo,Ko,fo,lo,ao,no,ln,Qo,ar,rr,ut,qt,Jt,ce].forEach((e=>{t.register(e)})),t}function ur(t){return wo.isObject(t)?new wo(t.x,t.y):new wo}function vr(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function mr(t,e){if(!t)return;const i=[],n=mo(t,e);n&&i.push(n);const s=go(t);return s&&i.push(s),new xe(i)}function gr(t,e){return new ho({assembly:xo,components:[mr("x"in t?t.x:void 0,e.x),mr("y"in t?t.y:void 0,e.y)]})}function _r(t,e){const[i,n]=t?_o(t):[];if(!l(i)||!l(n))return Math.max(Math.abs(i??0),Math.abs(n??0));const s=en(t);return Math.max(10*Math.abs(s),10*Math.abs(e))}function br(t,e){const i=e instanceof ho?e.components[0]:void 0,n=e instanceof ho?e.components[1]:void 0,s=_r(i,t.x),o=_r(n,t.y);return Math.max(s,o)}function fr(t,e){return{baseStep:en(e),constraint:e,textProps:T.fromObject({draggingScale:nn(e,t),formatter:xi(tn(e,t))})}}function wr(t){if(!("y"in t))return!1;const e=t.y;return!(!e||!("inverted"in e)||!e.inverted)}const xr={id:"input-point2d",type:"input",accept:(t,e)=>{if(!wo.isObject(t))return null;const i=R,n=F(e,{expanded:i.optional.boolean,picker:i.optional.custom(Zi),x:i.optional.custom(Xi),y:i.optional.object({inverted:i.optional.boolean,max:i.optional.number,min:i.optional.number,step:i.optional.number})});return n?{initialValue:t,params:n}:null},binding:{reader:t=>ur,constraint:t=>gr(t.params,t.initialValue),equals:wo.equals,writer:t=>vr},controller:t=>{const e=t.document,i=t.value,n=t.constraint;if(!(n instanceof ho))throw p.shouldNeverHappen();const s="expanded"in t.params?t.params.expanded:void 0,o="picker"in t.params?t.params.picker:void 0;return new Lo(e,{axes:[fr(i.rawValue.x,n.components[0]),fr(i.rawValue.y,n.components[1])],expanded:s??!1,invertsY:wr(t.params),maxValue:br(i.rawValue,n),parser:bi,pickerLayout:o??"popup",value:i,viewProps:t.viewProps})}};class yr extends i{constructor(t){super(t),this.emitter_=new m,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new s(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class Cr extends i{constructor(t){super(t),this.emitter_=new m,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new s(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class Er extends i{constructor(t){super(t),this.emitter_=new m,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new s(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}const Pr={id:"list",type:"blade",accept(t){const e=R,i=F(t,{options:e.required.custom(Gi),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return i?{params:i}:null},controller(t){const e=new Ee(Wi(t.params.options)),i=V(t.params.value,{constraint:e}),n=new Me(t.document,{props:new T({options:e.values.value("options")}),value:i,viewProps:t.viewProps});return new Gt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:n})},api:t=>t.controller instanceof Gt&&t.controller.valueController instanceof Me?new yr(t.controller):null};function kr(t){return t.reduce(((t,e)=>Object.assign(t,{[e.presetKey]:e.read()})),{})}function zr(t,e){t.forEach((t=>{const i=e[t.target.presetKey];void 0!==i&&t.writer(t.target,t.reader(i))}))}class Lr extends Ot{constructor(t,e){super(t,e)}get element(){return this.controller_.view.element}importPreset(t){zr(this.controller_.rackController.rack.find(zt).map((t=>t.binding)),t),this.refresh()}exportPreset(){return kr(this.controller_.rackController.rack.find(zt).map((t=>t.binding.target)))}refresh(){this.controller_.rackController.rack.find(zt).forEach((t=>{t.binding.read()})),this.controller_.rackController.rack.find(Mt).forEach((t=>{t.binding.read()}))}}class Mr extends Yt{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const Vr={id:"slider",type:"blade",accept(t){const e=R,i=F(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return i?{params:i}:null},controller(t){var e,i;const n=null!==(e=t.params.value)&&void 0!==e?e:0,s=new Ce({max:t.params.max,min:t.params.min}),o=new Yi(t.document,{baseStep:1,parser:bi,sliderProps:new T({maxValue:s.values.value("max"),minValue:s.values.value("min")}),textProps:T.fromObject({draggingScale:nn(void 0,n),formatter:null!==(i=t.params.format)&&void 0!==i?i:wi}),value:V(n,{constraint:s}),viewProps:t.viewProps});return new Gt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:o})},api:t=>t.controller instanceof Gt&&t.controller.valueController instanceof Yi?new Cr(t.controller):null},Tr={id:"text",type:"blade",accept(t){const e=R,i=F(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return i?{params:i}:null},controller(t){var e;const i=new Ie(t.document,{parser:t.params.parse,props:T.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:t=>String(t)}),value:V(t.params.value),viewProps:t.viewProps});return new Gt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:i})},api:t=>t.controller instanceof Gt&&t.controller.valueController instanceof Ie?new Er(t.controller):null};function Ar(t){const e=t.createElement("div");return e.classList.add(_("dfw")()),t.body&&t.body.appendChild(e),e}function Sr(t,e,i){if(t.querySelector(`style[data-tp-style=${e}]`))return;const n=t.createElement("style");n.dataset.tpStyle=e,n.textContent=i,t.head.appendChild(n)}class Or extends Lr{constructor(t){var e,i;const n=t??{},s=null!==(e=n.document)&&void 0!==e?e:tt(),o=pr();super(new Mr(s,{expanded:n.expanded,blade:mt(),props:T.fromObject({title:n.title}),viewProps:K.create()}),o),this.pool_=o,this.containerElem_=null!==(i=n.container)&&void 0!==i?i:Ar(s),this.containerElem_.appendChild(this.element),this.doc_=s,this.usesDefaultWrapper_=!n.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw p.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw p.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((t=>{this.pool_.register(t),this.embedPluginStyle_(t)}))}embedPluginStyle_(t){t.css&&Sr(this.document,`plugin-${t.id}`,t.css)}setUpDefaultPlugins_(){Sr(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach((t=>{this.embedPluginStyle_(t)})),this.registerPlugin({plugins:[Vr,Pr,ce,Tr]})}}const Ir=new e("3.1.9");t.BladeApi=i,t.ButtonApi=v,t.FolderApi=Ot,t.InputBindingApi=kt,t.ListApi=yr,t.MonitorBindingApi=Lt,t.Pane=Or,t.SeparatorApi=Zt,t.SliderApi=Cr,t.TabApi=oe,t.TabPageApi=se,t.TextApi=Er,t.TpChangeEvent=s,t.VERSION=Ir,Object.defineProperty(t,"__esModule",{value:!0})}(r);const a="three-inspect",l={get:t=>localStorage.getItem(`${a}.${t}`),getJSON(t){const e=l.get(t);return e?JSON.parse(e):null},getNumber(t){const e=l.get(t);return e?Number.parseFloat(e):null},remove(t){localStorage.removeItem(`${a}.${t}`)},set:(t,e)=>localStorage.setItem(`${a}.${t}`,e),setJSON(t,e){l.set(t,JSON.stringify(e))},setNumber(t,e){l.set(t,String(e))}},h=r.FolderApi.prototype.addFolder,d=r.FolderApi.prototype.dispose;r.FolderApi.prototype.addFolder=function(t){const e=`${String(t.index??-1)}.${t.title}`,i=h.call(this,{expanded:null!==l.get(`pane.${e}`),...t});return i.element.id=e,i.on("fold",(t=>{const i=`pane.${e}`;t.expanded?l.set(i,""):l.remove(i)})),i},r.FolderApi.prototype.dispose=function(){d.call(this)};let c=class{constructor(){e(this,"listeners",{})}addEventListener(t,e){const{listeners:i}=this;i[t]??(i[t]=[]),i[t].includes(e)||i[t].push(e)}hasEventListener(t,e){return this.listeners[t].includes(e)}removeEventListener(t,e){const{listeners:i}=this,n=i[t];if(void 0===n)return;const s=n.indexOf(e);-1!==s&&n.splice(s,1)}dispatchEvent(t){const{listeners:e}=this,i=e[t.type];if(void 0===i)return;t.target=this;const n=i.slice(0);for(let s=0,o=n.length;s<o;s+=1)n[s].call(this,t);t.target=null}};const p=new c,u={THREE:null,camera:null,composer:null,debugRoot:null,renderer:null,root:null,scene:null},v=2*Math.PI,m=1e-6,g={type:"change"},_={type:"start"},b={type:"end"};class f extends c{constructor(t,i){const{OrthographicCamera:n,PerspectiveCamera:s,Quaternion:o,Spherical:r,Vector2:a,Vector3:l}=u.THREE;super(),e(this,"enabled",!0),e(this,"target"),e(this,"minDistance",0),e(this,"maxDistance",1/0),e(this,"minZoom",0),e(this,"maxZoom",1/0),e(this,"minPolarAngle",0),e(this,"maxPolarAngle",Math.PI),e(this,"minAzimuthAngle",-1/0),e(this,"maxAzimuthAngle",1/0),e(this,"enableKeyEvents",!1),e(this,"enableDamping",!1),e(this,"dampingFactor",.05),e(this,"enableZoom",!0),e(this,"zoomSpeed",1),e(this,"enableRotate",!0),e(this,"rotateSpeed",1),e(this,"enablePan",!0),e(this,"panSpeed",1),e(this,"screenSpacePanning",!0),e(this,"keyPanSpeed",20),e(this,"autoRotate",!1),e(this,"autoRotateSpeed",2),e(this,"reverseOrbit",!1),e(this,"mouseButtons",{LEFT:3,MIDDLE:4,RIGHT:5}),e(this,"touches",{ONE:0,TWO:2}),e(this,"getPolarAngle"),e(this,"getAzimuthalAngle"),e(this,"getDistance"),e(this,"saveState"),e(this,"reset"),e(this,"update"),e(this,"dispose"),i.style.touchAction="none",this.target=new l;const h=this.target.clone(),d=t.position.clone();let c=t instanceof n?t.zoom:0;const p=new l,f=(new o).setFromUnitVectors(t.up,new l(0,1,0)),w=f.clone().invert(),x=new l,y=new o;let C=-1;const E=new l,P=new r,k=new r;let z=1;const L=new l;let M=!1;const V=new a,T=new a,A=new a,S=new a,O=new a,I=new a,D=new a,R=new a,F=new a,U=[],N={};this.getPolarAngle=()=>P.phi,this.getAzimuthalAngle=()=>P.theta,this.getDistance=()=>t.position.distanceTo(this.target),this.saveState=()=>{h.copy(this.target),d.copy(t.position),c=t.zoom};const B=t=>{k.theta-=t},j=()=>2*Math.PI/60/60*this.autoRotateSpeed,H=()=>{p.copy(t.position).sub(this.target),p.applyQuaternion(f),P.setFromVector3(p),this.autoRotate&&-1===C&&B(j()),this.enableDamping?(P.theta+=k.theta*this.dampingFactor,P.phi+=k.phi*this.dampingFactor):(P.theta+=k.theta,P.phi+=k.phi);let e=this.minAzimuthAngle,i=this.maxAzimuthAngle;return isFinite(e)&&isFinite(i)&&(e<-Math.PI?e+=v:e>Math.PI&&(e-=v),i<-Math.PI?i+=v:i>Math.PI&&(i-=v),P.theta=e<=i?Math.max(e,Math.min(i,P.theta)):P.theta>(e+i)/2?Math.max(e,P.theta):Math.min(i,P.theta)),P.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,P.phi)),P.makeSafe(),P.radius*=z,P.radius=Math.max(this.minDistance,Math.min(this.maxDistance,P.radius)),this.enableDamping?this.target.addScaledVector(L,this.dampingFactor):this.target.add(L),p.setFromSpherical(P),p.applyQuaternion(w),t.position.copy(this.target).add(p),t.lookAt(this.target),this.enableDamping?(k.theta*=1-this.dampingFactor,k.phi*=1-this.dampingFactor,L.multiplyScalar(1-this.dampingFactor)):(k.set(0,0,0),L.set(0,0,0)),z=1,!!(M||x.distanceToSquared(t.position)>m||8*(1-y.dot(t.quaternion))>m)&&(this.dispatchEvent(g),x.copy(t.position),y.copy(t.quaternion),M=!1,!0)};this.reset=()=>{this.target.copy(h),t.position.copy(d),t instanceof n&&(t.zoom=c,t.updateProjectionMatrix()),this.dispatchEvent(g),H(),C=-1},this.update=H;const K=()=>.95**this.zoomSpeed,$=t=>{k.phi-=t},Y=(t,e)=>{E.setFromMatrixColumn(e,0),E.multiplyScalar(-t),L.add(E)},q=(e,i)=>{this.screenSpacePanning?E.setFromMatrixColumn(i,1):(E.setFromMatrixColumn(i,0),E.crossVectors(t.up,E)),E.multiplyScalar(e),L.add(E)},G=(e,o)=>{if(t instanceof s){const{fov:n}=t;p.copy(t.position).sub(this.target);let s=p.length();s*=Math.tan(n/2*Math.PI/180),Y(2*e*s/i.clientHeight,t.matrix),q(2*o*s/i.clientHeight,t.matrix)}else t instanceof n&&(Y(e*(t.right-t.left)/t.zoom/i.clientWidth,t.matrix),q(o*(t.top-t.bottom)/t.zoom/i.clientHeight,t.matrix))},Z=e=>{t instanceof s?z/=e:t instanceof n&&(t.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,t.zoom*e)),t.updateProjectionMatrix(),M=!0)},X=e=>{t instanceof s?z*=e:t instanceof n&&(t.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,t.zoom/e)),t.updateProjectionMatrix(),M=!0)},W=t=>{V.set(t.clientX,t.clientY)},Q=t=>{S.set(t.clientX,t.clientY)},J=t=>{T.set(t.clientX,t.clientY),A.subVectors(T,V).multiplyScalar(this.rotateSpeed),B(2*Math.PI*A.x/i.clientHeight),$(2*Math.PI*A.y/i.clientHeight),V.copy(T),H()},tt=t=>{O.set(t.clientX,t.clientY),I.subVectors(O,S).multiplyScalar(this.panSpeed),G(I.x,I.y),S.copy(O),H()},et=t=>{let e=!1;switch(t.key.toLowerCase()){case"arrowup":case"w":G(0,this.keyPanSpeed),e=!0;break;case"arrowdown":case"s":G(0,-this.keyPanSpeed),e=!0;break;case"arrowleft":case"a":G(this.keyPanSpeed,0),e=!0;break;case"arrowright":case"d":G(-this.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),H())},it=()=>{if(1===U.length)V.set(U[0].pageX,U[0].pageY);else{const t=.5*(U[0].pageX+U[1].pageX),e=.5*(U[0].pageY+U[1].pageY);V.set(t,e)}},nt=()=>{if(1===U.length)S.set(U[0].pageX,U[0].pageY);else{const t=.5*(U[0].pageX+U[1].pageX),e=.5*(U[0].pageY+U[1].pageY);S.set(t,e)}},st=()=>{const t=U[0].pageX-U[1].pageX,e=U[0].pageY-U[1].pageY,i=Math.sqrt(t**2+e**2);D.set(0,i)},ot=()=>{this.enableZoom&&st(),this.enablePan&&nt()},rt=()=>{this.enableZoom&&st(),this.enableRotate&&it()},at=t=>{const e=t.pointerId===U[0].pointerId?U[1]:U[0];return N[e.pointerId]},lt=t=>{if(1===U.length)T.set(t.pageX,t.pageY);else{const e=at(t),i=.5*(t.pageX+e.x),n=.5*(t.pageY+e.y);T.set(i,n)}A.subVectors(T,V).multiplyScalar(this.rotateSpeed),B(2*Math.PI*A.x/i.clientHeight),$(2*Math.PI*A.y/i.clientHeight),V.copy(T)},ht=t=>{if(1===U.length)O.set(t.pageX,t.pageY);else{const e=at(t),i=.5*(t.pageX+e.x),n=.5*(t.pageY+e.y);O.set(i,n)}I.subVectors(O,S).multiplyScalar(this.panSpeed),G(I.x,I.y),S.copy(O)},dt=t=>{const e=at(t),i=t.pageX-e.x,n=t.pageY-e.y,s=Math.sqrt(i**2+n**2);R.set(0,s),F.set(0,(R.y/D.y)**this.zoomSpeed),Z(F.y),D.copy(R)},ct=t=>{this.enableZoom&&dt(t),this.enablePan&&ht(t)},pt=t=>{this.enableZoom&&dt(t),this.enableRotate&&lt(t)},ut=t=>{let e=N[t.pointerId];void 0===e&&(e=new a,N[t.pointerId]=e),e.set(t.pageX,t.pageY)},vt=t=>{switch(ut(t),U.length){case 1:switch(this.touches.ONE){case 0:if(!this.enableRotate)return;it(),C=3;break;case 1:if(!this.enablePan)return;nt(),C=4;break;default:C=-1}break;case 2:switch(this.touches.TWO){case 2:if(!this.enableZoom&&!this.enablePan)return;ot(),C=5;break;case 3:if(!this.enableZoom&&!this.enableRotate)return;rt(),C=6;break;default:C=-1}break;default:C=-1}-1!==C&&this.dispatchEvent(_)},mt=t=>{switch(ut(t),C){case 3:if(!this.enableRotate)return;return lt(t),void H();case 4:if(!this.enablePan)return;return ht(t),void H();case 5:if(!this.enableZoom&&!this.enablePan)return;return ct(t),void H();case 6:if(!this.enableZoom&&!this.enableRotate)return;return pt(t),void H();default:C=-1}},gt=t=>{let e=-1;switch(t.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT}switch(e){case 4:if(!this.enableZoom)return;(t=>{D.set(t.clientX,t.clientY)})(t),C=1;break;case 3:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!this.enablePan)return;Q(t),C=2}else{if(!this.enableRotate)return;W(t),C=0}break;case 5:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!this.enableRotate)return;W(t),C=0}else{if(!this.enablePan)return;Q(t),C=2}break;default:C=-1}-1!==C&&this.dispatchEvent(_)},_t=t=>{switch(C){case 0:if(!this.enableRotate)return;return void J(t);case 1:if(!this.enableZoom)return;return void(t=>{R.set(t.clientX,t.clientY),F.subVectors(R,D),F.y>0?Z(K()):F.y<0&&X(K()),D.copy(R),H()})(t);case 2:if(!this.enablePan)return;tt(t)}},bt=t=>{this.enabled&&("touch"===t.pointerType?mt(t):_t(t))},ft=t=>{delete N[t.pointerId];for(let e=0,i=U.length;e<i;e+=1)if(U[e].pointerId===t.pointerId)return void U.splice(e,1)},wt=t=>{ft(t),0===U.length&&(i.releasePointerCapture(t.pointerId),i.removeEventListener("pointermove",bt),i.removeEventListener("pointerup",wt)),this.dispatchEvent(b),C=-1},xt=t=>{this.enabled&&(0===U.length&&(i.setPointerCapture(t.pointerId),i.addEventListener("pointermove",bt),i.addEventListener("pointerup",wt)),(t=>{U.push(t)})(t),"touch"===t.pointerType?vt(t):gt(t))},yt=t=>{ft(t)},Ct=t=>{!this.enabled||!this.enableZoom||-1!==C||(t.preventDefault(),this.dispatchEvent(_),(t=>{t.deltaY<0?X(K()):t.deltaY>0&&Z(K()),H()})(t),this.dispatchEvent(b))},Et=t=>{!this.enableKeyEvents||!this.enabled||!this.enablePan||et(t)},Pt=t=>{this.enabled&&t.preventDefault()};this.dispose=()=>{window.removeEventListener("keydown",Et),i.removeEventListener("contextmenu",Pt),i.removeEventListener("pointerdown",xt),i.removeEventListener("pointercancel",yt),i.removeEventListener("wheel",Ct),i.removeEventListener("pointermove",bt),i.removeEventListener("pointerup",wt)},window.addEventListener("keydown",Et),i.addEventListener("contextmenu",Pt),i.addEventListener("pointerdown",xt),i.addEventListener("pointercancel",yt),i.addEventListener("wheel",Ct,{passive:!1}),H()}}class w extends f{constructor(t,e){super(t,e),this.screenSpacePanning=!1,this.mouseButtons.LEFT=5,this.mouseButtons.RIGHT=3,this.touches.ONE=1,this.touches.TWO=3}}var x=(t=>(t[t.NONE=0]="NONE",t[t.ORBIT=1]="ORBIT",t[t.MAP=2]="MAP",t))(x||{});let y;const C=(t,e)=>{const{renderer:i}=u,n=()=>{l.setJSON("camera",{position:e.position.toArray(),quaternion:e.quaternion.toArray(),target:null==y?void 0:y.target.toArray(),zoom:e.zoom})};void 0!==y&&(y.dispose(),window.removeEventListener("pointerup",n),window.removeEventListener("wheel",n)),2===t?(l.setNumber("controls",2),y=new w(e,i.domElement),window.addEventListener("pointerup",n,{passive:!0}),window.addEventListener("wheel",n,{passive:!0})):1===t?(l.setNumber("controls",1),y=new f(e,i.domElement),window.addEventListener("pointerup",n,{passive:!0}),window.addEventListener("wheel",n,{passive:!0}),((t,e)=>{const{camera:i}=u,{Matrix4:n,Vector2:s,Vector3:o}=u.THREE,r=new o,a=window.devicePixelRatio,l=80*a,h=8*a,d=6*a,c=8*a,p=2*a,v=new n,m=new o,g=new s,_=new s,b=new s,f=new o(l/2,l/2,0),w={x:["#f73c3c","#942424"],y:["#6ccb26","#417a17"],z:["#178cf0","#0e5490"]},x=[{axis:"x",color:w.x,direction:new o(1,0,0),label:"X",line:p,position:new o,size:h},{axis:"y",color:w.y,direction:new o(0,1,0),label:"Y",line:p,position:new o,size:h},{axis:"z",color:w.z,direction:new o(0,0,1),label:"Z",line:p,position:new o,size:h},{axis:"-x",color:w.x,direction:new o(-1,0,0),position:new o,size:d},{axis:"-y",color:w.y,direction:new o(0,-1,0),position:new o,size:d},{axis:"-z",color:w.z,direction:new o(0,0,-1),position:new o,size:d}];let y,C=null,E=!1,P=!1;const k=document.createElement("canvas");k.style.width=l/2+"px",k.style.height=l/2+"px",k.width=l,k.height=l,k.className="orbit-controls-gizmo",t.append(k);const z=k.getContext("2d");if(null===z)throw new Error("2d canvas context is null!");const L=(t,e=10,i="#FF0000")=>{z.beginPath(),z.arc(t.x,t.y,e,0,2*Math.PI,!1),z.fillStyle=i,z.fill(),z.closePath()},M=(t,e,i=1,n="#FF0000")=>{z.beginPath(),z.moveTo(t.x,t.y),z.lineTo(e.x,e.y),z.lineWidth=i,z.strokeStyle=n,z.stroke(),z.closePath()},V=t=>{t&&z.clearRect(0,0,k.width,k.height);for(let e=0,i=x.length;e<i;e+=1){const t=x[e],i=C===t,n=t.position.z>=-.01?t.color[0]:t.color[1];t.line&&M(f,t.position,t.line,n),L(t.position,t.size,i?"#FFFFFF":n),t.label&&(z.font=`bold ${12*a}px monospace`,z.fillStyle="#222222",z.textBaseline="middle",z.textAlign="center",z.fillText(t.label,t.position.x,t.position.y))}},T=t=>{const e=t.direction.clone().applyMatrix4(v);t.position.set(e.x*(f.x-t.size/2-c)+f.x,f.y-e.y*(f.y-t.size/2-c),e.z)},A=()=>{i.updateMatrix(),v.extractRotation(i.matrix).invert();for(let t=0,e=x.length;t<e;t+=1)T(x[t]);x.sort(((t,e)=>t.position.z>e.position.z?1:-1)),V(!0)},S=t=>{E||k.classList.add("dragging"),E=!0,C=null,_.set(t.clientX,t.clientY),b.subVectors(_,g).multiplyScalar(.5),g.copy(_)},O=()=>{setTimeout((()=>{E=!1}),0),k.classList.remove("dragging"),e.enabled=P,window.removeEventListener("pointermove",S,!1),window.removeEventListener("pointerup",O,!1)},I=()=>{y=k.getBoundingClientRect()},D=t=>{if(E)return;const e=C;C=null,void 0!==t&&m.set(t.clientX-y.left,t.clientY-y.top,0);for(let i=0,n=x.length;i<n;i+=1)r.copy(x[i].position).divideScalar(a),m.distanceTo(r)<x[i].size&&(C=x[i]);e!==C&&V(!1)},R=t=>{g.set(t.clientX,t.clientY),P=e.enabled,e.enabled=!1,window.addEventListener("pointermove",S,!1),window.addEventListener("pointerup",O,!1)},F=()=>{if(E||!C)return;const t=C.direction.clone(),n=i.position.distanceTo(e.target);t.multiplyScalar(n);const s=performance.now(),o=()=>{const n=performance.now()-s,r=Math.min(n/400,1);i.position.lerp(t,r),e.update(),1===r?D():requestAnimationFrame(o)};o(),C=null};e.addEventListener("change",A),e.addEventListener("start",(()=>k.classList.add("inactive"))),e.addEventListener("end",(()=>k.classList.remove("inactive"))),k.addEventListener("pointerdown",R,!1),k.addEventListener("pointerenter",I,!1),k.addEventListener("pointermove",D,!1),k.addEventListener("click",F,!1),A()})(u.debugRoot,y)):(l.remove("camera"),l.remove("controls"))};let E=-1;const P=[],k=()=>{for(let t=0,e=P.length;t<e;t+=1)P[t]();E=requestAnimationFrame(k)},z=t=>{P.push(t)},L=t=>{P.splice(P.indexOf(t),1)},M=1,V=2,T=4,A=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768});
/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */function S(t){return t.isPerspectiveCamera}function O(t){return t.isOrthographicCamera}const I=2*Math.PI,D=Math.PI/2,R=1e-5,F=Math.PI/180;function U(t,e,i){return Math.max(e,Math.min(i,t))}function N(t,e=R){return Math.abs(t)<e}function B(t,e,i=R){return N(t-e,i)}function j(t,e){return Math.round(t/e)*e}function H(t){return isFinite(t)?t:t<0?-Number.MAX_VALUE:Number.MAX_VALUE}function K(t){return Math.abs(t)<Number.MAX_VALUE?t:t*(1/0)}function $(t,e,i,n,s=1/0,o){const r=2/(n=Math.max(1e-4,n)),a=r*o,l=1/(1+a+.48*a*a+.235*a*a*a);let h=t-e;const d=e,c=s*n;h=U(h,-c,c),e=t-h;const p=(i.value+r*h)*o;i.value=(i.value-r*p)*l;let u=e+(h+p)*l;return d-t>0==u>d&&(u=d,i.value=(u-d)/o),u}function Y(t,e,i,n,s=1/0,o,r){const a=2/(n=Math.max(1e-4,n)),l=a*o,h=1/(1+l+.48*l*l+.235*l*l*l);let d=e.x,c=e.y,p=e.z,u=t.x-d,v=t.y-c,m=t.z-p;const g=d,_=c,b=p,f=s*n,w=u*u+v*v+m*m;if(w>f*f){const t=Math.sqrt(w);u=u/t*f,v=v/t*f,m=m/t*f}d=t.x-u,c=t.y-v,p=t.z-m;const x=(i.x+a*u)*o,y=(i.y+a*v)*o,C=(i.z+a*m)*o;i.x=(i.x-a*x)*h,i.y=(i.y-a*y)*h,i.z=(i.z-a*C)*h,r.x=d+(u+x)*h,r.y=c+(v+y)*h,r.z=p+(m+C)*h;const E=g-t.x,P=_-t.y,k=b-t.z;return E*(r.x-g)+P*(r.y-_)+k*(r.z-b)>0&&(r.x=g,r.y=_,r.z=b,i.x=(r.x-g)/o,i.y=(r.y-_)/o,i.z=(r.z-b)/o),r}function q(t,e){e.set(0,0),t.forEach((t=>{e.x+=t.clientX,e.y+=t.clientY})),e.x/=t.length,e.y/=t.length}function G(t,e){return!!O(t)&&(console.warn(`${e} is not supported in OrthographicCamera`),!0)}class Z{constructor(){this._listeners={}}addEventListener(t,e){const i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)}hasEventListener(t,e){const i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)}removeEventListener(t,e){const i=this._listeners[t];if(void 0!==i){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}removeAllEventListeners(t){t?Array.isArray(this._listeners[t])&&(this._listeners[t].length=0):this._listeners={}}dispatchEvent(t){const e=this._listeners[t.type];if(void 0!==e){t.target=this;const i=e.slice(0);for(let e=0,n=i.length;e<n;e++)i[e].call(this,t)}}}const X=1/8,W=typeof window<"u",Q=W&&/Mac/.test(navigator.platform),J=!(W&&"PointerEvent"in window);let tt,et,it,nt,st,ot,rt,at,lt,ht,dt,ct,pt,ut,vt,mt,gt,_t,bt,ft,wt,xt;class yt extends Z{static install(t){tt=t.THREE,et=Object.freeze(new tt.Vector3(0,0,0)),it=Object.freeze(new tt.Vector3(0,1,0)),nt=Object.freeze(new tt.Vector3(0,0,1)),st=new tt.Vector2,ot=new tt.Vector3,rt=new tt.Vector3,at=new tt.Vector3,lt=new tt.Vector3,ht=new tt.Vector3,dt=new tt.Vector3,ct=new tt.Vector3,pt=new tt.Vector3,ut=new tt.Spherical,vt=new tt.Spherical,mt=new tt.Box3,gt=new tt.Box3,_t=new tt.Sphere,bt=new tt.Quaternion,ft=new tt.Quaternion,wt=new tt.Matrix4,xt=new tt.Raycaster}static get ACTION(){return A}constructor(t,e){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=0,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=A.NONE,this._viewport=null,this._dollyControlAmount=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._activePointers=[],this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new tt.Vector3,this._focalOffsetVelocity=new tt.Vector3,this._zoomVelocity={value:0},this._truckInternal=(t,e,i)=>{if(S(this._camera)){const n=ot.copy(this._camera.position).sub(this._target),s=this._camera.getEffectiveFOV()*F,o=n.length()*Math.tan(.5*s),r=this.truckSpeed*t*o/this._elementRect.height,a=this.truckSpeed*e*o/this._elementRect.height;this.verticalDragToForward?(i?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(r,0,!0),this.forward(-a,!0)):i?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y+a,this._focalOffsetEnd.z,!0):this.truck(r,a,!0)}else if(O(this._camera)){const n=this._camera,s=t*(n.right-n.left)/n.zoom/this._elementRect.width,o=e*(n.top-n.bottom)/n.zoom/this._elementRect.height;i?this.setFocalOffset(this._focalOffsetEnd.x+s,this._focalOffsetEnd.y+o,this._focalOffsetEnd.z,!0):this.truck(s,o,!0)}},this._rotateInternal=(t,e)=>{const i=I*this.azimuthRotateSpeed*t/this._elementRect.height,n=I*this.polarRotateSpeed*e/this._elementRect.height;this.rotate(i,n,!0)},this._dollyInternal=(t,e,i)=>{const n=Math.pow(.95,-t*this.dollySpeed),s=this._sphericalEnd.radius*n,o=this._sphericalEnd.radius,r=o*(t>=0?-1:1);this.dollyTo(s),this.infinityDolly&&(s<this.minDistance||this.maxDistance===this.minDistance)&&(this._camera.getWorldDirection(ot),this._targetEnd.add(ot.normalize().multiplyScalar(r)),this._target.add(ot.normalize().multiplyScalar(r))),this.dollyToCursor&&(this._dollyControlAmount+=this._sphericalEnd.radius-o,this.infinityDolly&&(s<this.minDistance||this.maxDistance===this.minDistance)&&(this._dollyControlAmount-=r),this._dollyControlCoord.set(e,i))},this._zoomInternal=(t,e,i)=>{const n=Math.pow(.95,t*this.dollySpeed),s=this._zoomEnd;this.zoomTo(this._zoom*n),this.dollyToCursor&&(this._dollyControlAmount+=this._zoomEnd-s,this._dollyControlCoord.set(e,i))},typeof tt>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=(new tt.Quaternion).setFromUnitVectors(this._camera.up,it),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=A.NONE,this._target=new tt.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new tt.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new tt.Spherical).setFromVector3(ot.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._nearPlaneCorners=[new tt.Vector3,new tt.Vector3,new tt.Vector3,new tt.Vector3],this._updateNearPlaneCorners(),this._boundary=new tt.Box3(new tt.Vector3(-1/0,-1/0,-1/0),new tt.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlAmount=0,this._dollyControlCoord=new tt.Vector2,this.mouseButtons={left:A.ROTATE,middle:A.DOLLY,right:A.TRUCK,wheel:S(this._camera)?A.DOLLY:O(this._camera)?A.ZOOM:A.NONE},this.touches={one:A.TOUCH_ROTATE,two:S(this._camera)?A.TOUCH_DOLLY_TRUCK:O(this._camera)?A.TOUCH_ZOOM_TRUCK:A.NONE,three:A.TOUCH_TRUCK};const i=new tt.Vector2,n=new tt.Vector2,s=new tt.Vector2,o=t=>{if(!this._enabled||!this._domElement)return;const e="mouse"!==t.pointerType?null:(t.buttons&M)===M?M:(t.buttons&T)===T?T:(t.buttons&V)===V?V:null;if(null!==e){const t=this._findPointerByMouseButton(e);t&&this._activePointers.splice(this._activePointers.indexOf(t),1)}const i={pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY,deltaX:0,deltaY:0,mouseButton:e};this._activePointers.push(i),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),v(t)},r=t=>{if(!this._enabled||!this._domElement)return;const e=(t.buttons&M)===M?M:(t.buttons&T)===T?T:(t.buttons&V)===V?V:null;if(null!==e){const t=this._findPointerByMouseButton(e);t&&this._activePointers.splice(this._activePointers.indexOf(t),1)}const i={pointerId:0,clientX:t.clientX,clientY:t.clientY,deltaX:0,deltaY:0,mouseButton:(t.buttons&M)===M?M:(t.buttons&T)===M?T:(t.buttons&V)===M?V:null};this._activePointers.push(i),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",d),this._domElement.ownerDocument.addEventListener("mousemove",l),this._domElement.ownerDocument.addEventListener("mouseup",d),v(t)},a=t=>{t.cancelable&&t.preventDefault();const e=t.pointerId,i=this._findPointerById(e);if(i){if(i.clientX=t.clientX,i.clientY=t.clientY,i.deltaX=t.movementX,i.deltaY=t.movementY,"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=0,(t.buttons&M)===M&&(this._state=this._state|this.mouseButtons.left),(t.buttons&T)===T&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&V)===V&&(this._state=this._state|this.mouseButtons.right);m()}},l=t=>{const e=this._findPointerById(0);e&&(e.clientX=t.clientX,e.clientY=t.clientY,e.deltaX=t.movementX,e.deltaY=t.movementY,this._state=0,(t.buttons&M)===M&&(this._state=this._state|this.mouseButtons.left),(t.buttons&T)===T&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&V)===V&&(this._state=this._state|this.mouseButtons.right),m())},h=t=>{const e=t.pointerId,i=this._findPointerById(e);if(i&&this._activePointers.splice(this._activePointers.indexOf(i),1),"touch"===t.pointerType)switch(this._activePointers.length){case 0:this._state=A.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=A.NONE;g()},d=()=>{const t=this._findPointerById(0);t&&this._activePointers.splice(this._activePointers.indexOf(t),1),this._state=A.NONE,g()};let c=-1;const p=t=>{if(!this._enabled||this.mouseButtons.wheel===A.NONE)return;if(t.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===A.ROTATE||this.mouseButtons.wheel===A.TRUCK){const t=performance.now();c-t<1e3&&this._getClientRect(this._elementRect),c=t}const e=Q?-1:-3,i=1===t.deltaMode?t.deltaY/e:t.deltaY/(10*e),n=this.dollyToCursor?(t.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,s=this.dollyToCursor?(t.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case A.ROTATE:this._rotateInternal(t.deltaX,t.deltaY),this._isUserControllingRotate=!0;break;case A.TRUCK:this._truckInternal(t.deltaX,t.deltaY,!1),this._isUserControllingTruck=!0;break;case A.OFFSET:this._truckInternal(t.deltaX,t.deltaY,!0),this._isUserControllingOffset=!0;break;case A.DOLLY:this._dollyInternal(-i,n,s),this._isUserControllingDolly=!0;break;case A.ZOOM:this._zoomInternal(-i,n,s),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},u=t=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===yt.ACTION.NONE){const e=t instanceof PointerEvent?t.pointerId:0,i=this._findPointerById(e);return i&&this._activePointers.splice(this._activePointers.indexOf(i),1),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mousemove",l),void this._domElement.ownerDocument.removeEventListener("mouseup",d)}t.preventDefault()}},v=t=>{if(this._enabled){if(q(this._activePointers,st),this._getClientRect(this._elementRect),i.copy(st),n.copy(st),this._activePointers.length>=2){const t=st.x-this._activePointers[1].clientX,e=st.y-this._activePointers[1].clientY,i=Math.sqrt(t*t+e*e);s.set(0,i);const o=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),r=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);n.set(o,r)}if("pointerType"in t&&"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=0,(t.buttons&M)===M&&(this._state=this._state|this.mouseButtons.left),(t.buttons&T)===T&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&V)===V&&(this._state=this._state|this.mouseButtons.right);((this._state&A.ROTATE)===A.ROTATE||(this._state&A.TOUCH_ROTATE)===A.TOUCH_ROTATE||(this._state&A.TOUCH_DOLLY_ROTATE)===A.TOUCH_DOLLY_ROTATE||(this._state&A.TOUCH_ZOOM_ROTATE)===A.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&A.TRUCK)===A.TRUCK||(this._state&A.TOUCH_TRUCK)===A.TOUCH_TRUCK||(this._state&A.TOUCH_DOLLY_TRUCK)===A.TOUCH_DOLLY_TRUCK||(this._state&A.TOUCH_ZOOM_TRUCK)===A.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&A.DOLLY)===A.DOLLY||(this._state&A.TOUCH_DOLLY)===A.TOUCH_DOLLY||(this._state&A.TOUCH_DOLLY_TRUCK)===A.TOUCH_DOLLY_TRUCK||(this._state&A.TOUCH_DOLLY_OFFSET)===A.TOUCH_DOLLY_OFFSET||(this._state&A.TOUCH_DOLLY_ROTATE)===A.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&A.ZOOM)===A.ZOOM||(this._state&A.TOUCH_ZOOM)===A.TOUCH_ZOOM||(this._state&A.TOUCH_ZOOM_TRUCK)===A.TOUCH_ZOOM_TRUCK||(this._state&A.TOUCH_ZOOM_OFFSET)===A.TOUCH_ZOOM_OFFSET||(this._state&A.TOUCH_ZOOM_ROTATE)===A.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&A.OFFSET)===A.OFFSET||(this._state&A.TOUCH_OFFSET)===A.TOUCH_OFFSET||(this._state&A.TOUCH_DOLLY_OFFSET)===A.TOUCH_DOLLY_OFFSET||(this._state&A.TOUCH_ZOOM_OFFSET)===A.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},m=()=>{if(!this._enabled)return;q(this._activePointers,st);const t=this._domElement&&document.pointerLockElement===this._domElement,e=t?-this._activePointers[0].deltaX:n.x-st.x,o=t?-this._activePointers[0].deltaY:n.y-st.y;if(n.copy(st),((this._state&A.ROTATE)===A.ROTATE||(this._state&A.TOUCH_ROTATE)===A.TOUCH_ROTATE||(this._state&A.TOUCH_DOLLY_ROTATE)===A.TOUCH_DOLLY_ROTATE||(this._state&A.TOUCH_ZOOM_ROTATE)===A.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(e,o),this._isUserControllingRotate=!0),(this._state&A.DOLLY)===A.DOLLY||(this._state&A.ZOOM)===A.ZOOM){const t=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,e=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0,n=this.dollyDragInverted?-1:1;(this._state&A.DOLLY)===A.DOLLY?(this._dollyInternal(n*o*X,t,e),this._isUserControllingDolly=!0):(this._zoomInternal(n*o*X,t,e),this._isUserControllingZoom=!0)}if((this._state&A.TOUCH_DOLLY)===A.TOUCH_DOLLY||(this._state&A.TOUCH_ZOOM)===A.TOUCH_ZOOM||(this._state&A.TOUCH_DOLLY_TRUCK)===A.TOUCH_DOLLY_TRUCK||(this._state&A.TOUCH_ZOOM_TRUCK)===A.TOUCH_ZOOM_TRUCK||(this._state&A.TOUCH_DOLLY_OFFSET)===A.TOUCH_DOLLY_OFFSET||(this._state&A.TOUCH_ZOOM_OFFSET)===A.TOUCH_ZOOM_OFFSET||(this._state&A.TOUCH_DOLLY_ROTATE)===A.TOUCH_DOLLY_ROTATE||(this._state&A.TOUCH_ZOOM_ROTATE)===A.TOUCH_ZOOM_ROTATE){const t=st.x-this._activePointers[1].clientX,e=st.y-this._activePointers[1].clientY,i=Math.sqrt(t*t+e*e),o=s.y-i;s.set(0,i);const r=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,a=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&A.TOUCH_DOLLY)===A.TOUCH_DOLLY||(this._state&A.TOUCH_DOLLY_ROTATE)===A.TOUCH_DOLLY_ROTATE||(this._state&A.TOUCH_DOLLY_TRUCK)===A.TOUCH_DOLLY_TRUCK||(this._state&A.TOUCH_DOLLY_OFFSET)===A.TOUCH_DOLLY_OFFSET?(this._dollyInternal(o*X,r,a),this._isUserControllingDolly=!0):(this._zoomInternal(o*X,r,a),this._isUserControllingZoom=!0)}((this._state&A.TRUCK)===A.TRUCK||(this._state&A.TOUCH_TRUCK)===A.TOUCH_TRUCK||(this._state&A.TOUCH_DOLLY_TRUCK)===A.TOUCH_DOLLY_TRUCK||(this._state&A.TOUCH_ZOOM_TRUCK)===A.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(e,o,!1),this._isUserControllingTruck=!0),((this._state&A.OFFSET)===A.OFFSET||(this._state&A.TOUCH_OFFSET)===A.TOUCH_OFFSET||(this._state&A.TOUCH_DOLLY_OFFSET)===A.TOUCH_DOLLY_OFFSET||(this._state&A.TOUCH_ZOOM_OFFSET)===A.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(e,o,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},g=()=>{q(this._activePointers,st),n.copy(st),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mouseup",d),this.dispatchEvent({type:"controlend"}))};this._addAllEventListeners=t=>{this._domElement=t,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),J&&this._domElement.addEventListener("mousedown",r),this._domElement.addEventListener("pointercancel",h),this._domElement.addEventListener("wheel",p,{passive:!1}),this._domElement.addEventListener("contextmenu",u)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("mousedown",r),this._domElement.removeEventListener("pointercancel",h),this._domElement.removeEventListener("wheel",p,{passive:!1}),this._domElement.removeEventListener("contextmenu",u),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mouseup",d))},this.cancel=()=>{this._state!==A.NONE&&(this._state=A.NONE,this._activePointers.length=0,g())},e&&this.connect(e),this.update(0)}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._domElement&&(t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,i=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,i)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,i=!1){this._isUserControllingRotate=!1;const n=U(t,this.minAzimuthAngle,this.maxAzimuthAngle),s=U(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=n,this._sphericalEnd.phi=s,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!i||B(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&B(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){this._isUserControllingDolly=!1;const i=this._sphericalEnd.radius,n=U(t,this.minDistance,this.maxDistance);if(this.colliderMeshes.length>=1){const t=this._collisionTest(),e=B(t,this._spherical.radius);if(!(i>n)&&e)return Promise.resolve();this._sphericalEnd.radius=Math.min(n,t)}else this._sphericalEnd.radius=n;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);const s=!e||B(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(s)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._isUserControllingZoom=!1,this._zoomEnd=U(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);const i=!e||B(this._zoom,this._zoomEnd,this.restThreshold);return this._createOnRestPromise(i)}pan(t,e,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,i)}truck(t,e,i=!1){this._camera.updateMatrix(),lt.setFromMatrixColumn(this._camera.matrix,0),ht.setFromMatrixColumn(this._camera.matrix,1),lt.multiplyScalar(t),ht.multiplyScalar(-e);const n=ot.copy(lt).add(ht),s=rt.copy(this._targetEnd).add(n);return this.moveTo(s.x,s.y,s.z,i)}forward(t,e=!1){ot.setFromMatrixColumn(this._camera.matrix,0),ot.crossVectors(this._camera.up,ot),ot.multiplyScalar(t);const i=rt.copy(this._targetEnd).add(ot);return this.moveTo(i.x,i.y,i.z,e)}elevate(t,e=!1){return ot.copy(this._camera.up).multiplyScalar(t),this.moveTo(this._targetEnd.x+ot.x,this._targetEnd.y+ot.y,this._targetEnd.z+ot.z,e)}moveTo(t,e,i,n=!1){this._isUserControllingTruck=!1;const s=ot.set(t,e,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,s,this.boundaryFriction),this._needsUpdate=!0,n||this._target.copy(this._targetEnd);const o=!n||B(this._target.x,this._targetEnd.x,this.restThreshold)&&B(this._target.y,this._targetEnd.y,this.restThreshold)&&B(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(t,e,i,n=!1){const s=ot.set(t,e,i).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(s.x,s.y,s.z,n)}fitToBox(t,e,{cover:i=!1,paddingLeft:n=0,paddingRight:s=0,paddingBottom:o=0,paddingTop:r=0}={}){const a=[],l=t.isBox3?mt.copy(t):mt.setFromObject(t);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const h=j(this._sphericalEnd.theta,D),d=j(this._sphericalEnd.phi,D);a.push(this.rotateTo(h,d,e));const c=ot.setFromSpherical(this._sphericalEnd).normalize(),p=bt.setFromUnitVectors(c,nt),u=B(Math.abs(c.y),1);u&&p.multiply(ft.setFromAxisAngle(it,h)),p.multiply(this._yAxisUpSpaceInverse);const v=gt.makeEmpty();rt.copy(l.min).applyQuaternion(p),v.expandByPoint(rt),rt.copy(l.min).setX(l.max.x).applyQuaternion(p),v.expandByPoint(rt),rt.copy(l.min).setY(l.max.y).applyQuaternion(p),v.expandByPoint(rt),rt.copy(l.max).setZ(l.min.z).applyQuaternion(p),v.expandByPoint(rt),rt.copy(l.min).setZ(l.max.z).applyQuaternion(p),v.expandByPoint(rt),rt.copy(l.max).setY(l.min.y).applyQuaternion(p),v.expandByPoint(rt),rt.copy(l.max).setX(l.min.x).applyQuaternion(p),v.expandByPoint(rt),rt.copy(l.max).applyQuaternion(p),v.expandByPoint(rt),v.min.x-=n,v.min.y-=o,v.max.x+=s,v.max.y+=r,p.setFromUnitVectors(nt,c),u&&p.premultiply(ft.invert()),p.premultiply(this._yAxisUpSpace);const m=v.getSize(ot),g=v.getCenter(rt).applyQuaternion(p);if(S(this._camera)){const t=this.getDistanceToFitBox(m.x,m.y,m.z,i);a.push(this.moveTo(g.x,g.y,g.z,e)),a.push(this.dollyTo(t,e)),a.push(this.setFocalOffset(0,0,0,e))}else if(O(this._camera)){const t=this._camera,n=t.right-t.left,s=t.top-t.bottom,o=i?Math.max(n/m.x,s/m.y):Math.min(n/m.x,s/m.y);a.push(this.moveTo(g.x,g.y,g.z,e)),a.push(this.zoomTo(o,e)),a.push(this.setFocalOffset(0,0,0,e))}return Promise.all(a)}fitToSphere(t,e){const i=[],n=t instanceof tt.Sphere?_t.copy(t):yt.createBoundingSphere(t,_t);if(i.push(this.moveTo(n.center.x,n.center.y,n.center.z,e)),S(this._camera)){const t=this.getDistanceToFitSphere(n.radius);i.push(this.dollyTo(t,e))}else if(O(this._camera)){const t=this._camera.right-this._camera.left,s=this._camera.top-this._camera.bottom,o=2*n.radius,r=Math.min(t/o,s/o);i.push(this.zoomTo(r,e))}return i.push(this.setFocalOffset(0,0,0,e)),Promise.all(i)}setLookAt(t,e,i,n,s,o,r=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1;const a=rt.set(n,s,o),l=ot.set(t,e,i);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(l.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,r||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const h=!r||B(this._target.x,this._targetEnd.x,this.restThreshold)&&B(this._target.y,this._targetEnd.y,this.restThreshold)&&B(this._target.z,this._targetEnd.z,this.restThreshold)&&B(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&B(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&B(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(h)}lerpLookAt(t,e,i,n,s,o,r,a,l,h,d,c,p,u=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1;const v=ot.set(n,s,o),m=rt.set(t,e,i);ut.setFromVector3(m.sub(v).applyQuaternion(this._yAxisUpSpace));const g=at.set(h,d,c),_=rt.set(r,a,l);vt.setFromVector3(_.sub(g).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(v.lerp(g,p));const b=vt.theta-ut.theta,f=vt.phi-ut.phi,w=vt.radius-ut.radius;this._sphericalEnd.set(ut.radius+w*p,ut.phi+f*p,ut.theta+b*p),this.normalizeRotations(),this._needsUpdate=!0,u||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const x=!u||B(this._target.x,this._targetEnd.x,this.restThreshold)&&B(this._target.y,this._targetEnd.y,this.restThreshold)&&B(this._target.z,this._targetEnd.z,this.restThreshold)&&B(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&B(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&B(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(x)}setPosition(t,e,i,n=!1){return this.setLookAt(t,e,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,n)}setTarget(t,e,i,n=!1){const s=this.getPosition(ot),o=this.setLookAt(s.x,s.y,s.z,t,e,i,n);return this._sphericalEnd.phi=U(this.polarAngle,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(t,e,i,n=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(t,e,i),this._needsUpdate=!0,n||this._focalOffset.copy(this._focalOffsetEnd);const s=!n||B(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&B(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&B(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}setOrbitPoint(t,e,i){this._camera.updateMatrixWorld(),lt.setFromMatrixColumn(this._camera.matrixWorldInverse,0),ht.setFromMatrixColumn(this._camera.matrixWorldInverse,1),dt.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const n=ot.set(t,e,i),s=n.distanceTo(this._camera.position),o=n.sub(this._camera.position);lt.multiplyScalar(o.x),ht.multiplyScalar(o.y),dt.multiplyScalar(o.z),ot.copy(lt).add(ht).add(dt),ot.z=ot.z+s,this.dollyTo(s,!1),this.setFocalOffset(-ot.x,ot.y,-ot.z,!1),this.moveTo(t,e,i,!1)}setBoundary(t){if(!t)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,i,n){null!==t?(this._viewport=this._viewport||new tt.Vector4,"number"==typeof t?this._viewport.set(t,e,i,n):this._viewport.copy(t)):this._viewport=null}getDistanceToFitBox(t,e,i,n=!1){if(G(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const s=t/e,o=this._camera.getEffectiveFOV()*F,r=this._camera.aspect;return.5*((n?s>r:s<r)?e:t/r)/Math.tan(.5*o)+.5*i}getDistanceToFitSphere(t){if(G(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const e=this._camera.getEffectiveFOV()*F,i=2*Math.atan(Math.tan(.5*e)*this._camera.aspect),n=1<this._camera.aspect?e:i;return t/Math.sin(.5*n)}getTarget(t){return(t&&t.isVector3?t:new tt.Vector3).copy(this._targetEnd)}getPosition(t){return(t&&t.isVector3?t:new tt.Vector3).setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).add(this._targetEnd)}getFocalOffset(t){return(t&&t.isVector3?t:new tt.Vector3).copy(this._focalOffsetEnd)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%I,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=I),this._spherical.theta+=I*Math.round((this._sphericalEnd.theta-this._spherical.theta)/I)}reset(t=!1){if(!B(this._camera.up.x,this._cameraUp0.x)||!B(this._camera.up.y,this._cameraUp0.y)||!B(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const t=this.getPosition(ot);this.updateCameraUp(),this.setPosition(t.x,t.y,t.z)}const e=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)];return Promise.all(e)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,it),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const t=ot.subVectors(this._target,this._camera.position).normalize(),e=rt.crossVectors(t,this._camera.up).normalize();this._camera.up.crossVectors(e,t).normalize(),this._camera.updateMatrixWorld();const i=this.getPosition(ot);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}update(t){const e=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,n=this._sphericalEnd.radius-this._spherical.radius,s=ct.subVectors(this._targetEnd,this._target),o=pt.subVectors(this._focalOffsetEnd,this._focalOffset),r=this._zoomEnd-this._zoom;if(N(e))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const e=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=$(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,e,1/0,t),this._needsUpdate=!0}if(N(i))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const e=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=$(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,e,1/0,t),this._needsUpdate=!0}if(N(n))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const e=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=$(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,e,this.maxSpeed,t),this._needsUpdate=!0}if(N(s.x)&&N(s.y)&&N(s.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const e=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;Y(this._target,this._targetEnd,this._targetVelocity,e,this.maxSpeed,t,this._target),this._needsUpdate=!0}if(N(o.x)&&N(o.y)&&N(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const e=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;Y(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,e,this.maxSpeed,t,this._focalOffset),this._needsUpdate=!0}if(0!==this._dollyControlAmount){if(S(this._camera)){const t=this._camera,e=ot.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).normalize().negate(),i=rt.copy(e).cross(t.up).normalize();0===i.lengthSq()&&(i.x=1);const n=at.crossVectors(i,e),s=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*F*.5),o=(this._sphericalEnd.radius-this._dollyControlAmount-this._sphericalEnd.radius)/this._sphericalEnd.radius,r=ot.copy(this._targetEnd).add(i.multiplyScalar(this._dollyControlCoord.x*s*t.aspect)).add(n.multiplyScalar(this._dollyControlCoord.y*s));this._targetEnd.lerp(r,o)}else if(O(this._camera)){const t=this._camera,e=ot.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),i=rt.set(0,0,-1).applyQuaternion(t.quaternion),n=at.copy(e).add(i.multiplyScalar(-e.dot(t.up))),s=-(this._zoom-this._dollyControlAmount-this._zoomEnd)/this._zoom,o=ot.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).normalize().negate(),r=this._targetEnd.dot(o);this._targetEnd.lerp(n,s);const a=this._targetEnd.dot(o),l=o.multiplyScalar(a-r);this._targetEnd.sub(l)}this._target.copy(this._targetEnd),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._dollyControlAmount=0}if(N(r))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const e=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=$(this._zoom,this._zoomEnd,this._zoomVelocity,e,1/0,t)}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0);const a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!N(this._focalOffset.x)||!N(this._focalOffset.y)||!N(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),lt.setFromMatrixColumn(this._camera.matrix,0),ht.setFromMatrixColumn(this._camera.matrix,1),dt.setFromMatrixColumn(this._camera.matrix,2),lt.multiplyScalar(this._focalOffset.x),ht.multiplyScalar(-this._focalOffset.y),dt.multiplyScalar(this._focalOffset.z),ot.copy(lt).add(ht).add(dt),this._camera.position.add(ot)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),ot.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const l=this._needsUpdate;return l&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):l?(this.dispatchEvent({type:"update"}),N(e,this.restThreshold)&&N(i,this.restThreshold)&&N(n,this.restThreshold)&&N(s.x,this.restThreshold)&&N(s.y,this.restThreshold)&&N(s.z,this.restThreshold)&&N(o.x,this.restThreshold)&&N(o.y,this.restThreshold)&&N(o.z,this.restThreshold)&&N(r,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!l&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._updatedLastTime=l,this._needsUpdate=!1,l}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:H(this.maxDistance),minZoom:this.minZoom,maxZoom:H(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:H(this.maxPolarAngle),minAzimuthAngle:H(this.minAzimuthAngle),maxAzimuthAngle:H(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:ot.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){const i=JSON.parse(t);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=K(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=K(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=K(i.maxPolarAngle),this.minAzimuthAngle=K(i.minAzimuthAngle),this.maxAzimuthAngle=K(i.maxAzimuthAngle),this.smoothTime=i.smoothTime,this.draggingSmoothTime=i.draggingSmoothTime,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this.verticalDragToForward=i.verticalDragToForward,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],e),ut.setFromVector3(ot.fromArray(i.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(ut.theta,ut.phi,e),this.dollyTo(ut.radius,e),this.zoomTo(i.zoom,e),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],e),this._needsUpdate=!0}connect(t){this._domElement?console.warn("camera-controls is already connected."):(t.setAttribute("data-camera-controls-version","2.3.4"),this._addAllEventListeners(t))}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_findPointerById(t){return this._activePointers.find((e=>e.pointerId===t))}_findPointerByMouseButton(t){return this._activePointers.find((e=>e.mouseButton===t))}_encloseToBoundary(t,e,i){const n=e.lengthSq();if(0===n)return t;const s=rt.copy(e).add(t),o=this._boundary.clampPoint(s,at).sub(s),r=o.lengthSq();if(0===r)return t.add(e);if(r===n)return t;if(0===i)return t.add(e).add(o);{const n=1+i*r/e.dot(o);return t.add(rt.copy(e).multiplyScalar(n)).add(o.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(S(this._camera)){const t=this._camera,e=t.near,i=t.getEffectiveFOV()*F,n=Math.tan(.5*i)*e,s=n*t.aspect;this._nearPlaneCorners[0].set(-s,-n,0),this._nearPlaneCorners[1].set(s,-n,0),this._nearPlaneCorners[2].set(s,n,0),this._nearPlaneCorners[3].set(-s,n,0)}else if(O(this._camera)){const t=this._camera,e=1/t.zoom,i=t.left*e,n=t.right*e,s=t.top*e,o=t.bottom*e;this._nearPlaneCorners[0].set(i,s,0),this._nearPlaneCorners[1].set(n,s,0),this._nearPlaneCorners[2].set(n,o,0),this._nearPlaneCorners[3].set(i,o,0)}}_collisionTest(){let t=1/0;if(!(this.colliderMeshes.length>=1)||G(this._camera,"_collisionTest"))return t;const e=ot.setFromSpherical(this._spherical).divideScalar(this._spherical.radius);wt.lookAt(et,e,this._camera.up);for(let i=0;i<4;i++){const n=rt.copy(this._nearPlaneCorners[i]);n.applyMatrix4(wt);const s=at.addVectors(this._target,n);xt.set(s,e),xt.far=this._spherical.radius+1;const o=xt.intersectObjects(this.colliderMeshes);0!==o.length&&o[0].distance<t&&(t=o[0].distance)}return t}_getClientRect(t){if(!this._domElement)return;const e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise((t=>{const e=()=>{this.removeEventListener("rest",e),t()};this.addEventListener("rest",e)})))}_addAllEventListeners(t){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(t){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(t){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(t,e=new tt.Sphere){const i=e,n=i.center;mt.makeEmpty(),t.traverseVisible((t=>{t.isMesh&&mt.expandByObject(t)})),mt.getCenter(n);let s=0;return t.traverseVisible((t=>{if(!t.isMesh)return;const e=t,i=e.geometry.clone();i.applyMatrix4(e.matrixWorld);const o=i.attributes.position;for(let r=0,a=o.count;r<a;r++)ot.fromBufferAttribute(o,r),s=Math.max(s,n.distanceToSquared(ot))})),i.radius=Math.sqrt(s),i}}const Ct="tv-flex",Et="tv-grid",Pt="tv-hidden",kt="tv-scrollable",zt="tv-resizable",Lt="tv-readonly",Mt="tv-disabled",Vt="tv-focus",Tt="tv-multiple-values",At="tv-error",St="flash",Ot="font-regular";class It{constructor(t,i,n){e(this,"owner"),e(this,"name"),e(this,"fn"),this.owner=t,this.name=i,this.fn=n}unbind(){this.owner&&(this.owner.unbind(this.name??void 0,this.fn),this.owner=null,this.name=null,this.fn=null)}call(...t){this.fn&&this.fn.call(this.owner,...t)}on(t,e){var i;return null==(i=this.owner)?void 0:i.on(t,e)}}class Dt{constructor(){e(this,"_suspendEvents",!1),e(this,"_additionalEmitters",[]),e(this,"_events"),Object.defineProperty(this,"_events",{configurable:!1,enumerable:!1,value:{},writable:!0})}set suspendEvents(t){this._suspendEvents=!!t}get suspendEvents(){return this._suspendEvents}on(t,e){const i=this._events[t];return void 0===i?this._events[t]=[e]:-1===i.indexOf(e)&&i.push(e),new It(this,t,e)}once(t,e){const i=this.on(t,((...t)=>{e.call(this,...t),i.unbind()}));return i}emit(t,...e){if(this._suspendEvents)return this;let i=this._events[t];if(null==i?void 0:i.length){i=i.slice(0);for(let s=0;s<i.length;s+=1)if(i[s])try{i[s].call(this,...e)}catch(n){console.error("%c%s %c(event error)","color: #06f",t,"color: #f00"),console.error(n.stack)}}if(this._additionalEmitters.length){const i=this._additionalEmitters.slice();for(let n=0,s=i.length;n<s;n+=1)i[n].emit(t,...e)}return this}unbind(t,e){if(t){const i=this._events[t];if(!i)return this;if(e){const n=i.indexOf(e);-1!==n&&(1===i.length?delete this._events[t]:i.splice(n,1))}else delete this._events[t]}else this._events={};return this}addEmitter(t){this._additionalEmitters.includes(t)||this._additionalEmitters.push(t)}removeEmitter(t){const e=this._additionalEmitters.indexOf(t);-1!==e&&this._additionalEmitters.splice(e,1)}}const Rt=["flexDirection","flexGrow","flexBasis","flexShrink","flexWrap","alignItems","alignSelf","justifyContent","justifySelf"];class Ft extends Dt{constructor(t={}){if(super(),e(this,"_destroyed",!1),e(this,"_parent",null),e(this,"_eventsParent",[]),e(this,"_dom"),e(this,"_hiddenParents"),e(this,"_flashTimeout",null),e(this,"_suppressChange",!1),e(this,"_ignoreParent",!1),e(this,"_enabled",!0),e(this,"_readOnly",!1),e(this,"_hidden",!1),e(this,"_hasError",!1),e(this,"_domContent",null),e(this,"_onMouseOver",(t=>{this.emit("hover",t)})),e(this,"_onMouseOut",(t=>{this.emit("hoverend",t)})),"string"==typeof t.dom?this._dom=document.createElement(t.dom):t.dom instanceof Node?this._dom=t.dom:this._dom=document.createElement("div"),void 0!==t.id&&(this._dom.id=t.id),this._dom.ui=this,this._dom.addEventListener("mouseover",this._onMouseOver),this._dom.addEventListener("mouseout",this._onMouseOut),this._dom.classList.add("tv-element",Ot),t.class){const e=Array.isArray(t.class)?t.class:[t.class];for(const t of e)this._dom.classList.add(t)}this.enabled=t.enabled??!0,this._hiddenParents=!t.isRoot,this.hidden=t.hidden??!1,this.readOnly=t.readOnly??!1,this.ignoreParent=t.ignoreParent??!1,void 0!==t.width&&(this.width=t.width),void 0!==t.height&&(this.height=t.height),void 0!==t.tabIndex&&(this.tabIndex=t.tabIndex);for(const e in t)void 0!==t[e]&&-1!==Rt.indexOf(e)&&(this[e]=t[e])}destroy(){if(this._destroyed)return;if(this._destroyed=!0,this.parent){const t=this.parent;for(const e of this._eventsParent)e.unbind();this._eventsParent.length=0,"remove"in t&&!t._destroyed&&t.remove(this),this._parent=null,!t._destroyed&&this._dom&&this._dom.parentElement&&this._dom.parentElement.removeChild(this._dom)}const t=this._dom;t&&(t.removeEventListener("mouseover",this._onMouseOver),t.removeEventListener("mouseout",this._onMouseOut),delete t.ui,this._dom=null),this._flashTimeout&&window.clearTimeout(this._flashTimeout),this.emit("destroy",t,this),this.unbind()}flash(){this._flashTimeout||(this.class.add(St),this._flashTimeout=window.setTimeout((()=>{this._flashTimeout=null,this.class.remove(St)}),200))}_onClick(t){this.enabled&&this.emit("click",t)}_onHiddenToRootChange(t){this.emit(t?"hideToRoot":"showToRoot")}_onEnabledChange(t){t?this.class.remove(Mt):this.class.add(Mt),this.emit(t?"enable":"disable")}_onParentDestroy(){this.destroy()}_onParentDisable(){this._ignoreParent||this._enabled&&this._onEnabledChange(!1)}_onParentEnable(){this._ignoreParent||this._enabled&&this._onEnabledChange(!0)}_onParentShowToRoot(){const t=this.hiddenToRoot;this._hiddenParents=!1,t!==this.hiddenToRoot&&this._onHiddenToRootChange(this.hiddenToRoot)}_onParentHideToRoot(){const t=this.hiddenToRoot;this._hiddenParents=!0,t!==this.hiddenToRoot&&this._onHiddenToRootChange(this.hiddenToRoot)}_onReadOnlyChange(t){t?this.class.add(Lt):this.class.remove(Lt),this.emit("readOnly",t)}_onParentReadOnlyChange(t){this._ignoreParent||(t?this._readOnly||this._onReadOnlyChange(!0):this._readOnly||this._onReadOnlyChange(!1))}set enabled(t){if(this._enabled===t)return;const e=this.enabled;this._enabled=t,e!==t&&this._onEnabledChange(t)}get enabled(){return this._ignoreParent?this._enabled:this._enabled&&(!this._parent||this._parent.enabled)}set ignoreParent(t){this._ignoreParent=t,this._onEnabledChange(this.enabled),this._onReadOnlyChange(this.readOnly)}get ignoreParent(){return this._ignoreParent}get dom(){return this._dom}set parent(t){if(t===this._parent)return;const e=this.enabled,i=this.readOnly,n=this.hiddenToRoot;if(this._parent){for(let t=0;t<this._eventsParent.length;t+=1)this._eventsParent[t].unbind();this._eventsParent.length=0}this._parent=t,this._parent?(this._eventsParent.push(this._parent.once("destroy",this._onParentDestroy.bind(this))),this._eventsParent.push(this._parent.on("disable",this._onParentDisable.bind(this))),this._eventsParent.push(this._parent.on("enable",this._onParentEnable.bind(this))),this._eventsParent.push(this._parent.on("readOnly",this._onParentReadOnlyChange.bind(this))),this._eventsParent.push(this._parent.on("showToRoot",this._onParentShowToRoot.bind(this))),this._eventsParent.push(this._parent.on("hideToRoot",this._onParentHideToRoot.bind(this))),this._hiddenParents=this._parent.hiddenToRoot):this._hiddenParents=!0,this.emit("parent",this._parent);const s=this.enabled;s!==e&&this._onEnabledChange(s);const o=this.readOnly;o!==i&&this._onReadOnlyChange(o);const r=this.hiddenToRoot;r!==n&&this._onHiddenToRootChange(r)}get parent(){return this._parent}set hidden(t){if(t===this._hidden)return;const e=this.hiddenToRoot;this._hidden=t,t?this.class.add(Pt):this.class.remove(Pt),this.emit(t?"hide":"show"),this.hiddenToRoot!==e&&this._onHiddenToRootChange(this.hiddenToRoot)}get hidden(){return this._hidden}get hiddenToRoot(){return this._hidden||this._hiddenParents}set readOnly(t){this._readOnly!==t&&(this._readOnly=t,this._onReadOnlyChange(t))}get readOnly(){var t;return this._ignoreParent?this._readOnly:this._readOnly||!!(null==(t=this._parent)?void 0:t.readOnly)}set error(t){this._hasError!==t&&(this._hasError=t,t?this.class.add(At):this.class.remove(At))}get error(){return this._hasError}get style(){return this._dom.style}get class(){return this._dom.classList}set width(t){this.style.width="number"==typeof t?`${String(t)}px`:t}get width(){return this._dom.clientWidth}set height(t){this.style.height="number"==typeof t?`${String(t)}px`:t}get height(){return this._dom.clientHeight}set tabIndex(t){this._dom.tabIndex=t}get tabIndex(){return this._dom.tabIndex}get destroyed(){return this._destroyed}set flexDirection(t){this.style.flexDirection=t}get flexDirection(){return this.style.flexDirection}set flexGrow(t){this.style.flexGrow=t}get flexGrow(){return this.style.flexGrow}set flexBasis(t){this.style.flexBasis=t}get flexBasis(){return this.style.flexBasis}set flexShrink(t){this.style.flexShrink=t}get flexShrink(){return this.style.flexShrink}set flexWrap(t){this.style.flexWrap=t}get flexWrap(){return this.style.flexWrap}set alignItems(t){this.style.alignItems=t}get alignItems(){return this.style.alignItems}set alignSelf(t){this.style.alignSelf=t}get alignSelf(){return this.style.alignSelf}set justifyContent(t){this.style.justifyContent=t}get justifyContent(){return this.style.justifyContent}set justifySelf(t){this.style.justifySelf=t}get justifySelf(){return this.style.justifySelf}set disabled(t){this.enabled=!t}get disabled(){return!this.enabled}set element(t){this._dom=t}get element(){return this.dom}set innerElement(t){this._domContent=t}get innerElement(){return this._domContent}}e(Ft,"EVENT_ENABLE","enable"),e(Ft,"EVENT_DISABLE","disable"),e(Ft,"EVENT_HIDE","hide"),e(Ft,"EVENT_HIDE_TO_ROOT","hideToRoot"),e(Ft,"EVENT_SHOW","show"),e(Ft,"EVENT_SHOW_TO_ROOT","showToRoot"),e(Ft,"EVENT_READ_ONLY","readOnly"),e(Ft,"EVENT_PARENT","parent"),e(Ft,"EVENT_CLICK","click"),e(Ft,"EVENT_HOVER","hover"),e(Ft,"EVENT_HOVER_END","hoverend"),e(Ft,"EVENT_DESTROY","destroy");const Ut=[null,"top","right","bottom","left"],Nt=`${zt}-resizing`,Bt="tv-container-dragged",jt=`${Bt}-child`,Ht=t=>"dom"in t?t.dom:t;class Kt extends Ft{constructor(t={}){super(t),e(this,"_scrollable",!1),e(this,"_flex",!1),e(this,"_grid",!1),e(this,"_domResizeHandle",null),e(this,"_resizeTouchId",null),e(this,"_resizeData",null),e(this,"_resizeHorizontally",!0),e(this,"_resizeMin",100),e(this,"_resizeMax",300),e(this,"_draggedStartIndex",-1),e(this,"_domContent"),e(this,"_resizable",null),e(this,"_onScroll",(t=>{this.emit("scroll",t)})),e(this,"_onResizeStart",(t=>{t.preventDefault(),t.stopPropagation(),window.addEventListener("mousemove",this._onResizeMove),window.addEventListener("mouseup",this._onResizeEnd),this._resizeStart()})),e(this,"_onResizeMove",(t=>{t.preventDefault(),t.stopPropagation(),this._resizeMove(t.clientX,t.clientY)})),e(this,"_onResizeEnd",(t=>{t.preventDefault(),t.stopPropagation(),window.removeEventListener("mousemove",this._onResizeMove),window.removeEventListener("mouseup",this._onResizeEnd),this._resizeEnd()})),e(this,"_onResizeTouchStart",(t=>{t.preventDefault(),t.stopPropagation();for(let e=0;e<t.changedTouches.length;e+=1){const i=t.changedTouches[e];i.target===this._domResizeHandle&&(this._resizeTouchId=i.identifier)}window.addEventListener("touchmove",this._onResizeTouchMove),window.addEventListener("touchend",this._onResizeTouchEnd),this._resizeStart()})),e(this,"_onResizeTouchMove",(t=>{for(let e=0;e<t.changedTouches.length;e+=1){const i=t.changedTouches[e];if(i.identifier===this._resizeTouchId){t.stopPropagation(),t.preventDefault(),this._resizeMove(i.clientX,i.clientY);break}}})),e(this,"_onResizeTouchEnd",(t=>{for(let e=0;e<t.changedTouches.length;e+=1)if(t.changedTouches[e].identifier!==this._resizeTouchId){this._resizeTouchId=null,t.preventDefault(),t.stopPropagation(),window.removeEventListener("touchmove",this._onResizeTouchMove),window.removeEventListener("touchend",this._onResizeTouchEnd),this._resizeEnd();break}})),this.class.add("tv-container"),this.domContent=this._dom,this._domContent=this._dom,t.scrollable&&(this.scrollable=!0),this.flex=!!t.flex;let i=!!t.grid;i&&this.flex&&(console.error('Invalid Container arguments: "grid" and "flex" cannot both be true.'),i=!1),this.grid=i,this.resizable=t.resizable??null,void 0!==t.resizeMin&&(this.resizeMin=t.resizeMin),void 0!==t.resizeMax&&(this.resizeMax=t.resizeMax)}destroy(){this._destroyed||(this.domContent=null,this._domResizeHandle&&(this._domResizeHandle.removeEventListener("mousedown",this._onResizeStart),window.removeEventListener("mousemove",this._onResizeMove),window.removeEventListener("mouseup",this._onResizeEnd),this._domResizeHandle.removeEventListener("touchstart",this._onResizeTouchStart),window.removeEventListener("touchmove",this._onResizeTouchMove),window.removeEventListener("touchend",this._onResizeTouchEnd)),super.destroy())}append(t){const e=Ht(t);this._domContent.appendChild(e),this._onAppendChild(t)}appendBefore(t,e){const i=Ht(t);this._domContent.appendChild(i);const n=e&&Ht(e);this._domContent.insertBefore(i,n),this._onAppendChild(t)}appendAfter(t,e){const i=Ht(t),n=e&&Ht(e),s=n?n.nextSibling:null;s?this._domContent.insertBefore(i,s):this._domContent.appendChild(i),this._onAppendChild(t)}prepend(t){const e=Ht(t),i=this._domContent.firstChild;i?this._domContent.insertBefore(e,i):this._domContent.appendChild(e),this._onAppendChild(t)}remove(t){if(t.parent!==this)return;const e=Ht(t);this._domContent.removeChild(e),this._onRemoveChild(t)}move(t,e){let i=-1;for(let n=0;n<this.dom.childNodes.length;n+=1)if(this.dom.childNodes[n].ui===t){i=n;break}-1===i?this.appendBefore(t,this.dom.childNodes[e]):e!==i&&(this.remove(t),e<i?this.appendBefore(t,this.dom.childNodes[e]):this.appendAfter(t,this.dom.childNodes[e-1]))}clear(){for(let t=this._domContent.childNodes.length-1;t>-1;t-=1){const e=this._domContent.childNodes[t];e.ui&&e.ui!==this&&e.ui.destroy()}this._domResizeHandle&&(this._domResizeHandle.removeEventListener("mousedown",this._onResizeStart),this._domResizeHandle.removeEventListener("touchstart",this._onResizeTouchStart),this._domResizeHandle=null),this._domContent.innerHTML="",this.resizable&&(this._domResizeHandle=this._createResizeHandle(),this._dom.appendChild(this._domResizeHandle))}_onAppendChild(t){t.parent=this,this.emit("append",t)}_onRemoveChild(t){t.parent=null,this.emit("remove",t)}_createResizeHandle(){const t=document.createElement("div");return t.classList.add("tv-resizable-handle"),t.ui=this,t.addEventListener("mousedown",this._onResizeStart),t.addEventListener("touchstart",this._onResizeTouchStart,{passive:!1}),t}_resizeStart(){this.class.add(Nt)}_resizeMove(t,e){if(this._resizeData){if(this._resizeHorizontally){let e=this._resizeData.x-t;"right"===this._resizable&&(e=-e),this.width=4+Math.max(this._resizeMin,Math.min(this._resizeMax,this._resizeData.width+e))}else{let t=this._resizeData.y-e;"bottom"===this._resizable&&(t=-t),this.height=Math.max(this._resizeMin,Math.min(this._resizeMax,this._resizeData.height+t))}this.emit("resize")}else this._resizeData={height:this.dom.clientHeight,width:this.dom.clientWidth,x:t,y:e}}_resizeEnd(){this._resizeData=null,this.class.remove(Nt)}resize(t=0,e=0){this._resizeStart(),this._resizeMove(0,0),this._resizeMove(4-t,-e),this._resizeEnd()}_getDraggedChildIndex(t){for(let e=0;e<this.dom.childNodes.length;e+=1)if(this.dom.childNodes[e].ui===t)return e;return-1}_onChildDragStart(t,e){this.class.add(jt),this._draggedStartIndex=this._getDraggedChildIndex(e),e.class.add(Bt),this.emit("child:dragstart",e,this._draggedStartIndex)}_onChildDragMove(t,e){const i=this.dom.getBoundingClientRect(),n=t.clientX<i.left||t.clientX>i.right||t.clientY<i.top||t.clientY>i.bottom,s=this._getDraggedChildIndex(e);if(n)return e.class.remove(Bt),void(this._draggedStartIndex!==s&&(this.remove(e),this._draggedStartIndex<s?this.appendBefore(e,this.dom.childNodes[this._draggedStartIndex]):this.appendAfter(e,this.dom.childNodes[this._draggedStartIndex-1])));e.class.add(Bt);const o=t.clientY-i.top;let r=null;for(let a=0;a<this.dom.childNodes.length;a+=1){const t=this.dom.childNodes[a].ui,i=t.dom.offsetTop;if(a<s){if(o<=i+t.header.height){r=a;break}}else if(a>s&&o+e.height>=i+t.height){r=a;break}}null!==r&&s!==r&&(this.remove(e),r<s?this.appendBefore(e,this.dom.childNodes[r]):this.appendAfter(e,this.dom.childNodes[r-1]))}_onChildDragEnd(t,e){this.class.remove(jt),e.class.remove(Bt);const i=this._getDraggedChildIndex(e);this.emit("child:dragend",e,i,this._draggedStartIndex),this._draggedStartIndex=-1}forEachChild(t){for(let e=0;e<this.dom.childNodes.length;e+=1){const i=this.dom.childNodes[e].ui;if(i&&!1===t(i,e))break}}set flex(t){t!==this._flex&&(this._flex=t,t?this.class.add(Ct):this.class.remove(Ct))}get flex(){return this._flex}set grid(t){t!==this._grid&&(this._grid=t,t?this.class.add(Et):this.class.remove(Et))}get grid(){return this._grid}set scrollable(t){this._scrollable!==t&&(this._scrollable=t,t?this.class.add(kt):this.class.remove(kt))}get scrollable(){return this._scrollable}set resizable(t){if(t!==this._resizable){if(-1===Ut.indexOf(t))return void console.error(`Invalid resizable value: must be one of ${Ut.join(",")}`);this._resizable&&this.class.remove(`${zt}-${this._resizable}`),this._resizable=t,this._resizeHorizontally="right"===t||"left"===t,t?(this.class.add(zt),this.class.add(`${zt}-${t}`),this._domResizeHandle||(this._domResizeHandle=this._createResizeHandle()),this._dom.appendChild(this._domResizeHandle)):(this.class.remove(zt),this._domResizeHandle&&this._dom.removeChild(this._domResizeHandle))}}get resizable(){return this._resizable}set resizeMin(t){this._resizeMin=Math.max(0,Math.min(t,this._resizeMax))}get resizeMin(){return this._resizeMin}set resizeMax(t){this._resizeMax=Math.max(this._resizeMin,t)}get resizeMax(){return this._resizeMax}set domContent(t){this._domContent!==t&&(this._domContent&&this._domContent.removeEventListener("scroll",this._onScroll),this._domContent=t,this._domContent&&this._domContent.addEventListener("scroll",this._onScroll))}get domContent(){return this._domContent}}e(Kt,"EVENT_APPEND","append"),e(Kt,"EVENT_REMOVE","remove"),e(Kt,"EVENT_SCROLL","scroll"),e(Kt,"EVENT_RESIZE","resize");class $t extends Ft{constructor(t={}){super({dom:"span",...t}),e(this,"_unsafe"),e(this,"_text",""),e(this,"renderChanges",!1),this.class.add("tv-label"),this._unsafe=t.unsafe??!1,this.text=t.text??t.value??"",t.allowTextSelection&&this.class.add("tv-default-mousedown"),t.nativeTooltip&&(this.dom.title=this.text),this.placeholder=t.placeholder??null,this.renderChanges=t.renderChanges??!1,this.on("change",(()=>{this.renderChanges&&this.flash()}))}_updateText(t){return this.class.remove(Tt),this._text!==t&&(this._text=t,this._unsafe?this._dom.innerHTML=t:this._dom.textContent=t,this.emit("change",t),!0)}set text(t){this._updateText(t??"")}get text(){return this._text}set value(t){this.text=t}get value(){return this.text}set values(t){t.some((e=>e!==t[0]))?(this._updateText(""),this.class.add(Tt)):this._updateText(t[0])}set placeholder(t){t?this.dom.setAttribute("placeholder",t):this.dom.removeAttribute("placeholder")}get placeholder(){return this.dom.getAttribute("placeholder")??""}}class Yt extends Ft{constructor(t={}){super(t),e(this,"_domInput"),e(this,"_suspendInputChangeEvt"),e(this,"_prevValue"),e(this,"_keyChange",!1),e(this,"_renderChanges",!1),e(this,"_blurOnEnter",!0),e(this,"_blurOnEscape",!0),e(this,"_onInputKeyDownEvt"),e(this,"_onInputChangeEvt"),e(this,"_onInputFocus",(t=>{this.class.add(Vt),this.emit("focus",t),this._prevValue=this._domInput.value})),e(this,"_onInputBlur",(t=>{this.class.remove(Vt),this.emit("blur",t)})),e(this,"_onInputKeyUp",(t=>{"Escape"!==t.key&&this._onInputChange(t),this.emit("keyup",t)})),e(this,"_onInputCtxMenu",(t=>{this._domInput.select()})),e(this,"_updateInputReadOnly",(()=>{!this.enabled||this.readOnly?this._domInput.setAttribute("readonly","true"):this._domInput.removeAttribute("readonly")})),this.class.add("tv-input-element");let i=t.input;i||(i=document.createElement("input"),i.type="text"),i.ui=this,i.tabIndex=0,i.autocomplete="off",this._onInputKeyDownEvt=this._onInputKeyDown.bind(this),this._onInputChangeEvt=this._onInputChange.bind(this),i.addEventListener("change",this._onInputChangeEvt),i.addEventListener("keydown",this._onInputKeyDownEvt),i.addEventListener("focus",this._onInputFocus),i.addEventListener("blur",this._onInputBlur),i.addEventListener("contextmenu",this._onInputCtxMenu,!1),this.dom.appendChild(i),this._domInput=i,this._suspendInputChangeEvt=!1,void 0!==t.value&&(this._domInput.value=t.value),this.placeholder=t.placeholder??"",this.renderChanges=t.renderChanges??!1,this.blurOnEnter=t.blurOnEnter??!0,this.blurOnEscape=t.blurOnEscape??!0,this.keyChange=t.keyChange??!1,this._prevValue=null,this.on("change",(()=>{this.renderChanges&&this.flash()})),this.on("disable",this._updateInputReadOnly),this.on("enable",this._updateInputReadOnly),this.on("readOnly",this._updateInputReadOnly),this._updateInputReadOnly()}destroy(){if(this._destroyed)return;const t=this._domInput;t.removeEventListener("change",this._onInputChangeEvt),t.removeEventListener("keydown",this._onInputKeyDownEvt),t.removeEventListener("focus",this._onInputFocus),t.removeEventListener("blur",this._onInputBlur),t.removeEventListener("keyup",this._onInputKeyUp),t.removeEventListener("contextmenu",this._onInputCtxMenu),super.destroy()}_onInputKeyDown(t){if("Enter"===t.key&&this.blurOnEnter)this._suspendInputChangeEvt=this.keyChange,this._domInput.blur(),this._suspendInputChangeEvt=!1;else if("Escape"===t.key){this._suspendInputChangeEvt=!0;const e=this._domInput.value;this._domInput.value=this._prevValue??"",this._suspendInputChangeEvt=!1,this.keyChange&&e!==this._prevValue&&this._onInputChange(t),this.blurOnEscape&&this._domInput.blur()}this.emit("keydown",t)}_onInputChange(t){}focus(t){this._domInput.focus(),t&&this._domInput.select()}blur(){this._domInput.blur()}set placeholder(t){t?this.dom.setAttribute("placeholder",t):this.dom.removeAttribute("placeholder")}get placeholder(){return this.dom.getAttribute("placeholder")??""}set keyChange(t){this._keyChange!==t&&(this._keyChange=t,t?this._domInput.addEventListener("keyup",this._onInputKeyUp):this._domInput.removeEventListener("keyup",this._onInputKeyUp))}get keyChange(){return this._keyChange}get input(){return this._domInput}set blurOnEnter(t){this._blurOnEnter=t}get blurOnEnter(){return this._blurOnEnter}set blurOnEscape(t){this._blurOnEnter=t}get blurOnEscape(){return this._blurOnEnter}set renderChanges(t){this._renderChanges=t}get renderChanges(){return this._renderChanges}}class qt extends Yt{constructor(t={}){super(t),e(this,"_onValidate"),this.class.add("tv-text-input"),t.onValidate&&(this.onValidate=t.onValidate)}_onInputChange(){if(!this._suspendInputChangeEvt){if(this._onValidate){const t=!this._onValidate(this.value);if(this.error=t,t)return}else this.error=!1;this.emit("change",this.value)}}_updateValue(t){let e=t;if(this.class.remove(Tt),e&&"object"==typeof e)if(Array.isArray(e)){let t=!1;for(let i=0;i<e.length;i+=1)if(e[i]&&"object"==typeof e[i]){t=!0;break}e=t?"[Not available]":e.map((t=>null===t?"null":t)).join(",")}else e="[Not available]";return e!==this.value&&(this._suspendInputChangeEvt=!0,this._domInput.value=null==e?"":String(e),this._suspendInputChangeEvt=!1,this.emit("change",e),!0)}set value(t){this._updateValue(t)&&(this.error=!1)}get value(){return this._domInput.value}set values(t){t.some((e=>e!==t[0]))?(this._updateValue(null),this.class.add(Tt)):this._updateValue(t[0])}set onValidate(t){this._onValidate=t}get onValidate(){return this._onValidate}}const Gt="tv-item-selected",Zt="tv-item-open",Xt="tv-item-empty",Wt="tv-item-rename",Qt=class extends Kt{constructor(t={}){super(t),e(this,"_containerContents"),e(this,"_labelIcon"),e(this,"_labelText"),e(this,"_numChildren",0),e(this,"_treeView"),e(this,"_allowDrag",!0),e(this,"_allowDrop",!0),e(this,"_allowSelect",!0),e(this,"_icon"),e(this,"_onContentKeyDown",(t=>{"INPUT"!==t.target.tagName&&this.allowSelect&&this._treeView&&this._treeView._onChildKeyDown(t,this)})),e(this,"_onContentMouseDown",(t=>{var e;!(null==(e=this._treeView)?void 0:e.allowDrag)||!this._allowDrag||(this._treeView._updateModifierKeys(t),t.stopPropagation())})),e(this,"_onContentMouseUp",(t=>{t.stopPropagation(),t.preventDefault(),window.removeEventListener("mouseup",this._onContentMouseUp),this._treeView&&this._treeView._onChildDragEnd(t,this)})),e(this,"_onContentMouseOver",(t=>{t.stopPropagation(),this._treeView&&this._treeView._onChildDragOver(t,this),this.emit("hover",t)})),e(this,"_onContentDragStart",(t=>{var e;t.stopPropagation(),t.preventDefault(),(null==(e=this._treeView)?void 0:e.allowDrag)&&(this.class.contains(Wt)||(this._treeView._onChildDragStart(t,this),window.addEventListener("mouseup",this._onContentMouseUp)))})),e(this,"_onContentClick",(t=>{if(!this.allowSelect||0!==t.button||"INPUT"===t.target.tagName)return;t.stopPropagation();const e=this._containerContents.dom.getBoundingClientRect();this._numChildren>0&&t.clientX-e.left<0?(this.open=!this.open,t.altKey&&this._dfs((t=>{t.open=this.open})),this.focus()):this._treeView&&this._treeView._onChildClick(t,this)})),e(this,"_onContentDblClick",(t=>{var e;if(!(null==(e=this._treeView)?void 0:e.allowRenaming)||0!==t.button||"INPUT"===t.target.tagName)return;t.stopPropagation();const i=this._containerContents.dom.getBoundingClientRect();this.numChildren&&t.clientX-i.left<0||(this.allowSelect&&(this._treeView.deselect(),this._treeView._onChildClick(t,this)),this.rename())})),e(this,"_onContentContextMenu",(t=>{var e,i;null==(i=null==(e=this._treeView)?void 0:e._onContextMenu)||i.call(e,t,this)})),e(this,"_onContentFocus",(t=>{this.emit("focus")})),e(this,"_onContentBlur",(t=>{this.emit("blur")})),this.class.add("tv-item",Xt),this._containerContents=new Kt({class:"tv-item-contents",flex:!0,flexDirection:"row",tabIndex:0}),this.append(this._containerContents),this._containerContents.dom.innerHTML+='<svg class="icon-minus" viewBox="0 0 32 32"><path fill="#fff" d="M8 14.656h16v2.688h-16v-2.688z"></path></svg>',this._containerContents.dom.innerHTML+='<svg class="icon-plus" viewBox="0 0 768 768"><path fill="#fff" d="M607.5 415.5h-192v192h-63v-192h-192v-63h192v-192h63v192h192v63z"></path></svg>',this._containerContents.dom.draggable=!0,this._labelIcon=new $t({class:"tv-item-icon"}),this._containerContents.append(this._labelIcon),this.icon=t.icon,this._labelText=new $t({class:"tv-item-text"}),this._containerContents.append(this._labelText),this.allowSelect=t.allowSelect??!0,this.allowDrop=t.allowDrop??!0,this.allowDrag=t.allowDrag??!0,t.text&&(this.text=t.text),t.selected&&(this.selected=t.selected);const i=this._containerContents.dom;i.addEventListener("focus",this._onContentFocus),i.addEventListener("blur",this._onContentBlur),i.addEventListener("keydown",this._onContentKeyDown),i.addEventListener("dragstart",this._onContentDragStart),i.addEventListener("mousedown",this._onContentMouseDown),i.addEventListener("mouseover",this._onContentMouseOver),i.addEventListener("click",this._onContentClick),i.addEventListener("dblclick",this._onContentDblClick),i.addEventListener("contextmenu",this._onContentContextMenu)}destroy(){if(this._destroyed)return;const{dom:t}=this._containerContents;t.removeEventListener("focus",this._onContentFocus),t.removeEventListener("blur",this._onContentBlur),t.removeEventListener("keydown",this._onContentKeyDown),t.removeEventListener("dragstart",this._onContentDragStart),t.removeEventListener("mousedown",this._onContentMouseDown),t.removeEventListener("mouseover",this._onContentMouseOver),t.removeEventListener("click",this._onContentClick),t.removeEventListener("dblclick",this._onContentDblClick),t.removeEventListener("contextmenu",this._onContentContextMenu),window.removeEventListener("mouseup",this._onContentMouseUp),super.destroy()}_onAppendChild(t){super._onAppendChild(t),t instanceof Qt&&(this._numChildren+=1,this._parent!==this._treeView&&this.class.remove(Xt),this._treeView&&this._treeView._onAppendTreeViewItem(t))}_onRemoveChild(t){t instanceof Qt&&(this._numChildren-=1,0===this._numChildren&&this.class.add(Xt),this._treeView&&this._treeView._onRemoveTreeViewItem(t)),super._onRemoveChild(t)}_dfs(t){t(this);let e=this.firstChild;for(;e;)e._dfs(t),e=e.nextSibling}rename(){this.class.add(Wt);const t=new qt({class:Ot,renderChanges:!1,value:this.text});t.on("blur",(()=>{t.destroy()})),t.on("destroy",(()=>{this.class.remove(Wt),this.focus()})),t.on("change",(e=>{const i=e.trim();i&&(this.text=i,t.destroy())})),t.on("disable",(()=>{t.input.removeAttribute("readonly")})),this._containerContents.append(t),t.focus(!0)}focus(){this._containerContents.dom.focus()}blur(){this._containerContents.dom.blur()}set selected(t){t!==this.selected?t?(this._containerContents.class.add(Gt),this.emit("select",this),this._treeView&&this._treeView._onChildSelected(this),this.focus()):(this._containerContents.class.remove(Gt),this.blur(),this.emit("deselect",this),this._treeView&&this._treeView._onChildDeselected(this)):t&&this.focus()}get selected(){return this._containerContents.class.contains(Gt)}set text(t){this._labelText.value!==t&&(this._labelText.value=t,this._treeView&&this._treeView._onChildRename(this,t))}get text(){return this._labelText.value}get textLabel(){return this._labelText}get iconLabel(){return this._labelIcon}set open(t){if(this.open!==t)if(t){if(!this.numChildren)return;this.class.add(Zt),this.emit("open",this)}else this.class.remove(Zt),this.emit("close",this)}get open(){return this.class.contains(Zt)||this.parent===this._treeView}set parentsOpen(t){let e=this.parent;for(;e&&e instanceof Qt;)e.open=t,e=e.parent}get parentsOpen(){let t=this.parent;for(;t&&t instanceof Qt;){if(!t.open)return!1;t=t.parent}return!0}set allowDrop(t){this._allowDrop=t}get allowDrop(){return this._allowDrop}set allowDrag(t){this._allowDrag=t}get allowDrag(){return this._allowDrag}set allowSelect(t){this._allowSelect=t}get allowSelect(){return this._allowSelect}set treeView(t){this._treeView=t}get treeView(){return this._treeView}get numChildren(){return this._numChildren}get firstChild(){if(this._numChildren)for(let t=0;t<this.dom.childNodes.length;t+=1)if(this.dom.childNodes[t].ui instanceof Qt)return this.dom.childNodes[t].ui;return null}get lastChild(){if(this._numChildren)for(let t=this.dom.childNodes.length-1;t>=0;t-=1)if(this.dom.childNodes[t].ui instanceof Qt)return this.dom.childNodes[t].ui;return null}get nextSibling(){let t=this.dom.nextSibling;for(;t&&!(t.ui instanceof Qt);)t=t.nextSibling;return t&&t.ui}get previousSibling(){let t=this.dom.previousSibling;for(;t&&!(t.ui instanceof Qt);)t=t.previousSibling;return t&&t.ui}set icon(t){this._icon!==t&&(this._icon=t,t?this._labelIcon.dom.setAttribute("data-icon",String.fromCodePoint(Number.parseInt(t,16))):(this._labelIcon.dom.style.display="none",this._labelIcon.dom.removeAttribute("data-icon")))}get icon(){return this._icon}};let Jt=Qt;e(Jt,"EVENT_SELECT","select"),e(Jt,"EVENT_DESELECT","deselect"),e(Jt,"EVENT_OPEN","open"),e(Jt,"EVENT_CLOSE","close");const te=(t,e)=>{if(0===t.length)return e.length;if(0===e.length)return t.length;if(t===e)return 0;const i=[];for(let n=0;n<=e.length;n++)i[n]=[n];for(let n=0;n<=t.length;n++)i[0][n]=n;for(let n=1;n<=e.length;n++)for(let s=1;s<=t.length;s++)e.charAt(n-1)===t.charAt(s-1)?i[n][s]=i[n-1][s-1]:i[n][s]=Math.min(i[n-1][s-1]+1,Math.min(i[n][s-1]+1,i[n-1][s]+1));return i[e.length][t.length]},ee=(t,e)=>{if(t===e)return t.length;let i=0;const n=new Set;for(let s=0;s<e.length;s++)n.add(e.charAt(s));for(let s=0;s<t.length;s++)n.has(t.charAt(s))&&i++;return i},ie=t=>{const e=[],i=t.replace(/([^A-Z])([A-Z][^A-Z])/g,"$1 $2").replace(/([A-Z0-9]{2,})/g," $1").split(/(\s|\-|_)/g);for(let n=0;n<i.length;n++)i[n]=i[n].toLowerCase().trim(),i[n]&&"-"!==i[n]&&"_"!==i[n]&&e.push(i[n]);return e},ne=(t,e,i)=>{const n=[];for(const s of t){if(s.subFull!==1/0){n.push(s),s.edits===1/0&&(s.edits=0),s.sub===1/0&&(s.sub=s.subFull);continue}if(s.name===e||s.name.startsWith(e)){n.push(s),s.edits===1/0&&(s.edits=0),s.sub===1/0&&(s.sub=0);continue}if(ee(e,s.name)/e.length<(i.containsCharsTolerance??0))continue;let t=1/0,o=1/0;for(let n=0;n<s.tokens.length;n++){if(s.tokens[n]===e){t=0,o=n;break}const r=te(e,s.tokens[n]);(o===1/0||r<t)&&-1!==s.tokens[n].indexOf(e)?(o=n,t=r):o===1/0&&r<t&&r/Math.max(e.length,s.tokens[n].length)<=(i.editsDistanceTolerance??0)&&(t=r)}t!==1/0&&(n.push(s),s.edits=s.edits===1/0?t:s.edits+t,s.sub=s.sub===1/0?o:s.sub+o)}return n},se="tv-item-dragged",oe="tv-filtering",re="tv-filtering-result",ae="inside",le="before",he="after",de=(t,e)=>Array.prototype.indexOf.call(e.dom.childNodes,t.dom)-1,ce=t=>{t.parentsOpen=!0},pe=t=>{if(t.numChildren>0&&t.open)return t.firstChild;const e=t.nextSibling;if(e)return e;let i=t.parent;if(!(i instanceof Jt))return null;let n=i.nextSibling;for(;!n&&(i=i.parent,i instanceof Jt);)n=i.nextSibling;return n},ue=t=>{const e=t.previousSibling;if(e)return e.numChildren>0&&e.open?(t=>{if(!t.numChildren||!t.open)return null;let e=t.lastChild;for(;(null==e?void 0:e.numChildren)&&e.open;)e=e.lastChild;return e})(e):e;const i=t.parent;return i instanceof Jt?i:null};class ve extends Kt{constructor(t={}){super(t),e(this,"_selectedItems",[]),e(this,"_dragItems",[]),e(this,"_allowDrag"),e(this,"_allowReordering"),e(this,"_allowRenaming"),e(this,"_dragging",!1),e(this,"_dragOverItem",null),e(this,"_dragArea",ae),e(this,"_dragScroll",0),e(this,"_dragScrollInterval",null),e(this,"_dragHandle"),e(this,"_dragScrollElement"),e(this,"_onContextMenu"),e(this,"_onReparentFn"),e(this,"_pressedCtrl",!1),e(this,"_pressedShift",!1),e(this,"_filter",null),e(this,"_filterResults",[]),e(this,"_wasDraggingAllowedBeforeFiltering"),e(this,"_updateModifierKeys",(t=>{this._pressedCtrl=(null==t?void 0:t.ctrlKey)??(null==t?void 0:t.metaKey)??!1,this._pressedShift=(null==t?void 0:t.shiftKey)??!1})),e(this,"_onMouseLeave",(t=>{!this._allowDrag||!this._dragging||(this._dragOverItem=null,this._updateDragHandle())})),e(this,"_onMouseMove",(t=>{if(!this._dragging)return;const e=this.dom.getBoundingClientRect();this._dragScroll=0;let i=e.top,n=e.bottom;if(this._dragScrollElement!==this){const t=this._dragScrollElement.dom.getBoundingClientRect();i=Math.max(i+this._dragScrollElement.dom.scrollTop,t.top),n=Math.min(n+this._dragScrollElement.dom.scrollTop,t.bottom)}i=Math.max(0,i),n=Math.min(n,document.body.clientHeight),t.pageY<i+32&&this._dragScrollElement.dom.scrollTop>0?this._dragScroll=-1:t.pageY>n-32&&this._dragScrollElement.dom.scrollHeight>this._dragScrollElement.height+this._dragScrollElement.dom.scrollTop&&(this._dragScroll=1)})),e(this,"_onDragMove",(t=>{if(t.preventDefault(),t.stopPropagation(),!this._allowDrag||!this._dragOverItem)return;const e=this._dragHandle.dom.getBoundingClientRect(),i=Math.floor((t.clientY-e.top)/e.height*5),n=this._dragArea,s=this._dragOverItem;if(this._dragOverItem.parent===this){let t=!1;for(let e=0;e<this._dragItems.length;e+=1)if(this._dragItems[e].parent===this._dragOverItem){t=!0,this._dragOverItem=null;break}t||(this._dragArea=ae)}else{let t=!1;for(let e=0;e<this._dragItems.length;e+=1)if(this._dragItems[e].dom.contains(this._dragOverItem.dom)){t=!0;break}if(t)this._dragOverItem=null;else if(this._allowReordering&&i<=1&&this._dragOverItem.previousSibling&&-1===this._dragItems.indexOf(this._dragOverItem.previousSibling))this._dragArea=le;else if(this._allowReordering&&i>=4&&this._dragOverItem.nextSibling&&-1===this._dragItems.indexOf(this._dragOverItem.nextSibling)&&(0===this._dragOverItem.numChildren||!this._dragOverItem.open))this._dragArea=he;else{let t=!1;if(this._allowReordering&&this._dragOverItem.open)for(let e=0;e<this._dragItems.length;e+=1)if(this._dragItems[e].parent===this._dragOverItem){t=!0,this._dragArea=le;break}t||(this._dragArea=ae)}}(n!==this._dragArea||s!==this._dragOverItem)&&this._updateDragHandle()}));const i=document.createElement("style");i.innerHTML='@charset "UTF-8";:host{--font-family: inconsolatamedium, Monaco, Menlo, "Ubuntu Mono", Consolas, source-code-pro, monospace;--bg-darkest: #202020;--bg-darker: #202020;--bg-dark: #282828;--bg-primary: #333333;--color-line: #333333;--color-icon: #666666;--text-darkest: rgb(170 170 170 / 50%);--text-dark: rgb(170 170 170 / 50%);--text-secondary: #aaaaaa;--text-primary: #ffffff;--text-active: #4CAF50;--error: #fb222f;--error-secondary: #d34141;--border-primary: #aaaaaa;--element-shadow-hover: 0 0 2px 1px rgba(255, 102, 0, .3);--element-shadow-active: 0 0 0 1px rgba(255, 102, 0, .3);--element-shadow-error: 0 0 0 1px var(--error-secondary);--element-color-placeholder: #829193;--field-padding: 3px;--disabled-opacity: .4;--element-margin: 6px;--element-opacity-disabled: .4;--element-opacity-readonly: .7}.tv-container{position:relative;min-width:0;min-height:0}.tv-container.tv-resizable>.tv-resizable-handle{position:absolute;z-index:1;opacity:0;background-color:transparent}.tv-container.tv-resizable>.tv-resizable-handle:hover{opacity:1}.tv-container.tv-resizable.tv-resizable-resizing>.tv-resizable-handle{opacity:1}.tv-container.tv-resizable.tv-resizable-left>.tv-resizable-handle,.tv-container.tv-resizable.tv-resizable-right>.tv-resizable-handle{top:0;bottom:0;width:1px;height:auto;cursor:ew-resize}.tv-container.tv-resizable.tv-resizable-left>.tv-resizable-handle{left:0;border-left:3px solid var(--bg-darkest)}.tv-container.tv-resizable.tv-resizable-right>.tv-resizable-handle{right:0;border-right:3px solid var(--bg-darkest)}.tv-container.tv-resizable.tv-resizable-top>.tv-resizable-handle,.tv-container.tv-resizable.tv-resizable-bottom>.tv-resizable-handle{left:0;right:0;width:auto;height:1px;cursor:ns-resize}.tv-container.tv-resizable.tv-resizable-top>.tv-resizable-handle{top:0;border-top:3px solid var(--bg-darkest)}.tv-container.tv-resizable.tv-resizable-bottom>.tv-resizable-handle{bottom:0;border-bottom:3px solid var(--bg-darkest)}.tv-container-dragged{outline:2px solid var(--text-primary);box-sizing:border-box;opacity:.7;z-index:1}.tv-container-dragged-child{outline:1px dotted var(--text-active);box-sizing:border-box}@keyframes tv-flash-animation{0%{outline-color:var(--text-active)}to{outline-color:rgba(var(--text-active),0)}}.tv-element{font-weight:400;font-style:normal;border:0 solid var(--border-primary)}.tv-element.flash{outline:1px solid var(--text-active);animation:tv-flash-animation .2s ease-in-out forwards}.tv-element:focus{outline:none}.tv-element::-moz-focus-inner{border:0}.tv-element.tv-hidden{display:none}.tv-input-element{display:inline-block;border:1px solid var(--bg-darker);border-radius:2px;box-sizing:border-box;margin:var(--element-margin);min-height:24px;height:24px;background-color:var(--bg-dark);vertical-align:top;transition:color .1s,background-color .1s,box-shadow .1s;position:relative;color:var(--text-secondary)}.tv-input-element>input{height:100%;width:calc(100% - 16px);padding:0 var(--element-margin);line-height:1;color:inherit;background:transparent;border:none;outline:none;box-shadow:none;font-family:var(--font-family);font-weight:400;font-size:12px}.tv-input-element:before{color:inherit}.tv-input-element.tv-multiple-values:before{position:absolute;padding:0 8px;content:"...";white-space:nowrap;font-family:var(--font-family);font-weight:400;font-size:12px;top:5px}.tv-input-element:not(.tv-disabled,.tv-readonly):hover{background-color:var(--bg-darker);color:var(--text-primary)}.tv-input-element:not(.tv-disabled,.tv-readonly):not(.tv-error):hover{box-shadow:var(--element-shadow-hover)}.tv-input-element:not(.tv-disabled,.tv-readonly).tv-focus{background-color:var(--bg-darkest);box-shadow:var(--element-shadow-active)}.tv-input-element.tv-focus:after,.tv-input-element.tv-focus:before,.tv-input-element:hover:after,.tv-input-element:hover:before{display:none}.tv-input-element.tv-readonly{border-color:transparent}.tv-input-element.tv-disabled{color:var(--text-darkest)}.tv-input-element.tv-error{color:var(--text-secondary);box-shadow:var(--element-shadow-error)}.tv-input-element[placeholder]{position:relative}.tv-input-element[placeholder]:after{content:attr(placeholder);background-color:var(--bg-dark);position:absolute;top:0;right:0;padding:0 8px;line-height:22px;font-size:10px;font-weight:600;white-space:nowrap;color:var(--element-color-placeholder);pointer-events:none}.tv-label{display:inline-block;box-sizing:border-box;margin:var(--element-margin);vertical-align:middle;transition:opacity .1s;color:var(--text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;user-select:none}.tv-label.tv-default-mousedown{user-select:initial}.tv-label.tv-multiple-values{position:relative;color:transparent}.tv-label.tv-multiple-values:before{content:"...";color:var(--text-secondary);white-space:nowrap;font-family:var(--font-family);font-weight:400;font-size:12px}.tv-label.tv-error{color:var(--error-secondary)}.tv-label.tv-selectable:hover{color:var(--text-active);text-decoration:underline;-webkit-touch-callout:none;user-select:none}.tv-label[placeholder]{position:relative}.tv-label[placeholder]:after{content:attr(placeholder);position:absolute;top:0;right:0;padding:0 8px;color:#999;pointer-events:none}@font-face{font-family:plusminus;font-weight:400;font-style:normal;font-display:block;src:url(data:application/octet-stream;base64,d09GMgABAAAAAAIwAA0AAAAABfgAAAHdAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP0ZGVE0cGh4GYACCXhEICoEEdwsQAAE2AiQDGgQgBYMbB08b9ATIngXlmGuJ8SoMIRZRsZl/ekTw/n6fc8598IHUlkA1VShRNdXA8c3GF5hkhanQ64qWQG+qm8oPha05+yUS9oRC13hgWQsEyteqVv9/VZNP3eT/L9AsHJO6TDJaYF1i4dgYYNp5gIGOTZsyCtADo6yd/1efyWczfAZJsv8mymY0CgHfr5/vw5//JurZwgAzkEJohAqJUi7EAzX5Mj/iPlXHXxujS9XERO12mo8yN52zvUABAdKVhLLtUgIHpASWStsMPR0phZXzMTUY5ufM9IJaEXoAQiEaogCRSABAUMETIaaNQQtGqLEYVgNUgECIVpioB3Hj4ZpRnC5nrwxiWPo5BIAp+4zEVxfZE94PBHDnzXA1rm3+1+lXvNcOytr8hI4EgV9slUY8fiM0FSD2AiQqwWeB1kCABADAyGsBQmtCILXWECha2wlUWgcI1PpOEGi0ngjQs9hfEVVXGGEg8YWg4OtAhe+kajMmVGPkSsOeTX5mzZ0dnZ2dMLs8+5xPsMvS2tPB1A1PyPLQm7Em32fp5m7rNwLL43ApGKwfM3eU7gdjbek0hTv1sLRwznwZHeADy+JCG9tqrc78/PnCEpDSupZIGUWJKurmyOF72YTc0dPWe5/JRt17IwA=)}.tv{-webkit-touch-callout:none;user-select:none;min-width:max-content}.tv-item{position:relative;padding-left:24px}.tv-item:before{content:"\\a0";position:absolute;background-color:var(--color-icon);width:2px;left:14px;top:-12px;bottom:12px}.tv-item:last-child:before{height:25px;bottom:auto}.tv-item.tv-disabled>.tv-item-contents>.tv-item-text{opacity:var(--disabled-opacity)}.tv-item-contents{position:relative;color:var(--text-secondary);margin-left:3px;border:1px solid transparent;align-items:center;height:24px;box-sizing:border-box}.tv-item-contents:hover{cursor:pointer;color:var(--text-primary);background-color:var(--bg-dark)}.tv-item-contents:hover>.tv-item-icon{color:var(--text-primary)}.tv-item-icon{color:var(--text-darkest);margin:0 2px 0 0;flex-shrink:0}.tv-item-icon:before{content:"\\a0";position:absolute;background-color:var(--color-icon);left:-12px;top:10px;width:24px;height:2px}.tv-item-icon:after{content:attr(data-icon);display:inline-block;vertical-align:sub;width:22px;height:22px;position:relative;z-index:1;text-align:center}.tv-item-text{margin:0;flex-shrink:0;position:relative;z-index:1;transition:opacity .1s;padding-right:8px;color:inherit}.tv-item-contents.tv-item-selected{background-color:var(--bg-darkest);color:var(--text-primary)}.tv-item-contents.tv-item-selected>.tv-item-icon{color:var(--text-primary)}.tv-item .icon-plus,.tv-item .icon-minus{position:absolute;font-size:10px;font-weight:700;text-align:center;color:var(--text-secondary);background-color:var(--bg-dark);top:0;left:-24px;width:16px;height:16px;line-height:16px;margin:3px;cursor:pointer;z-index:1;box-sizing:border-box;padding:2px}.tv-item .tv-item.tv-item-empty .icon-plus,.tv-item .tv-item.tv-item-empty .icon-minus{display:none}.tv-item>.tv-item-contents .icon-minus{display:none}.tv-item.tv-item-open>.tv-item-contents .icon-minus{display:block}.tv-item.tv-item-open>.tv-item-contents .icon-plus{display:none}.tv>.tv-item{padding-left:0}.tv>.tv-item:before{content:none}.tv>.tv-item>.tv-item-contents{margin-left:0}.tv>.tv-item>.tv-item-contents>.tv-item-icon:before{content:none}.tv>.tv-item>.tv-item-contents>.tv-item-icon:after{margin-left:0}.tv>.tv-item>.tv-item{padding-left:21px}.tv>.tv-item>.tv-item:before{left:11px}.tv:not(.tv-filtering)>.tv-item .tv-item:not(.tv-item-open,.tv-item-empty)>.tv-item{display:none}.tv-item-dragged>.tv-item-contents{background-color:rgba(var(--bg-dark),.5);color:var(--text-primary)}.tv-drag-handle{position:fixed;width:32px;height:20px;top:0;bottom:0;z-index:4;margin-top:-1px;margin-left:-1px}.tv-drag-handle.before{border-top:4px solid var(--text-active);padding-right:8px;height:24px}.tv-drag-handle.inside{border:4px solid var(--text-active)}.tv-drag-handle.after{border-bottom:4px solid var(--text-active);padding-right:8px;height:24px}.tv-item-contents:after{content:" ";display:block;clear:both}.tv-item.tv-item-rename>.tv-item-contents>.tv-item-text{display:none}.tv-item.tv-item-rename>.tv-item-contents>.tv-text-input{margin:0;flex-grow:1;box-shadow:none!important;border:0;background-color:transparent}.tv-item.tv-item-rename>.tv-item-contents>.tv-text-input>input{font-family:inherit;font-size:14px;padding:0}.tv.tv-filtering .tv-item{padding-left:0}.tv.tv-filtering .tv-item:before{display:none}.tv.tv-filtering .tv-item:not(.tv-filtering-result)>.tv-item-contents{display:none}.tv.tv-filtering .tv-item-contents{margin-left:0}.tv-filtering-result .tv-item-contents:before,.tv-filtering-result .tv-item-icon:before{display:none}.tv-no-select{-webkit-touch-callout:none;user-select:none}.tv-flex{flex-direction:column}.tv-flex:not(.tv-hidden){display:flex}.tv-grid{display:grid}.tv-scrollable{overflow:auto}.tv-hidden{display:none}.font-thin{font-weight:100;font-style:normal}.font-light{font-weight:200;font-style:normal}.font-regular{font-weight:400;font-style:normal}.font-bold{font-weight:700;font-style:normal}.fixed-font{font-family:var(--font-family);font-weight:400;font-size:12px}\n',this.dom.append(i),this.class.add("tv"),this._allowDrag=t.allowDrag??!0,this._allowReordering=t.allowReordering??!0,this._allowRenaming=t.allowRenaming??!1,this._dragHandle=new Ft({class:"tv-drag-handle"}),this._dragScrollElement=t.dragScrollElement??this,this.append(this._dragHandle),this._onContextMenu=t.onContextMenu,this._onReparentFn=t.onReparent,this._wasDraggingAllowedBeforeFiltering=this._allowDrag,window.addEventListener("keydown",this._updateModifierKeys),window.addEventListener("keyup",this._updateModifierKeys),window.addEventListener("mousedown",(()=>this._updateModifierKeys())),this.dom.addEventListener("mouseleave",this._onMouseLeave),this._dragHandle.dom.addEventListener("mousemove",this._onDragMove),this._dragHandle.on("destroy",(t=>{t.removeEventListener("mousemove",this._onDragMove)}))}destroy(){this._destroyed||(window.removeEventListener("keydown",this._updateModifierKeys),window.removeEventListener("keyup",this._updateModifierKeys),window.removeEventListener("mousedown",(()=>this._updateModifierKeys())),window.removeEventListener("mousemove",this._onMouseMove),this.dom.removeEventListener("mouseleave",this._onMouseLeave),this._dragScrollInterval&&(window.clearInterval(this._dragScrollInterval),this._dragScrollInterval=null),super.destroy())}_getChildrenRange(t,e){const i=[];if(this._filterResults.length){const n=this.dom.querySelectorAll(`.tv-item.${re}`);let s=-1,o=-1;for(let r=0;r<n.length;r+=1){const a=n[r].ui;if(a===t?s=r:a===e&&(o=r),-1!==s&&-1!==o){const t=s<o?o:s;for(let e=s<o?s:o;e<=t;e+=1)i.push(n[e].ui);break}}}else{let n=t;const s=t.dom.getBoundingClientRect(),o=e.dom.getBoundingClientRect();if(s.top<o.top)for(;n&&n!==e;)n=pe(n),n&&n!==e&&i.push(n);else for(;n&&n!==e;)n=ue(n),n&&n!==e&&i.push(n);i.push(e)}return i}_onAppendChild(t){super._onAppendChild(t),t instanceof Jt&&this._onAppendTreeViewItem(t)}_onRemoveChild(t){t instanceof Jt&&this._onRemoveTreeViewItem(t),super._onRemoveChild(t)}_onAppendTreeViewItem(t){t.treeView=this,this._filter&&this._searchItems([[t.text,t]],this._filter),t.forEachChild((t=>{t instanceof Jt&&this._onAppendTreeViewItem(t)}))}_onRemoveTreeViewItem(t){t.selected=!1,t.forEachChild(((t,e)=>{t instanceof Jt&&this._onRemoveTreeViewItem(t)}))}_onChildKeyDown(t,e){if(-1!==["Tab","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].indexOf(t.key))if(t.preventDefault(),t.stopPropagation(),"ArrowDown"===t.key){if(this._selectedItems.length){const t=pe(e);t&&(this._pressedShift||this._pressedCtrl?t.selected=!0:this._selectSingleItem(t))}}else if("ArrowUp"===t.key){if(this._selectedItems.length){const t=ue(e);t&&(this._pressedShift||this._pressedCtrl?t.selected=!0:this._selectSingleItem(t))}}else"ArrowLeft"===t.key?e.parent!==this&&(e.open=!1):"ArrowRight"===t.key?e.open=!0:t.key}_onChildClick(t,e){if(0===t.button&&e.allowSelect)if(this._pressedCtrl)e.selected=!e.selected;else if(this._pressedShift){if(!this._selectedItems.length||1===this._selectedItems.length&&this._selectedItems[0]===e)return void(e.selected=!0);const t=this._selectedItems[this._selectedItems.length-1];ce(t),this._getChildrenRange(t,e).forEach((t=>{t.allowSelect&&(t.selected=!0)}))}else this._selectSingleItem(e)}traverseDepthFirst(t){const e=i=>{if(i&&i instanceof Jt&&(t(i),i.numChildren))for(let t=0;t<i.dom.childNodes.length;t+=1)e(i.dom.childNodes[t].ui)};for(let i=0;i<this.dom.childNodes.length;i+=1)e(this.dom.childNodes[i].ui)}_getTreeOrder(){const t=new Map;let e=0;return this.traverseDepthFirst((i=>{e+=1,t.set(i,e)})),t}_onChildDragStart(t,e){if(this.allowDrag&&!this._dragging){if(this._dragItems=[],-1===this._selectedItems.indexOf(e))e.class.add(se),this._dragItems.push(e);else{const t=[];let e=-1;for(let i=0;i<this._selectedItems.length;i+=1){let n=this._selectedItems[i].parent,s=0,o=!1;for(;n&&n instanceof Jt;){if(-1!==this._selectedItems.indexOf(n)){o=!0;break}s+=1,n=n.parent}if(!o){if(-1===e)e=s;else if(e!==s)return;t.push(this._selectedItems[i])}}this._dragItems=t}this._dragItems.length&&(this._dragItems.forEach((t=>{t.class.add(se)})),this.isDragging=!0,this.emit("dragstart",this._dragItems.slice()))}}_onChildDragEnd(t,e){if(!this.allowDrag||!this._dragging)return;this._dragItems.forEach((t=>t.class.remove(se)));let i=!1;for(let s=0;s<this._dragItems.length;s+=1)if(this._dragItems[s].parent===this){i=!0;break}const n=this._dragOverItem;if(!i&&n){if(this._dragItems.length>1){const t=this._getTreeOrder();this._dragItems.sort(((e,i)=>(t.get(e)??0)-(t.get(i)??0)))}if(this._dragItems.length){const t=[];if(this._onReparentFn){const e=[],i=t=>{let i=e.findIndex((e=>e.parent===t));return-1===i&&(e.push({children:[...t.dom.childNodes],parent:t}),i=e.length-1),e[i].children};this._dragItems.forEach((e=>{if(e.parent===n&&this._dragArea===ae||(t.push({item:e,oldParent:e.parent}),!e.parent))return;const s=i(e.parent),o=s.indexOf(e.dom);s.splice(o,1)})),t.forEach(((e,s)=>{if(this._dragArea===le){if(e.newParent=n.parent,!n.parent)return;const t=i(n.parent),s=t.indexOf(n.dom);t.splice(s,0,e.item.dom),e.newChildIndex=s}else if(this._dragArea===ae){e.newParent=n;const t=i(n);t.push(e.item.dom),e.newChildIndex=t.length-1}else if(this._dragArea===he){if(e.newParent=n.parent,!n.parent)return;const o=i(n.parent),r=s>0?t[s-1].item:n,a=o.indexOf(r.dom);o.splice(a+1,0,e.item.dom),e.newChildIndex=a+1}e.newChildIndex-=1}))}else this._dragItems.forEach((e=>{e.parent===this._dragOverItem&&this._dragArea===ae||(t.push({item:e,oldParent:e.parent}),e.parent.remove(e))})),t.forEach(((e,i)=>{this._dragArea===le?(e.newParent=n.parent,n.parent.appendBefore(e.item,n),e.newChildIndex=de(e.item,e.newParent)):this._dragArea===ae?(e.newParent=n,n.append(e.item),n.open=!0,e.newChildIndex=de(e.item,e.newParent)):this._dragArea===he&&(e.newParent=n.parent,n.parent.appendAfter(e.item,i>0?t[i-1].item:this._dragOverItem),e.newChildIndex=de(e.item,e.newParent))}));t.length&&(this._onReparentFn&&this._onReparentFn(t),this.emit("reparent",t))}}this._dragItems=[],this.isDragging=!1,this.emit("dragend")}_onChildDragOver(t,e){!this._allowDrag||!this._dragging||(e.allowDrop&&-1===this._dragItems.indexOf(e)?this._dragOverItem=e:this._dragOverItem=null,this._updateDragHandle(),this._onDragMove(t))}_scrollWhileDragging(){this._dragging&&0!==this._dragScroll&&(this._dragScrollElement.dom.scrollTop+=8*this._dragScroll,this._dragOverItem=null,this._updateDragHandle())}_updateDragHandle(t,e){if(!(e||this._allowDrag&&this._dragging))return;const i=t??this._dragOverItem;if(i&&!i.hidden&&i.parentsOpen){const t=i._containerContents.dom.getBoundingClientRect();this._dragHandle.hidden=!1,this._dragHandle.class.remove(he,le,ae),this._dragHandle.class.add(this._dragArea);const e=t.top;let n=t.left,s=t.width;if(this.dom.parentElement){const t=this.dom.parentElement.getBoundingClientRect();n=Math.max(n,t.left),s=Math.min(s,this.dom.parentElement.clientWidth-n+t.left)}this._dragHandle.style.top=`${e}px`,this._dragHandle.style.left=`${n}px`,this._dragHandle.style.width=s-7+"px"}else this._dragHandle.hidden=!0}_selectSingleItem(t){let e=!1;for(let i=this._selectedItems.length-1;i>-1;i-=1)this._selectedItems[i]&&this._selectedItems[i]!==t&&(this._selectedItems[i].selected=!1,e=!0);t.selected=!!e||!t.selected}_onChildSelected(t){this._selectedItems.push(t),ce(t),this.emit("select",t)}_onChildDeselected(t){const e=this._selectedItems.indexOf(t);-1!==e&&(this._selectedItems.splice(e,1),this.emit("deselect",t))}_onChildRename(t,e){if(this._filter){t.class.remove(re);const e=this._filterResults.indexOf(t);-1!==e&&this._filterResults.splice(e,1),this._searchItems([[t.text,t]],this._filter)}this.emit("rename",t,e)}_searchItems(t,e){const i=((t,e="",i={})=>{if(!(e=e.toLowerCase().trim()))return[];const n=ie(e);if(!n.length)return[];i.containsCharsTolerance??(i.containsCharsTolerance=.5),i.editsDistanceTolerance??(i.editsDistanceTolerance=.5);let s=[];for(const r of t){const t=r[0].toLowerCase().trim().indexOf(e);s.push({name:r[0],item:r[1],tokens:ie(r[0]),edits:1/0,subFull:-1!==t?t:1/0,sub:1/0})}for(let r=0;r<n.length;r++)s=ne(s,n[r],i);s.sort(((t,e)=>t.subFull!==e.subFull?t.subFull-e.subFull:t.sub!==e.sub?t.sub-e.sub:t.edits!==e.edits?t.edits-e.edits:t.name.length-e.name.length));let o=s.map((t=>t.item));return i.hasOwnProperty("limitResults")&&o.length>(i.limitResults??0)&&(o=o.slice(0,i.limitResults)),o})(t,e);i.length&&i.forEach((t=>{this._filterResults.push(t),t.class.add(re)}))}_applyFilter(t){this._clearFilter(),this._wasDraggingAllowedBeforeFiltering=this._allowDrag,this._allowDrag=!1,this.class.add(oe);const e=[];this.traverseDepthFirst((t=>{e.push([t.text,t])})),this._searchItems(e,t)}_clearFilter(){this._filterResults.forEach((t=>{t.destroyed||t.class.remove(re)})),this._filterResults.length=0,this.class.remove(oe),this._allowDrag=this._wasDraggingAllowedBeforeFiltering}showDragHandle(t){this._updateDragHandle(t,!0)}deselect(){for(let t=this._selectedItems.length-1;t>-1;t-=1)this._selectedItems[t]&&(this._selectedItems[t].selected=!1)}clearTreeItems(){for(let t=this.dom.childNodes.length-1;t>-1;t-=1){const e=this.dom.childNodes[t];if(!e)continue;const i=e.ui;i instanceof Jt&&i.destroy()}this._selectedItems=[],this._dragItems=[],this._allowDrag=this._wasDraggingAllowedBeforeFiltering}set allowDrag(t){this._allowDrag=t,this._filter&&(this._wasDraggingAllowedBeforeFiltering=t)}get allowDrag(){return this._allowDrag}set allowReordering(t){this._allowReordering=t}get allowReordering(){return this._allowReordering}set allowRenaming(t){this._allowRenaming=t}get allowRenaming(){return this._allowRenaming}set isDragging(t){this._dragging!==t&&(t?(this._dragging=!0,this._updateDragHandle(),(this.scrollable||this._dragScrollElement!==this)&&(window.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("mousemove",this._onMouseMove),this._dragScrollInterval||(this._dragScrollInterval=window.setInterval((()=>{this._scrollWhileDragging()}),1e3/60)))):(this._dragOverItem=null,this._updateDragHandle(),this._dragging=!1,window.removeEventListener("mousemove",this._onMouseMove),this._dragScrollInterval&&(window.clearInterval(this._dragScrollInterval),this._dragScrollInterval=null)))}get isDragging(){return this._dragging}get selected(){return this._selectedItems.slice()}set filter(t){this._filter!==t&&(this._filter=t,t?this._applyFilter(t):this._clearFilter())}get filter(){return this._filter}get pressedCtrl(){return this._pressedCtrl}get pressedShift(){return this._pressedShift}}e(ve,"EVENT_DRAGSTART","dragstart"),e(ve,"EVENT_DRAGEND","dragend"),e(ve,"EVENT_REPARENT","reparent"),e(ve,"EVENT_SELECT","select"),e(ve,"EVENT_DESELECT","deselect"),e(ve,"EVENT_RENAME","rename");class me extends ve{constructor(t={}){super(t),e(this,"wc",document.createElement("tree-view")),e(this,"shadowRoot",this.wc.attachShadow({mode:"open"})),this.shadowRoot.append(this.dom)}}var ge={};!function(t){class e{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class i{constructor(t){this.target=t}}class n extends i{constructor(t,e,i,n){super(t),this.value=e,this.presetKey=i,this.last=n??!0}}function s(t){return null==t}const o={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class r{constructor(t){var e;this.message=null!==(e=o[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new r({type:"alreadydisposed"})}static notBindable(){return new r({type:"notbindable"})}static propertyNotFound(t){return new r({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new r({type:"shouldneverhappen"})}}class a{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter((t=>t.handler!==e))),this}emit(t,e){const i=this.observers_[t];i&&i.forEach((t=>{t.handler(e)}))}}const l="tp";function h(t){return(e,i)=>[l,"-",t,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function d(t,e){return i=>e(t(i))}function c(t){return t.rawValue}function p(t,e){t.emitter.on("change",d(c,e)),e(t.rawValue)}function u(t,e,i){p(t.value(e),i)}function v(t,e,i){i?t.classList.add(e):t.classList.remove(e)}function m(t,e){return i=>{v(t,e,i)}}function g(t,e){p(t,(t=>{e.textContent=t??""}))}const _=h("btn");class b{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(_()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(_("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElement("div");n.classList.add(_("t")),g(e.props.value("title"),n),this.buttonElement.appendChild(n)}}class f{constructor(t,e){this.emitter=new a,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new b(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class w{constructor(t,e){var i;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(i=null==e?void 0:e.equals)&&void 0!==i?i:(t,e)=>t===e,this.emitter=new a,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(t):t,s=this.rawValue_;this.equals_(s,n)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:n,sender:this}))}}class x{constructor(t){this.emitter=new a,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},n=this.value_;n===t&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:i,previousRawValue:n,rawValue:this.value_,sender:this}))}}function y(t,e){const i=null==e?void 0:e.constraint,n=null==e?void 0:e.equals;return i||n?new w(t,e):new x(t)}class C{constructor(t){this.emitter=new a,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,i)=>Object.assign(e,{[i]:y(t[i])})),{})}static fromObject(t){const e=this.createCore(t);return new C(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function E(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function P(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function k(t){return null!==t&&"object"==typeof t}function z(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function L(t){return{custom:e=>z(e)(t),boolean:z((t=>"boolean"==typeof t?t:void 0))(t),number:z((t=>"number"==typeof t?t:void 0))(t),string:z((t=>"string"==typeof t?t:void 0))(t),function:z((t=>"function"==typeof t?t:void 0))(t),constant:e=>z((t=>t===e?e:void 0))(t),raw:z((t=>t))(t),object:e=>z((t=>{if(k(t))return E(t,e)}))(t),array:e=>z((t=>{if(Array.isArray(t))return P(t,e)}))(t)}}const M={optional:L(!0),required:L(!1)};function V(t,e){const i=M.required.object(e)(t);return i.succeeded?i.value:void 0}function T(t){console.warn([`Missing '${t.key}' of ${t.target} in ${t.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function A(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}class S{constructor(t){this.value_=t}static create(t){return[new S(t),(e,i)=>{t.setRawValue(e,i)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const O=h("");function I(t,e){return m(t,O(void 0,e))}class D extends C{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=S.create(y(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,i,n;const s=t??{};return new D(C.createCore({disabled:null!==(e=s.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=s.hidden)&&void 0!==i&&i,parent:null!==(n=s.parent)&&void 0!==n?n:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){p(this.globalDisabled_,I(t,"disabled")),u(this,"hidden",I(t,"hidden"))}bindDisabled(t){p(this.globalDisabled_,(e=>{t.disabled=e}))}bindTabIndex(t){p(this.globalDisabled_,(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}getGlobalDisabled_(){const t=this.get("parent");return!!t&&t.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const i=t.previousRawValue;null==i||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function R(){return["veryfirst","first","last","verylast"]}const F=h(""),U={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class N{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{R().forEach((t=>{e.classList.remove(F(void 0,U[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(F(void 0,U[t]))}))})),this.viewProps.handleDispose((()=>{A(e)}))}get parent(){return this.parent_}set parent(t){this.parent_=t,"parent"in this.viewProps.valMap_?this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null):T({key:"parent",target:D.name,place:"BladeController.parent"})}}const B="http://www.w3.org/2000/svg";function j(t){t.offsetHeight}function H(t,e){const i=t.style.transition;t.style.transition="none",e(),t.style.transition=i}function K(t){return void 0!==t.ontouchstart}function $(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function Y(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const q=h("lbl");function G(t,e){const i=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,n)=>{n>0&&i.appendChild(t.createElement("br")),i.appendChild(e)})),i}class Z{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(q()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(q("l")),u(e.props,"label",(e=>{s(e)?this.element.classList.add(q(void 0,"nol")):(this.element.classList.remove(q(void 0,"nol")),$(i),i.appendChild(G(t,e)))})),this.element.appendChild(i),this.labelElement=i;const n=t.createElement("div");n.classList.add(q("v")),this.element.appendChild(n),this.valueElement=n}}class X extends N{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new Z(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class W extends N{constructor(t){super(t),this.value=t.value}}class Q extends C{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=C.createCore(e);return new Q(i)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!s(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const i=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};u(this,"expanded",i),u(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function J(t){return Q.create(t)}function tt(t,e){let i=0;return H(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),j(e),i=e.clientHeight,t.set("temporaryExpanded",null),j(e)})),i}function et(t,e){e.style.height=t.styleHeight}function it(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),s(t.get("expandedHeight"))&&t.set("expandedHeight",tt(t,e)),t.set("shouldFixHeight",!0),j(e)})),t.emitter.on("change",(()=>{et(t,e)})),et(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&t.cleanUpTransition()}))}class nt{constructor(t,e){const i=h(e.viewName);this.element=t.createElement("div"),this.element.classList.add(i()),e.viewProps.bindClassModifiers(this.element)}}class st extends W{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new Z(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class ot{constructor(){this.disabled=!1,this.emitter=new a}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class rt{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new a,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class at{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function lt(t,e){if(t instanceof e)return t;if(t instanceof at){const i=t.constraints.reduce(((t,i)=>t||(i instanceof e?i:null)),null);if(i)return i}return null}class ht{constructor(t){this.values=C.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(t,i),e)}}class dt{constructor(t){this.values=C.fromObject({max:t.max,min:t.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(t){const e=this.values.get("max"),i=this.values.get("min");let n=t;return s(i)||(n=Math.max(n,i)),s(e)||(n=Math.min(n,e)),n}}class ct{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}const pt=h("pop");class ut{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(pt()),e.viewProps.bindClassModifiers(this.element),p(e.shows,m(this.element,pt(void 0,"v")))}}class vt{constructor(t,e){this.shows=y(!1),this.viewProps=e.viewProps,this.view=new ut(t,{shows:this.shows,viewProps:this.viewProps})}}const mt=h("txt");class gt{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(mt()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const i=t.createElement("input");i.classList.add(mt("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class _t{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new gt(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);s(i)||(this.value.rawValue=i),this.view.refresh()}}function bt(t){return"false"!==t&&!!t}class ft{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const wt={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class xt{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=wt[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const yt={"+":t=>t,"-":t=>-t,"~":t=>~t};class Ct{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=yt[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Et(t){return(e,i)=>{for(let n=0;n<t.length;n++){const s=t[n](e,i);if(""!==s)return s}return""}}function Pt(t,e){var i;const n=t.substr(e).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function kt(t,e){const i=t.substr(e,1);return i.match(/^[1-9]$/)?i:""}function zt(t,e){var i;const n=t.substr(e).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Lt(t,e){const i=zt(t,e);if(""!==i)return i;const n=t.substr(e,1);if("-"!==n&&"+"!==n)return"";const s=zt(t,e+=1);return""===s?"":n+s}function Mt(t,e){const i=t.substr(e,1);if(e+=1,"e"!==i.toLowerCase())return"";const n=Lt(t,e);return""===n?"":i+n}function Vt(t,e){const i=t.substr(e,1);if("0"===i)return i;const n=kt(t,e);return e+=n.length,""===n?"":n+zt(t,e)}function Tt(t,e){const i=Vt(t,e);if(e+=i.length,""===i)return"";const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const s=zt(t,e);return i+n+s+Mt(t,e+=s.length)}function At(t,e){const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const n=zt(t,e);return e+=n.length,""===n?"":i+n+Mt(t,e)}function St(t,e){const i=Vt(t,e);return e+=i.length,""===i?"":i+Mt(t,e)}const Ot=Et([Tt,At,St]);function It(t,e){var i;const n=t.substr(e).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Dt(t,e){const i=t.substr(e,2);if(e+=i.length,"0b"!==i.toLowerCase())return"";const n=It(t,e);return""===n?"":i+n}function Rt(t,e){var i;const n=t.substr(e).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Ft(t,e){const i=t.substr(e,2);if(e+=i.length,"0o"!==i.toLowerCase())return"";const n=Rt(t,e);return""===n?"":i+n}function Ut(t,e){var i;const n=t.substr(e).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Nt(t,e){const i=t.substr(e,2);if(e+=i.length,"0x"!==i.toLowerCase())return"";const n=Ut(t,e);return""===n?"":i+n}const Bt=Et([Dt,Ft,Nt]),jt=Et([Bt,Ot]);function Ht(t,e){const i=jt(t,e);return e+=i.length,""===i?null:{evaluable:new ft(i),cursor:e}}function Kt(t,e){const i=t.substr(e,1);if(e+=i.length,"("!==i)return null;const n=Xt(t,e);if(!n)return null;e=n.cursor,e+=Pt(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:n.evaluable,cursor:e}}function $t(t,e){var i;return null!==(i=Ht(t,e))&&void 0!==i?i:Kt(t,e)}function Yt(t,e){const i=$t(t,e);if(i)return i;const n=t.substr(e,1);if(e+=n.length,"+"!==n&&"-"!==n&&"~"!==n)return null;const s=Yt(t,e);return s?{cursor:e=s.cursor,evaluable:new Ct(n,s.evaluable)}:null}function qt(t,e,i){i+=Pt(e,i).length;const n=t.filter((t=>e.startsWith(t,i)))[0];return n?(i+=n.length,{cursor:i+=Pt(e,i).length,operator:n}):null}function Gt(t,e){return(i,n)=>{const s=t(i,n);if(!s)return null;n=s.cursor;let o=s.evaluable;for(;;){const s=qt(e,i,n);if(!s)break;n=s.cursor;const r=t(i,n);if(!r)return null;n=r.cursor,o=new xt(s.operator,o,r.evaluable)}return o?{cursor:n,evaluable:o}:null}}const Zt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>Gt(t,e)),Yt);function Xt(t,e){return e+=Pt(t,e).length,Zt(t,e)}function Wt(t){const e=Xt(t,0);return e&&e.cursor+Pt(t,e.cursor).length===t.length?e.evaluable:null}function Qt(t){var e;const i=Wt(t);return null!==(e=null==i?void 0:i.evaluate())&&void 0!==e?e:null}function Jt(t){if("number"==typeof t)return t;if("string"==typeof t){const e=Qt(t);if(!s(e))return e}return 0}function te(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}function ee(t){return String(t)}function ie(t,e){for(;t.length<e;)t.push(void 0)}function ne(t){const e=[];return ie(e,t),y(e)}function se(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function oe(t,e){const i=[...se(t),e];return i.length>t.length?i.splice(0,i.length-t.length):ie(i,t.length),i}function re({primary:t,secondary:e,forward:i,backward:n}){let s=!1;function o(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(n=>{o((()=>{e.setRawValue(i(t,e),n.options)}))})),e.emitter.on("change",(s=>{o((()=>{t.setRawValue(n(t,e),s.options)})),o((()=>{e.setRawValue(i(t,e),s.options)}))})),o((()=>{e.setRawValue(i(t,e),{forceEmit:!1,last:!0})}))}function ae(t,e){const i=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function le(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function he(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function de(t){return"ArrowUp"===t||"ArrowDown"===t}function ce(t){return de(t)||"ArrowLeft"===t||"ArrowRight"===t}function pe(t,e){var i,n;const s=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:t.pageX-((null!==(i=s&&s.scrollX)&&void 0!==i?i:0)+o.left),y:t.pageY-((null!==(n=s&&s.scrollY)&&void 0!==n?n:0)+o.top)}}class ue{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new a,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(pe(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(pe(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(pe(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const i=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function ve(t,e,i,n,s){return n+(t-e)/(i-e)*(s-n)}function me(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function ge(t,e,i){return Math.min(Math.max(t,e),i)}const _e=h("txt");class be{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(_e(),_e(void 0,"num")),e.arrayPosition&&this.element.classList.add(_e(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(_e("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(_e()),this.inputElement.classList.add(_e("i"));const n=t.createElement("div");n.classList.add(_e("k")),this.element.appendChild(n),this.knobElement=n;const s=t.createElementNS(B,"svg");s.classList.add(_e("g")),this.knobElement.appendChild(s);const o=t.createElementNS(B,"path");o.classList.add(_e("gb")),s.appendChild(o),this.guideBodyElem_=o;const r=t.createElementNS(B,"path");r.classList.add(_e("gh")),s.appendChild(r),this.guideHeadElem_=r;const a=t.createElement("div");a.classList.add(h("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(_e(void 0,"drg"));this.element.classList.add(_e(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),n=ge(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class fe{constructor(t,e){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=null!==(i=e.sliderProps)&&void 0!==i?i:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=y(null),this.view=new be(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new ue(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,i;const n=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("minValue"),s=null===(i=this.sliderProps_)||void 0===i?void 0:i.get("maxValue");let o=t;return void 0!==n&&(o=Math.max(o,n)),void 0!==s&&(o=Math.min(o,s)),o}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);s(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()}onInputKeyDown_(t){const e=ae(this.baseStep_,le(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==ae(this.baseStep_,le(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function we(t,e){t.write(e)}function xe(t){const e=t?lt(t,ct):null;return e?e.step:null}function ye(t,e){const i=t&&lt(t,ct);return i?me(i.step):Math.max(me(e),2)}function Ce(t){return xe(t)??1}function Ee(t,e){var i;const n=t&&lt(t,ct),s=Math.abs(null!==(i=null==n?void 0:n.step)&&void 0!==i?i:e);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}function Pe(t){return[t[0],t[1],t[2]]}function ke(t,e){const i=te("float"===e?2:0);return`rgb(${Pe(t.getComponents("rgb",e)).map((t=>i(t))).join(", ")})`}function ze(t){return e=>ke(e,t)}function Le(t,e){const i=te(2),n=te("float"===e?2:0);return`rgba(${t.getComponents("rgb",e).map(((t,e)=>(3===e?i:n)(t))).join(", ")})`}function Me(t){return e=>Le(e,t)}function Ve(t,e){const i=te("float"===e?2:0),n=["r","g","b"];return`{${Pe(t.getComponents("rgb",e)).map(((t,e)=>`${n[e]}: ${i(t)}`)).join(", ")}}`}function Te(t){return e=>Ve(e,t)}function Ae(t,e){const i=te(2),n=te("float"===e?2:0),s=["r","g","b","a"];return`{${t.getComponents("rgb",e).map(((t,e)=>{const o=3===e?i:n;return`${s[e]}: ${o(t)}`})).join(", ")}}`}function Se(t){return e=>Ae(e,t)}["int","float"].reduce(((t,e)=>[...t,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:ze(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:Me(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:Te(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:Se(e)}]),[]);class Oe{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var i,n;return null!==(n=null===(i=this.components[e])||void 0===i?void 0:i.constrain(t))&&void 0!==n?n:t}));return this.asm_.fromComponents(e)}}const Ie=h("pndtxt");class De{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Ie()),this.textViews.forEach((e=>{const i=t.createElement("div");i.classList.add(Ie("a")),i.appendChild(e.element),this.element.appendChild(i)}))}}function Re(t,e,i){return new fe(t,{arrayPosition:0===i?"fst":i===e.axes.length-1?"lst":"mid",baseStep:e.axes[i].baseStep,parser:e.parser,props:e.axes[i].textProps,value:y(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}class Fe{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((i,n)=>Re(t,e,n))),this.acs_.forEach(((t,i)=>{re({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[i],backward:(t,n)=>{const s=e.assembly.toComponents(t.rawValue);return s[i]=n.rawValue,e.assembly.fromComponents(s)}})})),this.view=new De(t,{textViews:this.acs_.map((t=>t.view))})}}function Ue(t,e){return"step"in t&&!s(t.step)?new ct(t.step,e):null}function Ne(t){return s(t.max)||s(t.min)?s(t.max)&&s(t.min)?null:new dt({max:t.max,min:t.min}):new ht({max:t.max,min:t.min})}const Be={monitor:{defaultInterval:200,defaultLineCount:3}},je=h("grl");class He{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(je()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=t.createElementNS(B,"svg");i.classList.add(je("g")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(B,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const s=t.createElement("div");s.classList.add(je("t"),h("tt")()),this.element.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,i=this.props_.get("minValue"),n=this.props_.get("maxValue"),s=[];this.value.rawValue.forEach(((o,r)=>{if(void 0===o)return;const a=ve(r,0,e,0,t.width),l=ve(o,i,n,t.height,0);s.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const o=this.tooltipElem_,r=this.value.rawValue[this.cursor_.rawValue];if(void 0===r)return void o.classList.remove(je("t","a"));const a=ve(this.cursor_.rawValue,0,e,0,t.width),l=ve(r,i,n,t.height,0);o.style.left=`${a}px`,o.style.top=`${l}px`,o.textContent=`${this.formatter_(r)}`,o.classList.contains(je("t","a"))||(o.classList.add(je("t","a"),je("t","in")),j(o),o.classList.remove(je("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Ke{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=y(-1),this.view=new He(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),K(t)){const t=new ue(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(ve(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.rawValue=Math.floor(ve(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}class $e{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}on(t,e){const n=e.bind(this);return this.controller_.emitter.on(t,(()=>{n(new i(this))})),this}}class Ye extends i{constructor(t,e,i){super(t),this.cell=e,this.index=i}}class qe extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.emitter_=new a;const e=this.controller_.valueController;e.cellControllers.forEach(((t,i)=>{const n=new $e(t);this.cellToApiMap_.set(t,n),t.emitter.on("click",(()=>{const t=i%e.size[0],s=Math.floor(i/e.size[0]);this.emitter_.emit("click",{event:new Ye(this,n,[t,s])})}))}))}cell(t,e){const i=this.controller_.valueController,n=i.cellControllers[e*i.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class Ge{constructor(t,e){this.size=e.size;const[i,n]=this.size,s=[];for(let o=0;o<n;o++)for(let n=0;n<i;n++){const i=new f(t,{props:C.fromObject(Object.assign({},e.cellConfig(n,o))),viewProps:D.create()});s.push(i)}this.cellCs_=s,this.viewProps=D.create(),this.viewProps.handleDispose((()=>{this.cellCs_.forEach((t=>{t.viewProps.set("disposed",!0)}))})),this.view=new nt(t,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach((t=>{this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}}const Ze={id:"buttongrid",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(t){const e=M,i=V(t,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return i?{params:i}:null},controller:t=>new X(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:new Ge(t.document,{cellConfig:t.params.cells,size:t.params.size})}),api:t=>t.controller instanceof X&&t.controller.valueController instanceof Ge?new qe(t.controller):null};class Xe extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.controller_.valueController.value.emitter.on(t,(t=>{i(new n(this,t.rawValue,void 0,t.options.last))})),this}}function We(t,e,i){return t*(1-i)+e*i}const Qe=20,Je=.001,ti=100;function ei(t,e){let i=.25,n=.5,s=-1;for(let o=0;o<Qe;o++){const[o,r]=t.curve(n);if(n+=i*(o<e?1:-1),s=r,i*=.5,Math.abs(e-o)<Je)break}return s}class ii{constructor(t=0,e=0,i=1,n=1){this.cache_=[],this.comps_=[t,e,i,n]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(t){return!(s(t)||!Array.isArray(t))&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}static equals(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}curve(t){const e=We(0,this.x1,t),i=We(0,this.y1,t),n=We(this.x1,this.x2,t),s=We(this.y1,this.y2,t),o=We(this.x2,1,t),r=We(this.y2,1,t),a=We(e,n,t),l=We(i,s,t),h=We(n,o,t),d=We(s,r,t);return[We(a,h,t),We(l,d,t)]}y(t){if(0===this.cache_.length){const t=[];for(let e=0;e<ti;e++)t.push(ei(this,ve(e,0,ti-1,0,1)));this.cache_=t}return this.cache_[Math.round(ve(ge(t,0,1),0,1,0,ti-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const ni={toComponents:t=>t.toObject(),fromComponents:t=>new ii(...t)};function si(t){const e=te(2);return`cubic-bezier(${t.toObject().map((t=>e(t))).join(", ")})`}const oi=[0,.5,.5,1];function ri(t){const e=t.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return new ii(...oi);const i=[e[1],e[2],e[3],e[4]].reduce(((t,e)=>{if(!t)return null;const i=Number(e);return isNaN(i)?null:[...t,i]}),[]);return new ii(...i??oi)}const ai=h("cbz");class li{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ai()),e.viewProps.bindClassModifiers(this.element),e.foldable.bindExpandedClass(this.element,ai(void 0,"expanded")),u(e.foldable,"completed",m(this.element,ai(void 0,"cpl")));const i=t.createElement("div");i.classList.add(ai("h")),this.element.appendChild(i);const n=t.createElement("button");n.classList.add(ai("b")),e.viewProps.bindDisabled(n);const s=t.createElementNS(B,"svg");s.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',n.appendChild(s),i.appendChild(n),this.buttonElement=n;const o=t.createElement("div");if(o.classList.add(ai("t")),i.appendChild(o),this.textElement=o,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(ai("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const hi=h("cbzp");class di{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(hi()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(hi("g")),this.element.appendChild(i),this.graphElement=i;const n=t.createElement("div");n.classList.add(hi("t")),this.element.appendChild(n),this.textElement=n}}function ci(t,e){const i=new MutationObserver((t=>{for(const n of t)"childList"===n.type&&n.addedNodes.forEach((t=>{t.contains(t)&&(e(),i.disconnect())}))})),n=t.ownerDocument;i.observe(n.body,{attributes:!0,childList:!0,subtree:!0})}const pi=h("cbzg");function ui(t,e){return i=>e(t(i))}class vi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(pi()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(pi("p")),this.element.appendChild(i),this.previewElement=i;const n=t.createElementNS(B,"svg");n.classList.add(pi("g")),this.element.appendChild(n),this.svgElem_=n;const s=t.createElementNS(B,"path");s.classList.add(pi("u")),this.svgElem_.appendChild(s),this.guideElem_=s;const o=t.createElementNS(B,"polyline");o.classList.add(pi("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[t.createElement("div"),t.createElement("div")],this.handleElems_.forEach((t=>{t.classList.add(pi("h")),this.element.appendChild(t)})),this.vectorElems_=[t.createElementNS(B,"line"),t.createElementNS(B,"line")],this.vectorElems_.forEach((t=>{t.classList.add(pi("v")),this.svgElem_.appendChild(t)})),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=e.selection,this.handleElems_.forEach(((t,e)=>{p(this.sel_,ui((t=>t===e),m(t,pi("h","sel"))))})),ci(this.element,(()=>{this.refresh()}))}getVertMargin_(t){return.25*t}valueToPosition(t,e){const i=this.element.getBoundingClientRect(),n=i.width,s=i.height,o=this.getVertMargin_(s);return{x:ve(t,0,1,0,n),y:ve(e,0,1,s-o,o)}}positionToValue(t,e){const i=this.element.getBoundingClientRect(),n=i.width,s=i.height,o=this.getVertMargin_(s);return{x:ge(ve(t,0,n,0,1),0,1),y:ve(e,s-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map((t=>{const e=this.valueToPosition(0,t),i=this.valueToPosition(1,t);return[`M ${e.x},${e.y}`,`L ${i.x},${i.y}`].join(" ")})).join(" "));const t=this.value_.rawValue,e=[];let i=0;for(;;){const n=this.valueToPosition(...t.curve(i));if(e.push([n.x,n.y].join(",")),i>=1)break;i=Math.min(i+.05,1)}this.lineElem_.setAttributeNS(null,"points",e.join(" "));const n=t.toObject();[0,1].forEach((t=>{const e=this.valueToPosition(t,t),i=this.valueToPosition(n[2*t],n[2*t+1]),s=this.vectorElems_[t];s.setAttributeNS(null,"x1",String(e.x)),s.setAttributeNS(null,"y1",String(e.y)),s.setAttributeNS(null,"x2",String(i.x)),s.setAttributeNS(null,"y2",String(i.y));const o=this.handleElems_[t];o.style.left=`${i.x}px`,o.style.top=`${i.y}px`}))}onValueChange_(){this.refresh()}}const mi=24,gi=400,_i=1e3,bi=h("cbzprv");class fi{constructor(t,e){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(bi()),e.viewProps.bindClassModifiers(this.element);const i=t.createElementNS(B,"svg");i.classList.add(bi("g")),this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(B,"path");n.classList.add(bi("t")),this.svgElem_.appendChild(n),this.ticksElem_=n;const s=t.createElement("div");s.classList.add(bi("m")),this.element.appendChild(s),this.markerElem_=s,this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_),e.viewProps.handleDispose(this.onDispose_),ci(this.element,(()=>{this.refresh()}))}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(bi("m","a")),this.startTime_=(new Date).getTime()+gi,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(bi("m","a"))}onDispose_(){this.stop()}updateMarker_(t){const e=this.value_.rawValue.y(ge(t,0,1));this.markerElem_.style.left=100*e+"%"}refresh(){const t=this.svgElem_.getBoundingClientRect(),e=t.width,i=t.height,n=[],s=this.value_.rawValue;for(let o=0;o<mi;o++){const t=ve(o,0,mi-1,0,1),r=ve(s.y(t),0,1,0,e);n.push(`M ${r},0 v${i}`)}this.ticksElem_.setAttributeNS(null,"d",n.join(" "))}onTimer_(){if(null===this.startTime_)return;const t=(new Date).getTime()-this.startTime_,e=t/_i;this.updateMarker_(e),t>_i+gi&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function wi(t,e,i,n){const s=i-t,o=n-e;return Math.sqrt(s*s+o*o)}function xi(t,e,i,n){const s=wi(t,e,i,n),o=Math.atan2(n-e,i-t),r=Math.round(o/(Math.PI/4))*Math.PI/4;return{x:t+Math.cos(r)*s,y:e+Math.sin(r)*s}}class yi{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.sel_=y(0),this.viewProps=e.viewProps,this.view=new vi(t,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new fi(t,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",(t=>{t.stopImmediatePropagation(),t.preventDefault(),this.prevView_.play()})),this.view.previewElement.appendChild(this.prevView_.element);const i=new ue(this.view.element);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(t,e,i){const n=this.sel_.rawValue,s=this.value.rawValue.toObject(),o=this.view.positionToValue(t.x,t.y),r=e?xi(n,n,o.x,o.y):o;s[2*n]=r.x,s[2*n+1]=r.y,this.value.setRawValue(new ii(...s),i)}onPointerDown_(t){const e=t.data;if(!e.point)return;const i=this.value.rawValue,n=this.view.valueToPosition(i.x1,i.y1),s=wi(e.point.x,e.point.y,n.x,n.y),o=this.view.valueToPosition(i.x2,i.y2),r=wi(e.point.x,e.point.y,o.x,o.y);this.sel_.rawValue=s<=r?0:1,this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(t){ce(t.key)&&t.preventDefault();const e=this.sel_.rawValue,i=this.value.rawValue.toObject();i[2*e]+=ae(this.baseStep_,he(t)),i[2*e+1]+=ae(this.baseStep_,le(t)),this.value.setRawValue(new ii(...i),{forceEmit:!1,last:!1})}onKeyUp_(t){ce(t.key)&&t.preventDefault();const e=ae(this.baseStep_,he(t)),i=ae(this.baseStep_,le(t));0===e&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Ci{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new di(t,{viewProps:this.viewProps}),this.gc_=new yi(t,{baseStep:e.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const i=Object.assign(Object.assign({},e.axis),{constraint:new dt({max:1,min:0})}),n=Object.assign(Object.assign({},e.axis),{constraint:void 0});this.tc_=new Fe(t,{assembly:ni,axes:[i,n,i,n],parser:Qt,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map((t=>t.inputElement))]}refresh(){this.gc_.refresh()}}class Ei{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=J(e.expanded),this.view=new li(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new _t(t,{parser:ri,props:C.fromObject({formatter:si}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_="popup"===e.pickerLayout?new vt(t,{viewProps:this.viewProps}):null;const i=new Ci(t,{axis:e.axis,value:this.value,viewProps:this.viewProps});i.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),p(this.popC_.shows,(t=>{t&&i.refresh()})),re({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),it(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=t.relatedTarget;(!e||!this.popC_.view.element.contains(e))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=Y(t);i&&e.contains(i)||i&&i===this.view.buttonElement&&!K(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_&&"Escape"===t.key&&(this.popC_.shows.rawValue=!1)}}function Pi(){return new Oe({assembly:ni,components:[0,1,2,3].map((t=>t%2==0?new dt({min:0,max:1}):void 0))})}const ki={id:"cubic-bezier",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(t){const e=M,i=V(t,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom((t=>"inline"===t||"popup"===t?t:void 0))});return i?{params:i}:null},controller(t){var e,i;const n=y(new ii(...t.params.value),{constraint:Pi(),equals:ii.equals}),s=new Ei(t.document,{axis:{baseStep:.1,textProps:C.fromObject({draggingScale:.01,formatter:te(2)})},expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,pickerLayout:null!==(i=t.params.picker)&&void 0!==i?i:"popup",value:n,viewProps:t.viewProps});return new st(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:s})},api:t=>t.controller instanceof st&&t.controller.valueController instanceof Ei?new Xe(t.controller):null};class zi extends e{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}const Li=20;class Mi{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(t){this.start_=t.getTime()}calculateFps_(t){if(0===this.timestamps_.length)return null;const e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}compactTimestamps_(){if(this.timestamps_.length<=Li)return;const t=this.timestamps_.length-Li;this.timestamps_.splice(0,t);const e=this.timestamps_[0].frameCount;this.timestamps_.forEach((t=>{t.frameCount-=e})),this.frameCount_-=e}end(t){if(null===this.start_)return;const e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}const Vi=h("fps");class Ti{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Vi()),e.viewProps.bindClassModifiers(this.element),this.graphElement=t.createElement("div"),this.graphElement.classList.add(Vi("g")),this.element.appendChild(this.graphElement);const i=t.createElement("div");i.classList.add(Vi("l")),this.element.appendChild(i);const n=t.createElement("span");n.classList.add(Vi("v")),n.textContent="--",i.appendChild(n),this.valueElement=n;const s=t.createElement("span");s.classList.add(Vi("u")),s.textContent="FPS",i.appendChild(s)}}class Ai{constructor(t,e){this.stopwatch_=new Mi,this.onTick_=this.onTick_.bind(this),this.ticker_=e.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=e.value,this.viewProps=e.viewProps,this.view=new Ti(t,{viewProps:this.viewProps}),this.graphC_=new Ke(t,{formatter:te(0),lineCount:e.lineCount,props:C.fromObject({maxValue:e.maxValue,minValue:e.minValue}),value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose((()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()}))}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const t=this.stopwatch_.fps;if(null!==t){const e=this.value_.rawValue;this.value_.rawValue=oe(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}function Si(t,e){return 0===e?new ot:new rt(t,e??Be.monitor.defaultInterval)}const Oi={id:"fpsgraph",type:"blade",accept(t){const e=M,i=V(t,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return i?{params:i}:null},controller(t){var e,i,n,s;const o=null!==(e=t.params.interval)&&void 0!==e?e:500;return new X(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:new Ai(t.document,{lineCount:null!==(i=t.params.lineCount)&&void 0!==i?i:2,maxValue:null!==(n=t.params.max)&&void 0!==n?n:90,minValue:null!==(s=t.params.min)&&void 0!==s?s:0,ticker:Si(t.document,o),value:ne(80),viewProps:t.viewProps})})},api:t=>t.controller instanceof X&&t.controller.valueController instanceof Ai?new zi(t.controller):null};class Ii{constructor(t,e){this.min=t,this.max=e}static isObject(t){if("object"!=typeof t||null===t)return!1;const e=t.min,i=t.max;return!("number"!=typeof e||"number"!=typeof i)}static equals(t,e){return t.min===e.min&&t.max===e.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Di={fromComponents:t=>new Ii(t[0],t[1]),toComponents:t=>[t.min,t.max]};class Ri{constructor(t){this.edge=t}constrain(t){var e,i,n,s,o,r,a,l;if(t.min<=t.max)return new Ii(null!==(i=null===(e=this.edge)||void 0===e?void 0:e.constrain(t.min))&&void 0!==i?i:t.min,null!==(s=null===(n=this.edge)||void 0===n?void 0:n.constrain(t.max))&&void 0!==s?s:t.max);const h=(t.min+t.max)/2;return new Ii(null!==(r=null===(o=this.edge)||void 0===o?void 0:o.constrain(h))&&void 0!==r?r:h,null!==(l=null===(a=this.edge)||void 0===a?void 0:a.constrain(h))&&void 0!==l?l:h)}}const Fi=h("rsltxt");class Ui{constructor(t,e){this.sliderView_=e.sliderView,this.textView_=e.textView,this.element=t.createElement("div"),this.element.classList.add(Fi());const i=t.createElement("div");i.classList.add(Fi("s")),i.appendChild(this.sliderView_.element),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Fi("t")),n.appendChild(this.textView_.element),this.element.appendChild(n)}}const Ni=h("rsl");class Bi{constructor(t,e){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=e.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=t.createElement("div"),this.element.classList.add(Ni()),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_);const i=t.createElement("div");i.classList.add(Ni("t")),this.element.appendChild(i),this.trackElement=i;const n=t.createElement("div");n.classList.add(Ni("b")),i.appendChild(n),this.barElement=n;const s=["min","max"].map((e=>{const n=t.createElement("div");return n.classList.add(Ni("k"),Ni("k",e)),i.appendChild(n),n}));this.knobElements=[s[0],s[1]],this.update_()}valueToX_(t){return 100*ge(ve(t,this.sliderProps_.get("minValue"),this.sliderProps_.get("maxValue"),0,1),0,1)}update_(){const t=this.value_.rawValue;0===t.length?this.element.classList.add(Ni(void 0,"zero")):this.element.classList.remove(Ni(void 0,"zero"));const e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left=`${e[0]}%`,this.barElement.style.right=100-e[1]+"%",this.knobElements.forEach(((t,i)=>{t.style.left=`${e[i]}%`}))}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class ji{constructor(t,e){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=e.sliderProps,this.viewProps=e.viewProps,this.value=e.value,this.view=new Bi(t,{sliderProps:this.sliderProps,value:this.value,viewProps:e.viewProps});const i=new ue(this.view.trackElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}ofs_(){return"min"===this.grabbing_?this.view.knobElements[0].getBoundingClientRect().width/2:"max"===this.grabbing_?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(t){return t.point?ve((t.point.x+this.ofs_())/t.bounds.width,0,1,this.sliderProps.get("minValue"),this.sliderProps.get("maxValue")):null}onPointerDown_(t){if(!t.data.point)return;const e=t.data.point.x/t.data.bounds.width,i=this.value.rawValue,n=this.sliderProps.get("minValue"),s=this.sliderProps.get("maxValue"),o=ve(i.min,n,s,0,1),r=ve(i.max,n,s,0,1);Math.abs(r-e)<=.025?this.grabbing_="max":Math.abs(o-e)<=.025?this.grabbing_="min":e>=o&&e<=r?(this.grabbing_="length",this.grabOffset_=ve(e-o,0,1,0,s-n)):e<o?(this.grabbing_="min",this.onPointerMove_(t)):e>r&&(this.grabbing_="max",this.onPointerMove_(t))}applyPointToValue_(t,e){const i=this.valueFromData_(t);if(null===i)return;const n=this.sliderProps.get("minValue"),s=this.sliderProps.get("maxValue");if("min"===this.grabbing_)this.value.setRawValue(new Ii(i,this.value.rawValue.max),e);else if("max"===this.grabbing_)this.value.setRawValue(new Ii(this.value.rawValue.min,i),e);else if("length"===this.grabbing_){const t=this.value.rawValue.length;let o=i-this.grabOffset_,r=o+t;o<n?(o=n,r=n+t):r>s&&(o=s-t,r=s),this.value.setRawValue(new Ii(o,r),e)}}onPointerMove_(t){this.applyPointToValue_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.applyPointToValue_(t.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Hi{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sc_=new ji(t,e);const i={baseStep:e.baseStep,constraint:e.constraint,textProps:C.fromObject({draggingScale:e.draggingScale,formatter:e.formatter})};this.tc_=new Fe(t,{assembly:Di,axes:[i,i],parser:e.parser,value:this.value,viewProps:e.viewProps}),this.view=new Ui(t,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function Ki(t){return Ii.isObject(t)?new Ii(t.min,t.max):new Ii(0,0)}function $i(t,e){t.writeProperty("max",e.max),t.writeProperty("min",e.min)}function Yi(t){const e=[],i=Ne(t);i&&e.push(i);const n=Ue(t);return n&&e.push(n),new Ri(new at(e))}const qi={id:"input-interval",type:"input",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept:(t,e)=>{if(!Ii.isObject(t))return null;const i=M,n=V(e,{format:i.optional.function,max:i.optional.number,min:i.optional.number,step:i.optional.number});return n?{initialValue:new Ii(t.min,t.max),params:n}:null},binding:{reader:t=>Ki,constraint:t=>Yi(t.params),equals:Ii.equals,writer:t=>$i},controller(t){var e;const i=t.value,n=t.constraint;if(!(n instanceof Ri))throw r.shouldNeverHappen();const s=(i.rawValue.min+i.rawValue.max)/2,o=null!==(e=t.params.format)&&void 0!==e?e:te(ye(n.edge,s)),a=n.edge&&lt(n.edge,ht);if(a)return new Hi(t.document,{baseStep:Ce(n.edge),constraint:n.edge,draggingScale:Ee(n.edge,s),formatter:o,parser:Qt,sliderProps:new C({maxValue:a.values.value("max"),minValue:a.values.value("min")}),value:i,viewProps:t.viewProps});const l={baseStep:Ce(n.edge),constraint:n.edge,textProps:C.fromObject({draggingScale:s,formatter:o})};return new Fe(t.document,{assembly:Di,axes:[l,l],parser:Qt,value:i,viewProps:t.viewProps})}};class Gi{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}}class Zi extends n{constructor(t,e,i,n,s){super(t,n,s),this.cell=e,this.index=i}}class Xi extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach((t=>{const e=new Gi(t);this.cellToApiMap_.set(t,e)}))}get value(){return this.controller_.value}cell(t,e){const i=this.controller_.valueController,n=i.cellControllers[e*i.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const i=e.bind(this);this.controller_.value.emitter.on(t,(t=>{const e=this.controller_.valueController,n=e.findCellByValue(t.rawValue);if(!n)return;const s=this.cellToApiMap_.get(n);if(!s)return;const o=e.cellControllers.indexOf(n);i(new Zi(this,s,[o%e.size[0],Math.floor(o/e.size[0])],t.rawValue,void 0))}))}}const Wi=h("rad");class Qi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Wi()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("label");i.classList.add(Wi("l")),this.element.appendChild(i);const n=t.createElement("input");n.classList.add(Wi("i")),n.name=e.name,n.type="radio",e.viewProps.bindDisabled(n),i.appendChild(n),this.inputElement=n;const s=t.createElement("div");s.classList.add(Wi("b")),i.appendChild(s);const o=t.createElement("div");o.classList.add(Wi("t")),s.appendChild(o),u(e.props,"title",(t=>{o.textContent=t}))}}class Ji{constructor(t,e){this.props=e.props,this.viewProps=e.viewProps,this.view=new Qi(t,{name:e.name,props:this.props,viewProps:this.viewProps})}}class tn{constructor(t,e){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=e.size;const[i,n]=this.size;for(let s=0;s<n;s++)for(let n=0;n<i;n++){const i=new Ji(t,{name:e.groupName,props:C.fromObject(Object.assign({},e.cellConfig(n,s))),viewProps:D.create()});this.cellCs_.push(i),this.cellValues_.push(e.cellConfig(n,s).value)}this.value=e.value,p(this.value,(t=>{const e=this.findCellByValue(t);e&&(e.view.inputElement.checked=!0)})),this.viewProps=D.create(),this.view=new nt(t,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach((t=>{t.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}findCellByValue(t){const e=this.cellValues_.findIndex((e=>e===t));return e<0?null:this.cellCs_[e]}onCellInputChange_(t){const e=t.currentTarget,i=this.cellCs_.findIndex((t=>t.view.inputElement===e));i<0||(this.value.rawValue=this.cellValues_[i])}}const en={id:"radiogrid",type:"blade",accept(t){const e=M,i=V(t,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return i?{params:i}:null},controller:t=>new st(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:new tn(t.document,{groupName:t.params.groupName,cellConfig:t.params.cells,size:t.params.size,value:y(t.params.value)})}),api:t=>t.controller instanceof st&&t.controller.valueController instanceof tn?new Xi(t.controller):null};function nn(t){return{id:"input-radiogrid",type:"input",accept(e,i){if(!t.isType(e))return null;const n=M,s=V(i,{cells:n.required.function,groupName:n.required.string,size:n.required.array(n.required.number),view:n.required.constant("radiogrid")});return s?{initialValue:e,params:s}:null},binding:t.binding,controller:t=>new tn(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})}}const sn=nn({isType:t=>"number"==typeof t,binding:{reader:t=>Jt,writer:t=>we}}),on=nn({isType:t=>"string"==typeof t,binding:{reader:t=>ee,writer:t=>we}}),rn=nn({isType:t=>"boolean"==typeof t,binding:{reader:t=>bt,writer:t=>we}}),an=[Ze,ki,Oi,qi,en,rn,sn,on];t.ButtonCellApi=$e,t.ButtonGridApi=qe,t.ButtonGridController=Ge,t.CubicBezier=ii,t.CubicBezierApi=Xe,t.CubicBezierAssembly=ni,t.CubicBezierController=Ei,t.CubicBezierGraphController=yi,t.CubicBezierGraphView=vi,t.CubicBezierPickerController=Ci,t.CubicBezierPickerView=di,t.CubicBezierPreviewView=fi,t.CubicBezierView=li,t.FpsGraphBladeApi=zi,t.FpsGraphController=Ai,t.FpsView=Ti,t.Fpswatch=Mi,t.Interval=Ii,t.IntervalAssembly=Di,t.IntervalConstraint=Ri,t.RadioCellApi=Gi,t.RadioController=Ji,t.RadioGridApi=Xi,t.RadioGridController=tn,t.RadioView=Qi,t.RangeSliderController=ji,t.RangeSliderTextController=Hi,t.RangeSliderTextView=Ui,t.RangeSliderView=Bi,t.TpRadioGridChangeEvent=Zi,t.plugins=an,Object.defineProperty(t,"__esModule",{value:!0})}(ge);const _e=s({__proto__:null,default:o(ge)},[ge]);var be={};!function(t){const e="tp";function i(t){return(i,n)=>[e,"-",t,"v",i?`_${i}`:"",n?`-${n}`:""].join("")}function n(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function s(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function o(t){return null!==t&&"object"==typeof t}function r(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function a(t){return{custom:e=>r(e)(t),boolean:r((t=>"boolean"==typeof t?t:void 0))(t),number:r((t=>"number"==typeof t?t:void 0))(t),string:r((t=>"string"==typeof t?t:void 0))(t),function:r((t=>"function"==typeof t?t:void 0))(t),constant:e=>r((t=>t===e?e:void 0))(t),raw:r((t=>t))(t),object:e=>r((t=>{if(o(t))return n(t,e)}))(t),array:e=>r((t=>{if(Array.isArray(t))return s(t,e)}))(t)}}const l={optional:a(!0),required:a(!1)};function h(t,e){const i=l.required.object(e)(t);return i.succeeded?i.value:void 0}function d(t,e,i,n){function s(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,o){function r(t){try{l(n.next(t))}catch(e){o(e)}}function a(t){try{l(n.throw(t))}catch(e){o(e)}}function l(t){t.done?i(t.value):s(t.value).then(r,a)}l((n=n.apply(t,e||[])).next())}))}function c(){const t=document.createElement("canvas");t.width=128,t.height=64;const e=t.getContext("2d");return e.fillStyle="#222",e.fillRect(0,0,t.width,t.height),e.fillStyle="#ddd",e.font="monospaced",e.textAlign="center",e.textBaseline="middle",e.fillText("No image",.5*t.width,.5*t.height),new Promise((e=>{t.toBlob((t=>{const i=new Image;i.src=URL.createObjectURL(t),i.onload=()=>{e(i)}}))}))}function p(t){return d(this,void 0,void 0,(function*(){const e=new Image;return e.crossOrigin="anonymous",new Promise((i=>{e.src=t,e.onload=()=>{i(e)}}))}))}function u(t){const e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0);const i=new Image;return new Promise((t=>{e.toBlob((e=>{i.src=URL.createObjectURL(e),i.onload=()=>{t(i)}}))}))}const v=i("img");class m{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(v()),e.viewProps.bindClassModifiers(this.element),this.input=t.createElement("input"),this.input.classList.add(v("input")),this.input.setAttribute("type","file"),this.input.setAttribute("accept",e.extensions.join(",")),this.element.appendChild(this.input),this.image_=t.createElement("img"),this.image_.classList.add(v("image")),this.image_.classList.add(v(`image_${e.imageFit}`)),this.element.classList.add(v("area_root")),this.element.appendChild(this.image_)}changeImage(t){this.image_.src=t}changeDraggingState(t){const e=this.element;t?null==e||e.classList.add(v("area_dragging")):null==e||e.classList.remove(v("area_dragging"))}}class g{constructor(t,e){this.placeholderImage=null,this.value=e.value,this.viewProps=e.viewProps,this.view=new m(t,{viewProps:this.viewProps,extensions:e.extensions,imageFit:e.imageFit}),this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.viewProps.handleDispose((()=>{this.view.input.removeEventListener("change",this.onFile),this.view.input.removeEventListener("drop",this.onDrop),this.view.input.removeEventListener("dragover",this.onDragOver),this.view.input.removeEventListener("dragleave",this.onDragLeave)})),this.value.emitter.on("change",this.handleValueChange.bind(this)),this.handleValueChange()}onFile(t){const e=(null==t?void 0:t.target).files;if(!e||!e.length)return;const i=e[0],n=URL.createObjectURL(i);this.setValue(n),this.updateImage(n)}onDrop(t){return d(this,void 0,void 0,(function*(){t.preventDefault();try{const{dataTransfer:e}=t,i=null==e?void 0:e.files[0];if(i){const t=URL.createObjectURL(i);this.updateImage(t),this.setValue(t)}else{const t=null==e?void 0:e.getData("url");if(!t)throw new Error("No url");p(t).then((t=>d(this,void 0,void 0,(function*(){const e=yield u(t);this.updateImage(e.src),this.setValue(e)}))))}}catch(e){console.error("Could not parse the dropped image",e)}finally{this.view.changeDraggingState(!1)}}))}onDragOver(t){t.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}handleImage(t){return d(this,void 0,void 0,(function*(){if(t instanceof HTMLImageElement)u(t).then((t=>{this.updateImage(t.src)}));else if("string"==typeof t){let e="";try{if("placeholder"===t)throw new Error("placeholder");new URL(t),e=(yield p(t)).src}catch{e=(yield this.handlePlaceholderImage()).src}finally{this.updateImage(e),this.setValue(e)}}}))}updateImage(t){this.view.changeImage(t)}setValue(t){return d(this,void 0,void 0,(function*(){t instanceof HTMLImageElement?this.value.setRawValue(t):t?this.value.setRawValue(yield p(t)):this.value.setRawValue(yield this.handlePlaceholderImage())}))}handleValueChange(){this.handleImage(this.value.rawValue)}handlePlaceholderImage(){return d(this,void 0,void 0,(function*(){return this.placeholderImage||(this.placeholderImage=yield c()),this.placeholderImage}))}}const _=[".jpg",".png",".gif"],b={id:"input-image",type:"input",css:".tp-imgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-imgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-imgv:hover{background-color:var(--in-bg-h)}.tp-imgv:focus{background-color:var(--in-bg-f)}.tp-imgv:active{background-color:var(--in-bg-a)}.tp-imgv:disabled{opacity:0.5}:root{--tp-plugin-image-dragging-color: hsla(230, 100%, 66%, 1.00)}.tp-imgv{cursor:pointer;display:grid;height:calc(var(--bld-us) * 3);overflow:hidden;position:relative}.tp-imgv.tp-v-disabled{opacity:0.5}.tp-imgv_input{width:100%;height:100%;opacity:0}.tp-imgv_image{width:100%;height:100%;position:absolute;pointer-events:none;border:0}.tp-imgv_image_contain{-o-object-fit:contain;object-fit:contain}.tp-imgv_image_cover{-o-object-fit:cover;object-fit:cover}.tp-imgv_area_root{transition:opacity 0.16s ease-in-out}.tp-imgv_area_dragging{border:2px dashed var(--tp-plugin-image-dragging-color);border-radius:6px;opacity:0.6}",accept(t,e){if(!(t instanceof HTMLImageElement||"string"==typeof t))return null;const i=l,n=h(e,{view:i.required.constant("input-image"),acceptUrl:i.optional.boolean,imageFit:i.optional.custom((t=>"contain"===t||"cover"===t?t:void 0)),extensions:i.optional.array(i.required.string)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>t=>t instanceof HTMLImageElement?""===t.src?"placeholder":t.src:"string"==typeof t?t:"placeholder",writer:t=>(t,e)=>{t.write(e)}},controller(t){var e,i;return new g(t.document,{value:t.value,imageFit:null!==(e=t.params.imageFit)&&void 0!==e?e:"cover",viewProps:t.viewProps,extensions:null!==(i=t.params.extensions)&&void 0!==i?i:_})}};t.plugin=b,Object.defineProperty(t,"__esModule",{value:!0})}(be);const fe=s({__proto__:null,default:o(be)},[be]);var we={};!function(t){function e(t){return null==t}const i={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class n{constructor(t){var e;this.message=null!==(e=i[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new n({type:"alreadydisposed"})}static notBindable(){return new n({type:"notbindable"})}static propertyNotFound(t){return new n({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new n({type:"shouldneverhappen"})}}class s{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter((t=>t.handler!==e))),this}emit(t,e){const i=this.observers_[t];i&&i.forEach((t=>{t.handler(e)}))}}const o="tp";function r(t){return(e,i)=>[o,"-",t,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function a(t,e){return i=>e(t(i))}function l(t){return t.rawValue}function h(t,e){t.emitter.on("change",a(l,e)),e(t.rawValue)}function d(t,e,i){h(t.value(e),i)}function c(t,e,i){i?t.classList.add(e):t.classList.remove(e)}function p(t,e){return i=>{c(t,e,i)}}class u{constructor(t,e){var i;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(i=null==e?void 0:e.equals)&&void 0!==i?i:(t,e)=>t===e,this.emitter=new s,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(t):t;this.equals_(this.rawValue_,n)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:i,rawValue:n,sender:this}))}}class v{constructor(t){this.emitter=new s,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0};this.value_===t&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:i,rawValue:this.value_,sender:this}))}}function m(t,e){const i=null==e?void 0:e.constraint,n=null==e?void 0:e.equals;return i||n?new u(t,e):new v(t)}class g{constructor(t){this.emitter=new s,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,i)=>Object.assign(e,{[i]:m(t[i])})),{})}static fromObject(t){const e=this.createCore(t);return new g(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function _(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function b(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function f(t){return null!==t&&"object"==typeof t}function w(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function x(t){return{custom:e=>w(e)(t),boolean:w((t=>"boolean"==typeof t?t:void 0))(t),number:w((t=>"number"==typeof t?t:void 0))(t),string:w((t=>"string"==typeof t?t:void 0))(t),function:w((t=>"function"==typeof t?t:void 0))(t),constant:e=>w((t=>t===e?e:void 0))(t),raw:w((t=>t))(t),object:e=>w((t=>{if(f(t))return _(t,e)}))(t),array:e=>w((t=>{if(Array.isArray(t))return b(t,e)}))(t)}}const y={optional:x(!0),required:x(!1)};function C(t,e){const i=y.required.object(e)(t);return i.succeeded?i.value:void 0}const E="http://www.w3.org/2000/svg";function P(t){t.offsetHeight}function k(t,e){const i=t.style.transition;t.style.transition="none",e(),t.style.transition=i}function z(t){return void 0!==t.ontouchstart}function L(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}class M extends g{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=g.createCore(e);return new M(i)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!e(t)?`${t}px`:"auto"}bindExpandedClass(t,e){d(this,"expanded",(()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)}))}}function V(t,e){let i=0;return k(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),P(e),i=e.clientHeight,t.set("temporaryExpanded",null),P(e)})),i}function T(t,e){e.style.height=t.styleHeight}function A(t,i){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),e(t.get("expandedHeight"))&&t.set("expandedHeight",V(t,i)),t.set("shouldFixHeight",!0),P(i)})),t.emitter.on("change",(()=>{T(t,i)})),T(t,i),i.addEventListener("transitionend",(e=>{"height"===e.propertyName&&(t.set("shouldFixHeight",!1),t.set("expandedHeight",null),t.set("completed",!0))}))}class S{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}class O{constructor(t){this.maxValue=t.max,this.minValue=t.min}constrain(t){let i=t;return e(this.minValue)||(i=Math.max(i,this.minValue)),e(this.maxValue)||(i=Math.min(i,this.maxValue)),i}}class I{constructor(t){this.step=t}constrain(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}const D=r("pop");class R{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(D()),e.viewProps.bindClassModifiers(this.element),h(e.shows,p(this.element,D(void 0,"v")))}}class F{constructor(t,e){this.shows=m(!1),this.viewProps=e.viewProps,this.view=new R(t,{shows:this.shows,viewProps:this.viewProps})}}class U{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const N={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class B{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=N[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const j={"+":t=>t,"-":t=>-t,"~":t=>~t};class H{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=j[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function K(t){return(e,i)=>{for(let n=0;n<t.length;n++){const s=t[n](e,i);if(""!==s)return s}return""}}function $(t,e){var i;const n=t.substr(e).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Y(t,e){const i=t.substr(e,1);return i.match(/^[1-9]$/)?i:""}function q(t,e){var i;const n=t.substr(e).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function G(t,e){const i=q(t,e);if(""!==i)return i;const n=t.substr(e,1);if("-"!==n&&"+"!==n)return"";const s=q(t,e+=1);return""===s?"":n+s}function Z(t,e){const i=t.substr(e,1);if(e+=1,"e"!==i.toLowerCase())return"";const n=G(t,e);return""===n?"":i+n}function X(t,e){const i=t.substr(e,1);if("0"===i)return i;const n=Y(t,e);return e+=n.length,""===n?"":n+q(t,e)}function W(t,e){const i=X(t,e);if(e+=i.length,""===i)return"";const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const s=q(t,e);return i+n+s+Z(t,e+=s.length)}function Q(t,e){const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const n=q(t,e);return e+=n.length,""===n?"":i+n+Z(t,e)}function J(t,e){const i=X(t,e);return e+=i.length,""===i?"":i+Z(t,e)}const tt=K([W,Q,J]);function et(t,e){var i;const n=t.substr(e).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function it(t,e){const i=t.substr(e,2);if(e+=i.length,"0b"!==i.toLowerCase())return"";const n=et(t,e);return""===n?"":i+n}function nt(t,e){var i;const n=t.substr(e).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function st(t,e){const i=t.substr(e,2);if(e+=i.length,"0o"!==i.toLowerCase())return"";const n=nt(t,e);return""===n?"":i+n}function ot(t,e){var i;const n=t.substr(e).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}function rt(t,e){const i=t.substr(e,2);if(e+=i.length,"0x"!==i.toLowerCase())return"";const n=ot(t,e);return""===n?"":i+n}const at=K([it,st,rt]),lt=K([at,tt]);function ht(t,e){const i=lt(t,e);return e+=i.length,""===i?null:{evaluable:new U(i),cursor:e}}function dt(t,e){const i=t.substr(e,1);if(e+=i.length,"("!==i)return null;const n=gt(t,e);if(!n)return null;e=n.cursor,e+=$(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:n.evaluable,cursor:e}}function ct(t,e){return ht(t,e)||dt(t,e)}function pt(t,e){const i=ct(t,e);if(i)return i;const n=t.substr(e,1);if(e+=n.length,"+"!==n&&"-"!==n&&"~"!==n)return null;const s=pt(t,e);return s?{cursor:e=s.cursor,evaluable:new H(n,s.evaluable)}:null}function ut(t,e,i){i+=$(e,i).length;const n=t.filter((t=>e.startsWith(t,i)))[0];return n?(i+=n.length,{cursor:i+=$(e,i).length,operator:n}):null}function vt(t,e){return(i,n)=>{const s=t(i,n);if(!s)return null;n=s.cursor;let o=s.evaluable;for(;;){const s=ut(e,i,n);if(!s)break;n=s.cursor;const r=t(i,n);if(!r)return null;n=r.cursor,o=new B(s.operator,o,r.evaluable)}return o?{cursor:n,evaluable:o}:null}}const mt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>vt(t,e)),pt);function gt(t,e){return e+=$(t,e).length,mt(t,e)}function _t(t){const e=gt(t,0);return e&&e.cursor+$(t,e.cursor).length===t.length?e.evaluable:null}function bt(t){var e;const i=_t(t);return null!==(e=null==i?void 0:i.evaluate())&&void 0!==e?e:null}function ft(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}function wt({primary:t,secondary:e,forward:i,backward:n}){let s=!1;function o(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(n=>{o((()=>{e.setRawValue(i(t,e),n.options)}))})),e.emitter.on("change",(s=>{o((()=>{t.setRawValue(n(t,e),s.options)})),o((()=>{e.setRawValue(i(t,e),s.options)}))})),o((()=>{e.setRawValue(i(t,e),{forceEmit:!1,last:!0})}))}function xt(t,e){const i=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function yt(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Ct(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Et(t){return"ArrowUp"===t||"ArrowDown"===t}function Pt(t){return Et(t)||"ArrowLeft"===t||"ArrowRight"===t}function kt(t,e){const i=e.ownerDocument.defaultView,n=e.getBoundingClientRect();return{x:t.pageX-((i&&i.scrollX||0)+n.left),y:t.pageY-((i&&i.scrollY||0)+n.top)}}class zt{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new s,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const i=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Lt(t,e,i){return Math.min(Math.max(t,e),i)}const Mt=r("txt");class Vt{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Mt(),Mt(void 0,"num")),e.arrayPosition&&this.element.classList.add(Mt(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(Mt("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Mt()),this.inputElement.classList.add(Mt("i"));const n=t.createElement("div");n.classList.add(Mt("k")),this.element.appendChild(n),this.knobElement=n;const s=t.createElementNS(E,"svg");s.classList.add(Mt("g")),this.knobElement.appendChild(s);const o=t.createElementNS(E,"path");o.classList.add(Mt("gb")),s.appendChild(o),this.guideBodyElem_=o;const a=t.createElementNS(E,"path");a.classList.add(Mt("gh")),s.appendChild(a),this.guideHeadElem_=a;const l=t.createElement("div");l.classList.add(r("tt")()),this.knobElement.appendChild(l),this.tooltipElem_=l,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(Mt(void 0,"drg"));this.element.classList.add(Mt(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),n=Lt(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Tt{constructor(t,e){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=m(null),this.view=new Vt(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new zt(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}onInputChange_(t){const i=t.currentTarget.value,n=this.parser_(i);e(n)||(this.value.rawValue=n),this.view.refresh()}onInputKeyDown_(t){const e=xt(this.baseStep_,yt(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==xt(this.baseStep_,yt(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function At(t){if("inline"===t||"popup"===t)return t}function St(t){const e=y;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}class Ot{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var i,n;return null!==(n=null===(i=this.components[e])||void 0===i?void 0:i.constrain(t))&&void 0!==n?n:t}));return this.asm_.fromComponents(e)}}const It=r("pndtxt");class Dt{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(It()),this.textViews.forEach((e=>{const i=t.createElement("div");i.classList.add(It("a")),i.appendChild(e.element),this.element.appendChild(i)}))}}function Rt(t,e,i){return new Tt(t,{arrayPosition:0===i?"fst":i===e.axes.length-1?"lst":"mid",baseStep:e.axes[i].baseStep,parser:e.parser,props:e.axes[i].textProps,value:m(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}class Ft{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((i,n)=>Rt(t,e,n))),this.acs_.forEach(((t,i)=>{wt({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[i],backward:(t,n)=>{const s=e.assembly.toComponents(t.rawValue);return s[i]=n.rawValue,e.assembly.fromComponents(s)}})})),this.view=new Dt(t,{textViews:this.acs_.map((t=>t.view))})}}class Ut{multiply(t){return this.format(this.quat.multiply(t.quat))}premultiply(t){return this.format(t.multiply(this))}slerp(t,e){return this.format(this.quat.slerp(t.quat,e))}}function Nt(t,e,i){return Math.min(Math.max(t,e),i)}function Bt(t,e){return Math.floor(t/e)*e}function jt(t,e){return t-Bt(t,e)}function Ht(t){return jt(t+Math.PI,2*Math.PI)-Math.PI}class Kt extends Ut{constructor(t,e,i,n,s){super(),this.x=t??0,this.y=e??0,this.z=i??0,this.order=n??"XYZ",this.unit=s??"rad"}static fromQuaternion(t,e,i){const n=t.toMat3(),[s,o,r,a]="XYZ"===e?[0,1,2,1]:"XZY"===e?[0,2,1,-1]:"YXZ"===e?[1,0,2,-1]:"YZX"===e?[1,2,0,1]:"ZXY"===e?[2,0,1,1]:[2,1,0,-1],l=[0,0,0],h=n[r+3*s];return l[o]=-a*Math.asin(Nt(h,-1,1)),Math.abs(h)<.999999?(l[s]=a*Math.atan2(n[r+3*o],n[4*r]),l[r]=a*Math.atan2(n[o+3*s],n[4*s])):l[s]=a*Math.atan2(-n[o+3*r],n[4*o]),Math.abs(l[s])+Math.abs(l[r])>Math.PI&&(l[s]=Ht(l[s]+Math.PI),l[o]=Ht(Math.PI-l[o]),l[r]=Ht(l[r]+Math.PI)),new Kt(...l,e).reunit(i)}get quat(){return $t.fromEuler(this)}getComponents(){return[this.x,this.y,this.z]}toEuler(t,e){return this.reorder(t).reunit(e)}format(t){return t instanceof Kt?t.reorder(this.order):t.toEuler(this.order,this.unit)}reorder(t){return t===this.order?this:this.quat.toEuler(t,this.unit)}reunit(t){const e={deg:Math.PI/180,rad:1,turn:2*Math.PI}[this.unit]*{deg:180/Math.PI,rad:1,turn:.5/Math.PI}[t];return new Kt(e*this.x,e*this.y,e*this.z,this.order,t)}}class $t extends Ut{constructor(t,e,i,n){super(),this.x=t??0,this.y=e??0,this.z=i??0,this.w=n??1}static fromAxisAngle(t,e){const i=e/2,n=Math.sin(i);return new $t(t.x*n,t.y*n,t.z*n,Math.cos(i))}static fromEuler(t){const e=t.reunit("rad"),[i,n,s,o]="XYZ"===e.order?[0,1,2,1]:"XZY"===e.order?[0,2,1,-1]:"YXZ"===e.order?[1,0,2,-1]:"YZX"===e.order?[1,2,0,1]:"ZXY"===e.order?[2,0,1,1]:[2,1,0,-1],r=e.getComponents(),a=.5*r[i],l=.5*o*r[n],h=.5*r[s],d=Math.cos(a),c=Math.cos(l),p=Math.cos(h),u=Math.sin(a),v=Math.sin(l),m=Math.sin(h),g=[0,0,0,p*c*d+m*v*u];return g[i]=p*c*u-m*v*d,g[n]=o*(p*v*d+m*c*u),g[s]=m*c*d-p*v*u,new $t(...g)}static lookRotation(t,e){const{normal:i,tangent:n,binormal:s}=t.orthoNormalize(e),o=s.x,r=n.x,a=i.x,l=s.y,h=n.y,d=i.y,c=s.z,p=n.z,u=i.z,v=o+h+u;if(v>0){const t=.5/Math.sqrt(v+1);return new $t((p-d)*t,(a-c)*t,(l-r)*t,.25/t)}if(o>h&&o>u){const t=2*Math.sqrt(1+o-h-u);return new $t(.25*t,(r+l)/t,(a+c)/t,(p-d)/t)}if(h>u){const t=2*Math.sqrt(1+h-o-u);return new $t((r+l)/t,.25*t,(d+p)/t,(a-c)/t)}{const t=2*Math.sqrt(1+u-o-h);return new $t((a+c)/t,(d+p)/t,.25*t,(l-r)/t)}}get quat(){return this}getComponents(){return[this.x,this.y,this.z,this.w]}toEuler(t,e){return Kt.fromQuaternion(this,t,e)}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const t=this.length;return 0===t?new $t:new $t(this.x/t,this.y/t,this.z/t,this.w/t)}get negated(){return new $t(-this.x,-this.y,-this.z,-this.w)}get ban360s(){return this.w<0?this.negated:this}multiply(t){const e=t.quat;return new $t(this.w*e.x+this.x*e.w+this.y*e.z-this.z*e.y,this.w*e.y-this.x*e.z+this.y*e.w+this.z*e.x,this.w*e.z+this.x*e.y-this.y*e.x+this.z*e.w,this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z)}format(t){return t.quat}slerp(t,e){let i=t.quat;if(0===e)return this;if(1===e)return i;const n=this.ban360s;i=i.ban360s;let s=n.w*i.w+n.x*i.x+n.y*i.y+n.z*i.z;if(s<0&&(i=i.negated,s=-s),s>=1)return n;const o=1-s*s;if(o<=Number.EPSILON){const t=1-e;return new $t(t*n.x+e*i.x,t*n.y+e*i.y,t*n.z+e*i.z,t*n.w+e*i.w).normalized}const r=Math.sqrt(o),a=Math.atan2(r,s),l=Math.sin((1-e)*a)/r,h=Math.sin(e*a)/r;return new $t(n.x*l+i.x*h,n.y*l+i.y*h,n.z*l+i.z*h,n.w*l+i.w*h)}toMat3(){const{x:t,y:e,z:i,w:n}=this;return[1-2*e*e-2*i*i,2*t*e+2*i*n,2*t*i-2*e*n,2*t*e-2*i*n,1-2*t*t-2*i*i,2*e*i+2*t*n,2*t*i+2*e*n,2*e*i-2*t*n,1-2*t*t-2*e*e]}}class Yt{constructor(){this.offset=[0,0,-5],this.fov=30,this.aspect=1,this.viewport=[0,0,1,1]}project(t){const e=.5*(this.viewport[0]+this.viewport[2]),i=.5*(this.viewport[1]+this.viewport[3]),n=this.viewport[2]-this.viewport[0],s=this.viewport[3]-this.viewport[1],o=1/Math.tan(this.fov*Math.PI/360),r=-(t.z+this.offset[2]);return[e+(t.x+this.offset[0])/r*o*n*.5/this.aspect,i-(t.y+this.offset[1])/r*o*s*.5]}}class qt{constructor(t,e,i){this.element=t.createElementNS(E,"path"),this.vertices=e,this.projector=i}setRotation(t){let e="";return this.vertices.forEach(((i,n)=>{const s=i.applyQuaternion(t),[o,r]=this.projector.project(s);e+=`${0===n?"M":"L"}${o} ${r}`})),this.element.setAttributeNS(null,"d",e),this}}class Gt{constructor(t,e,i){this.x=t??0,this.y=e??0,this.z=i??0}getComponents(){return[this.x,this.y,this.z]}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const t=this.length;return 0===t?new Gt:new Gt(this.x/t,this.y/t,this.z/t)}get negated(){return new Gt(-this.x,-this.y,-this.z)}add(t){return new Gt(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new Gt(this.x-t.x,this.y-t.y,this.z-t.z)}scale(t){return new Gt(this.x*t,this.y*t,this.z*t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){return new Gt(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}orthoNormalize(t){const e=this.normalized;t=t.normalized;let i=e.dot(t);1===i&&(t=Math.abs(e.y)>Math.abs(e.z)?new Gt(0,0,1):new Gt(0,1,0),i=e.dot(t));const n=(t=t.sub(e.scale(i)).normalized).cross(e);return{normal:e,tangent:t,binormal:n}}applyQuaternion(t){const e=t.w*this.x+t.y*this.z-t.z*this.y,i=t.w*this.y+t.z*this.x-t.x*this.z,n=t.w*this.z+t.x*this.y-t.y*this.x,s=-t.x*this.x-t.y*this.y-t.z*this.z;return new Gt(e*t.w+s*-t.x+i*-t.z-n*-t.y,i*t.w+s*-t.y+n*-t.x-e*-t.z,n*t.w+s*-t.z+e*-t.y-i*-t.x)}}function Zt(t,e){const i=e.z>0?new $t(0,0,0,1):new $t(0,0,1,0);return Math.abs(t.z)>.9999?i:$t.lookRotation(t,e)}function Xt(t,e,i,n,s,o=1){const r=[];for(let a=0;a<i;a++){const l=t+e*a/(i-1),h=new Gt;h[n]=o*Math.cos(l),h[s]=o*Math.sin(l),r.push(h)}return r}const Wt=r("rotationgizmo"),Qt=new Gt(0,0,0),Jt=new Gt(1,0,0),te=new Gt(0,1,0),ee=new Gt(0,0,1),ie=new Gt(0,0,-1),ne=new Gt(.7,0,0),se=new Gt(0,.7,0),oe=new Gt(0,0,.7),re=new Gt(-.7,0,0),ae=new Gt(0,-.7,0),le=new Gt(0,0,-.7),he=new $t(0,0,0,1);function de(t,e,i){const n=t.createElementNS(E,"g"),s=t.createElementNS(E,"circle");s.classList.add(Wt(e)),s.setAttributeNS(null,"cx","0"),s.setAttributeNS(null,"cy","0"),s.setAttributeNS(null,"r","8"),n.appendChild(s);const o=t.createElementNS(E,"text");return o.classList.add(Wt("labeltext")),o.setAttributeNS(null,"y","4"),o.setAttributeNS(null,"text-anchor","middle"),o.setAttributeNS(null,"font-size","10"),o.textContent=i,n.appendChild(o),n}class ce{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.onModeChange_=this.onModeChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Wt()),"popup"===e.pickerLayout&&this.element.classList.add(Wt(void 0,"p"));const i=t.createElement("div");i.classList.add(Wt("p")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const n=t.createElementNS(E,"svg");n.classList.add(Wt("g")),this.padElement.appendChild(n),this.svgElem_=n,this.projector_=new Yt,this.projector_.viewport=[0,0,136,136];const s=Xt(0,Math.PI,33,"x","y"),o=Xt(0,2*Math.PI,65,"x","y",1.1);this.xArcB_=new qt(t,s,this.projector_),this.xArcB_.element.classList.add(Wt("arcx")),this.svgElem_.appendChild(this.xArcB_.element),this.yArcB_=new qt(t,s,this.projector_),this.yArcB_.element.classList.add(Wt("arcy")),this.svgElem_.appendChild(this.yArcB_.element),this.zArcB_=new qt(t,s,this.projector_),this.zArcB_.element.classList.add(Wt("arcz")),this.svgElem_.appendChild(this.zArcB_.element),this.xArcBC_=new qt(t,s,this.projector_),this.xArcBC_.element.classList.add(Wt("arcc")),this.svgElem_.appendChild(this.xArcBC_.element),this.yArcBC_=new qt(t,s,this.projector_),this.yArcBC_.element.classList.add(Wt("arcc")),this.svgElem_.appendChild(this.yArcBC_.element),this.zArcBC_=new qt(t,s,this.projector_),this.zArcBC_.element.classList.add(Wt("arcc")),this.svgElem_.appendChild(this.zArcBC_.element);const r=t.createElementNS(E,"g");n.classList.add(Wt("axes")),this.svgElem_.appendChild(r),this.axesElem_=r,this.xAxis_=new qt(t,[Qt,ne],this.projector_),this.xAxis_.element.classList.add(Wt("axisx")),this.axesElem_.appendChild(this.xAxis_.element),this.yAxis_=new qt(t,[Qt,se],this.projector_),this.yAxis_.element.classList.add(Wt("axisy")),this.axesElem_.appendChild(this.yAxis_.element),this.zAxis_=new qt(t,[Qt,oe],this.projector_),this.zAxis_.element.classList.add(Wt("axisz")),this.axesElem_.appendChild(this.zAxis_.element),this.xnAxis_=new qt(t,[Qt,re],this.projector_),this.xnAxis_.element.classList.add(Wt("axisn")),this.axesElem_.appendChild(this.xnAxis_.element),this.ynAxis_=new qt(t,[Qt,ae],this.projector_),this.ynAxis_.element.classList.add(Wt("axisn")),this.axesElem_.appendChild(this.ynAxis_.element),this.znAxis_=new qt(t,[Qt,le],this.projector_),this.znAxis_.element.classList.add(Wt("axisn")),this.axesElem_.appendChild(this.znAxis_.element),this.xArcF_=new qt(t,s,this.projector_),this.xArcF_.element.classList.add(Wt("arcx")),this.svgElem_.appendChild(this.xArcF_.element),this.yArcF_=new qt(t,s,this.projector_),this.yArcF_.element.classList.add(Wt("arcy")),this.svgElem_.appendChild(this.yArcF_.element),this.zArcF_=new qt(t,s,this.projector_),this.zArcF_.element.classList.add(Wt("arcz")),this.svgElem_.appendChild(this.zArcF_.element),this.xArcFC_=new qt(t,s,this.projector_),this.xArcFC_.element.classList.add(Wt("arcc")),this.svgElem_.appendChild(this.xArcFC_.element),this.yArcFC_=new qt(t,s,this.projector_),this.yArcFC_.element.classList.add(Wt("arcc")),this.svgElem_.appendChild(this.yArcFC_.element),this.zArcFC_=new qt(t,s,this.projector_),this.zArcFC_.element.classList.add(Wt("arcc")),this.svgElem_.appendChild(this.zArcFC_.element),this.rArc_=new qt(t,o,this.projector_),this.rArc_.element.classList.add(Wt("arcr")),this.rArc_.setRotation(he),this.svgElem_.appendChild(this.rArc_.element),this.rArcC_=new qt(t,o,this.projector_),this.rArcC_.element.classList.add(Wt("arcc")),this.rArcC_.setRotation(he),this.svgElem_.appendChild(this.rArcC_.element);const a=t.createElementNS(E,"g");n.classList.add(Wt("labels")),this.svgElem_.appendChild(a),this.labelsElem_=a,this.xLabel=de(t,"labelcirclex","X"),this.labelsElem_.appendChild(this.xLabel),this.yLabel=de(t,"labelcircley","Y"),this.labelsElem_.appendChild(this.yLabel),this.zLabel=de(t,"labelcirclez","Z"),this.labelsElem_.appendChild(this.zLabel),this.xnLabel=de(t,"labelcirclen","-X"),this.labelsElem_.appendChild(this.xnLabel),this.ynLabel=de(t,"labelcirclen","-Y"),this.labelsElem_.appendChild(this.ynLabel),this.znLabel=de(t,"labelcirclen","-Z"),this.labelsElem_.appendChild(this.znLabel);const l=()=>{this.xArcB_.element.classList.add(Wt("arcx_hover")),this.xArcF_.element.classList.add(Wt("arcx_hover"))},h=()=>{this.xArcB_.element.classList.remove(Wt("arcx_hover")),this.xArcF_.element.classList.remove(Wt("arcx_hover"))};this.xArcBC_.element.addEventListener("mouseenter",l),this.xArcBC_.element.addEventListener("mouseleave",h),this.xArcFC_.element.addEventListener("mouseenter",l),this.xArcFC_.element.addEventListener("mouseleave",h);const d=()=>{this.yArcB_.element.classList.add(Wt("arcy_hover")),this.yArcF_.element.classList.add(Wt("arcy_hover"))},c=()=>{this.yArcB_.element.classList.remove(Wt("arcy_hover")),this.yArcF_.element.classList.remove(Wt("arcy_hover"))};this.yArcBC_.element.addEventListener("mouseenter",d),this.yArcBC_.element.addEventListener("mouseleave",c),this.yArcFC_.element.addEventListener("mouseenter",d),this.yArcFC_.element.addEventListener("mouseleave",c);const p=()=>{this.zArcB_.element.classList.add(Wt("arcz_hover")),this.zArcF_.element.classList.add(Wt("arcz_hover"))},u=()=>{this.zArcB_.element.classList.remove(Wt("arcz_hover")),this.zArcF_.element.classList.remove(Wt("arcz_hover"))};this.zArcBC_.element.addEventListener("mouseenter",p),this.zArcBC_.element.addEventListener("mouseleave",u),this.zArcFC_.element.addEventListener("mouseenter",p),this.zArcFC_.element.addEventListener("mouseleave",u);const v=()=>{this.rArc_.element.classList.add(Wt("arcr_hover"))},m=()=>{this.rArc_.element.classList.remove(Wt("arcr_hover"))};this.rArcC_.element.addEventListener("mouseenter",v),this.rArcC_.element.addEventListener("mouseleave",m),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,e.mode.emitter.on("change",this.onModeChange_),this.mode_=e.mode,this.update_()}get xArcBElement(){return this.xArcBC_.element}get yArcBElement(){return this.yArcBC_.element}get zArcBElement(){return this.zArcBC_.element}get xArcFElement(){return this.xArcFC_.element}get yArcFElement(){return this.yArcFC_.element}get zArcFElement(){return this.zArcFC_.element}get rArcElement(){return this.rArcC_.element}get allFocusableElements(){return[this.padElement]}update_(){const t=this.value.rawValue.quat.normalized;this.xAxis_.setRotation(t),this.yAxis_.setRotation(t),this.zAxis_.setRotation(t),this.xnAxis_.setRotation(t),this.ynAxis_.setRotation(t),this.znAxis_.setRotation(t);const e=Jt.applyQuaternion(t),i=te.applyQuaternion(t),n=ee.applyQuaternion(t),s=e.negated,o=i.negated,r=n.negated;[{el:this.xAxis_.element,v:e},{el:this.yAxis_.element,v:i},{el:this.zAxis_.element,v:n},{el:this.xnAxis_.element,v:s},{el:this.ynAxis_.element,v:o},{el:this.znAxis_.element,v:r}].map((({el:t,v:e})=>(this.axesElem_.removeChild(t),{el:t,v:e}))).sort(((t,e)=>t.v.z-e.v.z)).forEach((({el:t})=>{this.axesElem_.appendChild(t)})),this.xArcB_.setRotation(Zt(e,ie)),this.yArcB_.setRotation(Zt(i,ie)),this.zArcB_.setRotation(Zt(n,ie)),this.xArcBC_.setRotation(Zt(e,ie)),this.yArcBC_.setRotation(Zt(i,ie)),this.zArcBC_.setRotation(Zt(n,ie)),this.xArcF_.setRotation(Zt(e,ee)),this.yArcF_.setRotation(Zt(i,ee)),this.zArcF_.setRotation(Zt(n,ee)),this.xArcFC_.setRotation(Zt(e,ee)),this.yArcFC_.setRotation(Zt(i,ee)),this.zArcFC_.setRotation(Zt(n,ee)),[{el:this.xLabel,v:ne},{el:this.yLabel,v:se},{el:this.zLabel,v:oe},{el:this.xnLabel,v:re},{el:this.ynLabel,v:ae},{el:this.znLabel,v:le}].forEach((({el:e,v:i})=>{const[n,s]=this.projector_.project(i.applyQuaternion(t));e.setAttributeNS(null,"transform",`translate( ${n}, ${s} )`)})),[{el:this.xLabel,v:e},{el:this.yLabel,v:i},{el:this.zLabel,v:n},{el:this.xnLabel,v:s},{el:this.ynLabel,v:o},{el:this.znLabel,v:r}].map((({el:t,v:e})=>(this.labelsElem_.removeChild(t),{el:t,v:e}))).sort(((t,e)=>t.v.z-e.v.z)).forEach((({el:t})=>{this.labelsElem_.appendChild(t)}))}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}onModeChange_(){const t=this.mode_.rawValue,e="angle-x"===t?"add":"remove",i="angle-y"===t?"add":"remove",n="angle-z"===t?"add":"remove",s="angle-r"===t?"add":"remove";this.xArcB_.element.classList[e](Wt("arcx_active")),this.yArcB_.element.classList[i](Wt("arcy_active")),this.zArcB_.element.classList[n](Wt("arcz_active")),this.xArcF_.element.classList[e](Wt("arcx_active")),this.yArcF_.element.classList[i](Wt("arcy_active")),this.zArcF_.element.classList[n](Wt("arcz_active")),this.rArc_.element.classList[s](Wt("arcr_active"))}}function pe(t){return Nt(t,0,1)}function ue(t){if(t<=0)return 0;if(t>=1)return 1;const e=1-t;return pe(1-e*(e*(e*(e*(e*(e*(-6*e+7)))))))}function ve(t,e,i){return pe((i-t)/(e-t))}const me=1/Math.sqrt(2),ge=new Gt(1,0,0),_e=new Gt(0,1,0),be=new Gt(0,0,1),fe=new $t(0,0,0,1),we=new $t(me,0,0,me),xe=new $t(0,-me,0,me),ye=new $t(-me,0,0,me),Ce=new $t(0,me,0,me),Ee=new $t(0,1,0,0);class Pe{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.mode_=m("free"),this.view=new ce(t,{value:this.value,mode:this.mode_,viewProps:this.viewProps,pickerLayout:e.pickerLayout}),this.ptHandler_=new zt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_);const i=new zt(this.view.xArcBElement);i.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),i.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const n=new zt(this.view.xArcFElement);n.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),n.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const s=new zt(this.view.yArcBElement);s.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),s.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const o=new zt(this.view.yArcFElement);o.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),o.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const r=new zt(this.view.zArcBElement);r.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),r.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const a=new zt(this.view.zArcFElement);a.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),a.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const l=new zt(this.view.rArcElement);l.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-r"))),l.emitter.on("up",(()=>this.changeModeIfNotAuto_("free"))),[{el:this.view.xLabel,q:xe},{el:this.view.yLabel,q:we},{el:this.view.zLabel,q:fe},{el:this.view.xnLabel,q:Ce},{el:this.view.ynLabel,q:ye},{el:this.view.znLabel,q:Ee}].forEach((({el:t,q:e})=>{new zt(t).emitter.on("down",(()=>this.autoRotate_(e)))})),this.px_=null,this.py_=null,this.angleState_=null}handlePointerEvent_(t){if(!t.point)return;const e=this.mode_.rawValue,i=t.point.x,n=t.point.y;if("auto"!==e)if("free"===e){if(null!=this.px_&&null!=this.py_){const t=i-this.px_,e=n-this.py_,s=Math.sqrt(t*t+e*e);if(0===s)return;const o=new Gt(e/s,t/s,0),r=$t.fromAxisAngle(o,s/68);this.value.rawValue=this.value.rawValue.premultiply(r)}this.px_=i,this.py_=n}else if("angle-r"===e){const e=t.bounds.width/2,s=t.bounds.height/2,o=Math.atan2(n-s,i-e);if(null==this.angleState_){const t=new Gt(0,0,1);this.angleState_={initialRotation:this.value.rawValue,initialAngle:o,axis:t,reverseAngle:!0}}else{const{initialRotation:t,initialAngle:e,axis:i}=this.angleState_,n=-Ht(o-e),s=$t.fromAxisAngle(i,n);this.value.rawValue=t.premultiply(s)}}else{const s=t.bounds.width/2,o=t.bounds.height/2,r=Math.atan2(n-o,i-s);if(null==this.angleState_){const t="angle-x"===e?ge:"angle-y"===e?_e:be,i=t.applyQuaternion(this.value.rawValue.quat).z>0;this.angleState_={initialRotation:this.value.rawValue,initialAngle:r,axis:t,reverseAngle:i}}else{const{initialRotation:t,initialAngle:e,axis:i,reverseAngle:n}=this.angleState_;let s=Ht(r-e);s=n?-s:s;const o=$t.fromAxisAngle(i,s);this.value.rawValue=t.multiply(o)}}}onPointerDown_(t){this.handlePointerEvent_(t.data)}onPointerMove_(t){this.handlePointerEvent_(t.data)}onPointerUp_(){this.px_=null,this.py_=null,this.angleState_=null}onPadKeyDown_(t){Pt(t.key)&&t.preventDefault();const e=xt(1,Ct(t)),i=xt(1,yt(t));if(0!==e||0!==i){const t=new Gt(-i,e,0),n=$t.fromAxisAngle(t,Math.PI/16);this.value.rawValue=this.value.rawValue.premultiply(n)}}changeModeIfNotAuto_(t){"auto"!==this.mode_.rawValue&&(this.mode_.rawValue=t)}autoRotate_(t){this.mode_.rawValue="auto";const e=this.value.rawValue,i=Date.now(),n=()=>{const s=ue(ve(0,300,Date.now()-i));this.value.rawValue=e.slerp(t,s),1!==s?requestAnimationFrame(n):this.mode_.rawValue="free"};requestAnimationFrame(n)}}const ke=r("rotationswatch"),ze=new Gt(1,0,0),Le=new Gt(0,1,0),Me=new Gt(0,0,1),Ve=new $t(0,0,0,1);class Te{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(ke()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(ke("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElementNS(E,"svg");n.classList.add(ke("g")),i.appendChild(n),this.svgElem_=n,this.projector_=new Yt,this.projector_.viewport=[0,0,20,20];const s=Xt(0,Math.PI,33,"x","y"),o=Xt(0,2*Math.PI,65,"x","y");this.rArc_=new qt(t,o,this.projector_),this.rArc_.element.classList.add(ke("arcr")),n.appendChild(this.rArc_.element),this.rArc_.setRotation(Ve),this.xArc_=new qt(t,s,this.projector_),this.xArc_.element.classList.add(ke("arc")),n.appendChild(this.xArc_.element),this.yArc_=new qt(t,s,this.projector_),this.yArc_.element.classList.add(ke("arc")),n.appendChild(this.yArc_.element),this.zArc_=new qt(t,s,this.projector_),this.zArc_.element.classList.add(ke("arc")),n.appendChild(this.zArc_.element),this.update_()}update_(){const t=this.value.rawValue.quat.normalized,e=ze.applyQuaternion(t),i=Le.applyQuaternion(t),n=Me.applyQuaternion(t);this.xArc_.setRotation(Zt(e,Me)),this.yArc_.setRotation(Zt(i,Me)),this.zArc_.setRotation(Zt(n,Me))}onValueChange_(){this.update_()}}class Ae{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Te(t,{value:this.value,viewProps:this.viewProps})}}const Se=r("rotation");class Oe{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Se()),e.foldable.bindExpandedClass(this.element,Se(void 0,"expanded")),d(e.foldable,"completed",p(this.element,Se(void 0,"cpl"))),"quaternion"===e.rotationMode&&this.element.classList.add(Se("quat"));const i=t.createElement("div");i.classList.add(Se("h")),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Se("s")),i.appendChild(n),this.swatchElement=n;const s=t.createElement("div");if(s.classList.add(Se("t")),i.appendChild(s),this.textElement=s,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(Se("g")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}class Ie{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=M.create(e.expanded),this.swatchC_=new Ae(t,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Ft(t,{assembly:e.assembly,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Oe(t,{rotationMode:e.rotationMode,foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new F(t,{viewProps:this.viewProps}):null;const n=new Pe(t,{value:this.value,viewProps:this.viewProps,pickerLayout:e.pickerLayout});n.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.gizmoC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(n.view.element),wt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.gizmoC_.view.element),A(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.gizmoC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=L(t);i&&e.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!z(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function De(t,e){const i=Math.pow(.1,t);return{baseStep:i,constraint:e,textProps:g.fromObject({draggingScale:i,formatter:ft(t)})}}function Re(t){if(!t)return;const i=[];return e(t.step)||i.push(new I(t.step)),(!e(t.max)||!e(t.min))&&i.push(new O({max:t.max,min:t.min})),new S(i)}function Fe(t,e){return{toComponents:t=>t.getComponents(),fromComponents:i=>new Kt(i[0],i[1],i[2],t,e)}}function Ue(t,e,i){var n,s,o;return"number"==typeof(null===(n=t)||void 0===n?void 0:n.x)&&"number"==typeof(null===(s=t)||void 0===s?void 0:s.y)&&"number"==typeof(null===(o=t)||void 0===o?void 0:o.z)?new Kt(t.x,t.y,t.z,e,i):new Kt(0,0,0,e,i)}function Ne(t){switch(t){case"XYZ":case"XZY":case"YXZ":case"YZX":case"ZXY":case"ZYX":return t;default:return}}function Be(t){switch(t){case"rad":case"deg":case"turn":return t;default:return}}const je={id:"rotation",type:"input",css:".tp-rotationswatchv_b,.tp-rotationgizmov_p{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-rotationswatchv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-rotationswatchv_b:hover{background-color:var(--btn-bg-h)}.tp-rotationswatchv_b:focus{background-color:var(--btn-bg-f)}.tp-rotationswatchv_b:active{background-color:var(--btn-bg-a)}.tp-rotationswatchv_b:disabled{opacity:0.5}.tp-rotationgizmov_p{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-rotationgizmov_p:hover{background-color:var(--in-bg-h)}.tp-rotationgizmov_p:focus{background-color:var(--in-bg-f)}.tp-rotationgizmov_p:active{background-color:var(--in-bg-a)}.tp-rotationgizmov_p:disabled{opacity:0.5}.tp-rotationv{position:relative}.tp-rotationv_quat .tp-txtv_i{padding-left:0}.tp-rotationv_root{background-color:var(--mo-bg);width:100%;height:calc( 2.0 * var(--bld-us))}.tp-rotationv_h{display:flex}.tp-rotationv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us);margin-right:4px}.tp-rotationv_g{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-rotationv.tp-rotationv-expanded .tp-rotationv_g{margin-top:var(--bld-s);opacity:1}.tp-rotationv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-rotationswatchv path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationswatchv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-rotationswatchv_arc{fill:none;stroke:var(--btn-bg);stroke-width:1px}.tp-rotationswatchv_arcr{fill:var(--btn-fg);stroke:var(--btn-bg);stroke-width:1px}.tp-rotationgizmov{padding-left:calc(var(--bld-us) + 4px)}.tp-rotationgizmov path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationgizmov_p{cursor:move;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-rotationgizmov_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-rotationgizmov_axisx{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_axisy{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_axisz{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_axisn{stroke:var(--in-fg);stroke-width:2px}.tp-rotationgizmov_arcx{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_hover{stroke:#eb103f}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_active{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_arcy{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_hover{stroke:#4eeb10}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_active{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_arcz{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_hover{stroke:#1068eb}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_active{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_arcr{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_hover{stroke:#ebd510}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_active{stroke:#ebd510;stroke-width:2px}.tp-rotationgizmov_arcc{fill:none;stroke:transparent;stroke-width:5px;pointer-events:auto}.tp-rotationgizmov_labelcirclex{fill:#eb103f;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclex:hover{opacity:0.7}.tp-rotationgizmov_labelcircley{fill:#4eeb10;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcircley:hover{opacity:0.7}.tp-rotationgizmov_labelcirclez{fill:#1068eb;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclez:hover{opacity:0.7}.tp-rotationgizmov_labelcirclen{fill:var(--in-fg);cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclen:hover{opacity:0.7}.tp-rotationgizmov_labeltext{fill:var(--btn-fg);stroke:var(--btn-fg);stroke-width:1px}.tp-rotationgizmov_p:focus .tp-rotationgizmov_m{background-color:var(--in-fg);border-width:0}",accept(t,e){var i,n;const s=y,o=C(e,{view:s.required.constant("rotation"),label:s.optional.string,picker:s.optional.custom(At),expanded:s.optional.boolean,rotationMode:s.required.constant("euler"),x:s.optional.custom(St),y:s.optional.custom(St),z:s.optional.custom(St),order:s.optional.custom(Ne),unit:s.optional.custom(Be)});return o?{initialValue:Ue(t,null!==(i=o.order)&&void 0!==i?i:"XYZ",null!==(n=o.unit)&&void 0!==n?n:"rad"),params:o}:null},binding:{reader:({params:t})=>e=>{var i,n;return Ue(e,null!==(i=t.order)&&void 0!==i?i:"XYZ",null!==(n=t.unit)&&void 0!==n?n:"rad")},constraint({params:t}){var e,i;return new Ot({assembly:Fe(null!==(e=t.order)&&void 0!==e?e:"XYZ",null!==(i=t.unit)&&void 0!==i?i:"rad"),components:[Re("x"in t?t.x:void 0),Re("y"in t?t.y:void 0),Re("z"in t?t.z:void 0)]})},writer:t=>(t,e)=>{t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}},controller({document:t,value:e,constraint:i,params:s,viewProps:o}){var r,a;if(!(i instanceof Ot))throw n.shouldNeverHappen();const l="expanded"in s?s.expanded:void 0,h="picker"in s?s.picker:void 0,d=null!==(r=s.unit)&&void 0!==r?r:"rad",c={rad:2,deg:0,turn:2}[d];return new Ie(t,{axes:[De(c,i.components[0]),De(c,i.components[1]),De(c,i.components[2])],assembly:Fe(null!==(a=s.order)&&void 0!==a?a:"XYZ",d),rotationMode:"euler",expanded:l??!1,parser:bt,pickerLayout:h??"popup",value:e,viewProps:o})}},He={toComponents:t=>[t.x,t.y,t.z,t.w],fromComponents:t=>new $t(t[0],t[1],t[2],t[3])};function Ke(t){return{baseStep:.01,constraint:t,textProps:g.fromObject({draggingScale:.01,formatter:t=>Math.abs(t)<.995?t.toFixed(2).replace("0.","."):t.toFixed(1)})}}function $e(t){var e,i,n,s;return"number"==typeof(null===(e=t)||void 0===e?void 0:e.x)&&"number"==typeof(null===(i=t)||void 0===i?void 0:i.y)&&"number"==typeof(null===(n=t)||void 0===n?void 0:n.z)&&"number"==typeof(null===(s=t)||void 0===s?void 0:s.w)?new $t(t.x,t.y,t.z,t.w):new $t(0,0,0,1)}const Ye={id:"rotation",type:"input",css:".tp-rotationswatchv_b,.tp-rotationgizmov_p{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-rotationswatchv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-rotationswatchv_b:hover{background-color:var(--btn-bg-h)}.tp-rotationswatchv_b:focus{background-color:var(--btn-bg-f)}.tp-rotationswatchv_b:active{background-color:var(--btn-bg-a)}.tp-rotationswatchv_b:disabled{opacity:0.5}.tp-rotationgizmov_p{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-rotationgizmov_p:hover{background-color:var(--in-bg-h)}.tp-rotationgizmov_p:focus{background-color:var(--in-bg-f)}.tp-rotationgizmov_p:active{background-color:var(--in-bg-a)}.tp-rotationgizmov_p:disabled{opacity:0.5}.tp-rotationv{position:relative}.tp-rotationv_quat .tp-txtv_i{padding-left:0}.tp-rotationv_root{background-color:var(--mo-bg);width:100%;height:calc( 2.0 * var(--bld-us))}.tp-rotationv_h{display:flex}.tp-rotationv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us);margin-right:4px}.tp-rotationv_g{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-rotationv.tp-rotationv-expanded .tp-rotationv_g{margin-top:var(--bld-s);opacity:1}.tp-rotationv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-rotationswatchv path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationswatchv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-rotationswatchv_arc{fill:none;stroke:var(--btn-bg);stroke-width:1px}.tp-rotationswatchv_arcr{fill:var(--btn-fg);stroke:var(--btn-bg);stroke-width:1px}.tp-rotationgizmov{padding-left:calc(var(--bld-us) + 4px)}.tp-rotationgizmov path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationgizmov_p{cursor:move;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-rotationgizmov_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-rotationgizmov_axisx{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_axisy{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_axisz{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_axisn{stroke:var(--in-fg);stroke-width:2px}.tp-rotationgizmov_arcx{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_hover{stroke:#eb103f}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_active{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_arcy{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_hover{stroke:#4eeb10}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_active{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_arcz{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_hover{stroke:#1068eb}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_active{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_arcr{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_hover{stroke:#ebd510}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_active{stroke:#ebd510;stroke-width:2px}.tp-rotationgizmov_arcc{fill:none;stroke:transparent;stroke-width:5px;pointer-events:auto}.tp-rotationgizmov_labelcirclex{fill:#eb103f;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclex:hover{opacity:0.7}.tp-rotationgizmov_labelcircley{fill:#4eeb10;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcircley:hover{opacity:0.7}.tp-rotationgizmov_labelcirclez{fill:#1068eb;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclez:hover{opacity:0.7}.tp-rotationgizmov_labelcirclen{fill:var(--in-fg);cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclen:hover{opacity:0.7}.tp-rotationgizmov_labeltext{fill:var(--btn-fg);stroke:var(--btn-fg);stroke-width:1px}.tp-rotationgizmov_p:focus .tp-rotationgizmov_m{background-color:var(--in-fg);border-width:0}",accept(t,e){const i=y,n=C(e,{view:i.required.constant("rotation"),label:i.optional.string,picker:i.optional.custom(At),expanded:i.optional.boolean,rotationMode:i.optional.constant("quaternion"),x:i.optional.custom(St),y:i.optional.custom(St),z:i.optional.custom(St),w:i.optional.custom(St)});return n?{initialValue:$e(t),params:n}:null},binding:{reader:t=>t=>$e(t),constraint:({params:t})=>new Ot({assembly:He,components:[Re("x"in t?t.x:void 0),Re("y"in t?t.y:void 0),Re("z"in t?t.z:void 0),Re("w"in t?t.w:void 0)]}),writer:t=>(t,e)=>{t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}},controller({document:t,value:e,constraint:i,params:s,viewProps:o}){if(!(i instanceof Ot))throw n.shouldNeverHappen();const r="expanded"in s?s.expanded:void 0,a="picker"in s?s.picker:void 0;return new Ie(t,{axes:[Ke(i.components[0]),Ke(i.components[1]),Ke(i.components[2]),Ke(i.components[3])],assembly:He,rotationMode:"quaternion",expanded:r??!1,parser:bt,pickerLayout:a??"popup",value:e,viewProps:o})}},qe=[je,Ye];t.RotationInputPluginEuler=je,t.RotationInputPluginQuaternion=Ye,t.plugins=qe,Object.defineProperty(t,"__esModule",{value:!0})}(we);const xe=s({__proto__:null,default:o(we)},[we]);var ye={};!function(t){const e="tp";function i(t){return(i,n)=>[e,"-",t,"v",i?`_${i}`:"",n?`-${n}`:""].join("")}function n(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function s(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function o(t){return null!==t&&"object"==typeof t}function r(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function a(t){return{custom:e=>r(e)(t),boolean:r((t=>"boolean"==typeof t?t:void 0))(t),number:r((t=>"number"==typeof t?t:void 0))(t),string:r((t=>"string"==typeof t?t:void 0))(t),function:r((t=>"function"==typeof t?t:void 0))(t),constant:e=>r((t=>t===e?e:void 0))(t),raw:r((t=>t))(t),object:e=>r((t=>{if(o(t))return n(t,e)}))(t),array:e=>r((t=>{if(Array.isArray(t))return s(t,e)}))(t)}}const l={optional:a(!0),required:a(!1)};function h(t,e){const i=l.required.object(e)(t);return i.succeeded?i.value:void 0}const d=i("txtr");class c{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(d()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("textarea");i.rows=e.lineCount,i.cols=22,i.placeholder=e.placeholder,i.classList.add(d("i")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){this.inputElement.value=this.value_.rawValue}onChange_(){this.refresh()}}class p{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.lineCount=e.lineCount,this.placeholder=e.placeholder,this.view=new c(t,{value:this.value,viewProps:this.viewProps,lineCount:this.lineCount,placeholder:this.placeholder}),this.view.inputElement.addEventListener("keyup",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value;this.value.rawValue=e,this.view.refresh()}}const u=[{id:"input-template",type:"input",css:".tp-txtrv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-txtrv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtrv:hover{background-color:var(--in-bg-h)}.tp-txtrv:focus{background-color:var(--in-bg-f)}.tp-txtrv:active{background-color:var(--in-bg-a)}.tp-txtrv:disabled{opacity:.5}.tp-txtrv{display:block;height:auto;padding-bottom:0;overflow:hidden;position:relative}.tp-txtrv.tp-v-disabled{opacity:.5}.tp-txtrv .tp-txtrv_i{font-family:var(--font-family);background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-size:11px;padding:4px;line-height:16px;min-width:0;width:100%;border:none;height:100%;resize:none;margin-bottom:-8px}.tp-txtrv .tp-txtrv_i:focus{outline:none}",accept(t,e){if("string"!=typeof t)return null;const i=l,n=h(e,{view:i.required.constant("textarea"),lineCount:i.optional.number,placeholder:i.optional.string});return n?{initialValue:t,params:n}:null},binding:{reader:t=>t=>"string"==typeof t?t:"",writer:t=>(t,e)=>{t.write(e)}},controller(t){var e,i;return new p(t.document,{value:t.value,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:3,placeholder:null!==(i=t.params.placeholder)&&void 0!==i?i:"Enter text here",viewProps:t.viewProps})}}];t.plugins=u,Object.defineProperty(t,"__esModule",{value:!0})}(ye);const Ce=s({__proto__:null,default:o(ye)},[ye]),Ee=t=>{const e=new r.Pane({container:t});return e.registerPlugin(_e),e.registerPlugin(fe),e.registerPlugin(xe),e.registerPlugin(Ce),e},Pe=()=>{const t=u.renderer.domElement;t.setAttribute("style","\n    width: 100% !important;\n    height: 100% !important;\n  ");const e=(t=>{const{element:e,side:i,min:n=100,max:s=300}=t;let o=0,r=0,a=0,l=0;const h="right"===i||"left"===i,d=document.createElement("div"),c=document.createElement("div");c.style.cssText=`\n    position: absolute;\n    z-index: 1000;\n    opacity: 0.5;\n    background-color: var(--color-resize-handle, #888);\n    cursor: ${h?"ew":"ns"}-resize;\n    ${h?"width":"height"}: 3px;\n    ${h?"height":"width"}: 100%;\n    ${h?"top: 0; bottom: 0;":"left: 0; right: 0;"}\n    ${(t=>{switch(t){case"left":return"left: 0;";case"right":return"left: calc(100% - 3px);";case"top":return"top: 0;";case"bottom":return"bottom: 0;";default:return""}})(i)}\n  `;const p=t=>{if(t.preventDefault(),t.stopPropagation(),h){let e=o-t.clientX;"right"===i&&(e=-e);const r=3+Math.max(n,Math.min(s,a+e));d.style.width=`${r}px`}else{let e=r-t.clientY;"bottom"===i&&(e=-e);const o=Math.max(n,Math.min(s,l+e));d.style.height=`${o}px`}},u=t=>{t.preventDefault(),t.stopPropagation(),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",u),c.style.opacity="0.5"};return c.addEventListener("mousedown",(t=>{t.preventDefault(),t.stopPropagation(),o=t.clientX,r=t.clientY,a=d.clientWidth,l=d.clientHeight,window.addEventListener("mousemove",p),window.addEventListener("mouseup",u),c.style.opacity="1"})),d.style.position="relative",d.style.overflow="hidden",d.append(e),d.append(c),t.height&&(d.style.height=`${t.height}px`),t.width&&(d.style.width=`${t.width}px`),d})({element:t,max:1/0,side:"right",width:window.innerWidth-335});return e.style.cssText+="--color-resize-handle: #222;",e.classList.add("h-screen"),e},ke={controlling:!1},ze={expanded:!1,picker:"inline",rotationMode:"euler",view:"rotation"},Le=(t,e)=>{const{THREE:i}=u,{element:n}=t,s={rotation:new i.Euler};t.addSeparator();const o=t.addInput(e,"position",{step:.1}),r=t.addInput(s,"rotation",ze).on("change",(()=>{ke.controlling&&e.rotation.copy(s.rotation)})),a=t.addInput(e,"scale",{step:.1}),l=()=>{ke.controlling||(e.rotation.equals(s.rotation)||(s.rotation.copy(e.rotation),r.refresh()),o.refresh(),a.refresh())};let h;z(l),"isInstancedMesh"in e&&(h=((t,e)=>{const{THREE:i}=u,n=new i.Matrix4;t.addSeparator();const s={index:0,position:new i.Vector3,rotation:new i.Euler,scale:new i.Vector3},o=t.addInput(s,"index",{label:"instance index",max:e.count-1,min:0,step:1}),r=t.addInput(s,"position",{index:0}),a=t.addInput(s,"rotation",ze),l=t.addInput(s,"scale",{index:0}),h=()=>{e.getMatrixAt(s.index,n),s.position.setFromMatrixPosition(n),s.rotation.setFromRotationMatrix(n),s.scale.setFromMatrixScale(n),r.refresh(),a.refresh(),l.refresh()},d=()=>{n.makeRotationFromEuler(s.rotation),n.setPosition(s.position),n.scale(s.scale),e.setMatrixAt(s.index,n),e.instanceMatrix.needsUpdate=!0};o.on("change",h),r.on("change",d),a.on("change",d),l.on("change",d);const c=()=>{ke.controlling||h()};return z(c),()=>L(c)})(t,e));const d=()=>{ke.controlling=!0},c=()=>{ke.controlling=!1};return n.addEventListener("mousedown",d,{passive:!0}),n.addEventListener("mouseup",c,{passive:!0}),()=>{n.removeEventListener("mousedown",d),n.removeEventListener("mouseup",c),o.dispose(),r.dispose(),a.dispose(),L(l),null==h||h()}},Me=(t,e)=>{t.addSeparator();const i={userData:JSON.stringify(e.userData,null,2)},n=i.userData.split(/\r\n|\r|\n/u).length,s=t.addMonitor(i,"userData",{interval:5e3,lineCount:n,multiline:!0});return()=>s.dispose()},Ve=[x.NONE,x.ORBIT,x.MAP],Te={controls:l.getNumber("controls")??x.NONE},Ae=(t,e)=>{const{THREE:i}=u,n=["none","orbit","map"];t.addInput(Te,"controls",{cells:(t,e)=>({title:n[Ve[3*e+t]],value:Ve[3*e+t]}),groupName:"controls",label:"inspect controls",size:[3,1],view:"radiogrid"}).on("change",(()=>C(Te.controls,e)));const s=()=>{e.updateProjectionMatrix()};t.addInput(e,"near").on("change",s),t.addInput(e,"far").on("change",s);const o=t.addInput(e,"zoom").on("change",s),r=()=>o.refresh();window.addEventListener("wheel",r,{passive:!0}),e instanceof i.OrthographicCamera&&(t.addInput(e,"bottom").on("change",s),t.addInput(e,"left").on("change",s),t.addInput(e,"right").on("change",s),t.addInput(e,"top").on("change",s)),e instanceof i.PerspectiveCamera&&(t.addInput(e,"fov").on("change",s),t.addInput(e,"filmOffset").on("change",s),t.addInput(e,"filmGauge").on("change",s));const a=[];return a.push(Le(t,e)),a.push(Me(t,e)),null!==u.composer&&a.push((t=>{const{composer:e}=u;if(null===e)return()=>null;const i=t.addFolder({title:"Postprocessing"}),{passes:n}=e;let s;for(let r=0,a=n.length;r<a;r+=1){const t=n[r];if("effects"in t){s=t;break}}if(void 0===s)return()=>i.dispose();const{effects:o}=s;for(let r=0,a=o.length;r<a;r+=1){const t=o[r];if("SMAAEffect"===t.name)i.addFolder({title:"smaa"});else if("BloomEffect"===t.name){const e=t,n=i.addFolder({title:"bloom"});n.addInput(e,"height"),n.addInput(e,"width"),n.addInput(e,"intensity")}else if("NoiseEffect"===t.name)i.addFolder({title:"noise"}).addInput(t.blendMode.opacity,"value",{label:"opacity"});else if("VignetteEffect"===t.name){const e=t,n=i.addFolder({title:"vignette"});n.addInput(e,"darkness"),n.addInput(e,"technique",{options:{default:0,eskil:1}}),n.addInput(e,"offset")}else if("SSREffect"===t.name){const e=t,n=i.addFolder({title:"ssr"});n.addInput(e,"intensity",{max:3,min:0,step:.01}),n.addInput(e,"exponent",{max:8,min:.125,step:.125}),n.addInput(e,"distance",{max:10,min:.001,step:.1}),n.addInput(e,"fade",{max:20,min:0,step:.01}),n.addInput(e,"roughnessFade",{max:1,min:0,step:.01}),n.addInput(e,"thickness",{max:10,min:0,step:.01}),n.addInput(e,"ior",{max:2.33333,min:1,step:.01}),n.addInput(e,"maxRoughness",{max:1,min:0,step:.01}),n.addInput(e,"maxDepthDifference",{max:100,min:0,step:.1});const s=n.addFolder({index:0,title:"Temporal Resolve"});s.addInput(e,"blend",{max:1,min:0,step:.001}),s.addInput(e,"correction",{max:1,min:0,step:1e-4}),s.addInput(e,"correctionRadius",{max:4,min:1,step:1});const o=n.addFolder({index:0,title:"Blur"});o.addInput(e,"blur",{max:1,min:0,step:.01}),o.addInput(e,"blurKernel",{max:5,min:0,step:1}),o.addInput(e,"blurSharpness",{max:100,min:0,step:1});const r=n.addFolder({index:0,title:"Jitter"});r.addInput(e,"jitter",{max:4,min:0,step:.01}),r.addInput(e,"jitterRoughness",{max:4,min:0,step:.01});const a=n.addFolder({index:0,title:"Tracing"});a.addInput(e,"steps",{max:256,min:1,step:1}),a.addInput(e,"refineSteps",{max:16,min:0,step:1}),a.addInput(e,"missedRays");const l=n.addFolder({index:0,title:"Resolution"});l.addInput(e,"resolutionScale",{max:1,min:.125,step:.125}),l.addInput(e,"velocityResolutionScale",{max:1,min:.125,step:.125})}else console.warn(`three-inspect does not yet support postprocessing effect: ${t.name}`)}return()=>i.dispose()})(t)),a.push((()=>window.removeEventListener("wheel",r))),a},Se=new WeakMap,Oe=new WeakMap,Ie=t=>Oe.get(t),De=t=>Se.get(t),Re=t=>{if(!0===t.userData.THREE_INSPECT_OMIT)return;t.traverse((e=>t!==e&&Re(e)));const e=Se.get(t);Se.delete(t),void 0!==e&&(Oe.delete(e),e.destroy())},Fe=new Map,Ue=(t,e,i)=>{if(!0===e.userData.THREE_INSPECT_OMIT)return;const n="isScene"in i?t:Se.get(i),s=`${e.name} (${(t=>{var e;return"isInstancedMesh"in t?"InstancedMesh":(null==(e=t.geometry)?void 0:e.isMeshLine)?"MeshLine":t.type})(e)})`,o=new Jt({text:s});o.open=!0,Se.set(e,o),Oe.set(o,e),n?n.append(o):e.parent&&Fe.set(e.parent.uuid,o);const r=Fe.get(e.uuid);r&&(o.append(r),Fe.delete(e.uuid));{const{children:i}=e;for(let n=0,s=i.length;n<s;n+=1)Ue(t,i[n],e)}},Ne=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],Be=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],je={max:1,min:0},He=(t,e)=>{t.addSeparator(),t.addInput(e.target,"position",{label:"target position",step:.1}).on("change",(()=>{e.target.updateMatrixWorld()}))},Ke=(t,e)=>{const{THREE:i}=u;let n,s;const o=[],r={color:`#${e.color.getHexString().toUpperCase()}`,helper:!1,shadowHelper:!1};if(e instanceof i.AmbientLight||t.addInput(r,"helper").on("change",(()=>n&&e[r.helper?"add":"remove"](n))),t.addInput(r,"color").on("change",(()=>e.color.set(r.color))),t.addInput(e,"intensity"),e instanceof i.DirectionalLight?(t.addInput(e,"castShadow"),Le(t,e),He(t,e),n=new i.DirectionalLightHelper(e)):e instanceof i.HemisphereLight?(t.addInput(e,"groundColor"),n=new i.HemisphereLightHelper(e,10)):e instanceof i.PointLight?(t.addInput(e,"decay"),t.addInput(e,"distance"),t.addInput(e,"power"),t.addInput(e,"castShadow"),Le(t,e),n=new i.PointLightHelper(e,10)):e instanceof i.SpotLight?(t.addInput(e,"angle",{max:Math.PI/2,min:0}),t.addInput(e,"decay"),t.addInput(e,"distance"),t.addInput(e,"penumbra",je),t.addInput(e,"power"),t.addInput(e,"castShadow"),Le(t,e),He(t,e),n=new i.SpotLightHelper(e)):e instanceof i.RectAreaLight&&(t.addInput(e,"power"),t.addInput(e,"width"),t.addInput(e,"height"),Le(t,e),n=((t,e)=>{const{THREE:i}=u,n=new i.BufferGeometry;n.setAttribute("position",new i.Float32BufferAttribute(Ne,3)),n.computeBoundingSphere();const s=new i.LineBasicMaterial({fog:!1}),o=new i.Line;o.type="RectAreaLightHelper";const r=new i.BufferGeometry;return r.setAttribute("position",new i.Float32BufferAttribute(Be,3)),r.computeBoundingSphere(),o.add(new i.Mesh(r,new i.MeshBasicMaterial({fog:!1,side:i.BackSide}))),o.updateMatrixWorld=()=>{if(o.scale.set(.5*t.width,.5*t.height,1),void 0===e){s.color.copy(t.color).multiplyScalar(t.intensity);const{color:e}=s,i=Math.max(e.r,e.g,e.b);i>1&&e.multiplyScalar(1/i),o.children[0].material.color.copy(e)}else s.color.set(e),o.children[0].material.color.set(e);o.matrixWorld.extractRotation(t.matrixWorld).scale(o.scale).copyPosition(t.matrixWorld),o.children[0].matrixWorld.copy(o.matrixWorld)},o.dispose=()=>{o.geometry.dispose(),o.material.dispose();const t=o.children[0];t.geometry.dispose(),t.material.dispose()},o})(e)),void 0!==n&&(n.userData.THREE_INSPECT_OMIT=!0),e.castShadow){const n=t.addFolder({index:e.id,title:"Shadow Camera"});n.addInput(e.shadow,"autoUpdate"),n.addInput(r,"shadowHelper",{label:"helper"}).on("change",(()=>s&&e[r.shadowHelper?"add":"remove"](s)));const o={mapSize:e.shadow.mapSize.x},a=()=>{e.shadow.mapSize.width=o.mapSize,e.shadow.mapSize.height=o.mapSize,e.shadow.dispose(),e.shadow.map=null},l=[256,512,1024,2048];if(n.addInput(o,"mapSize",{cells:t=>({title:l[t],value:l[t]}),groupName:"mapSize",size:[4,1],view:"radiogrid"}).on("change",a),n.addInput(e.shadow,"bias",{max:.09,min:0,step:.001}),n.addInput(e.shadow,"normalBias").on("change",a),n.addInput(e.shadow,"radius").on("change",a),e instanceof i.DirectionalLight){const{camera:t}=e.shadow;n.addInput(t,"near").on("change",a),n.addInput(t,"far").on("change",a),n.addInput(t,"left").on("change",a),n.addInput(t,"right").on("change",a),n.addInput(t,"top").on("change",a),n.addInput(t,"bottom").on("change",a),Le(n,t)}else if(e instanceof i.SpotLight){const{camera:t}=e.shadow;n.addInput(t,"near").on("change",a),n.addInput(t,"far").on("change",a),n.addInput(t,"focus",je),Le(n,t)}s=new i.CameraHelper(e.shadow.camera),s.userData.THREE_INSPECT_OMIT=!0}return t.on("change",(()=>{var t;null==(t=null==n?void 0:n.update)||t.call(n),null==s||s.update()})),o.push(Me(t,e)),o.push((()=>{var t;void 0!==n&&(e.remove(n),null==(t=n.dispose)||t.call(n)),void 0!==s&&(e.remove(s),s.dispose())})),o},$e=(()=>{const t=document.createElement("canvas");t.width=1,t.height=1;const e=t.getContext("2d");null!==e&&(e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1));const i=document.createElement("img");return i.src=t.toDataURL("image/png"),i})(),Ye=(t,e,i)=>{const{THREE:n}=u,s=e[i],o={current:()=>{}},r={ClampToEdgeWrapping:n.ClampToEdgeWrapping,MirroredRepeatWrapping:n.MirroredRepeatWrapping,RepeatWrapping:n.RepeatWrapping},a={LinearFilter:n.LinearFilter,NearestFilter:n.NearestFilter},l={...a,LinearMipmapLinearFilter:n.LinearMipmapLinearFilter,LinearMipmapNearestFilter:n.LinearMipmapNearestFilter,NearestMipmapLinearFilter:n.NearestMipmapLinearFilter,NearestMipmapNearestFilter:n.NearestMipmapNearestFilter},h={0:0,16:16,2:2,4:4,8:8},d={AlphaFormat:n.AlphaFormat,DepthFormat:n.DepthFormat,DepthStencilFormat:n.DepthStencilFormat,LuminanceAlphaFormat:n.LuminanceAlphaFormat,LuminanceFormat:n.LuminanceFormat,RGBAFormat:n.RGBAFormat,RGBAIntegerFormat:n.RGBAIntegerFormat,RGFormat:n.RGFormat,RGIntegerFormat:n.RGIntegerFormat,RedFormat:n.RedFormat,RedIntegerFormat:n.RedIntegerFormat},c={BasicDepthPacking:n.BasicDepthPacking,LinearEncoding:n.LinearEncoding,RGBADepthPacking:n.RGBADepthPacking,sRGBEncoding:n.sRGBEncoding},p={map:(null==s?void 0:s.image)??$e},v=t=>{m.hidden=!1,m.title=`${t.name} (Texture)`.trim();const i=()=>t.needsUpdate=!0;m.addInput(t,"wrapS",{options:r}).on("change",i),m.addInput(t,"wrapT",{options:r}).on("change",i),m.addInput(t,"magFilter",{options:a}),m.addInput(t,"minFilter",{options:l}),m.addInput(t,"offset",{step:.01}),m.addInput(t,"rotation",{step:.01}),m.addInput(t,"anisotropy",{options:h}).on("change",i),m.addInput(t,"format",{options:d}).on("change",i),m.addInput(t,"repeat",{x:{step:1},y:{step:1}}),m.addInput(t,"center"),m.addInput(t,"flipY"),m.addInput(t,"encoding",{options:c}).on("change",(()=>{i(),e instanceof n.Material&&(e.needsUpdate=!0)})),o.current=()=>m.children.forEach((t=>t.dispose()))};t.addInput(p,"map",{label:i,view:"input-image"}).on("change",(({value:t})=>{var r;if(t.src===$e.src||t.src===(null==s?void 0:s.image.src))return;null==(r=e[i])||r.dispose();const a=new n.Texture(t);e[i]=a,a.needsUpdate=!0,e instanceof n.Material&&(e.needsUpdate=!0),o.current(),v(a)}));const m=t.addFolder({hidden:!0,title:""});return s&&v(s),()=>o.current()},qe=(t,e)=>{const{THREE:i}=u,n=e.material,s=t.addFolder({index:e.id,title:`${n.name} (${n.type})`.trim()}),o={ObjectSpaceNormalMap:i.ObjectSpaceNormalMap,TangentSpaceNormalMap:i.TangentSpaceNormalMap},r=()=>{n.needsUpdate=!0},a=t=>{const e=n,i={[t]:`#${e[t].getHexString()}`};s.addInput(i,t).on("change",(()=>e[t].set(i.color)))};s.addInput(n,"visible"),s.addInput(n,"transparent").on("change",r),s.addInput(n,"opacity",je);const l=[["Back",i.BackSide],["Double",i.DoubleSide],["Front",i.FrontSide]];if(s.addInput(n,"side",{cells:t=>({title:l[t][0],value:l[t][1]}),groupName:"side",size:[3,1],view:"radiogrid"}),s.addInput(n,"vertexColors"),s.addSeparator(),n instanceof i.PointsMaterial)a("color"),s.addInput(n,"size"),s.addInput(n,"sizeAttenuation");else if(n instanceof i.LineBasicMaterial||n instanceof i.LineDashedMaterial)a("color"),s.addInput(n,"fog"),s.addInput(n,"linewidth");else if(n instanceof i.MeshBasicMaterial)a("color"),s.addInput(n,"fog"),s.addInput(n,"reflectivity",je),s.addInput(n,"refractionRatio",je),s.addInput(n,"wireframe");else if(n instanceof i.MeshDepthMaterial)s.addInput(n,"fog");else if(n instanceof i.MeshLambertMaterial)a("color"),a("emissive"),s.addInput(n,"emissiveIntensity",{min:0}),s.addInput(n,"flatShading").on("change",r),s.addInput(n,"fog"),s.addInput(n,"reflectivity",je),s.addInput(n,"refractionRatio",je),s.addInput(n,"wireframe");else if(n instanceof i.MeshPhongMaterial)a("color"),a("emissive"),s.addInput(n,"emissiveIntensity",{min:0}),s.addInput(n,"flatShading").on("change",r),s.addInput(n,"fog"),s.addInput(n,"reflectivity",je),s.addInput(n,"refractionRatio",je),s.addInput(n,"shininess",je),s.addInput(n,"wireframe");else if(n instanceof i.MeshStandardMaterial)a("color"),a("emissive"),s.addInput(n,"emissiveIntensity",{min:0}),s.addInput(n,"roughness",je),s.addInput(n,"metalness",je),s.addInput(n,"flatShading").on("change",r),s.addInput(n,"fog"),s.addInput(n,"wireframe"),s.addInput(n,"envMapIntensity"),n instanceof i.MeshPhysicalMaterial&&(s.addSeparator(),a("attenuationColor"),s.addInput(n,"clearcoat",je),s.addInput(n,"clearcoatRoughness",je),s.addInput(n,"transmission",je),s.addInput(n,"ior",{max:2.333,min:1}),s.addInput(n,"reflectivity",je),s.addInput(n,"sheen",je),s.addInput(n,"sheenRoughness",je),a("sheenColor"));else if(n instanceof i.ShaderMaterial){const t={uniforms:JSON.stringify(n.uniforms,null,2)};s.addInput(t,"uniforms",{view:"textarea"}).on("change",(()=>{try{n.uniforms=JSON.parse(t.uniforms),r()}catch{}})),s.addInput(n,"vertexShader",{view:"textarea"}).on("change",r),s.addInput(n,"fragmentShader",{view:"textarea"}).on("change",r)}return(n instanceof i.MeshBasicMaterial||n instanceof i.MeshLambertMaterial||n instanceof i.MeshPhongMaterial||n instanceof i.MeshStandardMaterial||n instanceof i.MeshPhysicalMaterial)&&(s.addSeparator(),Ye(s,n,"map"),Ye(s,n,"alphaMap"),Ye(s,n,"aoMap"),s.addInput(n,"aoMapIntensity",je),Ye(s,n,"lightMap"),s.addInput(n,"lightMapIntensity",je),(n instanceof i.MeshLambertMaterial||n instanceof i.MeshPhongMaterial||n instanceof i.MeshStandardMaterial||n instanceof i.MeshPhysicalMaterial)&&(Ye(s,n,"bumpMap"),s.addInput(n,"bumpScale",je),Ye(s,n,"displacementMap"),s.addInput(n,"displacementScale"),s.addInput(n,"displacementBias"),Ye(s,n,"emissiveMap"),Ye(s,n,"normalMap"),s.addInput(n,"normalMapType",{options:o})),(n instanceof i.MeshStandardMaterial||n instanceof i.MeshPhysicalMaterial)&&(Ye(s,n,"metalnessMap"),Ye(s,n,"roughnessMap"),n instanceof i.MeshPhysicalMaterial&&(Ye(s,n,"clearcoatMap"),Ye(s,n,"clearcoatNormalMap"),s.addInput(n,"clearcoatNormalScale",{x:je,y:je}),Ye(s,n,"clearcoatRoughnessMap"),Ye(s,n,"sheenRoughnessMap")))),s.addSeparator(),s.addInput(n,"alphaTest",je),s.addInput(n,"blendDst"),s.addInput(n,"clipShadows"),s.addInput(n,"depthTest"),s.addInput(n,"depthWrite"),s.addInput(n,"polygonOffset"),s.addInput(n,"polygonOffsetFactor"),s.addInput(n,"dithering"),()=>s.dispose()},Ge=(t,e)=>{const{THREE:i}=u;e instanceof i.Points&&t.addMonitor(e.geometry.attributes.position,"count"),t.addInput(e,"castShadow"),t.addInput(e,"receiveShadow"),t.addInput(e,"frustumCulled"),t.addInput(e,"matrixAutoUpdate"),t.addInput(e,"visible");const n=[];e.type.toLowerCase().includes("helper")||n.push(((t,e)=>{const i=new u.THREE.ArrowHelper;i.name="Forward helper",i.setLength(1),i.userData.THREE_INSPECT_OMIT=!0;const n={forwardHelper:!1},s=t.addInput(n,"forwardHelper").on("change",(()=>{n.forwardHelper?e.add(i):e.remove(i)}));return()=>{s.dispose(),e.remove(i),i.dispose()}})(t,e)),n.push(Le(t,e));const s=e;if(Array.isArray(s.material))for(let o=0,r=s.material.length;o<r;o+=1)s.material[o]instanceof i.Material&&n.push(qe(t,s));else void 0!==s.material&&s.material instanceof i.Material&&n.push(qe(t,s));return n.push(Me(t,e)),n},Ze={axes:void 0,grid:void 0},Xe=null!==l.get("grid"),We=null!==l.get("axes"),Qe={axes:We,background:$e,fogColor:"#000000",grid:Xe,gridDivisions:l.getNumber("gridDivisions")??4,gridSize:l.getNumber("gridSize")??10},Je=t=>{const{THREE:e,scene:i}=u,n=[],s=t=>{i[Qe[t]?"add":"remove"](Ze[t]),Qe[t]?l.set(t,""):l.remove(t)},o=t=>{i.remove(Ze.grid),Ze.grid.dispose(),Ze.grid=new e.GridHelper(Qe.gridSize,Qe.gridDivisions),i.add(Ze.grid),l.setNumber(t,Qe[t])};if(t.addInput(Qe,"axes",{label:"axes"}).on("change",(()=>s("axes"))),t.addInput(Qe,"grid",{label:"grid"}).on("change",(()=>s("grid"))),t.addInput(Qe,"gridSize",{label:"grid size"}).on("change",(()=>o("gridSize"))),t.addInput(Qe,"gridDivisions",{label:"grid divisions",step:1}).on("change",(()=>o("gridDivisions"))),null!==i.fog){Qe.fogColor=`#${i.fog.color.getHexString().toUpperCase()}`;const e=t.addFolder({title:"Fog"});e.addInput(Qe,"fogColor",{label:"color"}).on("change",(()=>{var t;null==(t=i.fog)||t.color.set(Qe.fogColor)})),"near"in i.fog&&e.addInput(i.fog,"near"),"far"in i.fog&&e.addInput(i.fog,"far")}return t.addSeparator(),n.push(Ye(t,i,"background")),t.addSeparator(),n.push((t=>{const{THREE:e,renderer:i}=u,n=new e.Color;i.getClearColor(n);const s={clearColor:`#${n.getHexString().toUpperCase()}`};t.addInput(s,"clearColor").on("change",(()=>{i.setClearColor(s.clearColor)}));const o=()=>{i.shadowMap.needsUpdate=!0};t.addSeparator(),t.addInput(i.shadowMap,"enabled",{label:"shadowmap"}).on("change",o),t.addInput(i.shadowMap,"autoUpdate").on("change",o),t.addInput(i.shadowMap,"type",{options:{Basic:e.BasicShadowMap,PCF:e.PCFShadowMap,"PCF Soft":e.PCFSoftShadowMap,VSM:e.VSMShadowMap}}).on("change",(()=>{i.shadowMap.needsUpdate=!0})),t.addSeparator(),t.addInput(i,"toneMapping",{options:{ACESFilmic:e.ACESFilmicToneMapping,Cineon:e.CineonToneMapping,Custom:e.CustomToneMapping,Linear:e.LinearToneMapping,None:e.NoToneMapping,Reinhard:e.ReinhardToneMapping}}),t.addInput(i,"toneMappingExposure",{label:"exposure"}),t.addSeparator();const r={calls:"",geometries:"",lines:"",points:"",textures:"",triangles:""},a={maxAnisotropy:i.capabilities.getMaxAnisotropy().toString(),maxAttributes:i.capabilities.maxAttributes.toFixed(),maxCubemapSize:`${i.capabilities.maxCubemapSize.toFixed()} (h * w)`,maxFragmentUniforms:i.capabilities.maxFragmentUniforms.toFixed(),maxTextureSize:`${i.capabilities.maxTextureSize.toFixed()} (h * w)`,maxTextures:i.capabilities.maxTextures.toFixed(),maxVaryings:i.capabilities.maxVaryings.toFixed(),maxVertexTextures:i.capabilities.maxVertexTextures.toFixed(),maxVertexUniforms:i.capabilities.maxVertexUniforms.toFixed()},l={interval:1e6},h=[];h.push(t.addMonitor(r,"calls",l)),h.push(t.addMonitor(r,"geometries",l)),h.push(t.addMonitor(r,"lines",l)),h.push(t.addMonitor(r,"points",l)),h.push(t.addMonitor(r,"textures",l)),h.push(t.addMonitor(r,"triangles",l)),t.addSeparator(),t.addMonitor(a,"maxAnisotropy",l),t.addMonitor(a,"maxAttributes",l),t.addMonitor(a,"maxCubemapSize",l),t.addMonitor(a,"maxFragmentUniforms",l),t.addMonitor(a,"maxTextureSize",l),t.addMonitor(a,"maxTextures",l),t.addMonitor(a,"maxVaryings",l),t.addMonitor(a,"maxVertexTextures",l),t.addMonitor(a,"maxVertexUniforms",l),t.addMonitor(i.capabilities,"precision",l);const d=()=>{const{render:t,memory:e}=i.info;r.calls=t.calls.toFixed(0),r.geometries=e.geometries.toFixed(0),r.lines=t.lines.toFixed(0),r.points=t.points.toFixed(0),r.textures=e.textures.toFixed(0),r.triangles=t.triangles.toFixed(0);for(let i=0,n=h.length;i<n;i+=1)h[i].refresh()},c=setInterval(d,2e3);return d(),()=>clearInterval(c)})(t)),n.push((()=>{Ze.grid.dispose(),Ze.axes.dispose()})),n},ti=t=>{const{THREE:e}=u,i=e.Object3D.prototype.add,n=e.Object3D.prototype.remove,s=e.Object3D.prototype.clear;return e.Object3D.prototype.add=function(...e){i.call(this,...e);for(let i=0,n=e.length;i<n;i+=1)Ue(t,e[i],this);return this},e.Object3D.prototype.remove=function(...t){n.call(this,...t);for(let e=0,i=t.length;e<i;e+=1)Re(t[e]);return this},e.Object3D.prototype.clear=function(){const{children:t}=this;s.call(this);for(let e=0,i=t.length;e<i;e+=1)Re(t[e]);return this},()=>{e.Object3D.prototype.add=i,e.Object3D.prototype.remove=n,e.Object3D.prototype.clear=s}},ei=(t,e,i)=>{const{scene:n}=u,s=ti(e);let o;(t=>{const{THREE:e,renderer:i}=u,n=i.domElement,s=new e.Raycaster,o=new e.Vector2,r=e=>{const{scene:i,camera:r}=u;o.x=e.clientX/n.clientWidth*2-1,o.y=-e.clientY/n.clientHeight*2+1,s.setFromCamera(o,r);const a=s.intersectObjects(i.children).filter((t=>!0!==t.object.userData.THREE_INSPECT_OMIT));t(a)};p.addEventListener("enable-select",(t=>{t.enabled?n.addEventListener("pointerdown",r,{passive:!0}):n.removeEventListener("pointerdown",r)}))})((t=>{if(t.length<1)return;let e;for(;void 0===e;){const i=t.shift();if(void 0===i)break;e=De(i.object)}void 0!==e&&(void 0!==o&&(o.selected=!1),e.selected=!0,e.dom.scrollIntoView())}));let r=null;t.on("deselect",(()=>{null==r||r(),r=null,o=void 0})),t.on("select",(t=>{null==r||r(),r=null,o=t;const e="Scene"===t.text?n:Ie(t);void 0!==e&&(r=((t,e)=>{const i=Ee(t);let n;return n="isPerspectiveCamera"in e||"isOrthographicCamera"in e?Ae(i,e):"isScene"in e?Je(i):"isLight"in e?Ke(i,e):Ge(i,e),()=>{n.forEach((t=>t())),i.dispose()}})(i,e))})),t.on("reparent",(t=>{for(let e=0,i=t.length;e<i;e+=1){const{item:i,newParent:s}=t[e],o=Ie(i),r="Scene"===s.text?n:Ie(s);void 0!==r&&void 0!==o&&r.attach(o)}}));{const{children:t}=n;for(let i=0,s=t.length;i<s;i+=1)Ue(e,t[i],n)}return()=>{s(),t.clearTreeItems(),(()=>{const{children:t}=n;for(let e=0,i=t.length;e<i;e+=1)Re(t[e])})()}},ii=t=>{const e=[],i=document.createElement("div");if(i.className="right"===t.location?"z-[100] absolute top-0 left-0 w-screen h-screen flex":"z-[100] absolute top-0 right-0 w-[350px] h-screen flex",u.root=i,"right"===t.location){const t=Pe();i.append(t);let n=window.innerWidth;const s=()=>{const e=window.innerWidth,i=e-n;t.style.width=`${t.clientWidth+i}px`,n=e};window.addEventListener("resize",s,{passive:!0}),e.push((()=>window.removeEventListener("resize",s)))}const{controls:n,nav:s,treeroot:o,treeview:a,pane:h}=(()=>{const t=document.createElement("div");t.className="relative flex flex-col grow bg-[#28292e]",u.debugRoot=t;const e=document.createElement("nav");e.className="tp-rotv z-50 sticky flex top-0 w-full overflow-x-auto z-1 bg-[#28292e] font-mono text-[11px]",t.append(e);const i=document.createElement("section");i.className="flex flex-col grow overflow-x-hidden overflow-y-auto",i.dataset.pane="World",t.append(i);const n=new me;n.scrollable=!0,n.allowRenaming=!1,n.dom.style.cssText="font-family: monospace; font-size: 11px; height: 300px;",n.wc.classList.add("sticky","top-0","z-10","bg-[#333]"),i.append(n.wc);const s=new Jt({text:"Scene"});n.append(s);const o=document.createElement("div");return i.append(o),{controls:t,nav:e,pane:o,treeroot:s,treeview:n}})(),{addPane:d}=((t,e)=>{let i="";const n=n=>{var s,o;if(i===n)return;l.set("selectedPane",n),null==(s=t.querySelector(`[data-pane="${i}"]`))||s.classList.add("hidden");const r=e.querySelector(`[data-nav="${i}"]`);null==r||r.classList.remove("bg-zinc-400","text-zinc-800"),null==r||r.classList.add("text-zinc-400"),null==(o=t.querySelector(`[data-pane="${n}"]`))||o.classList.remove("hidden");const a=e.querySelector(`[data-nav="${n}"]`);null==a||a.classList.add("bg-zinc-400","text-zinc-800"),null==a||a.classList.remove("text-zinc-400"),i=n},s=t=>{const i=document.createElement("button");i.className="py-1.5 px-2 text-zinc-400",i.dataset.nav=t,i.textContent=t,i.addEventListener("click",(()=>n(t)),{passive:!0}),e.append(i)},o=document.createElement("button");return o.title="Select an element to inspect it",o.innerHTML='<svg viewBox="0 0 24 24"><path d="M4.9 4.9 17.2 10l-4.9 1.7a.9.9 0 0 0-.6.6L10 17.2zm8.2 9.6 5.3 5.3a.9.9 0 1 0 1.4-1.4l-5.3-5.3 5.9-2a1 1 0 0 0 0-1.9l-17-7a1 1 0 0 0-1.3 1.3l7 17a1 1 0 0 0 1.9-.1z"/></svg>',o.className="w-6 fill-zinc-400 p-1 hover:fill-zinc-300 hover:bg-[rgba(255,255,255,0.05)]",o.addEventListener("click",(()=>{const t=o.classList.toggle("enabled");o.classList.toggle("bg-zinc-600",t),o.classList.toggle("hover:bg-zinc-600",t),o.classList.toggle("fill-zinc-100",t),o.classList.toggle("hover:fill-zinc-100",t),p.dispatchEvent({enabled:t,type:"enable-select"})}),{passive:!0}),e.append(o),s("World"),n("World"),{addPane:e=>{const i=document.createElement("section");return i.className="h-screen flex flex-col overflow-x-hidden overflow-y-auto hidden",i.dataset.pane=e,t.insertBefore(i,t.children[t.children.length-2]),s(e),Ee(i)}}})(n,s);return e.push((t=>{const e=document.createElement("div");e.className="sticky bottom-0 h-[105px]",t.append(e);const i=new r.Pane({container:e});i.registerPlugin(_e),i.addSeparator();const n=1048576,{memory:s}=performance,o={memory:s?s.usedJSHeapSize/n:0,time:""},a=performance.now();let l=0;const h=()=>{l=(performance.now()-a)/1e3;const t=l%60|0,e=l/60|0,i=l/60/60|0;o.time=`${i<10?`0${i}`:i}:${e<10?`0${e}`:e}:${t<10?`0${t}`:t}`};h();const d=setInterval(h,1e3);i.addMonitor(o,"time",{interval:1e3});const c=i.addBlade({label:"fps",lineCount:2,view:"fpsgraph"});let p=-1;s&&(i.addMonitor(o,"memory",{max:s.jsHeapSizeLimit/n,min:0,view:"graph"}),p=setInterval((()=>{o.memory=s.usedJSHeapSize/n}),3e3));const u=()=>{const t=c;t.end(),t.begin()};return z(u),()=>{i.dispose(),clearInterval(d),clearInterval(p),L(u)}})(n)),e.push(ei(a,o,h)),i.append(n),document.body.append(i),{addPane:d,disposers:e}},ni=document.createElement("style");ni.textContent='*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.visible{visibility:visible}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.bottom-0{bottom:0}.left-0{left:0}.right-0{right:0}.top-0{top:0}.z-10{z-index:10}.z-50{z-index:50}.z-\\[100\\]{z-index:100}.inline{display:inline}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-\\[105px\\]{height:105px}.h-screen{height:100vh}.w-6{width:1.5rem}.w-\\[350px\\]{width:350px}.w-full{width:100%}.w-screen{width:100vw}.grow{flex-grow:1}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.resize{resize:both}.flex-col{flex-direction:column}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.bg-\\[\\#28292e\\]{--tw-bg-opacity: 1;background-color:rgb(40 41 46 / var(--tw-bg-opacity))}.bg-\\[\\#333\\]{--tw-bg-opacity: 1;background-color:rgb(51 51 51 / var(--tw-bg-opacity))}.bg-zinc-400{--tw-bg-opacity: 1;background-color:rgb(161 161 170 / var(--tw-bg-opacity))}.bg-zinc-600{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity))}.fill-zinc-100{fill:#f4f4f5}.fill-zinc-400{fill:#a1a1aa}.p-1{padding:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\\.5{padding-top:.375rem;padding-bottom:.375rem}.font-mono{font-family:var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace)}.text-\\[11px\\]{font-size:11px}.text-zinc-400{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity))}.text-zinc-800{--tw-text-opacity: 1;color:rgb(39 39 42 / var(--tw-text-opacity))}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.invert{--tw-invert: invert(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}*{--bs-br: 0px !important;scrollbar-width:none}*::-webkit-scrollbar{display:none}.tp-grlv_g{height:30px!important}.tp-imgv{height:20px!important;transition:.2s!important}.tp-imgv:hover{height:80px!important}.tp-rotv_c{height:0!important;padding:0!important;margin-top:5px;width:100%!important}.stats .tp-rotv_c{height:auto!important}.orbit-controls-gizmo{position:absolute;top:10px;left:-90px;z-index:10}.hover\\:bg-\\[rgba\\(255\\,255\\,255\\,0\\.05\\)\\]:hover{background-color:#ffffff0d}.hover\\:bg-zinc-600:hover{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity))}.hover\\:fill-zinc-100:hover{fill:#f4f4f5}.hover\\:fill-zinc-300:hover{fill:#d4d4d8}\n',document.head.append(ni);const{scene:si,camera:oi,renderer:ri}=i(),ai=new class{constructor({THREE:t,scene:i,camera:n,renderer:s,composer:o,options:r={}}){if(e(this,"disposers",[]),e(this,"addPane"),!t){throw new Error("three-inspect constructor arguments have changed. Consult docs for new args: https://www.npmjs.com/package/three-inspect")}u.THREE=t,u.scene=i,u.camera=n,u.renderer=s,u.composer=o??null,yt.install({THREE:t});const{disposers:a,addPane:h}=ii({location:"right",...r});this.addPane=h,this.disposers.push(...a),this.disposers.push((()=>{const{THREE:t,scene:e}=u;return Ze.axes=new t.AxesHelper(1e3),Ze.axes.name="Axes helper",Ze.axes.userData.THREE_INSPECT_OMIT=!0,Ze.grid=new t.GridHelper(Qe.gridSize,Qe.gridDivisions),Ze.grid.name="Grid helper",Ze.grid.userData.THREE_INSPECT_OMIT=!0,Xe&&e.add(Ze.grid),We&&e.add(Ze.axes),()=>{e.remove(Ze.grid,Ze.axes)}})());const d=l.getNumber("controls");null!==d&&C(d,n),E=requestAnimationFrame(k)}registerPlugin(t){this.disposers.push(t(this))}dispose(){cancelAnimationFrame(E);for(let t=this.disposers.length-1;t>-1;t-=1)this.disposers[t]();this.disposers.slice(0,this.disposers.length)}}({THREE:n,scene:si,camera:oi,renderer:ri});export{ai as d};
