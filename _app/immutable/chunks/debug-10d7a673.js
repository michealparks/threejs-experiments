var t,e,i,n,s,o,r,a,l,h,p,d,c,u,v,m,g,b,w,f,_,x,y,C,k,E,P,M,L,V,z,A,S,I,D,R,T,j,N,F,O,B,K,U,$,q,H,W,Y,X,G,Z,Q,J,tt,et,it,nt,st,ot,rt,at,lt,ht,pt,dt,ct,ut,vt,mt,gt,bt,wt=Object.defineProperty,ft=(t,e,i)=>(((t,e,i)=>{e in t?wt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i),_t=(t,e,i)=>{if(!e.has(t))throw TypeError("Cannot "+i)},xt=(t,e,i)=>(_t(t,e,"read from private field"),i?i.call(t):e.get(t)),yt=(t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},Ct=(t,e,i,n)=>(_t(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i),kt=(t,e,i)=>(_t(t,e,"access private method"),i);import{T as Et,s as Pt,c as Mt,r as Lt,b as Vt}from"./index-096e168f.js";function zt(t,e){for(var i=0;i<e.length;i++){const n=e[i];if("string"!=typeof n&&!Array.isArray(n))for(const e in n)if("default"!==e&&!(e in t)){const i=Object.getOwnPropertyDescriptor(n,e);i&&Object.defineProperty(t,e,i.get?i:{enumerable:!0,get:()=>n[e]})}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"&&self;function At(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var St={exports:{}};
/*! Tweakpane 3.1.0 (c) 2016 cocopon, licensed under the MIT license. */!function(t){class e{constructor(t){const[e,i]=t.split("-"),n=e.split(".");this.major=parseInt(n[0],10),this.minor=parseInt(n[1],10),this.patch=parseInt(n[2],10),this.prerelease=i??null}toString(){const t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}class i{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class n{constructor(t){this.target=t}}class s extends n{constructor(t,e,i,n){super(t),this.value=e,this.presetKey=i,this.last=n??!0}}class o extends n{constructor(t,e,i){super(t),this.value=e,this.presetKey=i}}class r extends n{constructor(t,e){super(t),this.expanded=e}}class a extends n{constructor(t,e){super(t),this.index=e}}function l(t){return null==t}function h(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const p={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class d{constructor(t){var e;this.message=null!==(e=p[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new d({type:"alreadydisposed"})}static notBindable(){return new d({type:"notbindable"})}static propertyNotFound(t){return new d({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new d({type:"shouldneverhappen"})}}class c{constructor(t,e,i){this.obj_=t,this.key_=e,this.presetKey_=i??e}static isBindable(t){return!(null===t||"object"!=typeof t)}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const i=this.read();if(!c.isBindable(i))throw d.notBindable();if(!(t in i))throw d.propertyNotFound(t);i[t]=e}}class u extends i{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const i=e.bind(this);return this.controller_.valueController.emitter.on(t,(()=>{i(new n(this))})),this}}class v{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter((t=>t.handler!==e))),this}emit(t,e){const i=this.observers_[t];!i||i.forEach((t=>{t.handler(e)}))}}const m="tp";function g(t){return(e,i)=>[m,"-",t,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function b(t,e){return i=>e(t(i))}function w(t){return t.rawValue}function f(t,e){t.emitter.on("change",b(w,e)),e(t.rawValue)}function _(t,e,i){f(t.value(e),i)}function x(t,e,i){i?t.classList.add(e):t.classList.remove(e)}function y(t,e){return i=>{x(t,e,i)}}function C(t,e){f(t,(t=>{e.textContent=t??""}))}const k=g("btn");class E{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(k()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(k("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElement("div");n.classList.add(k("t")),C(e.props.value("title"),n),this.buttonElement.appendChild(n)}}class P{constructor(t,e){this.emitter=new v,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new E(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class M{constructor(t,e){var i;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(i=null==e?void 0:e.equals)&&void 0!==i?i:(t,e)=>t===e,this.emitter=new v,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(t):t;this.equals_(this.rawValue_,n)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:i,rawValue:n,sender:this}))}}class L{constructor(t){this.emitter=new v,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0};this.value_===t&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:i,rawValue:this.value_,sender:this}))}}function V(t,e){const i=null==e?void 0:e.constraint,n=null==e?void 0:e.equals;return i||n?new M(t,e):new L(t)}class z{constructor(t){this.emitter=new v,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,i)=>Object.assign(e,{[i]:V(t[i])})),{})}static fromObject(t){const e=this.createCore(t);return new z(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function A(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function S(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function I(t){return null!==t&&"object"==typeof t}function D(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function R(t){return{custom:e=>D(e)(t),boolean:D((t=>"boolean"==typeof t?t:void 0))(t),number:D((t=>"number"==typeof t?t:void 0))(t),string:D((t=>"string"==typeof t?t:void 0))(t),function:D((t=>"function"==typeof t?t:void 0))(t),constant:e=>D((t=>t===e?e:void 0))(t),raw:D((t=>t))(t),object:e=>D((t=>{if(I(t))return A(t,e)}))(t),array:e=>D((t=>{if(Array.isArray(t))return S(t,e)}))(t)}}const T={optional:R(!0),required:R(!1)};function j(t,e){const i=T.required.object(e)(t);return i.succeeded?i.value:void 0}function N(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}function F(){return["veryfirst","first","last","verylast"]}const O=g(""),B={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class K{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{F().forEach((t=>{e.classList.remove(O(void 0,B[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(O(void 0,B[t]))}))})),this.viewProps.handleDispose((()=>{N(e)}))}get parent(){return this.parent_}}const U="http://www.w3.org/2000/svg";function $(t){t.offsetHeight}function q(t,e){const i=t.style.transition;t.style.transition="none",e(),t.style.transition=i}function H(t){return void 0!==t.ontouchstart}function W(){return new Function("return this")()}function Y(){return W().document}function X(t){const e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d"):null}const G={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Z(t,e){const i=t.createElementNS(U,"svg");return i.innerHTML=G[e],i}function Q(t,e,i){t.insertBefore(e,t.children[i])}function J(t){t.parentElement&&t.parentElement.removeChild(t)}function tt(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function et(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function it(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const nt=g("lbl");function st(t,e){const i=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,n)=>{n>0&&i.appendChild(t.createElement("br")),i.appendChild(e)})),i}class ot{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(nt()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(nt("l")),_(e.props,"label",(e=>{l(e)?this.element.classList.add(nt(void 0,"nol")):(this.element.classList.remove(nt(void 0,"nol")),et(i),i.appendChild(st(t,e)))})),this.element.appendChild(i),this.labelElement=i;const n=t.createElement("div");n.classList.add(nt("v")),this.element.appendChild(n),this.valueElement=n}}class rt extends K{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new ot(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const at={id:"button",type:"blade",accept(t){const e=T,i=j(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return i?{params:i}:null},controller:t=>new rt(t.document,{blade:t.blade,props:z.fromObject({label:t.params.label}),valueController:new P(t.document,{props:z.fromObject({title:t.params.title}),viewProps:t.viewProps})}),api:t=>t.controller instanceof rt&&t.controller.valueController instanceof P?new u(t.controller):null};class lt extends K{constructor(t){super(t),this.value=t.value}}function ht(){return new z({positions:V([],{equals:h})})}class pt extends z{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=z.createCore(e);return new pt(i)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!l(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const i=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};_(this,"expanded",i),_(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function dt(t,e){let i=0;return q(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),$(e),i=e.clientHeight,t.set("temporaryExpanded",null),$(e)})),i}function ct(t,e){e.style.height=t.styleHeight}function ut(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),l(t.get("expandedHeight"))&&t.set("expandedHeight",dt(t,e)),t.set("shouldFixHeight",!0),$(e)})),t.emitter.on("change",(()=>{ct(t,e)})),ct(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&t.cleanUpTransition()}))}class vt extends i{constructor(t,e){super(t),this.rackApi_=e}}function mt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function gt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function bt(t,e){const i=e??{};return t.addBlade(Object.assign(Object.assign({},i),{view:"separator"}))}function wt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}class ft{constructor(t){this.emitter=new v,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw d.shouldNeverHappen();const i=void 0!==e?e:this.items_.length;this.items_.splice(i,0,t),this.cache_.add(t);const n=this.extract_(t);n&&(n.emitter.on("add",this.onSubListAdd_),n.emitter.on("remove",this.onSubListRemove_),n.allItems().forEach((t=>{this.cache_.add(t)}))),this.emitter.emit("add",{index:i,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const i=this.extract_(t);i&&(i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}class _t extends i{constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new v,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new s(this,e,this.controller_.binding.target.presetKey,t.options.last)})}}class xt extends rt{constructor(t,e){super(t,e),this.binding=e.binding}}class yt extends i{constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new v,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new o(this,e,this.controller_.binding.target.presetKey)})}}class Ct extends rt{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function kt(t){return t instanceof Mt?t.apiSet_:t instanceof vt?t.rackApi_.apiSet_:null}function Et(t,e){const i=t.find((t=>t.controller_===e));if(!i)throw d.shouldNeverHappen();return i}function Pt(t,e,i){if(!c.isBindable(t))throw d.notBindable();return new c(t,e,i)}class Mt extends i{constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new v,this.apiSet_=new ft(kt),this.pool_=e;const i=this.controller_.rack;i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),i.emitter.on("inputchange",this.onRackInputChange_),i.emitter.on("monitorupdate",this.onRackMonitorUpdate_),i.children.forEach((t=>{this.setUpApi_(t)}))}get children(){return this.controller_.rack.children.map((t=>Et(this.apiSet_,t)))}addInput(t,e,i){const n=i??{},s=this.controller_.view.element.ownerDocument,o=this.pool_.createInput(s,Pt(t,e,n.presetKey),n),r=new _t(o);return this.add(r,n.index)}addMonitor(t,e,i){const n=i??{},s=this.controller_.view.element.ownerDocument,o=this.pool_.createMonitor(s,Pt(t,e),n),r=new yt(o);return this.add(r,n.index)}addFolder(t){return gt(this,t)}addButton(t){return mt(this,t)}addSeparator(t){return bt(this,t)}addTab(t){return wt(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const i=this.apiSet_.find((e=>e.controller_===t.controller_));return i&&this.apiSet_.remove(i),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,i=this.pool_.createBlade(e,t),n=this.pool_.createBladeApi(i);return this.add(n,t.index)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}setUpApi_(t){this.apiSet_.find((e=>e.controller_===t))||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=Et(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof xt){const i=Et(this.apiSet_,e),n=e.binding;this.emitter_.emit("change",{event:new s(i,n.target.read(),n.target.presetKey,t.options.last)})}else if(e instanceof lt){const i=Et(this.apiSet_,e);this.emitter_.emit("change",{event:new s(i,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof Ct))throw d.shouldNeverHappen();const e=Et(this.apiSet_,t.bladeController),i=t.bladeController.binding;this.emitter_.emit("update",{event:new o(e,i.target.read(),i.target.presetKey)})}}class Lt extends vt{constructor(t,e){super(t,new Mt(t.rackController,e)),this.emitter_=new v,this.controller_.foldable.value("expanded").emitter.on("change",(t=>{this.emitter_.emit("fold",{event:new r(this,t.sender.rawValue)})})),this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})}))}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,i){return this.rackApi_.addInput(t,e,i)}addMonitor(t,e,i){return this.rackApi_.addMonitor(t,e,i)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class Vt extends K{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class zt{constructor(t,e){const i=g(e.viewName);this.element=t.createElement("div"),this.element.classList.add(i()),e.viewProps.bindClassModifiers(this.element)}}function At(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(n instanceof xt&&n.binding===e)return n}return null}function St(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(n instanceof Ct&&n.binding===e)return n}return null}function It(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(n instanceof lt&&n.value===e)return n}return null}function Dt(t){return t instanceof jt?t.rack:t instanceof Vt?t.rackController.rack:null}function Rt(t){const e=Dt(t);return e?e.bcSet_:null}class Tt{constructor(t){var e;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new v,this.blade_=t??null,null===(e=this.blade_)||void 0===e||e.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new ft(Rt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){t.parent&&t.parent.remove(t),t.parent_=this,this.bcSet_.add(t,e)}remove(t){t.parent_=null,this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter((e=>e instanceof t))}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const i=t.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),i instanceof xt)i.binding.emitter.on("change",this.onChildInputChange_);else if(i instanceof Ct)i.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(i instanceof lt)i.value.emitter.on("change",this.onChildValueChange_);else{const t=Dt(i);if(t){const e=t.emitter;e.on("layout",this.onDescendantLayout_),e.on("inputchange",this.onDescendantInputChange_),e.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const i=t.item;if(i instanceof xt)i.binding.emitter.off("change",this.onChildInputChange_);else if(i instanceof Ct)i.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(i instanceof lt)i.value.emitter.off("change",this.onChildValueChange_);else{const t=Dt(i);if(t){const e=t.emitter;e.off("layout",this.onDescendantLayout_),e.off("inputchange",this.onDescendantInputChange_),e.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter((t=>!t.viewProps.get("hidden"))),e=t[0],i=t[t.length-1];this.bcSet_.items.forEach((t=>{const n=[];t===e&&(n.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&n.push("veryfirst")),t===i&&(n.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&n.push("verylast")),t.blade.set("positions",n)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((t=>t.viewProps.get("disposed"))).forEach((t=>{this.bcSet_.remove(t)}))}onChildInputChange_(t){const e=At(this.find(xt),t.sender);if(!e)throw d.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=St(this.find(Ct),t.sender);if(!e)throw d.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=It(this.find(lt),t.sender);if(!e)throw d.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class jt extends K{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new zt(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const i=new Tt(e.root?void 0:e.blade);i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),this.rack=i,this.viewProps.handleDispose((()=>{for(let t=this.rack.children.length-1;t>=0;t--)this.rack.children[t].viewProps.set("disposed",!0)}))}onRackAdd_(t){!t.isRoot||Q(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){!t.isRoot||J(t.bladeController.view.element)}}const Nt=g("cnt");class Ft{constructor(t,e){var i;this.className_=g(null!==(i=e.viewName)&&void 0!==i?i:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),Nt()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),_(this.foldable_,"completed",y(this.element,this.className_(void 0,"cpl")));const n=t.createElement("button");n.classList.add(this.className_("b")),_(e.props,"title",(t=>{l(t)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const s=t.createElement("div");s.classList.add(this.className_("t")),C(e.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s;const o=t.createElement("div");o.classList.add(this.className_("m")),this.buttonElement.appendChild(o);const r=e.containerElement;r.classList.add(this.className_("c")),this.element.appendChild(r),this.containerElement=r}}class Ot extends Vt{constructor(t,e){var i;const n=pt.create(null===(i=e.expanded)||void 0===i||i),s=new jt(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:s,view:new Ft(t,{containerElement:s.view.element,foldable:n,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=n,ut(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Bt={id:"folder",type:"blade",accept(t){const e=T,i=j(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return i?{params:i}:null},controller:t=>new Ot(t.document,{blade:t.blade,expanded:t.params.expanded,props:z.fromObject({title:t.params.title}),viewProps:t.viewProps}),api:t=>t.controller instanceof Ot?new Lt(t.controller,t.pool):null};class Kt extends lt{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new ot(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Ut extends i{}const $t=g("spr");class qt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add($t()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("hr");i.classList.add($t("r")),this.element.appendChild(i)}}class Ht extends K{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new qt(t,{viewProps:e.viewProps})}))}}const Wt={id:"separator",type:"blade",accept(t){const e=j(t,{view:T.required.constant("separator")});return e?{params:e}:null},controller:t=>new Ht(t.document,{blade:t.blade,viewProps:t.viewProps}),api:t=>t.controller instanceof Ht?new Ut(t.controller):null},Yt=g("");function Xt(t,e){return y(t,Yt(void 0,e))}class Gt extends z{constructor(t){super(t)}static create(t){var e,i;const n=t??{},s={disabled:null!==(e=n.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=n.hidden)&&void 0!==i&&i},o=z.createCore(s);return new Gt(o)}bindClassModifiers(t){_(this,"disabled",Xt(t,"disabled")),_(this,"hidden",Xt(t,"hidden"))}bindDisabled(t){_(this,"disabled",(e=>{t.disabled=e}))}bindTabIndex(t){_(this,"disabled",(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}}const Zt=g("tbi");class Qt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Zt()),e.viewProps.bindClassModifiers(this.element),_(e.props,"selected",(t=>{t?this.element.classList.add(Zt(void 0,"sel")):this.element.classList.remove(Zt(void 0,"sel"))}));const i=t.createElement("button");i.classList.add(Zt("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElement("div");n.classList.add(Zt("t")),C(e.props.value("title"),n),this.buttonElement.appendChild(n),this.titleElement=n}}class Jt{constructor(t,e){this.emitter=new v,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Qt(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class te{constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Jt(t,{props:e.itemProps,viewProps:Gt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new jt(t,{blade:ht(),viewProps:Gt.create()}),this.props=e.props,_(this.props,"selected",(t=>{this.itemController.props.set("selected",t),this.contentController.viewProps.set("hidden",!t)}))}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class ee{constructor(t,e){this.controller_=t,this.rackApi_=e}get title(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,i){return this.rackApi_.addInput(t,e,i)}addMonitor(t,e,i){return this.rackApi_.addMonitor(t,e,i)}addBlade(t){return this.rackApi_.addBlade(t)}}class ie extends vt{constructor(t,e){super(t,new Mt(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new v,this.pageApiMap_=new Map,this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})})),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((t=>{this.setUpPageApi_(t)}))}get pages(){return this.controller_.pageSet.items.map((t=>{const e=this.pageApiMap_.get(t);if(!e)throw d.shouldNeverHappen();return e}))}addPage(t){const e=this.controller_.view.element.ownerDocument,i=new te(e,{itemProps:z.fromObject({selected:!1,title:t.title}),props:z.fromObject({selected:!1})});this.controller_.add(i,t.index);const n=this.pageApiMap_.get(i);if(!n)throw d.shouldNeverHappen();return n}removePage(t){this.controller_.remove(t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find((e=>e.controller_===t.contentController));if(!e)throw d.shouldNeverHappen();const i=new ee(t,e);this.pageApiMap_.set(t,i)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw d.shouldNeverHappen();this.pageApiMap_.delete(t.item)}onSelect_(t){this.emitter_.emit("select",{event:new a(this,t.rawValue)})}}const ne=-1;class se{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=V(!0),this.selectedIndex=V(ne),this.items_=[]}add(t,e){const i=e??this.items_.length;this.items_.splice(i,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=ne,void(this.empty.rawValue=!0);const t=this.items_.findIndex((t=>t.rawValue));t<0?(this.items_.forEach(((t,e)=>{t.rawValue=0===e})),this.selectedIndex.rawValue=0):(this.items_.forEach(((e,i)=>{e.rawValue=i===t})),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex((e=>e===t.sender));this.items_.forEach(((t,i)=>{t.rawValue=i===e})),this.selectedIndex.rawValue=e}else this.keepSelection_()}}const oe=g("tab");class re{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(oe(),Nt()),e.viewProps.bindClassModifiers(this.element),f(e.empty,y(this.element,oe(void 0,"nop")));const i=t.createElement("div");i.classList.add(oe("i")),this.element.appendChild(i),this.itemsElement=i;const n=e.contentsElement;n.classList.add(oe("c")),this.element.appendChild(n),this.contentsElement=n}}class ae extends Vt{constructor(t,e){const i=new jt(t,{blade:e.blade,viewProps:e.viewProps}),n=new se;super({blade:e.blade,rackController:i,view:new re(t,{contentsElement:i.view.element,empty:n.empty,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new ft((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=n}get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,e)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}onPageAdd_(t){const e=t.item;Q(this.view.itemsElement,e.itemController.view.element,t.index),this.rackController.rack.add(e.contentController,t.index),this.tab.add(e.props.value("selected"))}onPageRemove_(t){const e=t.item;J(e.itemController.view.element),this.rackController.rack.remove(e.contentController),this.tab.remove(e.props.value("selected"))}}const le={id:"tab",type:"blade",accept(t){const e=T,i=j(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return i&&0!==i.pages.length?{params:i}:null},controller(t){const e=new ae(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((i=>{const n=new te(t.document,{itemProps:z.fromObject({selected:!1,title:i.title}),props:z.fromObject({selected:!1})});e.add(n)})),e},api:t=>t.controller instanceof ae?new ie(t.controller,t.pool):null};function he(t,e){const i=t.accept(e.params);if(!i)return null;const n=T.optional.boolean(e.params.disabled).value,s=T.optional.boolean(e.params.hidden).value;return t.controller({blade:ht(),document:e.document,params:Object.assign(Object.assign({},i.params),{disabled:n,hidden:s}),viewProps:Gt.create({disabled:n,hidden:s})})}class pe{constructor(){this.disabled=!1,this.emitter=new v}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class de{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new v,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class ce{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function ue(t,e){if(t instanceof e)return t;if(t instanceof ce){const i=t.constraints.reduce(((t,i)=>t||(i instanceof e?i:null)),null);if(i)return i}return null}class ve{constructor(t){this.options=t}constrain(t){const e=this.options;return 0===e.length||e.filter((e=>e.value===t)).length>0?t:e[0].value}}class me{constructor(t){this.maxValue=t.max,this.minValue=t.min}constrain(t){let e=t;return l(this.minValue)||(e=Math.max(e,this.minValue)),l(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}class ge{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}const be=g("lst");class we{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(be()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("select");i.classList.add(be("s")),_(this.props_,"options",(e=>{tt(i),e.forEach(((e,n)=>{const s=t.createElement("option");s.dataset.index=String(n),s.textContent=e.text,s.value=String(e.value),i.appendChild(s)}))})),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const n=t.createElement("div");n.classList.add(be("m")),n.appendChild(Z(t,"dropdown")),this.element.appendChild(n),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class fe{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new we(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=t.currentTarget.selectedOptions.item(0);if(!e)return;const i=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[i].value}}const _e=g("pop");class xe{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(_e()),e.viewProps.bindClassModifiers(this.element),f(e.shows,y(this.element,_e(void 0,"v")))}}class ye{constructor(t,e){this.shows=V(!1),this.viewProps=e.viewProps,this.view=new xe(t,{shows:this.shows,viewProps:this.viewProps})}}const Ce=g("txt");class ke{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Ce()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const i=t.createElement("input");i.classList.add(Ce("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class Ee{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ke(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);l(i)||(this.value.rawValue=i),this.view.refresh()}}function Pe(t){return String(t)}function Me(t){return"false"!==t&&!!t}function Le(t){return Pe(t)}class Ve{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const ze={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class Ae{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=ze[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Se={"+":t=>t,"-":t=>-t,"~":t=>~t};class Ie{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=Se[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function De(t){return(e,i)=>{for(let n=0;n<t.length;n++){const s=t[n](e,i);if(""!==s)return s}return""}}function Re(t,e){var i;const n=t.substr(e).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Te(t,e){const i=t.substr(e,1);return i.match(/^[1-9]$/)?i:""}function je(t,e){var i;const n=t.substr(e).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Ne(t,e){const i=je(t,e);if(""!==i)return i;const n=t.substr(e,1);if("-"!==n&&"+"!==n)return"";const s=je(t,e+=1);return""===s?"":n+s}function Fe(t,e){const i=t.substr(e,1);if(e+=1,"e"!==i.toLowerCase())return"";const n=Ne(t,e);return""===n?"":i+n}function Oe(t,e){const i=t.substr(e,1);if("0"===i)return i;const n=Te(t,e);return e+=n.length,""===n?"":n+je(t,e)}function Be(t,e){const i=Oe(t,e);if(e+=i.length,""===i)return"";const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const s=je(t,e);return i+n+s+Fe(t,e+=s.length)}function Ke(t,e){const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const n=je(t,e);return e+=n.length,""===n?"":i+n+Fe(t,e)}function Ue(t,e){const i=Oe(t,e);return e+=i.length,""===i?"":i+Fe(t,e)}const $e=De([Be,Ke,Ue]);function qe(t,e){var i;const n=t.substr(e).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function He(t,e){const i=t.substr(e,2);if(e+=i.length,"0b"!==i.toLowerCase())return"";const n=qe(t,e);return""===n?"":i+n}function We(t,e){var i;const n=t.substr(e).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Ye(t,e){const i=t.substr(e,2);if(e+=i.length,"0o"!==i.toLowerCase())return"";const n=We(t,e);return""===n?"":i+n}function Xe(t,e){var i;const n=t.substr(e).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Ge(t,e){const i=t.substr(e,2);if(e+=i.length,"0x"!==i.toLowerCase())return"";const n=Xe(t,e);return""===n?"":i+n}const Ze=De([He,Ye,Ge]),Qe=De([Ze,$e]);function Je(t,e){const i=Qe(t,e);return e+=i.length,""===i?null:{evaluable:new Ve(i),cursor:e}}function ti(t,e){const i=t.substr(e,1);if(e+=i.length,"("!==i)return null;const n=ri(t,e);if(!n)return null;e=n.cursor,e+=Re(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:n.evaluable,cursor:e}}function ei(t,e){var i;return null!==(i=Je(t,e))&&void 0!==i?i:ti(t,e)}function ii(t,e){const i=ei(t,e);if(i)return i;const n=t.substr(e,1);if(e+=n.length,"+"!==n&&"-"!==n&&"~"!==n)return null;const s=ii(t,e);return s?{cursor:e=s.cursor,evaluable:new Ie(n,s.evaluable)}:null}function ni(t,e,i){i+=Re(e,i).length;const n=t.filter((t=>e.startsWith(t,i)))[0];return n?(i+=n.length,{cursor:i+=Re(e,i).length,operator:n}):null}function si(t,e){return(i,n)=>{const s=t(i,n);if(!s)return null;n=s.cursor;let o=s.evaluable;for(;;){const s=ni(e,i,n);if(!s)break;n=s.cursor;const r=t(i,n);if(!r)return null;n=r.cursor,o=new Ae(s.operator,o,r.evaluable)}return o?{cursor:n,evaluable:o}:null}}const oi=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>si(t,e)),ii);function ri(t,e){return e+=Re(t,e).length,oi(t,e)}function ai(t){const e=ri(t,0);return e&&e.cursor+Re(t,e.cursor).length===t.length?e.evaluable:null}function li(t){var e;const i=ai(t);return null!==(e=null==i?void 0:i.evaluate())&&void 0!==e?e:null}function hi(t){if("number"==typeof t)return t;if("string"==typeof t){const e=li(t);if(!l(e))return e}return 0}function pi(t){return String(t)}function di(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}const ci=di(0);function ui(t){return ci(t)+"%"}function vi(t){return String(t)}function mi(t){return t}function gi(t,e){for(;t.length<e;)t.push(void 0)}function bi(t){const e=[];return gi(e,t),V(e)}function wi(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function fi(t,e){const i=[...wi(t),e];return i.length>t.length?i.splice(0,i.length-t.length):gi(i,t.length),i}function _i({primary:t,secondary:e,forward:i,backward:n}){let s=!1;function o(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(n=>{o((()=>{e.setRawValue(i(t,e),n.options)}))})),e.emitter.on("change",(s=>{o((()=>{t.setRawValue(n(t,e),s.options)})),o((()=>{e.setRawValue(i(t,e),s.options)}))})),o((()=>{e.setRawValue(i(t,e),{forceEmit:!1,last:!0})}))}function xi(t,e){const i=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function yi(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Ci(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function ki(t){return"ArrowUp"===t||"ArrowDown"===t}function Ei(t){return ki(t)||"ArrowLeft"===t||"ArrowRight"===t}function Pi(t,e){var i,n;const s=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:t.pageX-((null!==(i=s&&s.scrollX)&&void 0!==i?i:0)+o.left),y:t.pageY-((null!==(n=s&&s.scrollY)&&void 0!==n?n:0)+o.top)}}class Mi{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new v,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Pi(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Pi(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Pi(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const i=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Li(t,e,i,n,s){return n+(t-e)/(i-e)*(s-n)}function Vi(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function zi(t,e,i){return Math.min(Math.max(t,e),i)}function Ai(t,e){return(t%e+e)%e}const Si=g("txt");class Ii{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Si(),Si(void 0,"num")),e.arrayPosition&&this.element.classList.add(Si(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(Si("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Si()),this.inputElement.classList.add(Si("i"));const n=t.createElement("div");n.classList.add(Si("k")),this.element.appendChild(n),this.knobElement=n;const s=t.createElementNS(U,"svg");s.classList.add(Si("g")),this.knobElement.appendChild(s);const o=t.createElementNS(U,"path");o.classList.add(Si("gb")),s.appendChild(o),this.guideBodyElem_=o;const r=t.createElementNS(U,"path");r.classList.add(Si("gh")),s.appendChild(r),this.guideHeadElem_=r;const a=t.createElement("div");a.classList.add(g("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(Si(void 0,"drg"));this.element.classList.add(Si(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),n=zi(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Di{constructor(t,e){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=null!==(i=e.sliderProps)&&void 0!==i?i:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=V(null),this.view=new Ii(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new Mi(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,i;const n=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("minValue"),s=null===(i=this.sliderProps_)||void 0===i?void 0:i.get("maxValue");let o=t;return void 0!==n&&(o=Math.max(o,n)),void 0!==s&&(o=Math.min(o,s)),o}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);l(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()}onInputKeyDown_(t){const e=xi(this.baseStep_,yi(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==xi(this.baseStep_,yi(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Ri=g("sld");class Ti{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Ri()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Ri("t")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const n=t.createElement("div");n.classList.add(Ri("k")),this.trackElement.appendChild(n),this.knobElement=n,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=zi(Li(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}}class ji{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new Ti(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mi(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){!t.point||this.value.setRawValue(Li(zi(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=xi(this.baseStep_,Ci(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){0!==xi(this.baseStep_,Ci(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ni=g("sldtxt");class Fi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ni());const i=t.createElement("div");i.classList.add(Ni("s")),this.sliderView_=e.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Ni("t")),this.textView_=e.textView,n.appendChild(this.textView_.element),this.element.appendChild(n)}}class Oi{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new ji(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new Di(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new Fi(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Bi(t,e){t.write(e)}function Ki(t){const e=T;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function Ui(t){if("inline"===t||"popup"===t)return t}function $i(t){const e=T;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function qi(t){if(Array.isArray(t))return t;const e=[];return Object.keys(t).forEach((i=>{e.push({text:i,value:t[i]})})),e}function Hi(t){return l(t)?null:new ve(qi(t))}function Wi(t){const e=t?ue(t,ve):null;return e?e.options:null}function Yi(t){const e=t?ue(t,ge):null;return e?e.step:null}function Xi(t,e){const i=t&&ue(t,ge);return i?Vi(i.step):Math.max(Vi(e),2)}function Gi(t){return Yi(t)??1}function Zi(t,e){var i;const n=t&&ue(t,ge),s=Math.abs(null!==(i=null==n?void 0:n.step)&&void 0!==i?i:e);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}const Qi=g("ckb");class Ji{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Qi()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("label");i.classList.add(Qi("l")),this.element.appendChild(i);const n=t.createElement("input");n.classList.add(Qi("i")),n.type="checkbox",i.appendChild(n),this.inputElement=n,e.viewProps.bindDisabled(this.inputElement);const s=t.createElement("div");s.classList.add(Qi("w")),i.appendChild(s);const o=Z(t,"check");s.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class tn{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Ji(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked}}function en(t){const e=[],i=Hi(t.options);return i&&e.push(i),new ce(e)}const nn={id:"input-bool",type:"input",accept:(t,e)=>{if("boolean"!=typeof t)return null;const i=j(e,{options:T.optional.custom(Ki)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Me,constraint:t=>en(t.params),writer:t=>Bi},controller:t=>{var e;const i=t.document,n=t.value,s=t.constraint;return s&&ue(s,ve)?new fe(i,{props:z.fromObject({options:null!==(e=Wi(s))&&void 0!==e?e:[]}),value:n,viewProps:t.viewProps}):new tn(i,{value:n,viewProps:t.viewProps})}},sn=g("col");class on{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(sn()),e.foldable.bindExpandedClass(this.element,sn(void 0,"expanded")),_(e.foldable,"completed",y(this.element,sn(void 0,"cpl")));const i=t.createElement("div");i.classList.add(sn("h")),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(sn("s")),i.appendChild(n),this.swatchElement=n;const s=t.createElement("div");if(s.classList.add(sn("t")),i.appendChild(s),this.textElement=s,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(sn("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}function rn(t,e,i){const n=zi(t/255,0,1),s=zi(e/255,0,1),o=zi(i/255,0,1),r=Math.max(n,s,o),a=Math.min(n,s,o),l=r-a;let h=0,p=0;const d=(a+r)/2;return 0!==l&&(p=l/(1-Math.abs(r+a-1)),h=n===r?(s-o)/l:s===r?2+(o-n)/l:4+(n-s)/l,h=h/6+(h<0?1:0)),[360*h,100*p,100*d]}function an(t,e,i){const n=(t%360+360)%360,s=zi(e/100,0,1),o=zi(i/100,0,1),r=(1-Math.abs(2*o-1))*s,a=r*(1-Math.abs(n/60%2-1)),l=o-r/2;let h,p,d;return[h,p,d]=n>=0&&n<60?[r,a,0]:n>=60&&n<120?[a,r,0]:n>=120&&n<180?[0,r,a]:n>=180&&n<240?[0,a,r]:n>=240&&n<300?[a,0,r]:[r,0,a],[255*(h+l),255*(p+l),255*(d+l)]}function ln(t,e,i){const n=zi(t/255,0,1),s=zi(e/255,0,1),o=zi(i/255,0,1),r=Math.max(n,s,o),a=r-Math.min(n,s,o);let l;return l=0===a?0:r===n?((s-o)/a%6+6)%6*60:r===s?60*((o-n)/a+2):60*((n-s)/a+4),[l,100*(0===r?0:a/r),100*r]}function hn(t,e,i){const n=Ai(t,360),s=zi(e/100,0,1),o=zi(i/100,0,1),r=o*s,a=r*(1-Math.abs(n/60%2-1)),l=o-r;let h,p,d;return[h,p,d]=n>=0&&n<60?[r,a,0]:n>=60&&n<120?[a,r,0]:n>=120&&n<180?[0,r,a]:n>=180&&n<240?[0,a,r]:n>=240&&n<300?[a,0,r]:[r,0,a],[255*(h+l),255*(p+l),255*(d+l)]}function pn(t,e,i){const n=i+e*(100-Math.abs(2*i-100))/200;return[t,0!==n?e*(100-Math.abs(2*i-100))/n:0,i+e*(100-Math.abs(2*i-100))/200]}function dn(t,e,i){const n=100-Math.abs(i*(200-e)/100-100);return[t,0!==n?e*i/n:0,i*(200-e)/200]}function cn(t){return[t[0],t[1],t[2]]}function un(t,e){return[t[0],t[1],t[2],e]}const vn={hsl:{hsl:(t,e,i)=>[t,e,i],hsv:pn,rgb:an},hsv:{hsl:dn,hsv:(t,e,i)=>[t,e,i],rgb:hn},rgb:{hsl:rn,hsv:ln,rgb:(t,e,i)=>[t,e,i]}};function mn(t,e){return["float"===e?1:"rgb"===t?255:360,"float"===e?1:"rgb"===t?255:100,"float"===e?1:"rgb"===t?255:100]}function gn(t,e,i){var n;const s=mn(e,i);return["rgb"===e?zi(t[0],0,s[0]):Ai(t[0],s[0]),zi(t[1],0,s[1]),zi(t[2],0,s[2]),zi(null!==(n=t[3])&&void 0!==n?n:1,0,1)]}function bn(t,e,i,n){const s=mn(e,i),o=mn(e,n);return t.map(((t,e)=>t/s[e]*o[e]))}function wn(t,e,i){const n=bn(t,e.mode,e.type,"int");return bn(vn[e.mode][i.mode](...n),i.mode,"int",i.type)}function fn(t,e){return"object"==typeof t&&!l(t)&&e in t&&"number"==typeof t[e]}class _n{constructor(t,e,i="int"){this.mode=e,this.type=i,this.comps_=gn(t,e,i)}static black(t="int"){return new _n([0,0,0],"rgb",t)}static fromObject(t,e="int"){const i="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new _n(i,"rgb",e)}static toRgbaObject(t,e="int"){return t.toRgbaObject(e)}static isRgbColorObject(t){return fn(t,"r")&&fn(t,"g")&&fn(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&fn(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode!==e.mode)return!1;const i=t.comps_,n=e.comps_;for(let s=0;s<i.length;s++)if(i[s]!==n[s])return!1;return!0}getComponents(t,e="int"){return un(wn(cn(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:e}),this.comps_[3])}toRgbaObject(t="int"){const e=this.getComponents("rgb",t);return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const xn=g("colp");class yn{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(xn());const i=t.createElement("div");i.classList.add(xn("hsv"));const n=t.createElement("div");n.classList.add(xn("sv")),this.svPaletteView_=e.svPaletteView,n.appendChild(this.svPaletteView_.element),i.appendChild(n);const s=t.createElement("div");s.classList.add(xn("h")),this.hPaletteView_=e.hPaletteView,s.appendChild(this.hPaletteView_.element),i.appendChild(s),this.element.appendChild(i);const o=t.createElement("div");if(o.classList.add(xn("rgb")),this.textView_=e.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const i=t.createElement("div");i.classList.add(xn("a"));const n=t.createElement("div");n.classList.add(xn("ap")),n.appendChild(this.alphaViews_.palette.element),i.appendChild(n);const s=t.createElement("div");s.classList.add(xn("at")),s.appendChild(this.alphaViews_.text.element),i.appendChild(s),this.element.appendChild(i)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((t=>t.inputElement))];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function Cn(t){return"int"===t?"int":"float"===t?"float":void 0}function kn(t){const e=T;return j(t,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Cn)}),expanded:e.optional.boolean,picker:e.optional.custom(Ui)})}function En(t){return t?.1:1}function Pn(t){var e;return null===(e=t.color)||void 0===e?void 0:e.type}function Mn(t,e){return t.alpha===e.alpha&&t.mode===e.mode&&t.notation===e.notation&&t.type===e.type}function Ln(t,e){const i=t.match(/^(.+)%$/);return Math.min(i?.01*parseFloat(i[1])*e:parseFloat(t),e)}const Vn={deg:t=>t,grad:t=>360*t/400,rad:t=>360*t/(2*Math.PI),turn:t=>360*t};function zn(t){const e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);const i=parseFloat(e[1]),n=e[2];return Vn[n](i)}function An(t){const e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[Ln(e[1],255),Ln(e[2],255),Ln(e[3],255)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function Sn(t){return e=>{const i=An(e);return i?new _n(i,"rgb",t):null}}function In(t){const e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[Ln(e[1],255),Ln(e[2],255),Ln(e[3],255),Ln(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function Dn(t){return e=>{const i=In(e);return i?new _n(i,"rgb",t):null}}function Rn(t){const e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[zn(e[1]),Ln(e[2],100),Ln(e[3],100)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function Tn(t){return e=>{const i=Rn(e);return i?new _n(i,"hsl",t):null}}function jn(t){const e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[zn(e[1]),Ln(e[2],100),Ln(e[3],100),Ln(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function Nn(t){return e=>{const i=jn(e);return i?new _n(i,"hsl",t):null}}function Fn(t){const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const i=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]:null}function On(t){const e=Fn(t);return e?new _n(e,"rgb","int"):null}function Bn(t){const e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Li(parseInt(e[4]+e[4],16),0,255,0,1)];const i=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16),Li(parseInt(i[4],16),0,255,0,1)]:null}function Kn(t){const e=Bn(t);return e?new _n(e,"rgb","int"):null}function Un(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const i=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function $n(t){return e=>{const i=Un(e);return i?new _n(i,"rgb",t):null}}function qn(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const i=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function Hn(t){return e=>{const i=qn(e);return i?new _n(i,"rgb",t):null}}const Wn=[{parser:Fn,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Bn,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:An,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:In,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Rn,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:jn,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Un,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:qn,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Yn(t){return Wn.reduce(((e,{parser:i,result:n})=>e||(i(t)?n:null)),null)}function Xn(t,e="int"){const i=Yn(t);return i?"hex"===i.notation&&"float"!==e?Object.assign(Object.assign({},i),{type:"int"}):"func"===i.notation?Object.assign(Object.assign({},i),{type:e}):null:null}const Gn={int:[On,Kn,Sn("int"),Dn("int"),Tn("int"),Nn("int"),$n("int"),Hn("int")],float:[Sn("float"),Dn("float"),Tn("float"),Nn("float"),$n("float"),Hn("float")]};function Zn(t){const e=Gn[t];return i=>"string"!=typeof i?_n.black(t):e.reduce(((t,e)=>t||e(i)),null)??_n.black(t)}function Qn(t){const e=Gn[t];return t=>e.reduce(((e,i)=>e||i(t)),null)}function Jn(t){const e=zi(Math.floor(t),0,255).toString(16);return 1===e.length?`0${e}`:e}function ts(t,e="#"){return`${e}${cn(t.getComponents("rgb")).map(Jn).join("")}`}function es(t,e="#"){const i=t.getComponents("rgb");return`${e}${[i[0],i[1],i[2],255*i[3]].map(Jn).join("")}`}function is(t,e){const i=di("float"===e?2:0);return`rgb(${cn(t.getComponents("rgb",e)).map((t=>i(t))).join(", ")})`}function ns(t){return e=>is(e,t)}function ss(t,e){const i=di(2),n=di("float"===e?2:0);return`rgba(${t.getComponents("rgb",e).map(((t,e)=>(3===e?i:n)(t))).join(", ")})`}function os(t){return e=>ss(e,t)}function rs(t){const e=[di(0),ui,ui];return`hsl(${cn(t.getComponents("hsl")).map(((t,i)=>e[i](t))).join(", ")})`}function as(t){const e=[di(0),ui,ui,di(2)];return`hsla(${t.getComponents("hsl").map(((t,i)=>e[i](t))).join(", ")})`}function ls(t,e){const i=di("float"===e?2:0),n=["r","g","b"];return`{${cn(t.getComponents("rgb",e)).map(((t,e)=>`${n[e]}: ${i(t)}`)).join(", ")}}`}function hs(t){return e=>ls(e,t)}function ps(t,e){const i=di(2),n=di("float"===e?2:0),s=["r","g","b","a"];return`{${t.getComponents("rgb",e).map(((t,e)=>{const o=3===e?i:n;return`${s[e]}: ${o(t)}`})).join(", ")}}`}function ds(t){return e=>ps(e,t)}const cs=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:ts},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:es},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:rs},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:as},...["int","float"].reduce(((t,e)=>[...t,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:ns(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:os(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:hs(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:ds(e)}]),[])];function us(t){return cs.reduce(((e,i)=>e||(Mn(i.format,t)?i.stringifier:null)),null)}const vs=g("apl");class ms{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(vs()),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(vs("b")),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(vs("c")),i.appendChild(n),this.colorElem_=n;const s=t.createElement("div");s.classList.add(vs("m")),this.element.appendChild(s),this.markerElem_=s;const o=t.createElement("div");o.classList.add(vs("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),i=new _n([e[0],e[1],e[2],0],"rgb"),n=new _n([e[0],e[1],e[2],255],"rgb"),s=["to right",ss(i),ss(n)];this.colorElem_.style.background=`linear-gradient(${s.join(",")})`,this.previewElem_.style.backgroundColor=ss(t);const o=Li(e[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}}class gs{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new ms(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mi(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=t.point.x/t.bounds.width,n=this.value.rawValue,[s,o,r]=n.getComponents("hsv");this.value.setRawValue(new _n([s,o,r,i],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=xi(En(!0),Ci(t));if(0===e)return;const i=this.value.rawValue,[n,s,o,r]=i.getComponents("hsv");this.value.setRawValue(new _n([n,s,o,r+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==xi(En(!0),Ci(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const bs=g("coltxt");function ws(t){const e=t.createElement("select"),i=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(i.reduce(((e,i)=>{const n=t.createElement("option");return n.textContent=i.text,n.value=i.value,e.appendChild(n),e}),t.createDocumentFragment())),e}class fs{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(bs());const i=t.createElement("div");i.classList.add(bs("m")),this.modeElem_=ws(t),this.modeElem_.classList.add(bs("ms")),i.appendChild(this.modeSelectElement);const n=t.createElement("div");n.classList.add(bs("mm")),n.appendChild(Z(t,"dropdown")),i.appendChild(n),this.element.appendChild(i);const s=t.createElement("div");s.classList.add(bs("w")),this.element.appendChild(s),this.textsElem_=s,this.textViews_=e.textViews,this.applyTextViews_(),f(e.colorMode,(t=>{this.modeElem_.value=t}))}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){tt(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach((e=>{const i=t.createElement("div");i.classList.add(bs("c")),i.appendChild(e.element),this.textsElem_.appendChild(i)}))}}function _s(t){return di("float"===t?2:0)}function xs(t,e,i){const n=mn(t,e)[i];return new me({min:0,max:n})}function ys(t,e,i){return new Di(t,{arrayPosition:0===i?"fst":2===i?"lst":"mid",baseStep:En(!1),parser:e.parser,props:z.fromObject({draggingScale:"float"===e.colorType?.01:1,formatter:_s(e.colorType)}),value:V(0,{constraint:xs(e.colorMode,e.colorType,i)}),viewProps:e.viewProps})}class Cs{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=V(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new fs(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},i=[ys(t,e,0),ys(t,e,1),ys(t,e,2)];return i.forEach(((t,e)=>{_i({primary:this.value,secondary:t.value,forward:t=>t.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[e],backward:(t,i)=>{const n=this.colorMode.rawValue,s=t.rawValue.getComponents(n,this.colorType_);return s[e]=i.rawValue,new _n(un(cn(s),s[3]),n,this.colorType_)}})})),i}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const ks=g("hpl");class Es{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(ks()),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(ks("c")),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(ks("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=is(new _n([e,100,100],"hsv"));const i=Li(e,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}}class Ps{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Es(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mi(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=Li(zi(t.point.x,0,t.bounds.width),0,t.bounds.width,0,359),n=this.value.rawValue,[,s,o,r]=n.getComponents("hsv");this.value.setRawValue(new _n([i,s,o,r],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=xi(En(!1),Ci(t));if(0===e)return;const i=this.value.rawValue,[n,s,o,r]=i.getComponents("hsv");this.value.setRawValue(new _n([n+e,s,o,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==xi(En(!1),Ci(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ms=g("svp"),Ls=64;class Vs{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Ms()),e.viewProps.bindTabIndex(this.element);const i=t.createElement("canvas");i.height=Ls,i.width=Ls,i.classList.add(Ms("c")),this.element.appendChild(i),this.canvasElement=i;const n=t.createElement("div");n.classList.add(Ms("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const t=X(this.canvasElement);if(!t)return;const e=this.value.rawValue.getComponents("hsv"),i=this.canvasElement.width,n=this.canvasElement.height,s=t.getImageData(0,0,i,n),o=s.data;for(let l=0;l<n;l++)for(let t=0;t<i;t++){const s=Li(t,0,i,0,100),r=Li(l,0,n,100,0),a=hn(e[0],s,r),h=4*(l*i+t);o[h]=a[0],o[h+1]=a[1],o[h+2]=a[2],o[h+3]=255}t.putImageData(s,0,0);const r=Li(e[1],0,100,0,100);this.markerElem_.style.left=`${r}%`;const a=Li(e[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class zs{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Vs(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mi(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=Li(t.point.x,0,t.bounds.width,0,100),n=Li(t.point.y,0,t.bounds.height,100,0),[s,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new _n([s,i,n,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){Ei(t.key)&&t.preventDefault();const[e,i,n,s]=this.value.rawValue.getComponents("hsv"),o=En(!1),r=xi(o,Ci(t)),a=xi(o,yi(t));0===r&&0===a||this.value.setRawValue(new _n([e,i+r,n+a,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=En(!1),i=xi(e,Ci(t)),n=xi(e,yi(t));0===i&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class As{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new Ps(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new zs(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new gs(t,{value:this.value,viewProps:this.viewProps}),text:new Di(t,{parser:li,baseStep:.1,props:z.fromObject({draggingScale:.01,formatter:di(2)}),value:V(0,{constraint:new me({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&_i({primary:this.value,secondary:this.alphaIcs_.text.value,forward:t=>t.rawValue.getComponents()[3],backward:(t,e)=>{const i=t.rawValue.getComponents();return i[3]=e.rawValue,new _n(i,t.rawValue.mode)}}),this.textC_=new Cs(t,{colorType:e.colorType,parser:li,value:this.value,viewProps:this.viewProps}),this.view=new yn(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const Ss=g("colsw");class Is{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(Ss()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Ss("sw")),this.element.appendChild(i),this.swatchElem_=i;const n=t.createElement("button");n.classList.add(Ss("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=es(t)}onValueChange_(){this.update_()}}class Ds{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Is(t,{value:this.value,viewProps:this.viewProps})}}class Rs{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=pt.create(e.expanded),this.swatchC_=new Ds(t,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Ee(t,{parser:e.parser,props:z.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new on(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new ye(t,{viewProps:this.viewProps}):null;const n=new As(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});n.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(n.view.element),_i({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ut(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=it(t);i&&e.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!H(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function Ts(t,e){return _n.isColorObject(t)?_n.fromObject(t,e):_n.black(e)}function js(t){return cn(t.getComponents("rgb")).reduce(((t,e)=>t<<8|255&Math.floor(e)),0)}function Ns(t){return t.getComponents("rgb").reduce(((t,e,i)=>t<<8|255&Math.floor(3===i?255*e:e)),0)>>>0}function Fs(t){return new _n([t>>16&255,t>>8&255,255&t],"rgb")}function Os(t){return new _n([t>>24&255,t>>16&255,t>>8&255,Li(255&t,0,255,0,1)],"rgb")}function Bs(t){return"number"!=typeof t?_n.black():Fs(t)}function Ks(t){return"number"!=typeof t?_n.black():Os(t)}function Us(t){const e=us(t);return e?(t,i)=>{Bi(t,e(i))}:null}function $s(t){const e=t?Ns:js;return(t,i)=>{Bi(t,e(i))}}function qs(t,e,i){const n=e.toRgbaObject(i);t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b),t.writeProperty("a",n.a)}function Hs(t,e,i){const n=e.toRgbaObject(i);t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b)}function Ws(t,e){return(i,n)=>{t?qs(i,n,e):Hs(i,n,e)}}function Ys(t){var e;return!(!(null==t?void 0:t.alpha)&&!(null===(e=null==t?void 0:t.color)||void 0===e?void 0:e.alpha))}function Xs(t){return t?t=>es(t,"0x"):t=>ts(t,"0x")}function Gs(t){return"color"in t||"view"in t&&"color"===t.view}const Zs={id:"input-color-number",type:"input",accept:(t,e)=>{if("number"!=typeof t||!Gs(e))return null;const i=kn(e);return i?{initialValue:t,params:i}:null},binding:{reader:t=>Ys(t.params)?Ks:Bs,equals:_n.equals,writer:t=>$s(Ys(t.params))},controller:t=>{const e=Ys(t.params),i="expanded"in t.params?t.params.expanded:void 0,n="picker"in t.params?t.params.picker:void 0;return new Rs(t.document,{colorType:"int",expanded:i??!1,formatter:Xs(e),parser:Qn("int"),pickerLayout:n??"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};function Qs(t){return _n.isRgbaColorObject(t)}function Js(t){return e=>Ts(e,t)}function to(t,e){return i=>t?ps(i,e):ls(i,e)}const eo={id:"input-color-object",type:"input",accept:(t,e)=>{if(!_n.isColorObject(t))return null;const i=kn(e);return i?{initialValue:t,params:i}:null},binding:{reader:t=>Js(Pn(t.params)),equals:_n.equals,writer:t=>Ws(Qs(t.initialValue),Pn(t.params))},controller:t=>{var e;const i=_n.isRgbaColorObject(t.initialValue),n="expanded"in t.params?t.params.expanded:void 0,s="picker"in t.params?t.params.picker:void 0,o=null!==(e=Pn(t.params))&&void 0!==e?e:"int";return new Rs(t.document,{colorType:o,expanded:n??!1,formatter:to(i,o),parser:Qn(o),pickerLayout:s??"popup",supportsAlpha:i,value:t.value,viewProps:t.viewProps})}},io={id:"input-color-string",type:"input",accept:(t,e)=>{if("string"!=typeof t||"view"in e&&"text"===e.view)return null;const i=Xn(t,Pn(e));if(!i||!us(i))return null;const n=kn(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>{var e;return Zn(null!==(e=Pn(t.params))&&void 0!==e?e:"int")},equals:_n.equals,writer:t=>{const e=Xn(t.initialValue,Pn(t.params));if(!e)throw d.shouldNeverHappen();const i=Us(e);if(!i)throw d.notBindable();return i}},controller:t=>{const e=Xn(t.initialValue,Pn(t.params));if(!e)throw d.shouldNeverHappen();const i=us(e);if(!i)throw d.shouldNeverHappen();const n="expanded"in t.params?t.params.expanded:void 0,s="picker"in t.params?t.params.picker:void 0;return new Rs(t.document,{colorType:e.type,expanded:n??!1,formatter:i,parser:Qn(e.type),pickerLayout:s??"popup",supportsAlpha:e.alpha,value:t.value,viewProps:t.viewProps})}};class no{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var i,n;return null!==(n=null===(i=this.components[e])||void 0===i?void 0:i.constrain(t))&&void 0!==n?n:t}));return this.asm_.fromComponents(e)}}const so=g("pndtxt");class oo{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(so()),this.textViews.forEach((e=>{const i=t.createElement("div");i.classList.add(so("a")),i.appendChild(e.element),this.element.appendChild(i)}))}}function ro(t,e,i){return new Di(t,{arrayPosition:0===i?"fst":i===e.axes.length-1?"lst":"mid",baseStep:e.axes[i].baseStep,parser:e.parser,props:e.axes[i].textProps,value:V(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}class ao{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((i,n)=>ro(t,e,n))),this.acs_.forEach(((t,i)=>{_i({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[i],backward:(t,n)=>{const s=e.assembly.toComponents(t.rawValue);return s[i]=n.rawValue,e.assembly.fromComponents(s)}})})),this.view=new oo(t,{textViews:this.acs_.map((t=>t.view))})}}function lo(t,e){return"step"in t&&!l(t.step)?new ge(t.step,e):null}function ho(t){return"max"in t&&!l(t.max)||"min"in t&&!l(t.min)?new me({max:t.max,min:t.min}):null}function po(t,e){const i=[],n=lo(t,e);n&&i.push(n);const s=ho(t);s&&i.push(s);const o=Hi(t.options);return o&&i.push(o),new ce(i)}function co(t){const e=t?ue(t,me):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function uo(t){const[e,i]=co(t);return[e??0,i??100]}const vo={id:"input-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;const i=T,n=j(e,{format:i.optional.function,max:i.optional.number,min:i.optional.number,options:i.optional.custom(Ki),step:i.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:t=>hi,constraint:t=>po(t.params,t.initialValue),writer:t=>Bi},controller:t=>{var e,i;const n=t.value,s=t.constraint;if(s&&ue(s,ve))return new fe(t.document,{props:z.fromObject({options:null!==(e=Wi(s))&&void 0!==e?e:[]}),value:n,viewProps:t.viewProps});const o=null!==(i="format"in t.params?t.params.format:void 0)&&void 0!==i?i:di(Xi(s,n.rawValue));if(s&&ue(s,me)){const[e,i]=uo(s);return new Oi(t.document,{baseStep:Gi(s),parser:li,sliderProps:z.fromObject({maxValue:i,minValue:e}),textProps:z.fromObject({draggingScale:Zi(s,n.rawValue),formatter:o}),value:n,viewProps:t.viewProps})}return new Di(t.document,{baseStep:Gi(s),parser:li,props:z.fromObject({draggingScale:Zi(s,n.rawValue),formatter:o}),value:n,viewProps:t.viewProps})}};class mo{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(l(t))return!1;const e=t.x,i=t.y;return!("number"!=typeof e||"number"!=typeof i)}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const go={toComponents:t=>t.getComponents(),fromComponents:t=>new mo(...t)},bo=g("p2d");class wo{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(bo()),e.viewProps.bindClassModifiers(this.element),f(e.expanded,y(this.element,bo(void 0,"expanded")));const i=t.createElement("div");i.classList.add(bo("h")),this.element.appendChild(i);const n=t.createElement("button");n.classList.add(bo("b")),n.appendChild(Z(t,"p2dpad")),e.viewProps.bindDisabled(n),i.appendChild(n),this.buttonElement=n;const s=t.createElement("div");if(s.classList.add(bo("t")),i.appendChild(s),this.textElement=s,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(bo("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const fo=g("p2dp");class _o{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(fo()),"popup"===e.layout&&this.element.classList.add(fo(void 0,"p"));const i=t.createElement("div");i.classList.add(fo("p")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const n=t.createElementNS(U,"svg");n.classList.add(fo("g")),this.padElement.appendChild(n),this.svgElem_=n;const s=t.createElementNS(U,"line");s.classList.add(fo("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const o=t.createElementNS(U,"line");o.classList.add(fo("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const r=t.createElementNS(U,"line");r.classList.add(fo("l")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(r),this.lineElem_=r;const a=t.createElement("div");a.classList.add(fo("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),i=this.maxValue_,n=Li(t,-i,+i,0,100),s=Li(e,-i,+i,0,100),o=this.invertsY_?100-s:s;this.lineElem_.setAttributeNS(null,"x2",`${n}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${n}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function xo(t,e,i){return[xi(e[0],Ci(t)),xi(e[1],yi(t))*(i?1:-1)]}class yo{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new _o(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mi(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=this.maxValue_,n=Li(t.point.x,0,t.bounds.width,-i,+i),s=Li(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-i,+i);this.value.setRawValue(new mo(n,s),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){Ei(t.key)&&t.preventDefault();const[e,i]=xo(t,this.baseSteps_,this.invertsY_);0===e&&0===i||this.value.setRawValue(new mo(this.value.rawValue.x+e,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,i]=xo(t,this.baseSteps_,this.invertsY_);0===e&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Co{constructor(t,e){var i,n;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=pt.create(e.expanded),this.popC_="popup"===e.pickerLayout?new ye(t,{viewProps:this.viewProps}):null;const s=new yo(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=s,this.textC_=new ao(t,{assembly:go,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new wo(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("blur",this.onPadButtonBlur_),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),_i({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ut(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=it(t);i&&e.contains(i)||i&&i===this.view.buttonElement&&!H(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}function ko(t){return mo.isObject(t)?new mo(t.x,t.y):new mo}function Eo(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function Po(t,e){if(!t)return;const i=[],n=lo(t,e);n&&i.push(n);const s=ho(t);return s&&i.push(s),new ce(i)}function Mo(t,e){return new no({assembly:go,components:[Po("x"in t?t.x:void 0,e.x),Po("y"in t?t.y:void 0,e.y)]})}function Lo(t,e){var i,n;const s=t&&ue(t,me);if(s)return Math.max(Math.abs(null!==(i=s.minValue)&&void 0!==i?i:0),Math.abs(null!==(n=s.maxValue)&&void 0!==n?n:0));const o=Gi(t);return Math.max(10*Math.abs(o),10*Math.abs(e))}function Vo(t,e){const i=e instanceof no?e.components[0]:void 0,n=e instanceof no?e.components[1]:void 0,s=Lo(i,t.x),o=Lo(n,t.y);return Math.max(s,o)}function zo(t,e){return{baseStep:Gi(e),constraint:e,textProps:z.fromObject({draggingScale:Zi(e,t),formatter:di(Xi(e,t))})}}function Ao(t){if(!("y"in t))return!1;const e=t.y;return!(!e||!("inverted"in e)||!e.inverted)}const So={id:"input-point2d",type:"input",accept:(t,e)=>{if(!mo.isObject(t))return null;const i=T,n=j(e,{expanded:i.optional.boolean,picker:i.optional.custom(Ui),x:i.optional.custom($i),y:i.optional.object({inverted:i.optional.boolean,max:i.optional.number,min:i.optional.number,step:i.optional.number})});return n?{initialValue:t,params:n}:null},binding:{reader:t=>ko,constraint:t=>Mo(t.params,t.initialValue),equals:mo.equals,writer:t=>Eo},controller:t=>{const e=t.document,i=t.value,n=t.constraint;if(!(n instanceof no))throw d.shouldNeverHappen();const s="expanded"in t.params?t.params.expanded:void 0,o="picker"in t.params?t.params.picker:void 0;return new Co(e,{axes:[zo(i.rawValue.x,n.components[0]),zo(i.rawValue.y,n.components[1])],expanded:s??!1,invertsY:Ao(t.params),maxValue:Vo(i.rawValue,n),parser:li,pickerLayout:o??"popup",value:i,viewProps:t.viewProps})}};class Io{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(l(t))return!1;const e=t.x,i=t.y,n=t.z;return!("number"!=typeof e||"number"!=typeof i||"number"!=typeof n)}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Do={toComponents:t=>t.getComponents(),fromComponents:t=>new Io(...t)};function Ro(t){return Io.isObject(t)?new Io(t.x,t.y,t.z):new Io}function To(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function jo(t,e){return new no({assembly:Do,components:[Po("x"in t?t.x:void 0,e.x),Po("y"in t?t.y:void 0,e.y),Po("z"in t?t.z:void 0,e.z)]})}function No(t,e){return{baseStep:Gi(e),constraint:e,textProps:z.fromObject({draggingScale:Zi(e,t),formatter:di(Xi(e,t))})}}const Fo={id:"input-point3d",type:"input",accept:(t,e)=>{if(!Io.isObject(t))return null;const i=T,n=j(e,{x:i.optional.custom($i),y:i.optional.custom($i),z:i.optional.custom($i)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Ro,constraint:t=>jo(t.params,t.initialValue),equals:Io.equals,writer:t=>To},controller:t=>{const e=t.value,i=t.constraint;if(!(i instanceof no))throw d.shouldNeverHappen();return new ao(t.document,{assembly:Do,axes:[No(e.rawValue.x,i.components[0]),No(e.rawValue.y,i.components[1]),No(e.rawValue.z,i.components[2])],parser:li,value:e,viewProps:t.viewProps})}};class Oo{constructor(t=0,e=0,i=0,n=0){this.x=t,this.y=e,this.z=i,this.w=n}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(l(t))return!1;const e=t.x,i=t.y,n=t.z,s=t.w;return!("number"!=typeof e||"number"!=typeof i||"number"!=typeof n||"number"!=typeof s)}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Bo={toComponents:t=>t.getComponents(),fromComponents:t=>new Oo(...t)};function Ko(t){return Oo.isObject(t)?new Oo(t.x,t.y,t.z,t.w):new Oo}function Uo(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function $o(t,e){return new no({assembly:Bo,components:[Po("x"in t?t.x:void 0,e.x),Po("y"in t?t.y:void 0,e.y),Po("z"in t?t.z:void 0,e.z),Po("w"in t?t.w:void 0,e.w)]})}function qo(t,e){return{baseStep:Gi(e),constraint:e,textProps:z.fromObject({draggingScale:Zi(e,t),formatter:di(Xi(e,t))})}}const Ho={id:"input-point4d",type:"input",accept:(t,e)=>{if(!Oo.isObject(t))return null;const i=T,n=j(e,{x:i.optional.custom($i),y:i.optional.custom($i),z:i.optional.custom($i),w:i.optional.custom($i)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Ko,constraint:t=>$o(t.params,t.initialValue),equals:Oo.equals,writer:t=>Uo},controller:t=>{const e=t.value,i=t.constraint;if(!(i instanceof no))throw d.shouldNeverHappen();return new ao(t.document,{assembly:Bo,axes:e.rawValue.getComponents().map(((t,e)=>qo(t,i.components[e]))),parser:li,value:e,viewProps:t.viewProps})}};function Wo(t){const e=[],i=Hi(t.options);return i&&e.push(i),new ce(e)}const Yo={id:"input-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;const i=j(e,{options:T.optional.custom(Ki)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>vi,constraint:t=>Wo(t.params),writer:t=>Bi},controller:t=>{var e;const i=t.document,n=t.value,s=t.constraint;return s&&ue(s,ve)?new fe(i,{props:z.fromObject({options:null!==(e=Wi(s))&&void 0!==e?e:[]}),value:n,viewProps:t.viewProps}):new Ee(i,{parser:t=>t,props:z.fromObject({formatter:mi}),value:n,viewProps:t.viewProps})}},Xo={monitor:{defaultInterval:200,defaultLineCount:3}},Go=g("mll");class Zo{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Go()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("textarea");i.classList.add(Go("i")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,i.readOnly=!0,e.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,i=[];this.value.rawValue.forEach((t=>{void 0!==t&&i.push(this.formatter_(t))})),t.textContent=i.join("\n"),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class Qo{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Zo(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const Jo=g("sgl");class tr{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Jo()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(Jo("i")),i.readOnly=!0,i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class er{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new tr(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const ir={id:"monitor-bool",type:"monitor",accept:(t,e)=>{if("boolean"!=typeof t)return null;const i=j(e,{lineCount:T.optional.number});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Me},controller:t=>{var e;return 1===t.value.rawValue.length?new er(t.document,{formatter:Le,value:t.value,viewProps:t.viewProps}):new Qo(t.document,{formatter:Le,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Xo.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}},nr=g("grl");class sr{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(nr()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=t.createElementNS(U,"svg");i.classList.add(nr("g")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(U,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const s=t.createElement("div");s.classList.add(nr("t"),g("tt")()),this.element.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,i=this.props_.get("minValue"),n=this.props_.get("maxValue"),s=[];this.value.rawValue.forEach(((o,r)=>{if(void 0===o)return;const a=Li(r,0,e,0,t.width),l=Li(o,i,n,t.height,0);s.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const o=this.tooltipElem_,r=this.value.rawValue[this.cursor_.rawValue];if(void 0===r)return void o.classList.remove(nr("t","a"));const a=Li(this.cursor_.rawValue,0,e,0,t.width),l=Li(r,i,n,t.height,0);o.style.left=`${a}px`,o.style.top=`${l}px`,o.textContent=`${this.formatter_(r)}`,o.classList.contains(nr("t","a"))||(o.classList.add(nr("t","a"),nr("t","in")),$(o),o.classList.remove(nr("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class or{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=V(-1),this.view=new sr(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),H(t)){const t=new Mi(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(Li(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.rawValue=Math.floor(Li(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function rr(t){return"format"in t&&!l(t.format)?t.format:di(2)}function ar(t){var e;return 1===t.value.rawValue.length?new er(t.document,{formatter:rr(t.params),value:t.value,viewProps:t.viewProps}):new Qo(t.document,{formatter:rr(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Xo.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}function lr(t){var e,i,n;return new or(t.document,{formatter:rr(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Xo.monitor.defaultLineCount,props:z.fromObject({maxValue:null!==(i="max"in t.params?t.params.max:null)&&void 0!==i?i:100,minValue:null!==(n="min"in t.params?t.params.min:null)&&void 0!==n?n:0}),value:t.value,viewProps:t.viewProps})}function hr(t){return"view"in t&&"graph"===t.view}const pr={id:"monitor-number",type:"monitor",accept:(t,e)=>{if("number"!=typeof t)return null;const i=T,n=j(e,{format:i.optional.function,lineCount:i.optional.number,max:i.optional.number,min:i.optional.number,view:i.optional.string});return n?{initialValue:t,params:n}:null},binding:{defaultBufferSize:t=>hr(t)?64:1,reader:t=>hi},controller:t=>hr(t.params)?lr(t):ar(t)},dr={id:"monitor-string",type:"monitor",accept:(t,e)=>{if("string"!=typeof t)return null;const i=T,n=j(e,{lineCount:i.optional.number,multiline:i.optional.boolean});return n?{initialValue:t,params:n}:null},binding:{reader:t=>vi},controller:t=>{var e;const i=t.value;return i.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new Qo(t.document,{formatter:mi,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Xo.monitor.defaultLineCount,value:i,viewProps:t.viewProps}):new er(t.document,{formatter:mi,value:i,viewProps:t.viewProps})}};class cr{constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new v,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}read(){const t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}function ur(t,e){const i=t.accept(e.target.read(),e.params);if(l(i))return null;const n=T,s={target:e.target,initialValue:i.initialValue,params:i.params},o=t.binding.reader(s),r=t.binding.constraint?t.binding.constraint(s):void 0,a=V(o(i.initialValue),{constraint:r,equals:t.binding.equals}),h=new cr({reader:o,target:e.target,value:a,writer:t.binding.writer(s)}),p=n.optional.boolean(e.params.disabled).value,d=n.optional.boolean(e.params.hidden).value,c=t.controller({constraint:r,document:e.document,initialValue:i.initialValue,params:i.params,value:h.value,viewProps:Gt.create({disabled:p,hidden:d})}),u=n.optional.string(e.params.label).value;return new xt(e.document,{binding:h,blade:ht(),props:z.fromObject({label:u??e.target.key}),valueController:c})}class vr{constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new v,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(void 0===t)return;const e=this.value.rawValue,i=this.reader_(t);this.value.rawValue=fi(e,i),this.emitter.emit("update",{rawValue:i,sender:this})}onTick_(t){this.read()}}function mr(t,e){return 0===e?new pe:new de(t,e??Xo.monitor.defaultInterval)}function gr(t,e){var i,n,s;const o=T,r=t.accept(e.target.read(),e.params);if(l(r))return null;const a={target:e.target,initialValue:r.initialValue,params:r.params},h=t.binding.reader(a),p=null!==(n=null!==(i=o.optional.number(e.params.bufferSize).value)&&void 0!==i?i:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(r.params))&&void 0!==n?n:1,d=o.optional.number(e.params.interval).value,c=new vr({reader:h,target:e.target,ticker:mr(e.document,d),value:bi(p)}),u=o.optional.boolean(e.params.disabled).value,v=o.optional.boolean(e.params.hidden).value,m=t.controller({document:e.document,params:r.params,value:c.value,viewProps:Gt.create({disabled:u,hidden:v})}),g=null!==(s=o.optional.string(e.params.label).value)&&void 0!==s?s:e.target.key;return new Ct(e.document,{binding:c,blade:ht(),props:z.fromObject({label:g}),valueController:m})}class br{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,i){if(l(e.read()))throw new d({context:{key:e.key},type:"nomatchingcontroller"});const n=this.pluginsMap_.inputs.reduce(((n,s)=>n??ur(s,{document:t,target:e,params:i})),null);if(n)return n;throw new d({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,i){const n=this.pluginsMap_.monitors.reduce(((n,s)=>n??gr(s,{document:t,params:i,target:e})),null);if(n)return n;throw new d({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const i=this.pluginsMap_.blades.reduce(((i,n)=>i??he(n,{document:t,params:e})),null);if(!i)throw new d({type:"nomatchingview",context:{params:e}});return i}createBladeApi(t){if(t instanceof xt)return new _t(t);if(t instanceof Ct)return new yt(t);if(t instanceof jt)return new Mt(t,this);const e=this.pluginsMap_.blades.reduce(((e,i)=>e??i.api({controller:t,pool:this})),null);if(!e)throw d.shouldNeverHappen();return e}}function wr(){const t=new br;return[So,Fo,Ho,Yo,vo,io,eo,Zs,nn,ir,dr,pr,at,Bt,Wt,le].forEach((e=>{t.register(e)})),t}class fr extends i{constructor(t){super(t),this.emitter_=new v,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new s(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class _r extends i{constructor(t){super(t),this.emitter_=new v,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new s(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class xr extends i{constructor(t){super(t),this.emitter_=new v,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new s(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}const yr={id:"list",type:"blade",accept(t){const e=T,i=j(t,{options:e.required.custom(Ki),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return i?{params:i}:null},controller(t){const e=new fe(t.document,{props:z.fromObject({options:qi(t.params.options)}),value:V(t.params.value),viewProps:t.viewProps});return new Kt(t.document,{blade:t.blade,props:z.fromObject({label:t.params.label}),valueController:e})},api:t=>t.controller instanceof Kt&&t.controller.valueController instanceof fe?new fr(t.controller):null};function Cr(t){return t.reduce(((t,e)=>Object.assign(t,{[e.presetKey]:e.read()})),{})}function kr(t,e){t.forEach((t=>{const i=e[t.presetKey];void 0!==i&&t.write(i)}))}class Er extends Lt{constructor(t,e){super(t,e)}get element(){return this.controller_.view.element}importPreset(t){kr(this.controller_.rackController.rack.find(xt).map((t=>t.binding.target)),t),this.refresh()}exportPreset(){return Cr(this.controller_.rackController.rack.find(xt).map((t=>t.binding.target)))}refresh(){this.controller_.rackController.rack.find(xt).forEach((t=>{t.binding.read()})),this.controller_.rackController.rack.find(Ct).forEach((t=>{t.binding.read()}))}}class Pr extends Ot{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const Mr={id:"slider",type:"blade",accept(t){const e=T,i=j(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return i?{params:i}:null},controller(t){var e,i;const n=null!==(e=t.params.value)&&void 0!==e?e:0,s=new Oi(t.document,{baseStep:1,parser:li,sliderProps:z.fromObject({maxValue:t.params.max,minValue:t.params.min}),textProps:z.fromObject({draggingScale:Zi(void 0,n),formatter:null!==(i=t.params.format)&&void 0!==i?i:pi}),value:V(n),viewProps:t.viewProps});return new Kt(t.document,{blade:t.blade,props:z.fromObject({label:t.params.label}),valueController:s})},api:t=>t.controller instanceof Kt&&t.controller.valueController instanceof Oi?new _r(t.controller):null},Lr={id:"text",type:"blade",accept(t){const e=T,i=j(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return i?{params:i}:null},controller(t){var e;const i=new Ee(t.document,{parser:t.params.parse,props:z.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:t=>String(t)}),value:V(t.params.value),viewProps:t.viewProps});return new Kt(t.document,{blade:t.blade,props:z.fromObject({label:t.params.label}),valueController:i})},api:t=>t.controller instanceof Kt&&t.controller.valueController instanceof Ee?new xr(t.controller):null};function Vr(t){const e=t.createElement("div");return e.classList.add(g("dfw")()),t.body&&t.body.appendChild(e),e}function zr(t,e,i){if(t.querySelector(`style[data-tp-style=${e}]`))return;const n=t.createElement("style");n.dataset.tpStyle=e,n.textContent=i,t.head.appendChild(n)}class Ar extends Er{constructor(t){var e,i;const n=t??{},s=null!==(e=n.document)&&void 0!==e?e:Y(),o=wr();super(new Pr(s,{expanded:n.expanded,blade:ht(),props:z.fromObject({title:n.title}),viewProps:Gt.create()}),o),this.pool_=o,this.containerElem_=null!==(i=n.container)&&void 0!==i?i:Vr(s),this.containerElem_.appendChild(this.element),this.doc_=s,this.usesDefaultWrapper_=!n.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw d.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw d.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((t=>{this.pool_.register(t),this.embedPluginStyle_(t)}))}embedPluginStyle_(t){t.css&&zr(this.document,`plugin-${t.id}`,t.css)}setUpDefaultPlugins_(){zr(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach((t=>{this.embedPluginStyle_(t)})),this.registerPlugin({plugins:[Mr,yr,le,Lr]})}}const Sr=new e("3.1.0");t.BladeApi=i,t.ButtonApi=u,t.FolderApi=Lt,t.InputBindingApi=_t,t.ListApi=fr,t.MonitorBindingApi=yt,t.Pane=Ar,t.SeparatorApi=Ut,t.SliderApi=_r,t.TabApi=ie,t.TabPageApi=ee,t.TextApi=xr,t.TpChangeEvent=s,t.VERSION=Sr,Object.defineProperty(t,"__esModule",{value:!0})}(St.exports);const It="three-debug",Dt={get:t=>localStorage.getItem(`${It}.${t}`),getJSON(t){const e=Dt.get(t);return e?JSON.parse(e):null},getNumber(t){const e=Dt.get(t);return e?Number.parseFloat(e):null},remove(t){localStorage.removeItem(`${It}.${t}`)},set:(t,e)=>localStorage.setItem(`${It}.${t}`,e),setJSON(t,e){Dt.set(t,JSON.stringify(e))},setNumber(t,e){Dt.set(t,String(e))}},Rt=St.exports.FolderApi.prototype.addFolder,Tt=St.exports.FolderApi.prototype.dispose;St.exports.FolderApi.prototype.addFolder=function(t){const e=`${String(t.index??-1)}.${t.title}`,i=Rt.call(this,{expanded:null!==Dt.get(`pane.${e}`),...t});return i.element.id=e,i.on("fold",(t=>{const i=`pane.${e}`;t.expanded?Dt.set(i,""):Dt.remove(i)})),i},St.exports.FolderApi.prototype.dispose=function(){Tt.call(this)};class jt{constructor(){ft(this,"listeners",{})}addEventListener(t,e){const{listeners:i}=this;void 0===i[t]&&(i[t]=[]),i[t].includes(e)||i[t].push(e)}hasEventListener(t,e){var i;return null==(i=this.listeners[t])?void 0:i.includes(e)}removeEventListener(t,e){const{listeners:i}=this,n=i[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){const{listeners:e}=this,i=e[t.type];if(void 0!==i){t.target=this;const e=i.slice(0);for(let i=0,n=e.length;i<n;i+=1)e[i].call(this,t);t.target=null}}}let Nt;const Ft=()=>Nt,Ot=2*Math.PI,Bt=1e-6,Kt={type:"change"},Ut={type:"start"},$t={type:"end"};class qt extends jt{constructor(t,e){const i=Ft();super(),ft(this,"enabled",!0),ft(this,"target"),ft(this,"minDistance",0),ft(this,"maxDistance",1/0),ft(this,"minZoom",0),ft(this,"maxZoom",1/0),ft(this,"minPolarAngle",0),ft(this,"maxPolarAngle",Math.PI),ft(this,"minAzimuthAngle",-1/0),ft(this,"maxAzimuthAngle",1/0),ft(this,"enableKeyEvents",!1),ft(this,"enableDamping",!1),ft(this,"dampingFactor",.05),ft(this,"enableZoom",!0),ft(this,"zoomSpeed",1),ft(this,"enableRotate",!0),ft(this,"rotateSpeed",1),ft(this,"enablePan",!0),ft(this,"panSpeed",1),ft(this,"screenSpacePanning",!0),ft(this,"keyPanSpeed",20),ft(this,"autoRotate",!1),ft(this,"autoRotateSpeed",2),ft(this,"reverseOrbit",!1),ft(this,"mouseButtons",{LEFT:0,MIDDLE:1,RIGHT:2}),ft(this,"touches",{ONE:0,TWO:2}),ft(this,"getPolarAngle"),ft(this,"getAzimuthalAngle"),ft(this,"getDistance"),ft(this,"saveState"),ft(this,"reset"),ft(this,"update"),ft(this,"dispose"),e.style.touchAction="none",this.target=new i.Vector3;const n=this.target.clone(),s=t.position.clone();let o=t.zoom;const r=new i.Vector3,a=(new i.Quaternion).setFromUnitVectors(t.up,new i.Vector3(0,1,0)),l=a.clone().invert(),h=new i.Vector3,p=new i.Quaternion;let d=-1;const c=new i.Vector3,u=new i.Spherical,v=new i.Spherical;let m=1;const g=new i.Vector3;let b=!1;const w=new i.Vector2,f=new i.Vector2,_=new i.Vector2,x=new i.Vector2,y=new i.Vector2,C=new i.Vector2,k=new i.Vector2,E=new i.Vector2,P=new i.Vector2,M=[],L={};this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.getDistance=()=>t.position.distanceTo(this.target),this.saveState=()=>{n.copy(this.target),s.copy(t.position),o=t.zoom};const V=t=>{v.theta-=t},z=()=>2*Math.PI/60/60*this.autoRotateSpeed,A=()=>{r.copy(t.position).sub(this.target),r.applyQuaternion(a),u.setFromVector3(r),this.autoRotate&&-1===d&&V(z()),this.enableDamping?(u.theta+=v.theta*this.dampingFactor,u.phi+=v.phi*this.dampingFactor):(u.theta+=v.theta,u.phi+=v.phi);let e=this.minAzimuthAngle,i=this.maxAzimuthAngle;return isFinite(e)&&isFinite(i)&&(e<-Math.PI?e+=Ot:e>Math.PI&&(e-=Ot),i<-Math.PI?i+=Ot:i>Math.PI&&(i-=Ot),u.theta=e<=i?Math.max(e,Math.min(i,u.theta)):u.theta>(e+i)/2?Math.max(e,u.theta):Math.min(i,u.theta)),u.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=m,u.radius=Math.max(this.minDistance,Math.min(this.maxDistance,u.radius)),this.enableDamping?this.target.addScaledVector(g,this.dampingFactor):this.target.add(g),r.setFromSpherical(u),r.applyQuaternion(l),t.position.copy(this.target).add(r),t.lookAt(this.target),this.enableDamping?(v.theta*=1-this.dampingFactor,v.phi*=1-this.dampingFactor,g.multiplyScalar(1-this.dampingFactor)):(v.set(0,0,0),g.set(0,0,0)),m=1,!!(b||h.distanceToSquared(t.position)>Bt||8*(1-p.dot(t.quaternion))>Bt)&&(this.dispatchEvent(Kt),h.copy(t.position),p.copy(t.quaternion),b=!1,!0)};this.reset=()=>{if(this.target.copy(n),t.position.copy(s),"isOrthographicCamera"in t){const e=t;e.zoom=o,e.updateProjectionMatrix()}this.dispatchEvent(Kt),A(),d=-1},this.update=A;const S=()=>.95**this.zoomSpeed,I=t=>{v.phi-=t},D=(t,e)=>{c.setFromMatrixColumn(e,0),c.multiplyScalar(-t),g.add(c)},R=(e,i)=>{this.screenSpacePanning?c.setFromMatrixColumn(i,1):(c.setFromMatrixColumn(i,0),c.crossVectors(t.up,c)),c.multiplyScalar(e),g.add(c)},T=(i,n)=>{if("isPerspectiveCamera"in t){const{fov:s}=t;r.copy(t.position).sub(this.target);let o=r.length();o*=Math.tan(s/2*Math.PI/180),D(2*i*o/e.clientHeight,t.matrix),R(2*n*o/e.clientHeight,t.matrix)}else if("isOrthographicCamera"in t){const s=t;D(i*(s.right-s.left)/s.zoom/e.clientWidth,s.matrix),R(n*(s.top-s.bottom)/s.zoom/e.clientHeight,s.matrix)}},j=e=>{if("isPerspectiveCamera"in t)m/=e;else if("isOrthographicCamera"in t){const i=t;i.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,i.zoom*e)),i.updateProjectionMatrix(),b=!0}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1},N=e=>{if("isPerspectiveCamera"in t)m*=e;else if("isOrthographicCamera"in t){const i=t;i.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,i.zoom/e)),i.updateProjectionMatrix(),b=!0}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1},F=t=>{w.set(t.clientX,t.clientY)},O=t=>{x.set(t.clientX,t.clientY)},B=t=>{f.set(t.clientX,t.clientY),_.subVectors(f,w).multiplyScalar(this.rotateSpeed),V(2*Math.PI*_.x/e.clientHeight),I(2*Math.PI*_.y/e.clientHeight),w.copy(f),A()},K=t=>{y.set(t.clientX,t.clientY),C.subVectors(y,x).multiplyScalar(this.panSpeed),T(C.x,C.y),x.copy(y),A()},U=t=>{let e=!1;switch(t.key.toLowerCase()){case"arrowup":case"w":T(0,this.keyPanSpeed),e=!0;break;case"arrowdown":case"s":T(0,-this.keyPanSpeed),e=!0;break;case"arrowleft":case"a":T(this.keyPanSpeed,0),e=!0;break;case"arrowright":case"d":T(-this.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),A())},$=()=>{if(1===M.length)w.set(M[0].pageX,M[0].pageY);else{const t=.5*(M[0].pageX+M[1].pageX),e=.5*(M[0].pageY+M[1].pageY);w.set(t,e)}},q=()=>{if(1===M.length)x.set(M[0].pageX,M[0].pageY);else{const t=.5*(M[0].pageX+M[1].pageX),e=.5*(M[0].pageY+M[1].pageY);x.set(t,e)}},H=()=>{const t=M[0].pageX-M[1].pageX,e=M[0].pageY-M[1].pageY,i=Math.sqrt(t**2+e**2);k.set(0,i)},W=()=>{this.enableZoom&&H(),this.enablePan&&q()},Y=()=>{this.enableZoom&&H(),this.enableRotate&&$()},X=t=>{const e=t.pointerId===M[0].pointerId?M[1]:M[0];return L[e.pointerId]},G=t=>{if(1===M.length)f.set(t.pageX,t.pageY);else{const e=X(t),i=.5*(t.pageX+e.x),n=.5*(t.pageY+e.y);f.set(i,n)}_.subVectors(f,w).multiplyScalar(this.rotateSpeed),V(2*Math.PI*_.x/e.clientHeight),I(2*Math.PI*_.y/e.clientHeight),w.copy(f)},Z=t=>{if(1===M.length)y.set(t.pageX,t.pageY);else{const e=X(t),i=.5*(t.pageX+e.x),n=.5*(t.pageY+e.y);y.set(i,n)}C.subVectors(y,x).multiplyScalar(this.panSpeed),T(C.x,C.y),x.copy(y)},Q=t=>{const e=X(t),i=t.pageX-e.x,n=t.pageY-e.y,s=Math.sqrt(i**2+n**2);E.set(0,s),P.set(0,(E.y/k.y)**this.zoomSpeed),j(P.y),k.copy(E)},J=t=>{this.enableZoom&&Q(t),this.enablePan&&Z(t)},tt=t=>{this.enableZoom&&Q(t),this.enableRotate&&G(t)},et=t=>{let e=L[t.pointerId];void 0===e&&(e=new i.Vector2,L[t.pointerId]=e),e.set(t.pageX,t.pageY)},it=t=>{switch(et(t),M.length){case 1:switch(this.touches.ONE){case 0:if(!this.enableRotate)return;$(),d=3;break;case 1:if(!this.enablePan)return;q(),d=4;break;default:d=-1}break;case 2:switch(this.touches.TWO){case 2:if(!this.enableZoom&&!this.enablePan)return;W(),d=5;break;case 3:if(!this.enableZoom&&!this.enableRotate)return;Y(),d=6;break;default:d=-1}break;default:d=-1}-1!==d&&this.dispatchEvent(Ut)},nt=t=>{switch(et(t),d){case 3:if(!this.enableRotate)return;return G(t),void A();case 4:if(!this.enablePan)return;return Z(t),void A();case 5:if(!this.enableZoom&&!this.enablePan)return;return J(t),void A();case 6:if(!this.enableZoom&&!this.enableRotate)return;return tt(t),void A();default:d=-1}},st=t=>{let e=-1;switch(t.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT}switch(e){case 1:if(!this.enableZoom)return;(t=>{k.set(t.clientX,t.clientY)})(t),d=1;break;case 0:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!this.enablePan)return;O(t),d=2}else{if(!this.enableRotate)return;F(t),d=0}break;case 2:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!this.enableRotate)return;F(t),d=0}else{if(!this.enablePan)return;O(t),d=2}break;default:d=-1}-1!==d&&this.dispatchEvent(Ut)},ot=t=>{switch(d){case 0:if(!this.enableRotate)return;return void B(t);case 1:if(!this.enableZoom)return;return void(t=>{E.set(t.clientX,t.clientY),P.subVectors(E,k),P.y>0?j(S()):P.y<0&&N(S()),k.copy(E),A()})(t);case 2:if(!this.enablePan)return;K(t)}},rt=t=>{!this.enabled||("touch"===t.pointerType?nt(t):ot(t))},at=t=>{delete L[t.pointerId];for(let e=0;e<M.length;e+=1)if(M[e].pointerId===t.pointerId)return void M.splice(e,1)},lt=t=>{at(t),0===M.length&&(e.releasePointerCapture(t.pointerId),e.removeEventListener("pointermove",rt),e.removeEventListener("pointerup",lt)),this.dispatchEvent($t),d=-1},ht=t=>{!this.enabled||(0===M.length&&(e.setPointerCapture(t.pointerId),e.addEventListener("pointermove",rt),e.addEventListener("pointerup",lt)),(t=>{M.push(t)})(t),"touch"===t.pointerType?it(t):st(t))},pt=t=>{at(t)},dt=t=>{!this.enabled||!this.enableZoom||-1!==d||(t.preventDefault(),this.dispatchEvent(Ut),(t=>{t.deltaY<0?N(S()):t.deltaY>0&&j(S()),A()})(t),this.dispatchEvent($t))},ct=t=>{!this.enableKeyEvents||!this.enabled||!this.enablePan||U(t)},ut=t=>{!this.enabled||t.preventDefault()};this.dispose=()=>{window.removeEventListener("keydown",ct),e.removeEventListener("contextmenu",ut),e.removeEventListener("pointerdown",ht),e.removeEventListener("pointercancel",pt),e.removeEventListener("wheel",dt),e.removeEventListener("pointermove",rt),e.removeEventListener("pointerup",lt)},window.addEventListener("keydown",ct),e.addEventListener("contextmenu",ut),e.addEventListener("pointerdown",ht),e.addEventListener("pointercancel",pt),e.addEventListener("wheel",dt,{passive:!1}),A()}}class Ht extends qt{constructor(t,e){super(t,e),this.screenSpacePanning=!1,this.mouseButtons.LEFT=2,this.mouseButtons.RIGHT=0,this.touches.ONE=1,this.touches.TWO=3}}var Wt=(t=>(t[t.NONE=0]="NONE",t[t.ORBIT=1]="ORBIT",t[t.MAP=2]="MAP",t))(Wt||{});let Yt;const Xt=(t,e,i)=>{const n=()=>{Dt.setJSON("camera",{position:t.position.toArray(),quaternion:t.quaternion.toArray(),target:null==Yt?void 0:Yt.target.toArray(),zoom:t.zoom})};void 0!==Yt&&(Yt.dispose(),window.removeEventListener("pointerup",n),window.removeEventListener("wheel",n)),2===i?(Dt.setNumber("controls",2),Yt=new Ht(t,e.domElement),window.addEventListener("pointerup",n,{passive:!0}),window.addEventListener("wheel",n,{passive:!0})):1===i?(Dt.setNumber("controls",1),Yt=new qt(t,e.domElement),window.addEventListener("pointerup",n,{passive:!0}),window.addEventListener("wheel",n,{passive:!0})):(Dt.remove("camera"),Dt.remove("controls"))};let Gt=-1;const Zt=[],Qt=()=>{for(let t=0,e=Zt.length;t<e;t+=1)Zt[t]();Gt=requestAnimationFrame(Qt)},Jt=t=>{Zt.push(t)},te=t=>{Zt.splice(Zt.indexOf(t),1)},ee="pcui-resizable",ie="pcui-readonly",ne="pcui-disabled",se="pcui-focus",oe="pcui-error",re="flash";class ae{constructor(t,e,i){ft(this,"owner",null),ft(this,"name",null),ft(this,"fn",null),this.owner=t,this.name=e,this.fn=i}unbind(){!this.owner||(this.owner.unbind(this.name,this.fn),this.owner=null,this.name=null,this.fn=null)}call(...t){!this.fn||this.fn.call(this.owner,...t)}on(t,e){return this.owner.on(t,e)}}class le{constructor(){yt(this,t,{})}on(e,i){const n=xt(this,t)[e];return void 0===n?xt(this,t)[e]=[i]:-1===n.indexOf(i)&&n.push(i),new ae(this,e,i)}once(t,e){const i=this.on(t,((...t)=>{e.call(this,...t),i.unbind()}));return i}emit(e,...i){let n=xt(this,t)[e];if(void 0!==n&&n.length>0){n=[...n];for(let t=0,e=n.length;t<e;t+=1)n[t].call(this,...i)}return this}unbind(e,i){if(void 0===e)Ct(this,t,{});else{const n=xt(this,t)[e];if(void 0===n)return this;if(void 0===i)delete xt(this,t)[e];else{const s=n.indexOf(i);-1!==s&&(1===n.length?delete xt(this,t)[e]:n.splice(s,1))}}return this}}t=new WeakMap;class he extends le{constructor(t={}){super(),yt(this,h),yt(this,d),yt(this,w),ft(this,"destroyed",!1),yt(this,e,!0),yt(this,i,!1),yt(this,n,null),yt(this,s,-1),yt(this,o,!1),yt(this,r,!1),yt(this,a,!1),yt(this,l,[]),ft(this,"dom"),yt(this,u,(()=>{this.destroy()})),yt(this,v,(()=>{xt(this,i)||xt(this,e)&&kt(this,d,c).call(this,!1)})),yt(this,m,(()=>{xt(this,i)||xt(this,e)&&kt(this,d,c).call(this,!0)})),yt(this,g,(()=>{const t=this.hiddenToRoot;Ct(this,o,!1),t!==this.hiddenToRoot&&kt(this,h,p).call(this,this.hiddenToRoot)})),yt(this,b,(()=>{const t=this.hiddenToRoot;Ct(this,o,!0),t!==this.hiddenToRoot&&kt(this,h,p).call(this,this.hiddenToRoot)})),yt(this,_,(t=>{xt(this,i)||(t?xt(this,a)||kt(this,w,f).call(this,!0):xt(this,a)||kt(this,w,f).call(this,!1))})),yt(this,x,!1),this.dom=t.dom??document.createElement("div"),void 0!==t.id&&(this.dom.id=t.id),this.dom.ui=this,this.dom.classList.add("pcui-element"),Ct(this,o,!t.isRoot),this.enabled=t.enabled??!0,this.hidden=t.hidden??!1}flash(){xt(this,s)>-1||(this.dom.classList.add(re),Ct(this,s,setTimeout((()=>{Ct(this,s,-1),this.dom.classList.remove(re)}),200)))}destroy(){var t;if(this.destroyed)return;if(this.destroyed=!0,this.parent){const e=this.parent;for(let t=0,n=xt(this,l).length;t<n;t+=1)xt(this,l)[t].unbind();xt(this,l).slice(0,xt(this,l).length);const i=e;"remove"in i&&!e.destroyed&&i.remove(this),Ct(this,n,null),!e.destroyed&&(null==(t=this.dom)?void 0:t.parentElement)&&this.dom.parentElement.removeChild(this.dom)}const{dom:e}=this;e&&(delete e.ui,this.dom=null),xt(this,s)>-1&&clearTimeout(xt(this,s)),this.emit("destroy",e,this),this.unbind()}set enabled(t){if(xt(this,e)===t)return;const{enabled:i}=this;Ct(this,e,t),i!==t&&kt(this,d,c).call(this,t)}get enabled(){return xt(this,i)?xt(this,e):xt(this,e)&&(!xt(this,n)||xt(this,n).enabled)}set ignoreParent(t){Ct(this,i,t),kt(this,d,c).call(this,this.enabled),kt(this,w,f).call(this,this.readOnly)}get ignoreParent(){return xt(this,i)}set parent(t){if(t===xt(this,n))return;const e=this.enabled,i=this.readOnly,s=this.hiddenToRoot;if(xt(this,n)){for(let t=0,e=xt(this,l).length;t<e;t+=1)xt(this,l)[t].unbind();xt(this,l).length=0}Ct(this,n,t),xt(this,n)?(xt(this,l).push(xt(this,n).once("destroy",xt(this,u))),xt(this,l).push(xt(this,n).on("disable",xt(this,v))),xt(this,l).push(xt(this,n).on("enable",xt(this,m))),xt(this,l).push(xt(this,n).on("readOnly",xt(this,_))),xt(this,l).push(xt(this,n).on("showToRoot",xt(this,g))),xt(this,l).push(xt(this,n).on("hideToRoot",xt(this,b))),Ct(this,o,xt(this,n).hiddenToRoot)):Ct(this,o,!0),this.emit("parent",xt(this,n));const r=this.enabled;r!==e&&kt(this,d,c).call(this,r);const a=this.readOnly;a!==i&&kt(this,w,f).call(this,a);const x=this.hiddenToRoot;x!==s&&kt(this,h,p).call(this,x)}get parent(){return xt(this,n)}set hidden(t){if(t===xt(this,r))return;const e=this.hiddenToRoot;Ct(this,r,t),t?this.dom.classList.add("hidden"):this.dom.classList.remove("hidden"),this.emit(t?"hide":"show"),this.hiddenToRoot!==e&&kt(this,h,p).call(this,this.hiddenToRoot)}get hidden(){return xt(this,r)}get hiddenToRoot(){return xt(this,r)||xt(this,o)}set readOnly(t){xt(this,a)!==t&&(Ct(this,a,t),kt(this,w,f).call(this,t))}get readOnly(){return xt(this,i)?xt(this,a):xt(this,a)||Boolean(xt(this,n)&&xt(this,n).readOnly)}set error(t){xt(this,x)!==t&&(Ct(this,x,t),t?this.dom.classList.add(oe):this.dom.classList.remove(oe))}get error(){return xt(this,x)}set width(t){this.dom.style.width=`${t}px`}get width(){return this.dom.clientWidth}set height(t){this.dom.style.height=`${t}px`}get height(){return this.dom.clientHeight}}e=new WeakMap,i=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,r=new WeakMap,a=new WeakMap,l=new WeakMap,h=new WeakSet,p=function(t){t?this.emit("hideToRoot"):this.emit("showToRoot")},d=new WeakSet,c=function(t){t?this.dom.classList.remove(ne):this.dom.classList.add(ne),this.emit(t?"enable":"disable")},u=new WeakMap,v=new WeakMap,m=new WeakMap,g=new WeakMap,b=new WeakMap,w=new WeakSet,f=function(t){t?this.dom.classList.add(ie):this.dom.classList.remove(ie),this.emit("readOnly",t)},_=new WeakMap,x=new WeakMap;const pe=`${ee}-resizing`,de="pcui-container",ce=`${de}-dragged`,ue=`${ce}-child`;class ve extends he{constructor(t={}){super(t),yt(this,L),yt(this,z),yt(this,S),yt(this,D),ft(this,"resizeMin",100),ft(this,"resizeMax",300),yt(this,y,!1),yt(this,C,null),yt(this,k,!1),yt(this,E,-1),yt(this,P,null),yt(this,M,null),ft(this,"_onScroll",(t=>{this.emit("scroll",t)})),ft(this,"_onResizeStart",(t=>{t.preventDefault(),t.stopPropagation(),window.addEventListener("mousemove",this._onResizeMove),window.addEventListener("mouseup",this._onResizeEnd),kt(this,L,V).call(this)})),ft(this,"_onResizeMove",(t=>{t.preventDefault(),t.stopPropagation(),kt(this,z,A).call(this,t.clientX,t.clientY)})),ft(this,"_onResizeEnd",(t=>{t.preventDefault(),t.stopPropagation(),window.removeEventListener("mousemove",this._onResizeMove),window.removeEventListener("mouseup",this._onResizeEnd),kt(this,S,I).call(this)})),this.dom.classList.add(de),t.flex?this.dom.classList.add("flex","flex-col"):t.grid&&this.dom.classList.add("grid"),this.resizable=t.resizable??null}append(t){this.dom.append(t.dom),this._onAppendChild(t)}appendBefore(t,e){this.dom.append(t.dom);const i=null==e?void 0:e.dom;this.dom.insertBefore(t.dom,i),this._onAppendChild(t)}appendAfter(t,e){const i=null==e?void 0:e.dom,n=i?i.nextSibling:null;n?this.dom.insertBefore(t.dom,n):this.dom.appendChild(t.dom),this._onAppendChild(t)}prepend(t){this.dom.prepend(t.dom),this._onAppendChild(t)}remove(t){t.parent===this&&(this.dom.removeChild(t.dom),this._onRemoveChild(t))}move(t,e){let i=-1;for(let n=0,s=this.dom.childNodes.length;n<s;n+=1)if(this.dom.childNodes[n].ui===t){i=n;break}-1===i?this.appendBefore(t,this.dom.childNodes[e].ui):e!==i&&(this.remove(t),e<i?this.appendBefore(t,this.dom.childNodes[e].ui):this.appendAfter(t,this.dom.childNodes[e-1].ui))}clear(){const{childNodes:t}=this.dom;let e=t.length-1;for(;e>-1;){const t=this.dom.childNodes[e];t.ui&&t.ui!==this&&t.ui.destroy(),e-=1}null!==xt(this,P)&&(xt(this,P).removeEventListener("mousedown",this._onResizeStart),Ct(this,P,null)),this.dom.innerHTML="",this.resizable&&(this._createResizeHandle(),this.dom.appendChild(xt(this,P)))}_onAppendChild(t){t.parent=this,this.emit("append",t)}_onRemoveChild(t){t.parent=null,this.emit("remove",t)}_createResizeHandle(){const t=document.createElement("div");t.classList.add("pcui-resizable-handle"),t.ui=this,t.addEventListener("mousedown",this._onResizeStart),Ct(this,P,t)}resize(t=0,e=0){kt(this,L,V).call(this),kt(this,z,A).call(this,0,0),kt(this,z,A).call(this,4-t,-e),kt(this,S,I).call(this)}_onChildDragStart(t,e){this.dom.classList.add(ue),Ct(this,E,kt(this,D,R).call(this,e)),e.dom.classList.add(ce),this.emit("child:dragstart",e,xt(this,E))}_onChildDragMove(t,e){const i=this.dom.getBoundingClientRect(),n=t.clientX<i.left||t.clientX>i.right||t.clientY<i.top||t.clientY>i.bottom,s=kt(this,D,R).call(this,e);if(n)return e.dom.classList.remove(ce),void(xt(this,E)!==s&&(this.remove(e),xt(this,E)<s?this.appendBefore(e,this.dom.childNodes[xt(this,E)].ui):this.appendAfter(e,this.dom.childNodes[xt(this,E)-1].ui)));e.dom.classList.add(ce);const o=t.clientY-i.top;let r=null;const{childNodes:a}=this.dom;for(let l=0,h=a.length;l<h;l+=1){const t=a[l].ui,i=t.dom.offsetTop;if(l<s){if(o<=i+t.header.height){r=l;break}}else if(l>s&&o+e.height>=i+t.height){r=l;break}}null!==r&&s!==r&&(this.remove(e),r<s?this.appendBefore(e,a[r].ui):this.appendAfter(e,a[r-1].ui))}_onChildDragEnd(t,e){this.dom.classList.remove(ue),e.dom.classList.remove(ce);const i=kt(this,D,R).call(this,e);this.emit("child:dragend",e,i,xt(this,E)),Ct(this,E,-1)}forEachChild(t){for(let e=0,i=this.dom.childNodes.length;e<i;e+=1){const i=this.dom.childNodes[e].ui;if(i&&!1===t(i,e))break}}destroy(){this.destroyed||(null!==xt(this,P)&&(xt(this,P).removeEventListener("mousedown",this._onResizeStart),window.removeEventListener("mousemove",this._onResizeMove),window.removeEventListener("mouseup",this._onResizeEnd)),Ct(this,P,null),super.destroy())}set scrollable(t){xt(this,y)!==t&&(Ct(this,y,t),t?this.dom.classList.add("overflow-auto"):this.dom.classList.remove("overflow-auto"))}get scrollable(){return xt(this,y)}set resizable(t){t!==xt(this,C)&&(xt(this,C)&&this.dom.classList.remove(`${ee}-${xt(this,C)}`),Ct(this,C,t),Ct(this,k,"right"===t||"left"===t),t?(this.dom.classList.add(ee,`${ee}-${t}`),null===xt(this,P)&&this._createResizeHandle(),this.dom.appendChild(xt(this,P))):(this.dom.classList.remove(ee),null!==xt(this,P)&&this.dom.removeChild(xt(this,P))))}get resizable(){return xt(this,C)}}y=new WeakMap,C=new WeakMap,k=new WeakMap,E=new WeakMap,P=new WeakMap,M=new WeakMap,L=new WeakSet,V=function(){this.dom.classList.add(pe)},z=new WeakSet,A=function(t,e){if(xt(this,M)){if(xt(this,k)){let e=xt(this,M).x-t;"right"===xt(this,C)&&(e=-e),this.width=4+Math.max(this.resizeMin,Math.min(this.resizeMax,xt(this,M).width+e))}else{let t=xt(this,M).y-e;"bottom"===xt(this,C)&&(t=-t),this.height=Math.max(this.resizeMin,Math.min(this.resizeMax,xt(this,M).height+t))}this.emit("resize")}else Ct(this,M,{height:this.dom.clientHeight,width:this.dom.clientWidth,x:t,y:e})},S=new WeakSet,I=function(){Ct(this,M,null),this.dom.classList.remove(pe)},D=new WeakSet,R=function(t){const{childNodes:e}=this.dom;for(let i=0,n=e.length;i<n;i+=1)if(e[i].ui===t)return i;return-1};class me extends he{constructor(t={}){t.dom??(t.dom=document.createElement("span")),super(t),yt(this,j),ft(this,"renderChanges",!1),yt(this,T,""),this.dom.classList.add("align-middle","whitespace-nowrap","pcui-label"),this.text=t.text??"",t.allowTextSelection&&this.dom.classList.add("pcui-default-mousedown"),t.renderChanges&&(this.renderChanges=t.renderChanges),this.on("change",(()=>{this.renderChanges&&this.flash()}))}set text(t){kt(this,j,N).call(this,t)}get text(){return xt(this,T)}}T=new WeakMap,j=new WeakSet,N=function(t){return xt(this,T)!==t&&(Ct(this,T,t),this.dom.textContent=t,this.emit("change",t),!0)};class ge extends he{constructor(t={}){const e=document.createElement("input");super({dom:e,...t}),ft(this,"onValidate",null),ft(this,"renderChanges",!1),ft(this,"blurOnEnter",!0),ft(this,"blurOnEscape",!0),yt(this,F,!1),yt(this,O,!1),yt(this,B,""),ft(this,"_onInputChange",(t=>{if(!xt(this,O)){if(this.onValidate){const t=!this.onValidate(this.value);if(this.error=t,t)return}else this.error=!1;this.emit("change",this.value)}})),ft(this,"_onInputFocus",(t=>{this.dom.classList.add(se),this.emit("focus",t),Ct(this,B,this.value)})),ft(this,"_onInputBlur",(t=>{this.dom.classList.remove(se),this.emit("blur",t)})),ft(this,"_onInputKeyDown",(t=>{const e=t.key.toLowerCase(),i=this.dom;if("enter"===e&&this.blurOnEnter)Ct(this,O,this.keyChange),i.blur(),Ct(this,O,!1);else if("escape"===e){Ct(this,O,!0);const e=i.value;i.value=xt(this,B),Ct(this,O,!1),this.keyChange&&e!==xt(this,B)&&this._onInputChange(t),this.blurOnEscape&&i.blur()}this.emit("keydown",t)})),ft(this,"_onInputKeyUp",(t=>{"Escape"===t.key&&this._onInputChange(t),this.emit("keyup",t)})),ft(this,"_onInputCtxMenu",(t=>{this.dom.select()})),e.classList.add("pcui-text-input","font-mono","text-[11px]"),e.ui=this,e.tabIndex=0,e.autocomplete="off",e.addEventListener("change",this._onInputChange),e.addEventListener("focus",this._onInputFocus),e.addEventListener("blur",this._onInputBlur),e.addEventListener("keydown",this._onInputKeyDown),e.addEventListener("contextmenu",this._onInputCtxMenu,!1),void 0!==t.value&&(this.value=t.value),this.on("change",(()=>{this.renderChanges&&this.flash()})),this.on("disable",this._updateInputReadOnly.bind(this)),this.on("enable",this._updateInputReadOnly.bind(this)),this.on("readOnly",this._updateInputReadOnly.bind(this)),this._updateInputReadOnly()}_updateInputReadOnly(){!this.enabled||this.readOnly?this.dom.setAttribute("readonly","readonly"):this.dom.removeAttribute("readonly")}_updateValue(t){const e=this.dom;return t!==this.value&&(Ct(this,O,!0),e.value=t??"",Ct(this,O,!1),this.emit("change",t),!0)}focus(t){const e=this.dom;e.focus(),t&&e.select()}blur(){this.dom.blur()}destroy(){this.destroyed||(this.dom.removeEventListener("change",this._onInputChange),this.dom.removeEventListener("focus",this._onInputFocus),this.dom.removeEventListener("blur",this._onInputBlur),this.dom.removeEventListener("keydown",this._onInputKeyDown),this.dom.removeEventListener("keyup",this._onInputKeyUp),this.dom.removeEventListener("contextmenu",this._onInputCtxMenu),super.destroy(),this.dom=null)}set value(t){this._updateValue(t)&&(this.error=!1)}get value(){return this.dom.value}set keyChange(t){xt(this,F)!==t&&(Ct(this,F,t),t?this.dom.addEventListener("keyup",this._onInputKeyUp):this.dom.removeEventListener("keyup",this._onInputKeyUp))}get keyChange(){return xt(this,F)}get input(){return this.dom}}F=new WeakMap,O=new WeakMap,B=new WeakMap;const be="pcui-treeview-item",we=`${be}-icon`,fe=`${be}-text`,_e=`${be}-selected`,xe=`${be}-open`,ye=`${be}-contents`,Ce=`${be}-empty`,ke=`${be}-rename`,Ee=class extends ve{constructor(t){super({flex:!0,...t}),ft(this,"allowSelect",!0),ft(this,"allowDrag",!0),ft(this,"allowDrop",!0),ft(this,"treeOrder",-1),ft(this,"treeView"),yt(this,K,0),ft(this,"containerContents"),yt(this,U,void 0),yt(this,$,void 0),yt(this,q,!1),yt(this,H,""),ft(this,"_onContentKeyDown",(t=>{var e;"input"===t.target.tagName.toLowerCase()||!this.allowSelect||null==(e=this.treeView)||e._onChildKeyDown(t,this)})),ft(this,"_onContentMouseDown",(t=>{void 0===this.treeView||!this.treeView.allowDrag||!this.allowDrag||(this.treeView._updateModifierKeys(t),t.stopPropagation())})),ft(this,"_onContentMouseUp",(t=>{var e;t.stopPropagation(),t.preventDefault(),window.removeEventListener("mouseup",this._onContentMouseUp),null==(e=this.treeView)||e._onChildDragEnd(t,this)})),ft(this,"_onContentMouseOver",(t=>{var e;t.stopPropagation(),null==(e=this.treeView)||e._onChildDragOver(t,this)})),ft(this,"_onContentDragStart",(t=>{t.stopPropagation(),t.preventDefault(),void 0!==this.treeView&&this.treeView.allowDrag&&!this.dom.classList.contains(ke)&&(this.treeView._onChildDragStart(t,this),window.addEventListener("mouseup",this._onContentMouseUp))})),ft(this,"_onContentClick",(t=>{if(!this.allowSelect||0!==t.button||"input"===t.target.tagName.toLowerCase())return;t.stopPropagation();const e=this.containerContents.dom.getBoundingClientRect();xt(this,K)>0&&t.clientX-e.left<0?(this.open=!this.open,t.altKey&&this.traverseDepthFirst((t=>{t.open=this.open})),this.focus()):this.treeView&&this.treeView._onChildClick(t,this)})),ft(this,"_onContentDblClick",(t=>{if(!this.treeView||!this.treeView.allowRenaming||0!==t.button||"input"===t.target.tagName.toLowerCase())return;t.stopPropagation();const e=this.containerContents.dom.getBoundingClientRect();this.numChildren&&t.clientX-e.left<0||(this.allowSelect&&(this.treeView.deselect(),this.treeView._onChildClick(t,this)),this.rename())})),ft(this,"_onContentContextMenu",(t=>{var e,i;null==(i=null==(e=this.treeView)?void 0:e.onContextMenu)||i.call(e,t,this)})),ft(this,"_onContentFocus",(t=>{this.emit("focus",t)})),ft(this,"_onContentBlur",(t=>{this.emit("blur",t)})),this.dom.classList.add(be,Ce,"relative","pl-8","h-[20px]"),this.containerContents=new ve,this.containerContents.dom.classList.add(ye,"relative","flex","flex-row"),this.containerContents.dom.tabIndex=0,this.append(this.containerContents),this.containerContents.dom.draggable=!0,Ct(this,U,new me),xt(this,U).dom.classList.add(we),this.containerContents.append(xt(this,U)),this.icon=t.icon??"",Ct(this,$,new me),xt(this,$).dom.classList.add(fe),this.containerContents.append(xt(this,$)),this.text=t.text,this.selected=t.selected??!1,this.containerContents.dom.addEventListener("focus",this._onContentFocus),this.containerContents.dom.addEventListener("blur",this._onContentBlur),this.containerContents.dom.addEventListener("keydown",this._onContentKeyDown),this.containerContents.dom.addEventListener("dragstart",this._onContentDragStart),this.containerContents.dom.addEventListener("mousedown",this._onContentMouseDown),this.containerContents.dom.addEventListener("mouseover",this._onContentMouseOver),this.containerContents.dom.addEventListener("click",this._onContentClick),this.containerContents.dom.addEventListener("dblclick",this._onContentDblClick),this.containerContents.dom.addEventListener("contextmenu",this._onContentContextMenu)}_onAppendChild(t){var e;super._onAppendChild(t),t instanceof Ee&&(Ct(this,K,xt(this,K)+1),this.parent!==this.treeView&&this.dom.classList.remove(Ce),null==(e=this.treeView)||e._onAppendTreeViewItem(t))}_onRemoveChild(t){var e;t instanceof Ee&&(Ct(this,K,xt(this,K)-1),0===xt(this,K)&&this.dom.classList.add(Ce),null==(e=this.treeView)||e._onRemoveTreeViewItem(t)),super._onRemoveChild(t)}traverseDepthFirst(t){t(this);let e=this.firstChild;for(;e;)e.traverseDepthFirst(t),e=e.nextSibling,null!==e&&t(e)}rename(){this.dom.classList.add(ke);const t=new ge({value:this.text});t.on("blur",(()=>{t.destroy()})),t.on("destroy",(()=>{this.dom.classList.remove(ke),this.focus()})),t.on("change",(e=>{const i=e.trim();i&&(this.text=i,t.destroy())})),t.on("disable",(()=>{t.input.removeAttribute("readonly")})),this.containerContents.append(t),t.focus(!0)}focus(){this.containerContents.dom.focus()}blur(){this.containerContents.dom.blur()}destroy(){this.destroyed||(this.containerContents.dom.removeEventListener("focus",this._onContentFocus),this.containerContents.dom.removeEventListener("blur",this._onContentBlur),this.containerContents.dom.removeEventListener("keydown",this._onContentKeyDown),this.containerContents.dom.removeEventListener("mousedown",this._onContentMouseDown),this.containerContents.dom.removeEventListener("dragstart",this._onContentDragStart),this.containerContents.dom.removeEventListener("mouseover",this._onContentMouseOver),this.containerContents.dom.removeEventListener("click",this._onContentClick),this.containerContents.dom.removeEventListener("dblclick",this._onContentDblClick),this.containerContents.dom.removeEventListener("contextmenu",this._onContentContextMenu),window.removeEventListener("mouseup",this._onContentMouseUp),super.destroy())}set selected(t){t!==this.selected?t?(this.containerContents.dom.classList.add(_e),this.emit("select",this),this.treeView&&this.treeView._onChildSelected(this),this.focus()):(this.containerContents.dom.classList.remove(_e),this.blur(),this.emit("deselect",this),this.treeView&&this.treeView._onChildDeselected(this)):t&&this.focus()}get selected(){return this.containerContents.dom.classList.contains(_e)}set text(t){xt(this,$).text!==t&&(xt(this,$).text=t,this.treeView&&this.treeView._onChildRename(this,t))}get text(){return xt(this,$).text}get textLabel(){return xt(this,$)}get iconLabel(){return xt(this,U)}set open(t){xt(this,q)!==t&&(Ct(this,q,t),t?(this.dom.classList.add(xe),this.emit("open",this)):(this.dom.classList.remove(xe),this.emit("close",this)))}get open(){return xt(this,q)||this.parent===this.treeView}set parentsOpen(t){let{parent:e}=this;for(;e&&e instanceof Ee;)e.open=t,e=e.parent}get parentsOpen(){let{parent:t}=this;for(;t&&t instanceof Ee;){if(!t.open)return!1;t=t.parent}return!0}get numChildren(){return xt(this,K)}get firstChild(){if(xt(this,K))for(let t=0;t<this.dom.childNodes.length;t+=1)if(this.dom.childNodes[t].ui instanceof Ee)return this.dom.childNodes[t].ui;return null}get lastChild(){if(xt(this,K))for(let t=this.dom.childNodes.length-1;t>=0;t-=1)if(this.dom.childNodes[t].ui instanceof Ee)return this.dom.childNodes[t].ui;return null}get nextSibling(){let t=this.dom.nextSibling;for(;t&&!(t.ui instanceof Ee);)t=t.nextSibling;return null==t?void 0:t.ui}get previousSibling(){let t=this.dom.previousSibling;for(;t&&!(t.ui instanceof Ee);)t=t.previousSibling;return null==t?void 0:t.ui}set icon(t){Ct(this,H,t),t?xt(this,U).dom.setAttribute("data-icon",t):xt(this,U).dom.removeAttribute("data-icon")}get icon(){return xt(this,H)}};let Pe=Ee;K=new WeakMap,U=new WeakMap,$=new WeakMap,q=new WeakMap,H=new WeakMap;const Me=(t,e)=>{if(0===t.length)return e.length;if(0===e.length)return t.length;if(t===e)return 0;let i=0,n=0,s=0,o=0;const r=[];for(i=0,s=e.length;i<=s;i+=1)r[i]=[i];for(i=0,s=t.length;i<=s;i+=1)r[0][i]=i;for(i=1,s=e.length;i<=s;i+=1)for(n=1,o=t.length;n<=o;n+=1)e.charAt(i-1)===t.charAt(n-1)?r[i][n]=r[i-1][n-1]:r[i][n]=Math.min(r[i-1][n-1]+1,Math.min(r[i][n-1]+1,r[i-1][n]+1));return r[e.length][t.length]},Le=(t,e)=>{if(t===e)return t.length;let i=0;const n={};let s;for(s=0;s<e.length;s+=1)n[e.charAt(s)]=!0;for(s=0;s<t.length;s+=1)n[t.charAt(s)]&&(i+=1);return i},Ve=t=>{const e=[],i=t.replace(/([^A-Z])([A-Z][^A-Z])/g,"$1 $2").replace(/([A-Z0-9]{2,})/g," $1").split(/(\s|-|_)/g);for(let n=0,s=i.length;n<s;n+=1)i[n]=i[n].toLowerCase().trim(),i[n]&&"-"!==i[n]&&"_"!==i[n]&&e.push(i[n]);return e},ze=(t,e,i)=>{const n=[];for(let s=0,o=t.length;s<o;s+=1){const o=t[s];if(o.subFull!==1/0){n.push(o),o.edits===1/0&&(o.edits=0),o.sub===1/0&&(o.sub=o.subFull);continue}if(o.name===e||0===o.name.indexOf(e)){n.push(o),o.edits===1/0&&(o.edits=0),o.sub===1/0&&(o.sub=0);continue}if(Le(e,o.name)/e.length<i.containsCharsTolerance)continue;let r=1/0,a=1/0;for(let t=0;t<o.tokens.length;t+=1){if(o.tokens[t]===e){r=0,a=t;break}const n=Me(e,o.tokens[t]);(a===1/0||n<r)&&-1!==o.tokens[t].indexOf(e)?(a=t,r=n):a===1/0&&n<r&&n/Math.max(e.length,o.tokens[t].length)<=i.editsDistanceTolerance&&(r=n)}r!==1/0&&(n.push(o),o.edits=o.edits===1/0?r:o.edits+r,o.sub=o.sub===1/0?a:o.sub+a)}return n},Ae="pcui-treeview",Se=`${Ae}-item-dragged`,Ie=`${Ae}-drag-handle`,De=`${Ae}-filtering`,Re=`${De}-result`,Te="inside",je="before",Ne="after",Fe=(t,e)=>Array.prototype.indexOf.call(e.dom.childNodes,t.dom)-1,Oe=t=>{if(t.numChildren>0&&t.open)return t.firstChild;const{nextSibling:e}=t;if(e)return e;let{parent:i}=t;if(!(i instanceof Pe))return null;let n=i.nextSibling;for(;!n&&(i=i.parent,i instanceof Pe);)n=i.nextSibling;return n},Be=t=>{const e=t.previousSibling;if(e)return e.numChildren>0&&e.open?(t=>{if(!t.numChildren||!t.open)return null;let e=t.lastChild;for(;(null==e?void 0:e.numChildren)&&e.open;)e=e.lastChild;return e})(e):e;const i=t.parent;return i instanceof Pe?i:null};class Ke extends ve{constructor(t={}){super(t),yt(this,lt),yt(this,vt),yt(this,gt),ft(this,"allowReordering",!0),ft(this,"allowRenaming",!0),ft(this,"onContextMenu",null),yt(this,W,!0),yt(this,Y,!0),yt(this,X,[]),yt(this,G,[]),yt(this,Z,!1),yt(this,Q,null),yt(this,J,!1),yt(this,tt,!1),yt(this,et,0),yt(this,it,-1),yt(this,nt,Te),yt(this,st,""),yt(this,ot,[]),yt(this,rt,document.createElement("div")),yt(this,at,void 0),ft(this,"_updateModifierKeys",(t=>{Ct(this,J,t.ctrlKey||t.metaKey),Ct(this,tt,t.shiftKey)})),yt(this,pt,(t=>{!xt(this,W)||!xt(this,Z)||(Ct(this,Q,null),kt(this,vt,mt).call(this))})),yt(this,dt,(t=>{const e=this.dom.getBoundingClientRect(),i=xt(this,at).dom;Ct(this,et,0);let{top:n,bottom:s}=e;if(xt(this,at)!==this){const t=i.getBoundingClientRect();n=Math.max(n+i.scrollTop,t.top),s=Math.min(s+i.scrollTop,t.bottom)}n=Math.max(0,n),s=Math.min(s,document.body.clientHeight),t.pageY<n+32&&i.scrollTop>0?Ct(this,et,-1):t.pageY>s-32&&i.scrollHeight>xt(this,at).height+i.scrollTop&&Ct(this,et,1)})),yt(this,ct,(()=>{!xt(this,Z)||0!==xt(this,et)&&(xt(this,at).dom.scrollTop+=8*xt(this,et),Ct(this,Q,null),kt(this,vt,mt).call(this))})),yt(this,ut,(t=>{if(t.preventDefault(),t.stopPropagation(),!xt(this,W)||null===xt(this,Q))return;const e=xt(this,rt).getBoundingClientRect(),i=xt(this,Q).dom.getBoundingClientRect().height,n=Math.floor((t.clientY-e.top)/i*5),s=xt(this,nt),o=xt(this,Q),r=xt(this,G);if(xt(this,Q).parent===this){let t=!1;for(let e=0,i=r.length;e<i;e+=1)if(r[e].parent===xt(this,Q)){t=!0,Ct(this,Q,null);break}t||Ct(this,nt,Te)}else{let t=!1;for(let e=0,i=r.length;e<i;e+=1)if(r[e].dom.contains(xt(this,Q).dom)){t=!0;break}if(t)Ct(this,Q,null);else if(this.allowReordering&&n<=1&&!r.includes(xt(this,Q).previousSibling))Ct(this,nt,je);else if(!(this.allowReordering&&n>=4)||r.includes(xt(this,Q).nextSibling)||0!==xt(this,Q).numChildren&&xt(this,Q).open){let t=!1;if(this.allowReordering&&xt(this,Q).open)for(let e=0;e<r.length;e+=1)if(r[e].parent===xt(this,Q)){t=!0,Ct(this,nt,je);break}t||Ct(this,nt,Te)}else Ct(this,nt,Ne)}(s!==xt(this,nt)||o!==xt(this,Q))&&kt(this,vt,mt).call(this)})),this.dom.classList.add(Ae,"z-10","bg-default-gray","text-white","min-w-max","font-mono","text-[11px]"),xt(this,rt).className=`${Ie} fixed z-[4] -mt-1 -ml-1`,Ct(this,at,this),this.dom.append(xt(this,rt)),window.addEventListener("keydown",this._updateModifierKeys),window.addEventListener("keyup",this._updateModifierKeys),window.addEventListener("mousedown",this._updateModifierKeys),this.dom.addEventListener("mouseleave",xt(this,pt))}_getChildrenRange(t,e){const i=[];if(xt(this,ot).length>0){const n=this.dom.querySelectorAll(`.${Ae}-item.${Re}`);let s=-1,o=-1;for(let r=0,a=n.length;r<a;r+=1){const a=n[r].ui;if(a===t?s=r:a===e&&(o=r),-1!==s&&-1!==o){const t=s<o?o:s;for(let e=s<o?s:o;e<=t;e+=1)i.push(n[e].ui);break}}}else{let n=t;const s=t.dom.getBoundingClientRect(),o=e.dom.getBoundingClientRect();if(s.top<o.top)for(;n&&n!==e;)n=Oe(n),n&&n!==e&&i.push(n);else for(;n&&n!==e;)n=Be(n),n&&n!==e&&i.push(n);i.push(e)}return i}_onAppendChild(t){super._onAppendChild(t),t instanceof Pe&&this._onAppendTreeViewItem(t)}_onRemoveChild(t){t instanceof Pe&&this._onRemoveTreeViewItem(t),super._onRemoveChild(t)}_onAppendTreeViewItem(t){t.treeView=this,""!==xt(this,st)&&this._searchItems([[t.text,t]],xt(this,st)),t.forEachChild((t=>{t instanceof Pe&&this._onAppendTreeViewItem(t)}))}_onRemoveTreeViewItem(t){t.selected=!1,t.forEachChild((t=>{t instanceof Pe&&this._onRemoveTreeViewItem(t)}))}_onChildKeyDown(t,e){const i=t.key.toLowerCase();if("tab"===i||"arrowleft"===i||"arrowup"===i||"arrowright"===i||"arrowdown"===i)if(t.preventDefault(),t.stopPropagation(),"arrowdown"===i){if(xt(this,X).length>0){const t=Oe(e);t&&(xt(this,tt)||xt(this,J)?t.selected=!0:kt(this,gt,bt).call(this,t))}}else if("arrowup"===i){if(xt(this,X).length>0){const t=Be(e);t&&(xt(this,tt)||xt(this,J)?t.selected=!0:kt(this,gt,bt).call(this,t))}}else"arrowleft"===i?e.parent!==this&&(e.open=!1):"arrowright"===i&&(e.open=!0)}_onChildClick(t,e){if(0===t.button&&e.allowSelect)if(xt(this,J))e.selected=!e.selected;else if(xt(this,tt)){if(!xt(this,X).length||1===xt(this,X).length&&xt(this,X)[0]===e)return void(e.selected=!0);const t=xt(this,X)[xt(this,X).length-1];t.parentsOpen=!0,this._getChildrenRange(t,e).forEach((t=>{t.allowSelect&&(t.selected=!0)}))}else kt(this,gt,bt).call(this,e)}traverseDepthFirst(t){const e=i=>{if(i instanceof Pe&&(t(i),i.numChildren))for(let t=0,n=i.dom.childNodes.length;t<n;t+=1)e(i.dom.childNodes[t].ui)};for(let i=0,n=this.dom.childNodes.length;i<n;i+=1)e(this.dom.childNodes[i].ui)}_onChildDragStart(t,e){if(this.allowDrag&&!xt(this,Z)){if(Ct(this,G,[]),xt(this,X).includes(e)){const t=[];let e=-1;for(let i=0,n=xt(this,X).length;i<n;i+=1){let{parent:n}=xt(this,X)[i],s=0,o=!1;for(;n instanceof Pe;){if(xt(this,X).includes(n)){o=!0;break}s+=1,n=n.parent}if(!o){if(-1===e)e=s;else if(e!==s)return;t.push(xt(this,X)[i])}}Ct(this,G,t)}else e.dom.classList.add(Se),xt(this,G).push(e);if(xt(this,G).length>0){for(let t=0,e=xt(this,G).length;t<e;t+=1)xt(this,G)[t].dom.classList.add(Se);this.isDragging=!0,this.emit("dragstart",xt(this,G))}}}_onChildDragEnd(t,e){var i;if(!this.allowDrag||!xt(this,Z))return;const n=xt(this,G);for(let o=0,r=n.length;o<r;o+=1)n[o].dom.classList.remove(Se);let s=!1;for(let o=0,r=n.length;o<r;o+=1)if(n[o].parent===this){s=!0;break}if(!s&&xt(this,Q)&&(n.length>1&&(kt(this,lt,ht).call(this),n.sort(((t,e)=>t.treeOrder-e.treeOrder))),n.length>0)){const t=[];for(let e=0,s=n.length;e<s;e+=1){const s=n[e];if(s.parent===xt(this,Q)&&xt(this,nt)===Te)return;t.push({item:s,oldParent:s.parent}),null==(i=s.parent)||i.remove(s)}for(let e=0,i=t.length;e<i;e+=1){const i=t[e];xt(this,nt)===je?(i.newParent=xt(this,Q).parent,xt(this,Q).parent.appendBefore(i.item,xt(this,Q)),i.newChildIndex=Fe(i.item,i.newParent)):xt(this,nt)===Te?(i.newParent=xt(this,Q),xt(this,Q).append(i.item),xt(this,Q).open=!0,i.newChildIndex=Fe(i.item,i.newParent)):xt(this,nt)===Ne&&(i.newParent=xt(this,Q).parent,xt(this,Q).parent.appendAfter(i.item,e>0?t[e-1].item:xt(this,Q)),i.newChildIndex=Fe(i.item,i.newParent))}t.length>0&&this.emit("reparent",t)}n.splice(0,n.length),this.isDragging=!1,this.emit("dragend")}_onChildDragOver(t,e){!xt(this,W)||!xt(this,Z)||(e.allowDrop&&!xt(this,G).includes(e)?Ct(this,Q,e):Ct(this,Q,null),kt(this,vt,mt).call(this),xt(this,ut).call(this,t))}_onChildSelected(t){xt(this,X).push(t),t.parentsOpen=!0,this.emit("select",t)}_onChildDeselected(t){const e=xt(this,X).indexOf(t);-1!==e&&(xt(this,X).splice(e,1),this.emit("deselect",t))}_onChildRename(t,e){if(""!==xt(this,st)){t.dom.classList.remove(Re);const e=xt(this,ot).indexOf(t);-1!==e&&xt(this,ot).splice(e,1),this._searchItems([[t.text,t]],xt(this,st))}this.emit("rename",t,e)}_searchItems(t,e){const i=((t,e,i={})=>{let n=0,s=0;const o=(e||"").toLowerCase().trim();if(!o)return[];const r=Ve(o);if(!r.length)return[];i.containsCharsTolerance??(i.containsCharsTolerance=.5),i.editsDistanceTolerance??(i.editsDistanceTolerance=.5);let a=[];for(n=0,s=t.length;n<s;n+=1){const e=t[n][0].toLowerCase().trim().indexOf(o);a.push({edits:1/0,item:t[n][1],name:t[n][0],sub:1/0,subFull:-1===e?1/0:e,tokens:Ve(t[n][0])})}for(n=0,s=r.length;n<s;n+=1)a=ze(a,r[n],i);a.sort(((t,e)=>t.subFull!==e.subFull?t.subFull-e.subFull:t.sub!==e.sub?t.sub-e.sub:t.edits!==e.edits?t.edits-e.edits:t.name.length-e.name.length));const l=[];for(n=0,s=a.length;n<s;n+=1)l[n]=a[n].item;return void 0!==i.limitResults&&l.length>i.limitResults?l.slice(0,i.limitResults):l})(t,e);if(!(i.length<1))for(let n=0,s=i.length;n<s;n+=1)xt(this,ot).push(i[n]),i[n].dom.classList.add(Re)}_applyFilter(t){this._clearFilter(),Ct(this,Y,xt(this,W)),Ct(this,W,!1),this.dom.classList.add(De);const e=[];this.traverseDepthFirst((t=>{e.push([t.text,t])})),this._searchItems(e,t)}_clearFilter(){xt(this,ot).forEach((t=>{t.destroyed||t.dom.classList.remove(Re)})),xt(this,ot).splice(0,xt(this,ot).length),this.dom.classList.remove(De),Ct(this,W,xt(this,Y))}showDragHandle(t){kt(this,vt,mt).call(this,t,!0)}deselect(){let t=xt(this,X).length-1;for(;t>-1;)xt(this,X)[t]&&(xt(this,X)[t].selected=!1),t-=1}clearTreeItems(){let t=this.dom.childNodes.length-1;for(;t>-1;){const e=this.dom.childNodes[t];if(!e){t-=1;continue}const{ui:i}=e.ui;i instanceof Pe&&i.destroy(),t-=1}xt(this,X).splice(0,xt(this,X).length),xt(this,G).splice(0,xt(this,G).length),Ct(this,W,xt(this,Y))}destroy(){this.destroyed||(this.dom.removeEventListener("mousemove",xt(this,ut)),window.removeEventListener("keydown",this._updateModifierKeys),window.removeEventListener("keyup",this._updateModifierKeys),window.removeEventListener("mousedown",this._updateModifierKeys),window.removeEventListener("mousemove",xt(this,dt)),this.dom.removeEventListener("mouseleave",xt(this,pt)),xt(this,it)>-1&&(clearInterval(xt(this,it)),Ct(this,it,-1)),super.destroy())}set allowDrag(t){Ct(this,W,t),""!==xt(this,st)&&Ct(this,Y,t)}get allowDrag(){return xt(this,W)}set isDragging(t){xt(this,Z)!==t&&(t?(Ct(this,Z,!0),kt(this,vt,mt).call(this),this.dom.addEventListener("mousemove",xt(this,ut)),(this.scrollable||xt(this,at)!==this)&&(window.removeEventListener("mousemove",xt(this,dt)),window.addEventListener("mousemove",xt(this,dt)),-1===xt(this,it)&&Ct(this,it,setInterval(xt(this,ct),1e3/60)))):(Ct(this,Q,null),kt(this,vt,mt).call(this),Ct(this,Z,!1),this.dom.removeEventListener("mousemove",xt(this,ut)),window.removeEventListener("mousemove",xt(this,dt)),xt(this,it)>-1&&(clearInterval(xt(this,it)),Ct(this,it,-1))))}get isDragging(){return xt(this,Z)}get selected(){return[...xt(this,X)]}set filter(t){xt(this,st)!==t&&(Ct(this,st,t),t?this._applyFilter(t):this._clearFilter())}get filter(){return xt(this,st)}get pressedCtrl(){return xt(this,J)}get pressedShift(){return xt(this,tt)}}W=new WeakMap,Y=new WeakMap,X=new WeakMap,G=new WeakMap,Z=new WeakMap,Q=new WeakMap,J=new WeakMap,tt=new WeakMap,et=new WeakMap,it=new WeakMap,nt=new WeakMap,st=new WeakMap,ot=new WeakMap,rt=new WeakMap,at=new WeakMap,lt=new WeakSet,ht=function(){let t=0;this.traverseDepthFirst((e=>{t+=1,e.treeOrder=t}))},pt=new WeakMap,dt=new WeakMap,ct=new WeakMap,ut=new WeakMap,vt=new WeakSet,mt=function(t,e){if(!(e||xt(this,W)&&xt(this,Z)))return;const i=t??xt(this,Q);if(i&&!i.hidden&&i.parentsOpen){const t=xt(this,rt),e=i.containerContents.dom.getBoundingClientRect();t.hidden=!1,t.classList.remove(Ne,je,Te),t.classList.add(xt(this,nt));const{top:n,height:s}=e;let{left:o,width:r}=e;if(this.dom.parentElement){const t=this.dom.parentElement.getBoundingClientRect();o=Math.max(o,t.left),r=Math.min(r,this.dom.parentElement.clientWidth-o+t.left)}t.style.height=`${s}px`,t.style.top=`${n}px`,t.style.width=r-7+"px"}else xt(this,rt).hidden=!0},gt=new WeakSet,bt=function(t){let e=xt(this,X).length,i=!1;for(;e>-1;)xt(this,X)[e]&&xt(this,X)[e]!==t&&(xt(this,X)[e].selected=!1,i=!0),e-=1;t.selected=!!i||!t.selected};var Ue={exports:{}};!function(t){class e{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class i{constructor(t){this.target=t}}class n extends i{constructor(t,e,i,n){super(t),this.value=e,this.presetKey=i,this.last=n??!0}}function s(t){return null==t}const o={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class r{constructor(t){var e;this.message=null!==(e=o[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new r({type:"alreadydisposed"})}static notBindable(){return new r({type:"notbindable"})}static propertyNotFound(t){return new r({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new r({type:"shouldneverhappen"})}}class a{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter((t=>t.handler!==e))),this}emit(t,e){const i=this.observers_[t];!i||i.forEach((t=>{t.handler(e)}))}}const l="tp";function h(t){return(e,i)=>[l,"-",t,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function p(t,e){return i=>e(t(i))}function d(t){return t.rawValue}function c(t,e){t.emitter.on("change",p(d,e)),e(t.rawValue)}function u(t,e,i){c(t.value(e),i)}function v(t,e,i){i?t.classList.add(e):t.classList.remove(e)}function m(t,e){return i=>{v(t,e,i)}}function g(t,e){c(t,(t=>{e.textContent=t??""}))}const b=h("btn");class w{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(b()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(b("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElement("div");n.classList.add(b("t")),g(e.props.value("title"),n),this.buttonElement.appendChild(n)}}class f{constructor(t,e){this.emitter=new a,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new w(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class _{constructor(t,e){var i;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(i=null==e?void 0:e.equals)&&void 0!==i?i:(t,e)=>t===e,this.emitter=new a,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(t):t;this.equals_(this.rawValue_,n)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:i,rawValue:n,sender:this}))}}class x{constructor(t){this.emitter=new a,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0};this.value_===t&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:i,rawValue:this.value_,sender:this}))}}function y(t,e){const i=null==e?void 0:e.constraint,n=null==e?void 0:e.equals;return i||n?new _(t,e):new x(t)}class C{constructor(t){this.emitter=new a,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,i)=>Object.assign(e,{[i]:y(t[i])})),{})}static fromObject(t){const e=this.createCore(t);return new C(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function k(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function E(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function P(t){return null!==t&&"object"==typeof t}function M(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function L(t){return{custom:e=>M(e)(t),boolean:M((t=>"boolean"==typeof t?t:void 0))(t),number:M((t=>"number"==typeof t?t:void 0))(t),string:M((t=>"string"==typeof t?t:void 0))(t),function:M((t=>"function"==typeof t?t:void 0))(t),constant:e=>M((t=>t===e?e:void 0))(t),raw:M((t=>t))(t),object:e=>M((t=>{if(P(t))return k(t,e)}))(t),array:e=>M((t=>{if(Array.isArray(t))return E(t,e)}))(t)}}const V={optional:L(!0),required:L(!1)};function z(t,e){const i=V.required.object(e)(t);return i.succeeded?i.value:void 0}function A(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}function S(){return["veryfirst","first","last","verylast"]}const I=h(""),D={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class R{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{S().forEach((t=>{e.classList.remove(I(void 0,D[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(I(void 0,D[t]))}))})),this.viewProps.handleDispose((()=>{A(e)}))}get parent(){return this.parent_}}const T="http://www.w3.org/2000/svg";function j(t){t.offsetHeight}function N(t,e){const i=t.style.transition;t.style.transition="none",e(),t.style.transition=i}function F(t){return void 0!==t.ontouchstart}function O(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function B(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const K=h("lbl");function U(t,e){const i=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,n)=>{n>0&&i.appendChild(t.createElement("br")),i.appendChild(e)})),i}class ${constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(K()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(K("l")),u(e.props,"label",(e=>{s(e)?this.element.classList.add(K(void 0,"nol")):(this.element.classList.remove(K(void 0,"nol")),O(i),i.appendChild(U(t,e)))})),this.element.appendChild(i),this.labelElement=i;const n=t.createElement("div");n.classList.add(K("v")),this.element.appendChild(n),this.valueElement=n}}class q extends R{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new $(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class H extends R{constructor(t){super(t),this.value=t.value}}class W extends C{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=C.createCore(e);return new W(i)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!s(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const i=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};u(this,"expanded",i),u(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Y(t){return W.create(t)}function X(t,e){let i=0;return N(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),j(e),i=e.clientHeight,t.set("temporaryExpanded",null),j(e)})),i}function G(t,e){e.style.height=t.styleHeight}function Z(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),s(t.get("expandedHeight"))&&t.set("expandedHeight",X(t,e)),t.set("shouldFixHeight",!0),j(e)})),t.emitter.on("change",(()=>{G(t,e)})),G(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&t.cleanUpTransition()}))}class Q{constructor(t,e){const i=h(e.viewName);this.element=t.createElement("div"),this.element.classList.add(i()),e.viewProps.bindClassModifiers(this.element)}}class J extends H{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new $(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const tt=h("");function et(t,e){return m(t,tt(void 0,e))}class it extends C{constructor(t){super(t)}static create(t){var e,i;const n=t??{},s={disabled:null!==(e=n.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=n.hidden)&&void 0!==i&&i},o=C.createCore(s);return new it(o)}bindClassModifiers(t){u(this,"disabled",et(t,"disabled")),u(this,"hidden",et(t,"hidden"))}bindDisabled(t){u(this,"disabled",(e=>{t.disabled=e}))}bindTabIndex(t){u(this,"disabled",(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}}class nt{constructor(){this.disabled=!1,this.emitter=new a}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class st{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new a,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class ot{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function rt(t,e){if(t instanceof e)return t;if(t instanceof ot){const i=t.constraints.reduce(((t,i)=>t||(i instanceof e?i:null)),null);if(i)return i}return null}class at{constructor(t){this.maxValue=t.max,this.minValue=t.min}constrain(t){let e=t;return s(this.minValue)||(e=Math.max(e,this.minValue)),s(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}class lt{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}const ht=h("pop");class pt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ht()),e.viewProps.bindClassModifiers(this.element),c(e.shows,m(this.element,ht(void 0,"v")))}}class dt{constructor(t,e){this.shows=y(!1),this.viewProps=e.viewProps,this.view=new pt(t,{shows:this.shows,viewProps:this.viewProps})}}const ct=h("txt");class ut{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ct()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const i=t.createElement("input");i.classList.add(ct("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class vt{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ut(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);s(i)||(this.value.rawValue=i),this.view.refresh()}}function mt(t){return"false"!==t&&!!t}class gt{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const bt={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class wt{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=bt[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const ft={"+":t=>t,"-":t=>-t,"~":t=>~t};class _t{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=ft[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function xt(t){return(e,i)=>{for(let n=0;n<t.length;n++){const s=t[n](e,i);if(""!==s)return s}return""}}function yt(t,e){var i;const n=t.substr(e).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Ct(t,e){const i=t.substr(e,1);return i.match(/^[1-9]$/)?i:""}function kt(t,e){var i;const n=t.substr(e).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Et(t,e){const i=kt(t,e);if(""!==i)return i;const n=t.substr(e,1);if("-"!==n&&"+"!==n)return"";const s=kt(t,e+=1);return""===s?"":n+s}function Pt(t,e){const i=t.substr(e,1);if(e+=1,"e"!==i.toLowerCase())return"";const n=Et(t,e);return""===n?"":i+n}function Mt(t,e){const i=t.substr(e,1);if("0"===i)return i;const n=Ct(t,e);return e+=n.length,""===n?"":n+kt(t,e)}function Lt(t,e){const i=Mt(t,e);if(e+=i.length,""===i)return"";const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const s=kt(t,e);return i+n+s+Pt(t,e+=s.length)}function Vt(t,e){const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const n=kt(t,e);return e+=n.length,""===n?"":i+n+Pt(t,e)}function zt(t,e){const i=Mt(t,e);return e+=i.length,""===i?"":i+Pt(t,e)}const At=xt([Lt,Vt,zt]);function St(t,e){var i;const n=t.substr(e).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function It(t,e){const i=t.substr(e,2);if(e+=i.length,"0b"!==i.toLowerCase())return"";const n=St(t,e);return""===n?"":i+n}function Dt(t,e){var i;const n=t.substr(e).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Rt(t,e){const i=t.substr(e,2);if(e+=i.length,"0o"!==i.toLowerCase())return"";const n=Dt(t,e);return""===n?"":i+n}function Tt(t,e){var i;const n=t.substr(e).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}function jt(t,e){const i=t.substr(e,2);if(e+=i.length,"0x"!==i.toLowerCase())return"";const n=Tt(t,e);return""===n?"":i+n}const Nt=xt([It,Rt,jt]),Ft=xt([Nt,At]);function Ot(t,e){const i=Ft(t,e);return e+=i.length,""===i?null:{evaluable:new gt(i),cursor:e}}function Bt(t,e){const i=t.substr(e,1);if(e+=i.length,"("!==i)return null;const n=Wt(t,e);if(!n)return null;e=n.cursor,e+=yt(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:n.evaluable,cursor:e}}function Kt(t,e){var i;return null!==(i=Ot(t,e))&&void 0!==i?i:Bt(t,e)}function Ut(t,e){const i=Kt(t,e);if(i)return i;const n=t.substr(e,1);if(e+=n.length,"+"!==n&&"-"!==n&&"~"!==n)return null;const s=Ut(t,e);return s?{cursor:e=s.cursor,evaluable:new _t(n,s.evaluable)}:null}function $t(t,e,i){i+=yt(e,i).length;const n=t.filter((t=>e.startsWith(t,i)))[0];return n?(i+=n.length,{cursor:i+=yt(e,i).length,operator:n}):null}function qt(t,e){return(i,n)=>{const s=t(i,n);if(!s)return null;n=s.cursor;let o=s.evaluable;for(;;){const s=$t(e,i,n);if(!s)break;n=s.cursor;const r=t(i,n);if(!r)return null;n=r.cursor,o=new wt(s.operator,o,r.evaluable)}return o?{cursor:n,evaluable:o}:null}}const Ht=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>qt(t,e)),Ut);function Wt(t,e){return e+=yt(t,e).length,Ht(t,e)}function Yt(t){const e=Wt(t,0);return e&&e.cursor+yt(t,e.cursor).length===t.length?e.evaluable:null}function Xt(t){var e;const i=Yt(t);return null!==(e=null==i?void 0:i.evaluate())&&void 0!==e?e:null}function Gt(t){if("number"==typeof t)return t;if("string"==typeof t){const e=Xt(t);if(!s(e))return e}return 0}function Zt(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}function Qt(t){return String(t)}function Jt(t,e){for(;t.length<e;)t.push(void 0)}function te(t){const e=[];return Jt(e,t),y(e)}function ee(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function ie(t,e){const i=[...ee(t),e];return i.length>t.length?i.splice(0,i.length-t.length):Jt(i,t.length),i}function ne({primary:t,secondary:e,forward:i,backward:n}){let s=!1;function o(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(n=>{o((()=>{e.setRawValue(i(t,e),n.options)}))})),e.emitter.on("change",(s=>{o((()=>{t.setRawValue(n(t,e),s.options)})),o((()=>{e.setRawValue(i(t,e),s.options)}))})),o((()=>{e.setRawValue(i(t,e),{forceEmit:!1,last:!0})}))}function se(t,e){const i=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function oe(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function re(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function ae(t){return"ArrowUp"===t||"ArrowDown"===t}function le(t){return ae(t)||"ArrowLeft"===t||"ArrowRight"===t}function he(t,e){var i,n;const s=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:t.pageX-((null!==(i=s&&s.scrollX)&&void 0!==i?i:0)+o.left),y:t.pageY-((null!==(n=s&&s.scrollY)&&void 0!==n?n:0)+o.top)}}class pe{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new a,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(he(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(he(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(he(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const i=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function de(t,e,i,n,s){return n+(t-e)/(i-e)*(s-n)}function ce(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function ue(t,e,i){return Math.min(Math.max(t,e),i)}const ve=h("txt");class me{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(ve(),ve(void 0,"num")),e.arrayPosition&&this.element.classList.add(ve(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(ve("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ve()),this.inputElement.classList.add(ve("i"));const n=t.createElement("div");n.classList.add(ve("k")),this.element.appendChild(n),this.knobElement=n;const s=t.createElementNS(T,"svg");s.classList.add(ve("g")),this.knobElement.appendChild(s);const o=t.createElementNS(T,"path");o.classList.add(ve("gb")),s.appendChild(o),this.guideBodyElem_=o;const r=t.createElementNS(T,"path");r.classList.add(ve("gh")),s.appendChild(r),this.guideHeadElem_=r;const a=t.createElement("div");a.classList.add(h("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(ve(void 0,"drg"));this.element.classList.add(ve(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),n=ue(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class ge{constructor(t,e){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=null!==(i=e.sliderProps)&&void 0!==i?i:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=y(null),this.view=new me(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new pe(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,i;const n=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("minValue"),s=null===(i=this.sliderProps_)||void 0===i?void 0:i.get("maxValue");let o=t;return void 0!==n&&(o=Math.max(o,n)),void 0!==s&&(o=Math.min(o,s)),o}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);s(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()}onInputKeyDown_(t){const e=se(this.baseStep_,oe(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==se(this.baseStep_,oe(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function be(t,e){t.write(e)}function we(t){const e=t?rt(t,lt):null;return e?e.step:null}function fe(t,e){const i=t&&rt(t,lt);return i?ce(i.step):Math.max(ce(e),2)}function _e(t){return we(t)??1}function xe(t,e){var i;const n=t&&rt(t,lt),s=Math.abs(null!==(i=null==n?void 0:n.step)&&void 0!==i?i:e);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}function ye(t){return[t[0],t[1],t[2]]}function Ce(t,e){const i=Zt("float"===e?2:0);return`rgb(${ye(t.getComponents("rgb",e)).map((t=>i(t))).join(", ")})`}function ke(t){return e=>Ce(e,t)}function Ee(t,e){const i=Zt(2),n=Zt("float"===e?2:0);return`rgba(${t.getComponents("rgb",e).map(((t,e)=>(3===e?i:n)(t))).join(", ")})`}function Pe(t){return e=>Ee(e,t)}function Me(t,e){const i=Zt("float"===e?2:0),n=["r","g","b"];return`{${ye(t.getComponents("rgb",e)).map(((t,e)=>`${n[e]}: ${i(t)}`)).join(", ")}}`}function Le(t){return e=>Me(e,t)}function Ve(t,e){const i=Zt(2),n=Zt("float"===e?2:0),s=["r","g","b","a"];return`{${t.getComponents("rgb",e).map(((t,e)=>{const o=3===e?i:n;return`${s[e]}: ${o(t)}`})).join(", ")}}`}function ze(t){return e=>Ve(e,t)}["int","float"].reduce(((t,e)=>[...t,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:ke(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:Pe(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:Le(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:ze(e)}]),[]);class Ae{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var i,n;return null!==(n=null===(i=this.components[e])||void 0===i?void 0:i.constrain(t))&&void 0!==n?n:t}));return this.asm_.fromComponents(e)}}const Se=h("pndtxt");class Ie{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Se()),this.textViews.forEach((e=>{const i=t.createElement("div");i.classList.add(Se("a")),i.appendChild(e.element),this.element.appendChild(i)}))}}function De(t,e,i){return new ge(t,{arrayPosition:0===i?"fst":i===e.axes.length-1?"lst":"mid",baseStep:e.axes[i].baseStep,parser:e.parser,props:e.axes[i].textProps,value:y(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}class Re{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((i,n)=>De(t,e,n))),this.acs_.forEach(((t,i)=>{ne({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[i],backward:(t,n)=>{const s=e.assembly.toComponents(t.rawValue);return s[i]=n.rawValue,e.assembly.fromComponents(s)}})})),this.view=new Ie(t,{textViews:this.acs_.map((t=>t.view))})}}function Te(t,e){return"step"in t&&!s(t.step)?new lt(t.step,e):null}function je(t){return"max"in t&&!s(t.max)||"min"in t&&!s(t.min)?new at({max:t.max,min:t.min}):null}const Ne={monitor:{defaultInterval:200,defaultLineCount:3}},Fe=h("grl");class Oe{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Fe()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=t.createElementNS(T,"svg");i.classList.add(Fe("g")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(T,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const s=t.createElement("div");s.classList.add(Fe("t"),h("tt")()),this.element.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,i=this.props_.get("minValue"),n=this.props_.get("maxValue"),s=[];this.value.rawValue.forEach(((o,r)=>{if(void 0===o)return;const a=de(r,0,e,0,t.width),l=de(o,i,n,t.height,0);s.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const o=this.tooltipElem_,r=this.value.rawValue[this.cursor_.rawValue];if(void 0===r)return void o.classList.remove(Fe("t","a"));const a=de(this.cursor_.rawValue,0,e,0,t.width),l=de(r,i,n,t.height,0);o.style.left=`${a}px`,o.style.top=`${l}px`,o.textContent=`${this.formatter_(r)}`,o.classList.contains(Fe("t","a"))||(o.classList.add(Fe("t","a"),Fe("t","in")),j(o),o.classList.remove(Fe("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Be{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=y(-1),this.view=new Oe(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),F(t)){const t=new pe(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(de(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.rawValue=Math.floor(de(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}class Ke{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}on(t,e){const n=e.bind(this);return this.controller_.emitter.on(t,(()=>{n(new i(this))})),this}}class Ue extends i{constructor(t,e,i){super(t),this.cell=e,this.index=i}}class $e extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.emitter_=new a;const e=this.controller_.valueController;e.cellControllers.forEach(((t,i)=>{const n=new Ke(t);this.cellToApiMap_.set(t,n),t.emitter.on("click",(()=>{const t=i%e.size[0],s=Math.floor(i/e.size[0]);this.emitter_.emit("click",{event:new Ue(this,n,[t,s])})}))}))}cell(t,e){const i=this.controller_.valueController,n=i.cellControllers[e*i.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class qe{constructor(t,e){this.size=e.size;const[i,n]=this.size,s=[];for(let o=0;o<n;o++)for(let n=0;n<i;n++){const i=new f(t,{props:C.fromObject(Object.assign({},e.cellConfig(n,o))),viewProps:it.create()});s.push(i)}this.cellCs_=s,this.viewProps=it.create(),this.viewProps.handleDispose((()=>{this.cellCs_.forEach((t=>{t.viewProps.set("disposed",!0)}))})),this.view=new Q(t,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach((t=>{this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}}const He={id:"buttongrid",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(t){const e=V,i=z(t,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return i?{params:i}:null},controller:t=>new q(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:new qe(t.document,{cellConfig:t.params.cells,size:t.params.size})}),api:t=>t.controller instanceof q&&t.controller.valueController instanceof qe?new $e(t.controller):null};class We extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.controller_.valueController.value.emitter.on(t,(t=>{i(new n(this,t.rawValue,void 0,t.options.last))})),this}}function Ye(t,e,i){return t*(1-i)+e*i}const Xe=20,Ge=.001,Ze=100;function Qe(t,e){let i=.25,n=.5,s=-1;for(let o=0;o<Xe;o++){const[o,r]=t.curve(n);if(n+=i*(o<e?1:-1),s=r,i*=.5,Math.abs(e-o)<Ge)break}return s}class Je{constructor(t=0,e=0,i=1,n=1){this.cache_=[],this.comps_=[t,e,i,n]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(t){return!(s(t)||!Array.isArray(t))&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}static equals(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}curve(t){const e=Ye(0,this.x1,t),i=Ye(0,this.y1,t),n=Ye(this.x1,this.x2,t),s=Ye(this.y1,this.y2,t),o=Ye(this.x2,1,t),r=Ye(this.y2,1,t),a=Ye(e,n,t),l=Ye(i,s,t),h=Ye(n,o,t),p=Ye(s,r,t);return[Ye(a,h,t),Ye(l,p,t)]}y(t){if(0===this.cache_.length){const t=[];for(let e=0;e<Ze;e++)t.push(Qe(this,de(e,0,Ze-1,0,1)));this.cache_=t}return this.cache_[Math.round(de(ue(t,0,1),0,1,0,Ze-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const ti={toComponents:t=>t.toObject(),fromComponents:t=>new Je(...t)};function ei(t){const e=Zt(2);return`cubic-bezier(${t.toObject().map((t=>e(t))).join(", ")})`}const ii=[0,.5,.5,1];function ni(t){const e=t.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return new Je(...ii);const i=[e[1],e[2],e[3],e[4]].reduce(((t,e)=>{if(!t)return null;const i=Number(e);return isNaN(i)?null:[...t,i]}),[]);return new Je(...i??ii)}const si=h("cbz");class oi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(si()),e.viewProps.bindClassModifiers(this.element),e.foldable.bindExpandedClass(this.element,si(void 0,"expanded")),u(e.foldable,"completed",m(this.element,si(void 0,"cpl")));const i=t.createElement("div");i.classList.add(si("h")),this.element.appendChild(i);const n=t.createElement("button");n.classList.add(si("b")),e.viewProps.bindDisabled(n);const s=t.createElementNS(T,"svg");s.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',n.appendChild(s),i.appendChild(n),this.buttonElement=n;const o=t.createElement("div");if(o.classList.add(si("t")),i.appendChild(o),this.textElement=o,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(si("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const ri=h("cbzp");class ai{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ri()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(ri("g")),this.element.appendChild(i),this.graphElement=i;const n=t.createElement("div");n.classList.add(ri("t")),this.element.appendChild(n),this.textElement=n}}function li(t,e){const i=new MutationObserver((t=>{for(const n of t)"childList"===n.type&&n.addedNodes.forEach((t=>{!t.contains(t)||(e(),i.disconnect())}))})),n=t.ownerDocument;i.observe(n.body,{attributes:!0,childList:!0,subtree:!0})}const hi=h("cbzg");function pi(t,e){return i=>e(t(i))}class di{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(hi()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(hi("p")),this.element.appendChild(i),this.previewElement=i;const n=t.createElementNS(T,"svg");n.classList.add(hi("g")),this.element.appendChild(n),this.svgElem_=n;const s=t.createElementNS(T,"path");s.classList.add(hi("u")),this.svgElem_.appendChild(s),this.guideElem_=s;const o=t.createElementNS(T,"polyline");o.classList.add(hi("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[t.createElement("div"),t.createElement("div")],this.handleElems_.forEach((t=>{t.classList.add(hi("h")),this.element.appendChild(t)})),this.vectorElems_=[t.createElementNS(T,"line"),t.createElementNS(T,"line")],this.vectorElems_.forEach((t=>{t.classList.add(hi("v")),this.svgElem_.appendChild(t)})),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=e.selection,this.handleElems_.forEach(((t,e)=>{c(this.sel_,pi((t=>t===e),m(t,hi("h","sel"))))})),li(this.element,(()=>{this.refresh()}))}getVertMargin_(t){return.25*t}valueToPosition(t,e){const i=this.element.getBoundingClientRect(),n=i.width,s=i.height,o=this.getVertMargin_(s);return{x:de(t,0,1,0,n),y:de(e,0,1,s-o,o)}}positionToValue(t,e){const i=this.element.getBoundingClientRect(),n=i.width,s=i.height,o=this.getVertMargin_(s);return{x:ue(de(t,0,n,0,1),0,1),y:de(e,s-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map((t=>{const e=this.valueToPosition(0,t),i=this.valueToPosition(1,t);return[`M ${e.x},${e.y}`,`L ${i.x},${i.y}`].join(" ")})).join(" "));const t=this.value_.rawValue,e=[];let i=0;for(;;){const n=this.valueToPosition(...t.curve(i));if(e.push([n.x,n.y].join(",")),i>=1)break;i=Math.min(i+.05,1)}this.lineElem_.setAttributeNS(null,"points",e.join(" "));const n=t.toObject();[0,1].forEach((t=>{const e=this.valueToPosition(t,t),i=this.valueToPosition(n[2*t],n[2*t+1]),s=this.vectorElems_[t];s.setAttributeNS(null,"x1",String(e.x)),s.setAttributeNS(null,"y1",String(e.y)),s.setAttributeNS(null,"x2",String(i.x)),s.setAttributeNS(null,"y2",String(i.y));const o=this.handleElems_[t];o.style.left=`${i.x}px`,o.style.top=`${i.y}px`}))}onValueChange_(){this.refresh()}}const ci=24,ui=400,vi=1e3,mi=h("cbzprv");class gi{constructor(t,e){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(mi()),e.viewProps.bindClassModifiers(this.element);const i=t.createElementNS(T,"svg");i.classList.add(mi("g")),this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(T,"path");n.classList.add(mi("t")),this.svgElem_.appendChild(n),this.ticksElem_=n;const s=t.createElement("div");s.classList.add(mi("m")),this.element.appendChild(s),this.markerElem_=s,this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_),e.viewProps.handleDispose(this.onDispose_),li(this.element,(()=>{this.refresh()}))}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(mi("m","a")),this.startTime_=(new Date).getTime()+ui,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(mi("m","a"))}onDispose_(){this.stop()}updateMarker_(t){const e=this.value_.rawValue.y(ue(t,0,1));this.markerElem_.style.left=100*e+"%"}refresh(){const t=this.svgElem_.getBoundingClientRect(),e=t.width,i=t.height,n=[],s=this.value_.rawValue;for(let o=0;o<ci;o++){const t=de(o,0,ci-1,0,1),r=de(s.y(t),0,1,0,e);n.push(`M ${r},0 v${i}`)}this.ticksElem_.setAttributeNS(null,"d",n.join(" "))}onTimer_(){if(null===this.startTime_)return;const t=(new Date).getTime()-this.startTime_,e=t/vi;this.updateMarker_(e),t>vi+ui&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function bi(t,e,i,n){const s=i-t,o=n-e;return Math.sqrt(s*s+o*o)}function wi(t,e,i,n){const s=bi(t,e,i,n),o=Math.atan2(n-e,i-t),r=Math.round(o/(Math.PI/4))*Math.PI/4;return{x:t+Math.cos(r)*s,y:e+Math.sin(r)*s}}class fi{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.sel_=y(0),this.viewProps=e.viewProps,this.view=new di(t,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new gi(t,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",(t=>{t.stopImmediatePropagation(),t.preventDefault(),this.prevView_.play()})),this.view.previewElement.appendChild(this.prevView_.element);const i=new pe(this.view.element);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(t,e,i){const n=this.sel_.rawValue,s=this.value.rawValue.toObject(),o=this.view.positionToValue(t.x,t.y),r=e?wi(n,n,o.x,o.y):o;s[2*n]=r.x,s[2*n+1]=r.y,this.value.setRawValue(new Je(...s),i)}onPointerDown_(t){const e=t.data;if(!e.point)return;const i=this.value.rawValue,n=this.view.valueToPosition(i.x1,i.y1),s=bi(e.point.x,e.point.y,n.x,n.y),o=this.view.valueToPosition(i.x2,i.y2),r=bi(e.point.x,e.point.y,o.x,o.y);this.sel_.rawValue=s<=r?0:1,this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(t){const e=t.data;!e.point||this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(t){const e=t.data;!e.point||this.updateValue_(e.point,t.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(t){le(t.key)&&t.preventDefault();const e=this.sel_.rawValue,i=this.value.rawValue.toObject();i[2*e]+=se(this.baseStep_,re(t)),i[2*e+1]+=se(this.baseStep_,oe(t)),this.value.setRawValue(new Je(...i),{forceEmit:!1,last:!1})}onKeyUp_(t){le(t.key)&&t.preventDefault();const e=se(this.baseStep_,re(t)),i=se(this.baseStep_,oe(t));0===e&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class _i{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new ai(t,{viewProps:this.viewProps}),this.gc_=new fi(t,{baseStep:e.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const i=Object.assign(Object.assign({},e.axis),{constraint:new at({max:1,min:0})}),n=Object.assign(Object.assign({},e.axis),{constraint:void 0});this.tc_=new Re(t,{assembly:ti,axes:[i,n,i,n],parser:Xt,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map((t=>t.inputElement))]}refresh(){this.gc_.refresh()}}class xi{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=Y(e.expanded),this.view=new oi(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new vt(t,{parser:ni,props:C.fromObject({formatter:ei}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_="popup"===e.pickerLayout?new dt(t,{viewProps:this.viewProps}):null;const i=new _i(t,{axis:e.axis,value:this.value,viewProps:this.viewProps});i.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),c(this.popC_.shows,(t=>{t&&i.refresh()})),ne({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Z(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=t.relatedTarget;(!e||!this.popC_.view.element.contains(e))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=B(t);i&&e.contains(i)||i&&i===this.view.buttonElement&&!F(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){!this.popC_||"Escape"===t.key&&(this.popC_.shows.rawValue=!1)}}function yi(){return new Ae({assembly:ti,components:[0,1,2,3].map((t=>t%2==0?new at({min:0,max:1}):void 0))})}const Ci={id:"cubic-bezier",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(t){const e=V,i=z(t,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom((t=>"inline"===t||"popup"===t?t:void 0))});return i?{params:i}:null},controller(t){var e,i;const n=y(new Je(...t.params.value),{constraint:yi(),equals:Je.equals}),s=new xi(t.document,{axis:{baseStep:.1,textProps:C.fromObject({draggingScale:.01,formatter:Zt(2)})},expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,pickerLayout:null!==(i=t.params.picker)&&void 0!==i?i:"popup",value:n,viewProps:t.viewProps});return new J(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:s})},api:t=>t.controller instanceof J&&t.controller.valueController instanceof xi?new We(t.controller):null};class ki extends e{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}const Ei=20;class Pi{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(t){this.start_=t.getTime()}calculateFps_(t){if(0===this.timestamps_.length)return null;const e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}compactTimestamps_(){if(this.timestamps_.length<=Ei)return;const t=this.timestamps_.length-Ei;this.timestamps_.splice(0,t);const e=this.timestamps_[0].frameCount;this.timestamps_.forEach((t=>{t.frameCount-=e})),this.frameCount_-=e}end(t){if(null===this.start_)return;const e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}const Mi=h("fps");class Li{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Mi()),e.viewProps.bindClassModifiers(this.element),this.graphElement=t.createElement("div"),this.graphElement.classList.add(Mi("g")),this.element.appendChild(this.graphElement);const i=t.createElement("div");i.classList.add(Mi("l")),this.element.appendChild(i);const n=t.createElement("span");n.classList.add(Mi("v")),n.textContent="--",i.appendChild(n),this.valueElement=n;const s=t.createElement("span");s.classList.add(Mi("u")),s.textContent="FPS",i.appendChild(s)}}class Vi{constructor(t,e){this.stopwatch_=new Pi,this.onTick_=this.onTick_.bind(this),this.ticker_=e.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=e.value,this.viewProps=e.viewProps,this.view=new Li(t,{viewProps:this.viewProps}),this.graphC_=new Be(t,{formatter:Zt(0),lineCount:e.lineCount,props:C.fromObject({maxValue:e.maxValue,minValue:e.minValue}),value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose((()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()}))}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const t=this.stopwatch_.fps;if(null!==t){const e=this.value_.rawValue;this.value_.rawValue=ie(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}function zi(t,e){return 0===e?new nt:new st(t,e??Ne.monitor.defaultInterval)}const Ai={id:"fpsgraph",type:"blade",accept(t){const e=V,i=z(t,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return i?{params:i}:null},controller(t){var e,i,n,s;const o=null!==(e=t.params.interval)&&void 0!==e?e:500;return new q(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:new Vi(t.document,{lineCount:null!==(i=t.params.lineCount)&&void 0!==i?i:2,maxValue:null!==(n=t.params.max)&&void 0!==n?n:90,minValue:null!==(s=t.params.min)&&void 0!==s?s:0,ticker:zi(t.document,o),value:te(80),viewProps:t.viewProps})})},api:t=>t.controller instanceof q&&t.controller.valueController instanceof Vi?new ki(t.controller):null};class Si{constructor(t,e){this.min=t,this.max=e}static isObject(t){if("object"!=typeof t||null===t)return!1;const e=t.min,i=t.max;return!("number"!=typeof e||"number"!=typeof i)}static equals(t,e){return t.min===e.min&&t.max===e.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Ii={fromComponents:t=>new Si(t[0],t[1]),toComponents:t=>[t.min,t.max]};class Di{constructor(t){this.edge=t}constrain(t){var e,i,n,s,o,r,a,l;if(t.min<=t.max)return new Si(null!==(i=null===(e=this.edge)||void 0===e?void 0:e.constrain(t.min))&&void 0!==i?i:t.min,null!==(s=null===(n=this.edge)||void 0===n?void 0:n.constrain(t.max))&&void 0!==s?s:t.max);const h=(t.min+t.max)/2;return new Si(null!==(r=null===(o=this.edge)||void 0===o?void 0:o.constrain(h))&&void 0!==r?r:h,null!==(l=null===(a=this.edge)||void 0===a?void 0:a.constrain(h))&&void 0!==l?l:h)}}const Ri=h("rsltxt");class Ti{constructor(t,e){this.sliderView_=e.sliderView,this.textView_=e.textView,this.element=t.createElement("div"),this.element.classList.add(Ri());const i=t.createElement("div");i.classList.add(Ri("s")),i.appendChild(this.sliderView_.element),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Ri("t")),n.appendChild(this.textView_.element),this.element.appendChild(n)}}const ji=h("rsl");class Ni{constructor(t,e){this.maxValue_=e.maxValue,this.minValue_=e.minValue,this.element=t.createElement("div"),this.element.classList.add(ji()),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this));const i=t.createElement("div");i.classList.add(ji("t")),this.element.appendChild(i),this.trackElement=i;const n=t.createElement("div");n.classList.add(ji("b")),i.appendChild(n),this.barElement=n;const s=["min","max"].map((e=>{const n=t.createElement("div");return n.classList.add(ji("k"),ji("k",e)),i.appendChild(n),n}));this.knobElements=[s[0],s[1]],this.update()}valueToX_(t){return 100*ue(de(t,this.minValue_,this.maxValue_,0,1),0,1)}update(){const t=this.value_.rawValue;0===t.length?this.element.classList.add(ji(void 0,"zero")):this.element.classList.remove(ji(void 0,"zero"));const e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left=`${e[0]}%`,this.barElement.style.right=100-e[1]+"%",this.knobElements.forEach(((t,i)=>{t.style.left=`${e[i]}%`}))}onValueChange_(){this.update()}}class Fi{constructor(t,e){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.maxValue_=e.maxValue,this.minValue_=e.minValue,this.viewProps=e.viewProps,this.value=e.value,this.view=new Ni(t,{maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:e.viewProps});const i=new pe(this.view.trackElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}ofs_(){return"min"===this.grabbing_?this.view.knobElements[0].getBoundingClientRect().width/2:"max"===this.grabbing_?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(t){return t.point?de((t.point.x+this.ofs_())/t.bounds.width,0,1,this.minValue_,this.maxValue_):null}onPointerDown_(t){if(!t.data.point)return;const e=t.data.point.x/t.data.bounds.width,i=this.value.rawValue,n=de(i.min,this.minValue_,this.maxValue_,0,1),s=de(i.max,this.minValue_,this.maxValue_,0,1);Math.abs(s-e)<=.025?this.grabbing_="max":Math.abs(n-e)<=.025?this.grabbing_="min":e>=n&&e<=s?(this.grabbing_="length",this.grabOffset_=de(e-n,0,1,0,this.maxValue_-this.minValue_)):e<n?(this.grabbing_="min",this.onPointerMove_(t)):e>s&&(this.grabbing_="max",this.onPointerMove_(t))}applyPointToValue_(t,e){const i=this.valueFromData_(t);if(null!==i)if("min"===this.grabbing_)this.value.setRawValue(new Si(i,this.value.rawValue.max),e);else if("max"===this.grabbing_)this.value.setRawValue(new Si(this.value.rawValue.min,i),e);else if("length"===this.grabbing_){const t=this.value.rawValue.length;let n=i-this.grabOffset_,s=n+t;n<this.minValue_?(n=this.minValue_,s=this.minValue_+t):s>this.maxValue_&&(n=this.maxValue_-t,s=this.maxValue_),this.value.setRawValue(new Si(n,s),e)}}onPointerMove_(t){this.applyPointToValue_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.applyPointToValue_(t.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Oi{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sc_=new Fi(t,e);const i={baseStep:e.baseStep,constraint:e.constraint,textProps:C.fromObject({draggingScale:e.draggingScale,formatter:e.formatter})};this.tc_=new Re(t,{assembly:Ii,axes:[i,i],parser:e.parser,value:this.value,viewProps:e.viewProps}),this.view=new Ti(t,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function Bi(t){return Si.isObject(t)?new Si(t.min,t.max):new Si(0,0)}function Ki(t,e){t.writeProperty("max",e.max),t.writeProperty("min",e.min)}function Ui(t){const e=[],i=je(t);i&&e.push(i);const n=Te(t);return n&&e.push(n),new Di(new ot(e))}const $i={id:"input-interval",type:"input",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept:(t,e)=>{if(!Si.isObject(t))return null;const i=V,n=z(e,{format:i.optional.function,max:i.optional.number,min:i.optional.number,step:i.optional.number});return n?{initialValue:new Si(t.min,t.max),params:n}:null},binding:{reader:t=>Bi,constraint:t=>Ui(t.params),equals:Si.equals,writer:t=>Ki},controller(t){var e;const i=t.value,n=t.constraint;if(!(n instanceof Di))throw r.shouldNeverHappen();const s=(i.rawValue.min+i.rawValue.max)/2,o=null!==(e=t.params.format)&&void 0!==e?e:Zt(fe(n.edge,s)),a=n.edge&&rt(n.edge,at);if(void 0!==(null==a?void 0:a.minValue)&&void 0!==(null==a?void 0:a.maxValue))return new Oi(t.document,{baseStep:_e(n.edge),constraint:n.edge,draggingScale:xe(a,s),formatter:o,maxValue:a.maxValue,minValue:a.minValue,parser:Xt,value:i,viewProps:t.viewProps});const l={baseStep:_e(n.edge),constraint:n.edge,textProps:C.fromObject({draggingScale:s,formatter:o})};return new Re(t.document,{assembly:Ii,axes:[l,l],parser:Xt,value:i,viewProps:t.viewProps})}};class qi{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}}class Hi extends n{constructor(t,e,i,n,s){super(t,n,s),this.cell=e,this.index=i}}class Wi extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach((t=>{const e=new qi(t);this.cellToApiMap_.set(t,e)}))}get value(){return this.controller_.value}cell(t,e){const i=this.controller_.valueController,n=i.cellControllers[e*i.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const i=e.bind(this);this.controller_.value.emitter.on(t,(t=>{const e=this.controller_.valueController,n=e.findCellByValue(t.rawValue);if(!n)return;const s=this.cellToApiMap_.get(n);if(!s)return;const o=e.cellControllers.indexOf(n);i(new Hi(this,s,[o%e.size[0],Math.floor(o/e.size[0])],t.rawValue,void 0))}))}}const Yi=h("rad");class Xi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Yi()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("label");i.classList.add(Yi("l")),this.element.appendChild(i);const n=t.createElement("input");n.classList.add(Yi("i")),n.name=e.name,n.type="radio",e.viewProps.bindDisabled(n),i.appendChild(n),this.inputElement=n;const s=t.createElement("div");s.classList.add(Yi("b")),i.appendChild(s);const o=t.createElement("div");o.classList.add(Yi("t")),s.appendChild(o),u(e.props,"title",(t=>{o.textContent=t}))}}class Gi{constructor(t,e){this.props=e.props,this.viewProps=e.viewProps,this.view=new Xi(t,{name:e.name,props:this.props,viewProps:this.viewProps})}}class Zi{constructor(t,e){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=e.size;const[i,n]=this.size;for(let s=0;s<n;s++)for(let n=0;n<i;n++){const i=new Gi(t,{name:e.groupName,props:C.fromObject(Object.assign({},e.cellConfig(n,s))),viewProps:it.create()});this.cellCs_.push(i),this.cellValues_.push(e.cellConfig(n,s).value)}this.value=e.value,c(this.value,(t=>{const e=this.findCellByValue(t);!e||(e.view.inputElement.checked=!0)})),this.viewProps=it.create(),this.view=new Q(t,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach((t=>{t.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}findCellByValue(t){const e=this.cellValues_.findIndex((e=>e===t));return e<0?null:this.cellCs_[e]}onCellInputChange_(t){const e=t.currentTarget,i=this.cellCs_.findIndex((t=>t.view.inputElement===e));i<0||(this.value.rawValue=this.cellValues_[i])}}const Qi={id:"radiogrid",type:"blade",accept(t){const e=V,i=z(t,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return i?{params:i}:null},controller:t=>new J(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:new Zi(t.document,{groupName:t.params.groupName,cellConfig:t.params.cells,size:t.params.size,value:y(t.params.value)})}),api:t=>t.controller instanceof J&&t.controller.valueController instanceof Zi?new Wi(t.controller):null};function Ji(t){return{id:"input-radiogrid",type:"input",accept(e,i){if(!t.isType(e))return null;const n=V,s=z(i,{cells:n.required.function,groupName:n.required.string,size:n.required.array(n.required.number),view:n.required.constant("radiogrid")});return s?{initialValue:e,params:s}:null},binding:t.binding,controller:t=>new Zi(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})}}const tn=Ji({isType:t=>"number"==typeof t,binding:{reader:t=>Gt,writer:t=>be}}),en=Ji({isType:t=>"string"==typeof t,binding:{reader:t=>Qt,writer:t=>be}}),nn=Ji({isType:t=>"boolean"==typeof t,binding:{reader:t=>mt,writer:t=>be}}),sn=[He,Ci,Ai,$i,Qi,nn,tn,en];t.CubicBezier=Je,t.plugins=sn,Object.defineProperty(t,"__esModule",{value:!0})}(Ue.exports);const $e=zt({__proto__:null,default:At(Ue.exports)},[Ue.exports]);var qe={exports:{}};!function(t){const e="tp";function i(t){return(i,n)=>[e,"-",t,"v",i?`_${i}`:"",n?`-${n}`:""].join("")}function n(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function s(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function o(t){return null!==t&&"object"==typeof t}function r(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function a(t){return{custom:e=>r(e)(t),boolean:r((t=>"boolean"==typeof t?t:void 0))(t),number:r((t=>"number"==typeof t?t:void 0))(t),string:r((t=>"string"==typeof t?t:void 0))(t),function:r((t=>"function"==typeof t?t:void 0))(t),constant:e=>r((t=>t===e?e:void 0))(t),raw:r((t=>t))(t),object:e=>r((t=>{if(o(t))return n(t,e)}))(t),array:e=>r((t=>{if(Array.isArray(t))return s(t,e)}))(t)}}const l={optional:a(!0),required:a(!1)};function h(t,e){const i=l.required.object(e)(t);return i.succeeded?i.value:void 0}function p(t,e,i,n){function s(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,o){function r(t){try{l(n.next(t))}catch(e){o(e)}}function a(t){try{l(n.throw(t))}catch(e){o(e)}}function l(t){t.done?i(t.value):s(t.value).then(r,a)}l((n=n.apply(t,e||[])).next())}))}function d(){const t=document.createElement("canvas");t.width=128,t.height=64;const e=t.getContext("2d");return e.fillStyle="#222",e.fillRect(0,0,t.width,t.height),e.fillStyle="#ddd",e.font="monospaced",e.textAlign="center",e.textBaseline="middle",e.fillText("No image",.5*t.width,.5*t.height),new Promise((e=>{t.toBlob((t=>{const i=new Image;i.src=URL.createObjectURL(t),i.onload=()=>{e(i)}}))}))}function c(t){return p(this,void 0,void 0,(function*(){const e=new Image;return e.crossOrigin="anonymous",new Promise((i=>{e.src=t,e.onload=()=>{i(e)}}))}))}function u(t){const e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0);const i=new Image;return new Promise((t=>{e.toBlob((e=>{i.src=URL.createObjectURL(e),i.onload=()=>{t(i)}}))}))}const v=i("img");class m{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(v()),e.viewProps.bindClassModifiers(this.element),this.input=t.createElement("input"),this.input.classList.add(v("input")),this.input.setAttribute("type","file"),this.input.setAttribute("accept",e.extensions.join(",")),this.element.appendChild(this.input),this.image_=t.createElement("img"),this.image_.classList.add(v("image")),this.image_.classList.add(v(`image_${e.imageFit}`)),this.element.classList.add(v("area_root")),this.element.appendChild(this.image_)}changeImage(t){this.image_.src=t}changeDraggingState(t){const e=this.element;t?null==e||e.classList.add(v("area_dragging")):null==e||e.classList.remove(v("area_dragging"))}}class g{constructor(t,e){this.placeholderImage=null,this.value=e.value,this.viewProps=e.viewProps,this.view=new m(t,{viewProps:this.viewProps,extensions:e.extensions,imageFit:e.imageFit}),this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.viewProps.handleDispose((()=>{this.view.input.removeEventListener("change",this.onFile),this.view.input.removeEventListener("drop",this.onDrop),this.view.input.removeEventListener("dragover",this.onDragOver),this.view.input.removeEventListener("dragleave",this.onDragLeave)})),this.value.emitter.on("change",this.handleValueChange.bind(this)),this.handleValueChange()}onFile(t){const e=(null==t?void 0:t.target).files;if(!e||!e.length)return;const i=e[0],n=URL.createObjectURL(i);this.setValue(n),this.updateImage(n)}onDrop(t){return p(this,void 0,void 0,(function*(){t.preventDefault();try{const{dataTransfer:e}=t,i=null==e?void 0:e.files[0];if(i){const t=URL.createObjectURL(i);this.updateImage(t),this.setValue(t)}else{const t=null==e?void 0:e.getData("url");if(!t)throw new Error("No url");c(t).then((t=>p(this,void 0,void 0,(function*(){const e=yield u(t);this.updateImage(e.src),this.setValue(e)}))))}}catch(e){console.error("Could not parse the dropped image",e)}finally{this.view.changeDraggingState(!1)}}))}onDragOver(t){t.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}handleImage(t){return p(this,void 0,void 0,(function*(){if(t instanceof HTMLImageElement)u(t).then((t=>{this.updateImage(t.src)}));else if("string"==typeof t){let e="";try{if("placeholder"===t)throw new Error("placeholder");new URL(t),e=(yield c(t)).src}catch{e=(yield this.handlePlaceholderImage()).src}finally{this.updateImage(e),this.setValue(e)}}}))}updateImage(t){this.view.changeImage(t)}setValue(t){return p(this,void 0,void 0,(function*(){t instanceof HTMLImageElement?this.value.setRawValue(t):t?this.value.setRawValue(yield c(t)):this.value.setRawValue(yield this.handlePlaceholderImage())}))}handleValueChange(){this.handleImage(this.value.rawValue)}handlePlaceholderImage(){return p(this,void 0,void 0,(function*(){return this.placeholderImage||(this.placeholderImage=yield d()),this.placeholderImage}))}}const b=[".jpg",".png",".gif"],w={id:"input-image",type:"input",css:".tp-imgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-imgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-imgv:hover{background-color:var(--in-bg-h)}.tp-imgv:focus{background-color:var(--in-bg-f)}.tp-imgv:active{background-color:var(--in-bg-a)}.tp-imgv:disabled{opacity:0.5}:root{--tp-plugin-image-dragging-color: hsla(230, 100%, 66%, 1.00)}.tp-imgv{cursor:pointer;display:grid;height:calc(var(--bld-us) * 3);overflow:hidden;position:relative}.tp-imgv.tp-v-disabled{opacity:0.5}.tp-imgv_input{width:100%;height:100%;opacity:0}.tp-imgv_image{width:100%;height:100%;position:absolute;pointer-events:none;border:0}.tp-imgv_image_contain{-o-object-fit:contain;object-fit:contain}.tp-imgv_image_cover{-o-object-fit:cover;object-fit:cover}.tp-imgv_area_root{transition:opacity 0.16s ease-in-out}.tp-imgv_area_dragging{border:2px dashed var(--tp-plugin-image-dragging-color);border-radius:6px;opacity:0.6}",accept(t,e){if(!(t instanceof HTMLImageElement||"string"==typeof t))return null;const i=l,n=h(e,{view:i.required.constant("input-image"),acceptUrl:i.optional.boolean,imageFit:i.optional.custom((t=>"contain"===t||"cover"===t?t:void 0)),extensions:i.optional.array(i.required.string)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>t=>t instanceof HTMLImageElement?""===t.src?"placeholder":t.src:"string"==typeof t?t:"placeholder",writer:t=>(t,e)=>{t.write(e)}},controller(t){var e,i;return new g(t.document,{value:t.value,imageFit:null!==(e=t.params.imageFit)&&void 0!==e?e:"cover",viewProps:t.viewProps,extensions:null!==(i=t.params.extensions)&&void 0!==i?i:b})}};t.plugin=w,Object.defineProperty(t,"__esModule",{value:!0})}(qe.exports);const He=zt({__proto__:null,default:At(qe.exports)},[qe.exports]);var We={exports:{}};!function(t){function e(t){return null==t}const i={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class n{constructor(t){var e;this.message=null!==(e=i[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new n({type:"alreadydisposed"})}static notBindable(){return new n({type:"notbindable"})}static propertyNotFound(t){return new n({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new n({type:"shouldneverhappen"})}}class s{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter((t=>t.handler!==e))),this}emit(t,e){const i=this.observers_[t];!i||i.forEach((t=>{t.handler(e)}))}}const o="tp";function r(t){return(e,i)=>[o,"-",t,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function a(t,e){return i=>e(t(i))}function l(t){return t.rawValue}function h(t,e){t.emitter.on("change",a(l,e)),e(t.rawValue)}function p(t,e,i){h(t.value(e),i)}function d(t,e,i){i?t.classList.add(e):t.classList.remove(e)}function c(t,e){return i=>{d(t,e,i)}}class u{constructor(t,e){var i;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(i=null==e?void 0:e.equals)&&void 0!==i?i:(t,e)=>t===e,this.emitter=new s,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(t):t;this.equals_(this.rawValue_,n)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:i,rawValue:n,sender:this}))}}class v{constructor(t){this.emitter=new s,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0};this.value_===t&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:i,rawValue:this.value_,sender:this}))}}function m(t,e){const i=null==e?void 0:e.constraint,n=null==e?void 0:e.equals;return i||n?new u(t,e):new v(t)}class g{constructor(t){this.emitter=new s,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,i)=>Object.assign(e,{[i]:m(t[i])})),{})}static fromObject(t){const e=this.createCore(t);return new g(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function b(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function w(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function f(t){return null!==t&&"object"==typeof t}function _(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function x(t){return{custom:e=>_(e)(t),boolean:_((t=>"boolean"==typeof t?t:void 0))(t),number:_((t=>"number"==typeof t?t:void 0))(t),string:_((t=>"string"==typeof t?t:void 0))(t),function:_((t=>"function"==typeof t?t:void 0))(t),constant:e=>_((t=>t===e?e:void 0))(t),raw:_((t=>t))(t),object:e=>_((t=>{if(f(t))return b(t,e)}))(t),array:e=>_((t=>{if(Array.isArray(t))return w(t,e)}))(t)}}const y={optional:x(!0),required:x(!1)};function C(t,e){const i=y.required.object(e)(t);return i.succeeded?i.value:void 0}const k="http://www.w3.org/2000/svg";function E(t){t.offsetHeight}function P(t,e){const i=t.style.transition;t.style.transition="none",e(),t.style.transition=i}function M(t){return void 0!==t.ontouchstart}function L(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}class V extends g{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=g.createCore(e);return new V(i)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!e(t)?`${t}px`:"auto"}bindExpandedClass(t,e){p(this,"expanded",(()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)}))}}function z(t,e){let i=0;return P(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),E(e),i=e.clientHeight,t.set("temporaryExpanded",null),E(e)})),i}function A(t,e){e.style.height=t.styleHeight}function S(t,i){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),e(t.get("expandedHeight"))&&t.set("expandedHeight",z(t,i)),t.set("shouldFixHeight",!0),E(i)})),t.emitter.on("change",(()=>{A(t,i)})),A(t,i),i.addEventListener("transitionend",(e=>{"height"===e.propertyName&&(t.set("shouldFixHeight",!1),t.set("expandedHeight",null),t.set("completed",!0))}))}class I{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}class D{constructor(t){this.maxValue=t.max,this.minValue=t.min}constrain(t){let i=t;return e(this.minValue)||(i=Math.max(i,this.minValue)),e(this.maxValue)||(i=Math.min(i,this.maxValue)),i}}class R{constructor(t){this.step=t}constrain(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}const T=r("pop");class j{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(T()),e.viewProps.bindClassModifiers(this.element),h(e.shows,c(this.element,T(void 0,"v")))}}class N{constructor(t,e){this.shows=m(!1),this.viewProps=e.viewProps,this.view=new j(t,{shows:this.shows,viewProps:this.viewProps})}}class F{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const O={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class B{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=O[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const K={"+":t=>t,"-":t=>-t,"~":t=>~t};class U{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=K[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function $(t){return(e,i)=>{for(let n=0;n<t.length;n++){const s=t[n](e,i);if(""!==s)return s}return""}}function q(t,e){var i;const n=t.substr(e).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function H(t,e){const i=t.substr(e,1);return i.match(/^[1-9]$/)?i:""}function W(t,e){var i;const n=t.substr(e).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function Y(t,e){const i=W(t,e);if(""!==i)return i;const n=t.substr(e,1);if("-"!==n&&"+"!==n)return"";const s=W(t,e+=1);return""===s?"":n+s}function X(t,e){const i=t.substr(e,1);if(e+=1,"e"!==i.toLowerCase())return"";const n=Y(t,e);return""===n?"":i+n}function G(t,e){const i=t.substr(e,1);if("0"===i)return i;const n=H(t,e);return e+=n.length,""===n?"":n+W(t,e)}function Z(t,e){const i=G(t,e);if(e+=i.length,""===i)return"";const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const s=W(t,e);return i+n+s+X(t,e+=s.length)}function Q(t,e){const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const n=W(t,e);return e+=n.length,""===n?"":i+n+X(t,e)}function J(t,e){const i=G(t,e);return e+=i.length,""===i?"":i+X(t,e)}const tt=$([Z,Q,J]);function et(t,e){var i;const n=t.substr(e).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function it(t,e){const i=t.substr(e,2);if(e+=i.length,"0b"!==i.toLowerCase())return"";const n=et(t,e);return""===n?"":i+n}function nt(t,e){var i;const n=t.substr(e).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function st(t,e){const i=t.substr(e,2);if(e+=i.length,"0o"!==i.toLowerCase())return"";const n=nt(t,e);return""===n?"":i+n}function ot(t,e){var i;const n=t.substr(e).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}function rt(t,e){const i=t.substr(e,2);if(e+=i.length,"0x"!==i.toLowerCase())return"";const n=ot(t,e);return""===n?"":i+n}const at=$([it,st,rt]),lt=$([at,tt]);function ht(t,e){const i=lt(t,e);return e+=i.length,""===i?null:{evaluable:new F(i),cursor:e}}function pt(t,e){const i=t.substr(e,1);if(e+=i.length,"("!==i)return null;const n=gt(t,e);if(!n)return null;e=n.cursor,e+=q(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:n.evaluable,cursor:e}}function dt(t,e){return ht(t,e)||pt(t,e)}function ct(t,e){const i=dt(t,e);if(i)return i;const n=t.substr(e,1);if(e+=n.length,"+"!==n&&"-"!==n&&"~"!==n)return null;const s=ct(t,e);return s?{cursor:e=s.cursor,evaluable:new U(n,s.evaluable)}:null}function ut(t,e,i){i+=q(e,i).length;const n=t.filter((t=>e.startsWith(t,i)))[0];return n?(i+=n.length,{cursor:i+=q(e,i).length,operator:n}):null}function vt(t,e){return(i,n)=>{const s=t(i,n);if(!s)return null;n=s.cursor;let o=s.evaluable;for(;;){const s=ut(e,i,n);if(!s)break;n=s.cursor;const r=t(i,n);if(!r)return null;n=r.cursor,o=new B(s.operator,o,r.evaluable)}return o?{cursor:n,evaluable:o}:null}}const mt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>vt(t,e)),ct);function gt(t,e){return e+=q(t,e).length,mt(t,e)}function bt(t){const e=gt(t,0);return e&&e.cursor+q(t,e.cursor).length===t.length?e.evaluable:null}function wt(t){var e;const i=bt(t);return null!==(e=null==i?void 0:i.evaluate())&&void 0!==e?e:null}function ft(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}function _t({primary:t,secondary:e,forward:i,backward:n}){let s=!1;function o(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(n=>{o((()=>{e.setRawValue(i(t,e),n.options)}))})),e.emitter.on("change",(s=>{o((()=>{t.setRawValue(n(t,e),s.options)})),o((()=>{e.setRawValue(i(t,e),s.options)}))})),o((()=>{e.setRawValue(i(t,e),{forceEmit:!1,last:!0})}))}function xt(t,e){const i=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function yt(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Ct(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function kt(t){return"ArrowUp"===t||"ArrowDown"===t}function Et(t){return kt(t)||"ArrowLeft"===t||"ArrowRight"===t}function Pt(t,e){const i=e.ownerDocument.defaultView,n=e.getBoundingClientRect();return{x:t.pageX-((i&&i.scrollX||0)+n.left),y:t.pageY-((i&&i.scrollY||0)+n.top)}}class Mt{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new s,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Pt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Pt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Pt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const i=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Lt(t,e,i){return Math.min(Math.max(t,e),i)}const Vt=r("txt");class zt{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Vt(),Vt(void 0,"num")),e.arrayPosition&&this.element.classList.add(Vt(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(Vt("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Vt()),this.inputElement.classList.add(Vt("i"));const n=t.createElement("div");n.classList.add(Vt("k")),this.element.appendChild(n),this.knobElement=n;const s=t.createElementNS(k,"svg");s.classList.add(Vt("g")),this.knobElement.appendChild(s);const o=t.createElementNS(k,"path");o.classList.add(Vt("gb")),s.appendChild(o),this.guideBodyElem_=o;const a=t.createElementNS(k,"path");a.classList.add(Vt("gh")),s.appendChild(a),this.guideHeadElem_=a;const l=t.createElement("div");l.classList.add(r("tt")()),this.knobElement.appendChild(l),this.tooltipElem_=l,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(Vt(void 0,"drg"));this.element.classList.add(Vt(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),n=Lt(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class At{constructor(t,e){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=m(null),this.view=new zt(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Mt(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}onInputChange_(t){const i=t.currentTarget.value,n=this.parser_(i);e(n)||(this.value.rawValue=n),this.view.refresh()}onInputKeyDown_(t){const e=xt(this.baseStep_,yt(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==xt(this.baseStep_,yt(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function St(t){if("inline"===t||"popup"===t)return t}function It(t){const e=y;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}class Dt{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var i,n;return null!==(n=null===(i=this.components[e])||void 0===i?void 0:i.constrain(t))&&void 0!==n?n:t}));return this.asm_.fromComponents(e)}}const Rt=r("pndtxt");class Tt{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Rt()),this.textViews.forEach((e=>{const i=t.createElement("div");i.classList.add(Rt("a")),i.appendChild(e.element),this.element.appendChild(i)}))}}function jt(t,e,i){return new At(t,{arrayPosition:0===i?"fst":i===e.axes.length-1?"lst":"mid",baseStep:e.axes[i].baseStep,parser:e.parser,props:e.axes[i].textProps,value:m(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}class Nt{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((i,n)=>jt(t,e,n))),this.acs_.forEach(((t,i)=>{_t({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[i],backward:(t,n)=>{const s=e.assembly.toComponents(t.rawValue);return s[i]=n.rawValue,e.assembly.fromComponents(s)}})})),this.view=new Tt(t,{textViews:this.acs_.map((t=>t.view))})}}class Ft{multiply(t){return this.format(this.quat.multiply(t.quat))}premultiply(t){return this.format(t.multiply(this))}slerp(t,e){return this.format(this.quat.slerp(t.quat,e))}}function Ot(t,e,i){return Math.min(Math.max(t,e),i)}function Bt(t,e){return Math.floor(t/e)*e}function Kt(t,e){return t-Bt(t,e)}function Ut(t){return Kt(t+Math.PI,2*Math.PI)-Math.PI}class $t extends Ft{constructor(t,e,i,n,s){super(),this.x=t??0,this.y=e??0,this.z=i??0,this.order=n??"XYZ",this.unit=s??"rad"}static fromQuaternion(t,e,i){const n=t.toMat3(),[s,o,r,a]="XYZ"===e?[0,1,2,1]:"XZY"===e?[0,2,1,-1]:"YXZ"===e?[1,0,2,-1]:"YZX"===e?[1,2,0,1]:"ZXY"===e?[2,0,1,1]:[2,1,0,-1],l=[0,0,0],h=n[r+3*s];return l[o]=-a*Math.asin(Ot(h,-1,1)),Math.abs(h)<.999999?(l[s]=a*Math.atan2(n[r+3*o],n[4*r]),l[r]=a*Math.atan2(n[o+3*s],n[4*s])):l[s]=a*Math.atan2(-n[o+3*r],n[4*o]),Math.abs(l[s])+Math.abs(l[r])>Math.PI&&(l[s]=Ut(l[s]+Math.PI),l[o]=Ut(Math.PI-l[o]),l[r]=Ut(l[r]+Math.PI)),new $t(...l,e).reunit(i)}get quat(){return qt.fromEuler(this)}getComponents(){return[this.x,this.y,this.z]}toEuler(t,e){return this.reorder(t).reunit(e)}format(t){return t instanceof $t?t.reorder(this.order):t.toEuler(this.order,this.unit)}reorder(t){return t===this.order?this:this.quat.toEuler(t,this.unit)}reunit(t){const e={deg:Math.PI/180,rad:1,turn:2*Math.PI}[this.unit]*{deg:180/Math.PI,rad:1,turn:.5/Math.PI}[t];return new $t(e*this.x,e*this.y,e*this.z,this.order,t)}}class qt extends Ft{constructor(t,e,i,n){super(),this.x=t??0,this.y=e??0,this.z=i??0,this.w=n??1}static fromAxisAngle(t,e){const i=e/2,n=Math.sin(i);return new qt(t.x*n,t.y*n,t.z*n,Math.cos(i))}static fromEuler(t){const e=t.reunit("rad"),[i,n,s,o]="XYZ"===e.order?[0,1,2,1]:"XZY"===e.order?[0,2,1,-1]:"YXZ"===e.order?[1,0,2,-1]:"YZX"===e.order?[1,2,0,1]:"ZXY"===e.order?[2,0,1,1]:[2,1,0,-1],r=e.getComponents(),a=.5*r[i],l=.5*o*r[n],h=.5*r[s],p=Math.cos(a),d=Math.cos(l),c=Math.cos(h),u=Math.sin(a),v=Math.sin(l),m=Math.sin(h),g=[0,0,0,c*d*p+m*v*u];return g[i]=c*d*u-m*v*p,g[n]=o*(c*v*p+m*d*u),g[s]=m*d*p-c*v*u,new qt(...g)}static lookRotation(t,e){const{normal:i,tangent:n,binormal:s}=t.orthoNormalize(e),o=s.x,r=n.x,a=i.x,l=s.y,h=n.y,p=i.y,d=s.z,c=n.z,u=i.z,v=o+h+u;if(v>0){const t=.5/Math.sqrt(v+1);return new qt((c-p)*t,(a-d)*t,(l-r)*t,.25/t)}if(o>h&&o>u){const t=2*Math.sqrt(1+o-h-u);return new qt(.25*t,(r+l)/t,(a+d)/t,(c-p)/t)}if(h>u){const t=2*Math.sqrt(1+h-o-u);return new qt((r+l)/t,.25*t,(p+c)/t,(a-d)/t)}{const t=2*Math.sqrt(1+u-o-h);return new qt((a+d)/t,(p+c)/t,.25*t,(l-r)/t)}}get quat(){return this}getComponents(){return[this.x,this.y,this.z,this.w]}toEuler(t,e){return $t.fromQuaternion(this,t,e)}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const t=this.length;return 0===t?new qt:new qt(this.x/t,this.y/t,this.z/t,this.w/t)}get negated(){return new qt(-this.x,-this.y,-this.z,-this.w)}get ban360s(){return this.w<0?this.negated:this}multiply(t){const e=t.quat;return new qt(this.w*e.x+this.x*e.w+this.y*e.z-this.z*e.y,this.w*e.y-this.x*e.z+this.y*e.w+this.z*e.x,this.w*e.z+this.x*e.y-this.y*e.x+this.z*e.w,this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z)}format(t){return t.quat}slerp(t,e){let i=t.quat;if(0===e)return this;if(1===e)return i;const n=this.ban360s;i=i.ban360s;let s=n.w*i.w+n.x*i.x+n.y*i.y+n.z*i.z;if(s<0&&(i=i.negated,s=-s),s>=1)return n;const o=1-s*s;if(o<=Number.EPSILON){const t=1-e;return new qt(t*n.x+e*i.x,t*n.y+e*i.y,t*n.z+e*i.z,t*n.w+e*i.w).normalized}const r=Math.sqrt(o),a=Math.atan2(r,s),l=Math.sin((1-e)*a)/r,h=Math.sin(e*a)/r;return new qt(n.x*l+i.x*h,n.y*l+i.y*h,n.z*l+i.z*h,n.w*l+i.w*h)}toMat3(){const{x:t,y:e,z:i,w:n}=this;return[1-2*e*e-2*i*i,2*t*e+2*i*n,2*t*i-2*e*n,2*t*e-2*i*n,1-2*t*t-2*i*i,2*e*i+2*t*n,2*t*i+2*e*n,2*e*i-2*t*n,1-2*t*t-2*e*e]}}class Ht{constructor(){this.offset=[0,0,-5],this.fov=30,this.aspect=1,this.viewport=[0,0,1,1]}project(t){const e=.5*(this.viewport[0]+this.viewport[2]),i=.5*(this.viewport[1]+this.viewport[3]),n=this.viewport[2]-this.viewport[0],s=this.viewport[3]-this.viewport[1],o=1/Math.tan(this.fov*Math.PI/360),r=-(t.z+this.offset[2]);return[e+(t.x+this.offset[0])/r*o*n*.5/this.aspect,i-(t.y+this.offset[1])/r*o*s*.5]}}class Wt{constructor(t,e,i){this.element=t.createElementNS(k,"path"),this.vertices=e,this.projector=i}setRotation(t){let e="";return this.vertices.forEach(((i,n)=>{const s=i.applyQuaternion(t),[o,r]=this.projector.project(s);e+=`${0===n?"M":"L"}${o} ${r}`})),this.element.setAttributeNS(null,"d",e),this}}class Yt{constructor(t,e,i){this.x=t??0,this.y=e??0,this.z=i??0}getComponents(){return[this.x,this.y,this.z]}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const t=this.length;return 0===t?new Yt:new Yt(this.x/t,this.y/t,this.z/t)}get negated(){return new Yt(-this.x,-this.y,-this.z)}add(t){return new Yt(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new Yt(this.x-t.x,this.y-t.y,this.z-t.z)}scale(t){return new Yt(this.x*t,this.y*t,this.z*t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){return new Yt(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}orthoNormalize(t){const e=this.normalized;t=t.normalized;let i=e.dot(t);1===i&&(t=Math.abs(e.y)>Math.abs(e.z)?new Yt(0,0,1):new Yt(0,1,0),i=e.dot(t));const n=(t=t.sub(e.scale(i)).normalized).cross(e);return{normal:e,tangent:t,binormal:n}}applyQuaternion(t){const e=t.w*this.x+t.y*this.z-t.z*this.y,i=t.w*this.y+t.z*this.x-t.x*this.z,n=t.w*this.z+t.x*this.y-t.y*this.x,s=-t.x*this.x-t.y*this.y-t.z*this.z;return new Yt(e*t.w+s*-t.x+i*-t.z-n*-t.y,i*t.w+s*-t.y+n*-t.x-e*-t.z,n*t.w+s*-t.z+e*-t.y-i*-t.x)}}function Xt(t,e){const i=e.z>0?new qt(0,0,0,1):new qt(0,0,1,0);return Math.abs(t.z)>.9999?i:qt.lookRotation(t,e)}function Gt(t,e,i,n,s,o=1){const r=[];for(let a=0;a<i;a++){const l=t+e*a/(i-1),h=new Yt;h[n]=o*Math.cos(l),h[s]=o*Math.sin(l),r.push(h)}return r}const Zt=r("rotationgizmo"),Qt=new Yt(0,0,0),Jt=new Yt(1,0,0),te=new Yt(0,1,0),ee=new Yt(0,0,1),ie=new Yt(0,0,-1),ne=new Yt(.7,0,0),se=new Yt(0,.7,0),oe=new Yt(0,0,.7),re=new Yt(-.7,0,0),ae=new Yt(0,-.7,0),le=new Yt(0,0,-.7),he=new qt(0,0,0,1);function pe(t,e,i){const n=t.createElementNS(k,"g"),s=t.createElementNS(k,"circle");s.classList.add(Zt(e)),s.setAttributeNS(null,"cx","0"),s.setAttributeNS(null,"cy","0"),s.setAttributeNS(null,"r","8"),n.appendChild(s);const o=t.createElementNS(k,"text");return o.classList.add(Zt("labeltext")),o.setAttributeNS(null,"y","4"),o.setAttributeNS(null,"text-anchor","middle"),o.setAttributeNS(null,"font-size","10"),o.textContent=i,n.appendChild(o),n}class de{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.onModeChange_=this.onModeChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Zt()),"popup"===e.pickerLayout&&this.element.classList.add(Zt(void 0,"p"));const i=t.createElement("div");i.classList.add(Zt("p")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const n=t.createElementNS(k,"svg");n.classList.add(Zt("g")),this.padElement.appendChild(n),this.svgElem_=n,this.projector_=new Ht,this.projector_.viewport=[0,0,136,136];const s=Gt(0,Math.PI,33,"x","y"),o=Gt(0,2*Math.PI,65,"x","y",1.1);this.xArcB_=new Wt(t,s,this.projector_),this.xArcB_.element.classList.add(Zt("arcx")),this.svgElem_.appendChild(this.xArcB_.element),this.yArcB_=new Wt(t,s,this.projector_),this.yArcB_.element.classList.add(Zt("arcy")),this.svgElem_.appendChild(this.yArcB_.element),this.zArcB_=new Wt(t,s,this.projector_),this.zArcB_.element.classList.add(Zt("arcz")),this.svgElem_.appendChild(this.zArcB_.element),this.xArcBC_=new Wt(t,s,this.projector_),this.xArcBC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.xArcBC_.element),this.yArcBC_=new Wt(t,s,this.projector_),this.yArcBC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.yArcBC_.element),this.zArcBC_=new Wt(t,s,this.projector_),this.zArcBC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.zArcBC_.element);const r=t.createElementNS(k,"g");n.classList.add(Zt("axes")),this.svgElem_.appendChild(r),this.axesElem_=r,this.xAxis_=new Wt(t,[Qt,ne],this.projector_),this.xAxis_.element.classList.add(Zt("axisx")),this.axesElem_.appendChild(this.xAxis_.element),this.yAxis_=new Wt(t,[Qt,se],this.projector_),this.yAxis_.element.classList.add(Zt("axisy")),this.axesElem_.appendChild(this.yAxis_.element),this.zAxis_=new Wt(t,[Qt,oe],this.projector_),this.zAxis_.element.classList.add(Zt("axisz")),this.axesElem_.appendChild(this.zAxis_.element),this.xnAxis_=new Wt(t,[Qt,re],this.projector_),this.xnAxis_.element.classList.add(Zt("axisn")),this.axesElem_.appendChild(this.xnAxis_.element),this.ynAxis_=new Wt(t,[Qt,ae],this.projector_),this.ynAxis_.element.classList.add(Zt("axisn")),this.axesElem_.appendChild(this.ynAxis_.element),this.znAxis_=new Wt(t,[Qt,le],this.projector_),this.znAxis_.element.classList.add(Zt("axisn")),this.axesElem_.appendChild(this.znAxis_.element),this.xArcF_=new Wt(t,s,this.projector_),this.xArcF_.element.classList.add(Zt("arcx")),this.svgElem_.appendChild(this.xArcF_.element),this.yArcF_=new Wt(t,s,this.projector_),this.yArcF_.element.classList.add(Zt("arcy")),this.svgElem_.appendChild(this.yArcF_.element),this.zArcF_=new Wt(t,s,this.projector_),this.zArcF_.element.classList.add(Zt("arcz")),this.svgElem_.appendChild(this.zArcF_.element),this.xArcFC_=new Wt(t,s,this.projector_),this.xArcFC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.xArcFC_.element),this.yArcFC_=new Wt(t,s,this.projector_),this.yArcFC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.yArcFC_.element),this.zArcFC_=new Wt(t,s,this.projector_),this.zArcFC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.zArcFC_.element),this.rArc_=new Wt(t,o,this.projector_),this.rArc_.element.classList.add(Zt("arcr")),this.rArc_.setRotation(he),this.svgElem_.appendChild(this.rArc_.element),this.rArcC_=new Wt(t,o,this.projector_),this.rArcC_.element.classList.add(Zt("arcc")),this.rArcC_.setRotation(he),this.svgElem_.appendChild(this.rArcC_.element);const a=t.createElementNS(k,"g");n.classList.add(Zt("labels")),this.svgElem_.appendChild(a),this.labelsElem_=a,this.xLabel=pe(t,"labelcirclex","X"),this.labelsElem_.appendChild(this.xLabel),this.yLabel=pe(t,"labelcircley","Y"),this.labelsElem_.appendChild(this.yLabel),this.zLabel=pe(t,"labelcirclez","Z"),this.labelsElem_.appendChild(this.zLabel),this.xnLabel=pe(t,"labelcirclen","-X"),this.labelsElem_.appendChild(this.xnLabel),this.ynLabel=pe(t,"labelcirclen","-Y"),this.labelsElem_.appendChild(this.ynLabel),this.znLabel=pe(t,"labelcirclen","-Z"),this.labelsElem_.appendChild(this.znLabel);const l=()=>{this.xArcB_.element.classList.add(Zt("arcx_hover")),this.xArcF_.element.classList.add(Zt("arcx_hover"))},h=()=>{this.xArcB_.element.classList.remove(Zt("arcx_hover")),this.xArcF_.element.classList.remove(Zt("arcx_hover"))};this.xArcBC_.element.addEventListener("mouseenter",l),this.xArcBC_.element.addEventListener("mouseleave",h),this.xArcFC_.element.addEventListener("mouseenter",l),this.xArcFC_.element.addEventListener("mouseleave",h);const p=()=>{this.yArcB_.element.classList.add(Zt("arcy_hover")),this.yArcF_.element.classList.add(Zt("arcy_hover"))},d=()=>{this.yArcB_.element.classList.remove(Zt("arcy_hover")),this.yArcF_.element.classList.remove(Zt("arcy_hover"))};this.yArcBC_.element.addEventListener("mouseenter",p),this.yArcBC_.element.addEventListener("mouseleave",d),this.yArcFC_.element.addEventListener("mouseenter",p),this.yArcFC_.element.addEventListener("mouseleave",d);const c=()=>{this.zArcB_.element.classList.add(Zt("arcz_hover")),this.zArcF_.element.classList.add(Zt("arcz_hover"))},u=()=>{this.zArcB_.element.classList.remove(Zt("arcz_hover")),this.zArcF_.element.classList.remove(Zt("arcz_hover"))};this.zArcBC_.element.addEventListener("mouseenter",c),this.zArcBC_.element.addEventListener("mouseleave",u),this.zArcFC_.element.addEventListener("mouseenter",c),this.zArcFC_.element.addEventListener("mouseleave",u);const v=()=>{this.rArc_.element.classList.add(Zt("arcr_hover"))},m=()=>{this.rArc_.element.classList.remove(Zt("arcr_hover"))};this.rArcC_.element.addEventListener("mouseenter",v),this.rArcC_.element.addEventListener("mouseleave",m),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,e.mode.emitter.on("change",this.onModeChange_),this.mode_=e.mode,this.update_()}get xArcBElement(){return this.xArcBC_.element}get yArcBElement(){return this.yArcBC_.element}get zArcBElement(){return this.zArcBC_.element}get xArcFElement(){return this.xArcFC_.element}get yArcFElement(){return this.yArcFC_.element}get zArcFElement(){return this.zArcFC_.element}get rArcElement(){return this.rArcC_.element}get allFocusableElements(){return[this.padElement]}update_(){const t=this.value.rawValue.quat.normalized;this.xAxis_.setRotation(t),this.yAxis_.setRotation(t),this.zAxis_.setRotation(t),this.xnAxis_.setRotation(t),this.ynAxis_.setRotation(t),this.znAxis_.setRotation(t);const e=Jt.applyQuaternion(t),i=te.applyQuaternion(t),n=ee.applyQuaternion(t),s=e.negated,o=i.negated,r=n.negated;[{el:this.xAxis_.element,v:e},{el:this.yAxis_.element,v:i},{el:this.zAxis_.element,v:n},{el:this.xnAxis_.element,v:s},{el:this.ynAxis_.element,v:o},{el:this.znAxis_.element,v:r}].map((({el:t,v:e})=>(this.axesElem_.removeChild(t),{el:t,v:e}))).sort(((t,e)=>t.v.z-e.v.z)).forEach((({el:t})=>{this.axesElem_.appendChild(t)})),this.xArcB_.setRotation(Xt(e,ie)),this.yArcB_.setRotation(Xt(i,ie)),this.zArcB_.setRotation(Xt(n,ie)),this.xArcBC_.setRotation(Xt(e,ie)),this.yArcBC_.setRotation(Xt(i,ie)),this.zArcBC_.setRotation(Xt(n,ie)),this.xArcF_.setRotation(Xt(e,ee)),this.yArcF_.setRotation(Xt(i,ee)),this.zArcF_.setRotation(Xt(n,ee)),this.xArcFC_.setRotation(Xt(e,ee)),this.yArcFC_.setRotation(Xt(i,ee)),this.zArcFC_.setRotation(Xt(n,ee)),[{el:this.xLabel,v:ne},{el:this.yLabel,v:se},{el:this.zLabel,v:oe},{el:this.xnLabel,v:re},{el:this.ynLabel,v:ae},{el:this.znLabel,v:le}].forEach((({el:e,v:i})=>{const[n,s]=this.projector_.project(i.applyQuaternion(t));e.setAttributeNS(null,"transform",`translate( ${n}, ${s} )`)})),[{el:this.xLabel,v:e},{el:this.yLabel,v:i},{el:this.zLabel,v:n},{el:this.xnLabel,v:s},{el:this.ynLabel,v:o},{el:this.znLabel,v:r}].map((({el:t,v:e})=>(this.labelsElem_.removeChild(t),{el:t,v:e}))).sort(((t,e)=>t.v.z-e.v.z)).forEach((({el:t})=>{this.labelsElem_.appendChild(t)}))}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}onModeChange_(){const t=this.mode_.rawValue,e="angle-x"===t?"add":"remove",i="angle-y"===t?"add":"remove",n="angle-z"===t?"add":"remove",s="angle-r"===t?"add":"remove";this.xArcB_.element.classList[e](Zt("arcx_active")),this.yArcB_.element.classList[i](Zt("arcy_active")),this.zArcB_.element.classList[n](Zt("arcz_active")),this.xArcF_.element.classList[e](Zt("arcx_active")),this.yArcF_.element.classList[i](Zt("arcy_active")),this.zArcF_.element.classList[n](Zt("arcz_active")),this.rArc_.element.classList[s](Zt("arcr_active"))}}function ce(t){return Ot(t,0,1)}function ue(t){if(t<=0)return 0;if(t>=1)return 1;const e=1-t;return ce(1-e*(e*(e*(e*(e*(e*(-6*e+7)))))))}function ve(t,e,i){return ce((i-t)/(e-t))}const me=1/Math.sqrt(2),ge=new Yt(1,0,0),be=new Yt(0,1,0),we=new Yt(0,0,1),fe=new qt(0,0,0,1),_e=new qt(me,0,0,me),xe=new qt(0,-me,0,me),ye=new qt(-me,0,0,me),Ce=new qt(0,me,0,me),ke=new qt(0,1,0,0);class Ee{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.mode_=m("free"),this.view=new de(t,{value:this.value,mode:this.mode_,viewProps:this.viewProps,pickerLayout:e.pickerLayout}),this.ptHandler_=new Mt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_);const i=new Mt(this.view.xArcBElement);i.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),i.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const n=new Mt(this.view.xArcFElement);n.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),n.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const s=new Mt(this.view.yArcBElement);s.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),s.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const o=new Mt(this.view.yArcFElement);o.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),o.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const r=new Mt(this.view.zArcBElement);r.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),r.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const a=new Mt(this.view.zArcFElement);a.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),a.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const l=new Mt(this.view.rArcElement);l.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-r"))),l.emitter.on("up",(()=>this.changeModeIfNotAuto_("free"))),[{el:this.view.xLabel,q:xe},{el:this.view.yLabel,q:_e},{el:this.view.zLabel,q:fe},{el:this.view.xnLabel,q:Ce},{el:this.view.ynLabel,q:ye},{el:this.view.znLabel,q:ke}].forEach((({el:t,q:e})=>{new Mt(t).emitter.on("down",(()=>this.autoRotate_(e)))})),this.px_=null,this.py_=null,this.angleState_=null}handlePointerEvent_(t){if(!t.point)return;const e=this.mode_.rawValue,i=t.point.x,n=t.point.y;if("auto"!==e)if("free"===e){if(null!=this.px_&&null!=this.py_){const t=i-this.px_,e=n-this.py_,s=Math.sqrt(t*t+e*e);if(0===s)return;const o=new Yt(e/s,t/s,0),r=qt.fromAxisAngle(o,s/68);this.value.rawValue=this.value.rawValue.premultiply(r)}this.px_=i,this.py_=n}else if("angle-r"===e){const e=t.bounds.width/2,s=t.bounds.height/2,o=Math.atan2(n-s,i-e);if(null==this.angleState_){const t=new Yt(0,0,1);this.angleState_={initialRotation:this.value.rawValue,initialAngle:o,axis:t,reverseAngle:!0}}else{const{initialRotation:t,initialAngle:e,axis:i}=this.angleState_,n=-Ut(o-e),s=qt.fromAxisAngle(i,n);this.value.rawValue=t.premultiply(s)}}else{const s=t.bounds.width/2,o=t.bounds.height/2,r=Math.atan2(n-o,i-s);if(null==this.angleState_){const t="angle-x"===e?ge:"angle-y"===e?be:we,i=t.applyQuaternion(this.value.rawValue.quat).z>0;this.angleState_={initialRotation:this.value.rawValue,initialAngle:r,axis:t,reverseAngle:i}}else{const{initialRotation:t,initialAngle:e,axis:i,reverseAngle:n}=this.angleState_;let s=Ut(r-e);s=n?-s:s;const o=qt.fromAxisAngle(i,s);this.value.rawValue=t.multiply(o)}}}onPointerDown_(t){this.handlePointerEvent_(t.data)}onPointerMove_(t){this.handlePointerEvent_(t.data)}onPointerUp_(){this.px_=null,this.py_=null,this.angleState_=null}onPadKeyDown_(t){Et(t.key)&&t.preventDefault();const e=xt(1,Ct(t)),i=xt(1,yt(t));if(0!==e||0!==i){const t=new Yt(-i,e,0),n=qt.fromAxisAngle(t,Math.PI/16);this.value.rawValue=this.value.rawValue.premultiply(n)}}changeModeIfNotAuto_(t){"auto"!==this.mode_.rawValue&&(this.mode_.rawValue=t)}autoRotate_(t){this.mode_.rawValue="auto";const e=this.value.rawValue,i=Date.now(),n=()=>{const s=ue(ve(0,300,Date.now()-i));this.value.rawValue=e.slerp(t,s),1!==s?requestAnimationFrame(n):this.mode_.rawValue="free"};requestAnimationFrame(n)}}const Pe=r("rotationswatch"),Me=new Yt(1,0,0),Le=new Yt(0,1,0),Ve=new Yt(0,0,1),ze=new qt(0,0,0,1);class Ae{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(Pe()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(Pe("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElementNS(k,"svg");n.classList.add(Pe("g")),i.appendChild(n),this.svgElem_=n,this.projector_=new Ht,this.projector_.viewport=[0,0,20,20];const s=Gt(0,Math.PI,33,"x","y"),o=Gt(0,2*Math.PI,65,"x","y");this.rArc_=new Wt(t,o,this.projector_),this.rArc_.element.classList.add(Pe("arcr")),n.appendChild(this.rArc_.element),this.rArc_.setRotation(ze),this.xArc_=new Wt(t,s,this.projector_),this.xArc_.element.classList.add(Pe("arc")),n.appendChild(this.xArc_.element),this.yArc_=new Wt(t,s,this.projector_),this.yArc_.element.classList.add(Pe("arc")),n.appendChild(this.yArc_.element),this.zArc_=new Wt(t,s,this.projector_),this.zArc_.element.classList.add(Pe("arc")),n.appendChild(this.zArc_.element),this.update_()}update_(){const t=this.value.rawValue.quat.normalized,e=Me.applyQuaternion(t),i=Le.applyQuaternion(t),n=Ve.applyQuaternion(t);this.xArc_.setRotation(Xt(e,Ve)),this.yArc_.setRotation(Xt(i,Ve)),this.zArc_.setRotation(Xt(n,Ve))}onValueChange_(){this.update_()}}class Se{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Ae(t,{value:this.value,viewProps:this.viewProps})}}const Ie=r("rotation");class De{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ie()),e.foldable.bindExpandedClass(this.element,Ie(void 0,"expanded")),p(e.foldable,"completed",c(this.element,Ie(void 0,"cpl"))),"quaternion"===e.rotationMode&&this.element.classList.add(Ie("quat"));const i=t.createElement("div");i.classList.add(Ie("h")),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Ie("s")),i.appendChild(n),this.swatchElement=n;const s=t.createElement("div");if(s.classList.add(Ie("t")),i.appendChild(s),this.textElement=s,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(Ie("g")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}class Re{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=V.create(e.expanded),this.swatchC_=new Se(t,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Nt(t,{assembly:e.assembly,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new De(t,{rotationMode:e.rotationMode,foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new N(t,{viewProps:this.viewProps}):null;const n=new Ee(t,{value:this.value,viewProps:this.viewProps,pickerLayout:e.pickerLayout});n.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.gizmoC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(n.view.element),_t({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.gizmoC_.view.element),S(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.gizmoC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=L(t);i&&e.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!M(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function Te(t,e){const i=Math.pow(.1,t);return{baseStep:i,constraint:e,textProps:g.fromObject({draggingScale:i,formatter:ft(t)})}}function je(t){if(!t)return;const i=[];return e(t.step)||i.push(new R(t.step)),(!e(t.max)||!e(t.min))&&i.push(new D({max:t.max,min:t.min})),new I(i)}function Ne(t,e){return{toComponents:t=>t.getComponents(),fromComponents:i=>new $t(i[0],i[1],i[2],t,e)}}function Fe(t,e,i){var n,s,o;return"number"==typeof(null===(n=t)||void 0===n?void 0:n.x)&&"number"==typeof(null===(s=t)||void 0===s?void 0:s.y)&&"number"==typeof(null===(o=t)||void 0===o?void 0:o.z)?new $t(t.x,t.y,t.z,e,i):new $t(0,0,0,e,i)}function Oe(t){switch(t){case"XYZ":case"XZY":case"YXZ":case"YZX":case"ZXY":case"ZYX":return t;default:return}}function Be(t){switch(t){case"rad":case"deg":case"turn":return t;default:return}}const Ke={id:"rotation",type:"input",css:".tp-rotationswatchv_b,.tp-rotationgizmov_p{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-rotationswatchv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-rotationswatchv_b:hover{background-color:var(--btn-bg-h)}.tp-rotationswatchv_b:focus{background-color:var(--btn-bg-f)}.tp-rotationswatchv_b:active{background-color:var(--btn-bg-a)}.tp-rotationswatchv_b:disabled{opacity:0.5}.tp-rotationgizmov_p{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-rotationgizmov_p:hover{background-color:var(--in-bg-h)}.tp-rotationgizmov_p:focus{background-color:var(--in-bg-f)}.tp-rotationgizmov_p:active{background-color:var(--in-bg-a)}.tp-rotationgizmov_p:disabled{opacity:0.5}.tp-rotationv{position:relative}.tp-rotationv_quat .tp-txtv_i{padding-left:0}.tp-rotationv_root{background-color:var(--mo-bg);width:100%;height:calc( 2.0 * var(--bld-us))}.tp-rotationv_h{display:flex}.tp-rotationv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us);margin-right:4px}.tp-rotationv_g{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-rotationv.tp-rotationv-expanded .tp-rotationv_g{margin-top:var(--bld-s);opacity:1}.tp-rotationv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-rotationswatchv path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationswatchv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-rotationswatchv_arc{fill:none;stroke:var(--btn-bg);stroke-width:1px}.tp-rotationswatchv_arcr{fill:var(--btn-fg);stroke:var(--btn-bg);stroke-width:1px}.tp-rotationgizmov{padding-left:calc(var(--bld-us) + 4px)}.tp-rotationgizmov path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationgizmov_p{cursor:move;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-rotationgizmov_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-rotationgizmov_axisx{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_axisy{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_axisz{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_axisn{stroke:var(--in-fg);stroke-width:2px}.tp-rotationgizmov_arcx{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_hover{stroke:#eb103f}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_active{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_arcy{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_hover{stroke:#4eeb10}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_active{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_arcz{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_hover{stroke:#1068eb}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_active{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_arcr{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_hover{stroke:#ebd510}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_active{stroke:#ebd510;stroke-width:2px}.tp-rotationgizmov_arcc{fill:none;stroke:transparent;stroke-width:5px;pointer-events:auto}.tp-rotationgizmov_labelcirclex{fill:#eb103f;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclex:hover{opacity:0.7}.tp-rotationgizmov_labelcircley{fill:#4eeb10;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcircley:hover{opacity:0.7}.tp-rotationgizmov_labelcirclez{fill:#1068eb;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclez:hover{opacity:0.7}.tp-rotationgizmov_labelcirclen{fill:var(--in-fg);cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclen:hover{opacity:0.7}.tp-rotationgizmov_labeltext{fill:var(--btn-fg);stroke:var(--btn-fg);stroke-width:1px}.tp-rotationgizmov_p:focus .tp-rotationgizmov_m{background-color:var(--in-fg);border-width:0}",accept(t,e){var i,n;const s=y,o=C(e,{view:s.required.constant("rotation"),label:s.optional.string,picker:s.optional.custom(St),expanded:s.optional.boolean,rotationMode:s.required.constant("euler"),x:s.optional.custom(It),y:s.optional.custom(It),z:s.optional.custom(It),order:s.optional.custom(Oe),unit:s.optional.custom(Be)});return o?{initialValue:Fe(t,null!==(i=o.order)&&void 0!==i?i:"XYZ",null!==(n=o.unit)&&void 0!==n?n:"rad"),params:o}:null},binding:{reader:({params:t})=>e=>{var i,n;return Fe(e,null!==(i=t.order)&&void 0!==i?i:"XYZ",null!==(n=t.unit)&&void 0!==n?n:"rad")},constraint({params:t}){var e,i;return new Dt({assembly:Ne(null!==(e=t.order)&&void 0!==e?e:"XYZ",null!==(i=t.unit)&&void 0!==i?i:"rad"),components:[je("x"in t?t.x:void 0),je("y"in t?t.y:void 0),je("z"in t?t.z:void 0)]})},writer:t=>(t,e)=>{t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}},controller({document:t,value:e,constraint:i,params:s,viewProps:o}){var r,a;if(!(i instanceof Dt))throw n.shouldNeverHappen();const l="expanded"in s?s.expanded:void 0,h="picker"in s?s.picker:void 0,p=null!==(r=s.unit)&&void 0!==r?r:"rad",d={rad:2,deg:0,turn:2}[p];return new Re(t,{axes:[Te(d,i.components[0]),Te(d,i.components[1]),Te(d,i.components[2])],assembly:Ne(null!==(a=s.order)&&void 0!==a?a:"XYZ",p),rotationMode:"euler",expanded:l??!1,parser:wt,pickerLayout:h??"popup",value:e,viewProps:o})}},Ue={toComponents:t=>[t.x,t.y,t.z,t.w],fromComponents:t=>new qt(t[0],t[1],t[2],t[3])};function $e(t){return{baseStep:.01,constraint:t,textProps:g.fromObject({draggingScale:.01,formatter:t=>Math.abs(t)<.995?t.toFixed(2).replace("0.","."):t.toFixed(1)})}}function qe(t){var e,i,n,s;return"number"==typeof(null===(e=t)||void 0===e?void 0:e.x)&&"number"==typeof(null===(i=t)||void 0===i?void 0:i.y)&&"number"==typeof(null===(n=t)||void 0===n?void 0:n.z)&&"number"==typeof(null===(s=t)||void 0===s?void 0:s.w)?new qt(t.x,t.y,t.z,t.w):new qt(0,0,0,1)}const He={id:"rotation",type:"input",css:".tp-rotationswatchv_b,.tp-rotationgizmov_p{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-rotationswatchv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-rotationswatchv_b:hover{background-color:var(--btn-bg-h)}.tp-rotationswatchv_b:focus{background-color:var(--btn-bg-f)}.tp-rotationswatchv_b:active{background-color:var(--btn-bg-a)}.tp-rotationswatchv_b:disabled{opacity:0.5}.tp-rotationgizmov_p{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-rotationgizmov_p:hover{background-color:var(--in-bg-h)}.tp-rotationgizmov_p:focus{background-color:var(--in-bg-f)}.tp-rotationgizmov_p:active{background-color:var(--in-bg-a)}.tp-rotationgizmov_p:disabled{opacity:0.5}.tp-rotationv{position:relative}.tp-rotationv_quat .tp-txtv_i{padding-left:0}.tp-rotationv_root{background-color:var(--mo-bg);width:100%;height:calc( 2.0 * var(--bld-us))}.tp-rotationv_h{display:flex}.tp-rotationv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us);margin-right:4px}.tp-rotationv_g{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-rotationv.tp-rotationv-expanded .tp-rotationv_g{margin-top:var(--bld-s);opacity:1}.tp-rotationv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-rotationswatchv path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationswatchv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-rotationswatchv_arc{fill:none;stroke:var(--btn-bg);stroke-width:1px}.tp-rotationswatchv_arcr{fill:var(--btn-fg);stroke:var(--btn-bg);stroke-width:1px}.tp-rotationgizmov{padding-left:calc(var(--bld-us) + 4px)}.tp-rotationgizmov path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationgizmov_p{cursor:move;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-rotationgizmov_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-rotationgizmov_axisx{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_axisy{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_axisz{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_axisn{stroke:var(--in-fg);stroke-width:2px}.tp-rotationgizmov_arcx{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_hover{stroke:#eb103f}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_active{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_arcy{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_hover{stroke:#4eeb10}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_active{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_arcz{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_hover{stroke:#1068eb}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_active{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_arcr{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_hover{stroke:#ebd510}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_active{stroke:#ebd510;stroke-width:2px}.tp-rotationgizmov_arcc{fill:none;stroke:transparent;stroke-width:5px;pointer-events:auto}.tp-rotationgizmov_labelcirclex{fill:#eb103f;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclex:hover{opacity:0.7}.tp-rotationgizmov_labelcircley{fill:#4eeb10;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcircley:hover{opacity:0.7}.tp-rotationgizmov_labelcirclez{fill:#1068eb;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclez:hover{opacity:0.7}.tp-rotationgizmov_labelcirclen{fill:var(--in-fg);cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclen:hover{opacity:0.7}.tp-rotationgizmov_labeltext{fill:var(--btn-fg);stroke:var(--btn-fg);stroke-width:1px}.tp-rotationgizmov_p:focus .tp-rotationgizmov_m{background-color:var(--in-fg);border-width:0}",accept(t,e){const i=y,n=C(e,{view:i.required.constant("rotation"),label:i.optional.string,picker:i.optional.custom(St),expanded:i.optional.boolean,rotationMode:i.optional.constant("quaternion"),x:i.optional.custom(It),y:i.optional.custom(It),z:i.optional.custom(It),w:i.optional.custom(It)});return n?{initialValue:qe(t),params:n}:null},binding:{reader:t=>t=>qe(t),constraint:({params:t})=>new Dt({assembly:Ue,components:[je("x"in t?t.x:void 0),je("y"in t?t.y:void 0),je("z"in t?t.z:void 0),je("w"in t?t.w:void 0)]}),writer:t=>(t,e)=>{t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}},controller({document:t,value:e,constraint:i,params:s,viewProps:o}){if(!(i instanceof Dt))throw n.shouldNeverHappen();const r="expanded"in s?s.expanded:void 0,a="picker"in s?s.picker:void 0;return new Re(t,{axes:[$e(i.components[0]),$e(i.components[1]),$e(i.components[2]),$e(i.components[3])],assembly:Ue,rotationMode:"quaternion",expanded:r??!1,parser:wt,pickerLayout:a??"popup",value:e,viewProps:o})}},We=[Ke,He];t.RotationInputPluginEuler=Ke,t.RotationInputPluginQuaternion=He,t.plugins=We,Object.defineProperty(t,"__esModule",{value:!0})}(We.exports);const Ye=zt({__proto__:null,default:At(We.exports)},[We.exports]);var Xe={exports:{}};!function(t){const e="tp";function i(t){return(i,n)=>[e,"-",t,"v",i?`_${i}`:"",n?`-${n}`:""].join("")}function n(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}function s(t,e){return t.reduce(((t,i)=>{if(void 0===t)return;const n=e(i);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[])}function o(t){return null!==t&&"object"==typeof t}function r(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function a(t){return{custom:e=>r(e)(t),boolean:r((t=>"boolean"==typeof t?t:void 0))(t),number:r((t=>"number"==typeof t?t:void 0))(t),string:r((t=>"string"==typeof t?t:void 0))(t),function:r((t=>"function"==typeof t?t:void 0))(t),constant:e=>r((t=>t===e?e:void 0))(t),raw:r((t=>t))(t),object:e=>r((t=>{if(o(t))return n(t,e)}))(t),array:e=>r((t=>{if(Array.isArray(t))return s(t,e)}))(t)}}const l={optional:a(!0),required:a(!1)};function h(t,e){const i=l.required.object(e)(t);return i.succeeded?i.value:void 0}const p=i("txtr");class d{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(p()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("textarea");i.rows=e.lineCount,i.cols=22,i.placeholder=e.placeholder,i.classList.add(p("i")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){this.inputElement.value=this.value_.rawValue}onChange_(){this.refresh()}}class c{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.lineCount=e.lineCount,this.placeholder=e.placeholder,this.view=new d(t,{value:this.value,viewProps:this.viewProps,lineCount:this.lineCount,placeholder:this.placeholder}),this.view.inputElement.addEventListener("keyup",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value;this.value.rawValue=e,this.view.refresh()}}const u=[{id:"input-template",type:"input",css:".tp-txtrv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-txtrv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtrv:hover{background-color:var(--in-bg-h)}.tp-txtrv:focus{background-color:var(--in-bg-f)}.tp-txtrv:active{background-color:var(--in-bg-a)}.tp-txtrv:disabled{opacity:.5}.tp-txtrv{display:block;height:auto;padding-bottom:0;overflow:hidden;position:relative}.tp-txtrv.tp-v-disabled{opacity:.5}.tp-txtrv .tp-txtrv_i{font-family:var(--font-family);background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-size:11px;padding:4px;line-height:16px;min-width:0;width:100%;border:none;height:100%;resize:none;margin-bottom:-8px}.tp-txtrv .tp-txtrv_i:focus{outline:none}",accept(t,e){if("string"!=typeof t)return null;const i=l,n=h(e,{view:i.required.constant("textarea"),lineCount:i.optional.number,placeholder:i.optional.string});return n?{initialValue:t,params:n}:null},binding:{reader:t=>t=>"string"==typeof t?t:"",writer:t=>(t,e)=>{t.write(e)}},controller(t){var e,i;return new c(t.document,{value:t.value,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:3,placeholder:null!==(i=t.params.placeholder)&&void 0!==i?i:"Enter text here",viewProps:t.viewProps})}}];t.plugins=u,Object.defineProperty(t,"__esModule",{value:!0})}(Xe.exports);const Ge=zt({__proto__:null,default:At(Xe.exports)},[Xe.exports]),Ze=t=>{const e=new St.exports.Pane({container:t});return e.registerPlugin($e),e.registerPlugin(He),e.registerPlugin(Ye),e.registerPlugin(Ge),e},Qe={controlling:!1},Je={expanded:!1,picker:"inline",rotationMode:"euler",view:"rotation"},ti=(t,e)=>{const i=Ft(),{element:n}=t,s={rotation:new i.Euler};t.addSeparator();const o=t.addInput(e,"position",{step:.1}),r=t.addInput(s,"rotation",Je).on("change",(()=>{Qe.controlling&&e.rotation.copy(s.rotation)})),a=t.addInput(e,"scale",{step:.1}),l=()=>{Qe.controlling||(e.rotation.equals(s.rotation)||(s.rotation.copy(e.rotation),r.refresh()),o.refresh(),a.refresh())};let h;Jt(l),"isInstancedMesh"in e&&(h=((t,e)=>{const i=Ft(),n=new i.Matrix4;t.addSeparator();const s={index:0,position:new i.Vector3,rotation:new i.Euler,scale:new i.Vector3},o=t.addInput(s,"index",{label:"instance index",max:e.count-1,min:0,step:1}),r=t.addInput(s,"position",{index:0}),a=t.addInput(s,"rotation",Je),l=t.addInput(s,"scale",{index:0}),h=()=>{e.getMatrixAt(s.index,n),s.position.setFromMatrixPosition(n),s.rotation.setFromRotationMatrix(n),s.scale.setFromMatrixScale(n),r.refresh(),a.refresh(),l.refresh()},p=()=>{n.makeRotationFromEuler(s.rotation),n.setPosition(s.position),n.scale(s.scale),e.setMatrixAt(s.index,n),e.instanceMatrix.needsUpdate=!0};o.on("change",h),r.on("change",p),a.on("change",p),l.on("change",p);const d=()=>{Qe.controlling||h()};return Jt(d),()=>te(d)})(t,e));const p=()=>{Qe.controlling=!0},d=()=>{Qe.controlling=!1};return n.addEventListener("mousedown",p,{passive:!0}),n.addEventListener("mouseup",d,{passive:!0}),()=>{n.removeEventListener("mousedown",p),n.removeEventListener("mouseup",d),o.dispose(),r.dispose(),a.dispose(),te(l),null==h||h()}},ei=(t,e)=>{t.addSeparator();const i={userData:JSON.stringify(e.userData,null,2)},n=i.userData.split(/\r\n|\r|\n/u).length,s=t.addMonitor(i,"userData",{interval:5e3,lineCount:n,multiline:!0});return()=>s.dispose()},ii=[Wt.NONE,Wt.ORBIT,Wt.MAP],ni={controls:Dt.getNumber("controls")??Wt.NONE},si=(t,e,i,n)=>{const s=["none","orbit","map"];t.addInput(ni,"controls",{cells:(t,e)=>({title:s[ii[3*e+t]],value:ii[3*e+t]}),groupName:"controls",label:"debug controls",size:[3,1],view:"radiogrid"}).on("change",(()=>Xt(e,i,ni.controls)));const o=()=>{e.updateProjectionMatrix()};t.addInput(e,"near").on("change",o),t.addInput(e,"far").on("change",o);const r=t.addInput(e,"zoom").on("change",o),a=()=>r.refresh();window.addEventListener("wheel",a,{passive:!0}),"isOrthographicCamera"in e&&(t.addInput(e,"bottom").on("change",o),t.addInput(e,"left").on("change",o),t.addInput(e,"right").on("change",o),t.addInput(e,"top").on("change",o)),"isPerspectiveCamera"in e&&(t.addInput(e,"fov").on("change",o),t.addInput(e,"filmOffset").on("change",o),t.addInput(e,"filmGauge").on("change",o));const l=[];return l.push(ti(t,e)),l.push(ei(t,e)),l.push(((t,e)=>{if(void 0===e)return()=>null;const i=t.addFolder({title:"Postprocessing"}),{passes:n}=e;let s;for(let r=0,a=n.length;r<a;r+=1){const t=n[r];if("effects"in t){s=t;break}}if(void 0===s)return()=>i.dispose();i.addInput(s,"dithering");const{effects:o}=s;for(let r=0,a=o.length;r<a;r+=1){const t=o[r];if("SMAAEffect"===t.name)i.addFolder({title:"smaa"});else if("BloomEffect"===t.name){const e=t,n=i.addFolder({title:"bloom"});n.addInput(e,"height"),n.addInput(e,"width"),n.addInput(e,"intensity")}else if("NoiseEffect"===t.name)i.addFolder({title:"noise"}).addInput(t.blendMode.opacity,"value",{label:"opacity"});else if("VignetteEffect"===t.name){const e=t,n=i.addFolder({title:"vignette"});n.addInput(e,"darkness"),n.addInput(e,"technique",{options:{default:0,eskil:1}}),n.addInput(e,"offset")}else if("SSREffect"===t.name){const e=t,n=i.addFolder({title:"ssr"});n.addInput(e,"intensity",{max:3,min:0,step:.01}),n.addInput(e,"exponent",{max:8,min:.125,step:.125}),n.addInput(e,"distance",{max:10,min:.001,step:.1}),n.addInput(e,"fade",{max:20,min:0,step:.01}),n.addInput(e,"roughnessFade",{max:1,min:0,step:.01}),n.addInput(e,"thickness",{max:10,min:0,step:.01}),n.addInput(e,"ior",{max:2.33333,min:1,step:.01}),n.addInput(e,"maxRoughness",{max:1,min:0,step:.01}),n.addInput(e,"maxDepthDifference",{max:100,min:0,step:.1});const s=n.addFolder({index:0,title:"Temporal Resolve"});s.addInput(e,"blend",{max:1,min:0,step:.001}),s.addInput(e,"correction",{max:1,min:0,step:1e-4}),s.addInput(e,"correctionRadius",{max:4,min:1,step:1});const o=n.addFolder({index:0,title:"Blur"});o.addInput(e,"blur",{max:1,min:0,step:.01}),o.addInput(e,"blurKernel",{max:5,min:0,step:1}),o.addInput(e,"blurSharpness",{max:100,min:0,step:1});const r=n.addFolder({index:0,title:"Jitter"});r.addInput(e,"jitter",{max:4,min:0,step:.01}),r.addInput(e,"jitterRoughness",{max:4,min:0,step:.01});const a=n.addFolder({index:0,title:"Tracing"});a.addInput(e,"steps",{max:256,min:1,step:1}),a.addInput(e,"refineSteps",{max:16,min:0,step:1}),a.addInput(e,"missedRays");const l=n.addFolder({index:0,title:"Resolution"});l.addInput(e,"resolutionScale",{max:1,min:.125,step:.125}),l.addInput(e,"velocityResolutionScale",{max:1,min:.125,step:.125})}else console.warn(`three-debug does not yet support postprocessing effect: ${t.name}`)}return()=>i.dispose()})(t,n)),l.push((()=>window.removeEventListener("wheel",a))),l},oi=new WeakMap,ri=new WeakMap,ai=t=>ri.get(t),li=t=>{if(!0===t.userData.threeDebugOmit)return;t.traverse((e=>t!==e&&li(e)));const e=oi.get(t);oi.delete(t),void 0!==e&&(ri.delete(e),e.destroy())},hi=(t,e,i)=>{if(!0===e.userData.threeDebugOmit)return;const n="isScene"in i?t:oi.get(i);if(void 0===n)return;const s=`${e.name} (${(t=>{var e;return"isInstancedMesh"in t?"InstancedMesh":(null==(e=t.geometry)?void 0:e.isMeshLine)?"MeshLine":t.type})(e)})`,o=new Pe({text:s});o.open=!0,oi.set(e,o),ri.set(o,e),n.append(o);{const{children:i}=e;for(let n=0,s=i.length;n<s;n+=1)hi(t,i[n],e)}},pi={max:1,min:0},di={1024:1024,2048:2048,256:256,512:512},ci=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],ui=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],vi=(t,e)=>{t.addSeparator(),t.addInput(e.target,"position",{label:"target position",step:.1}).on("change",(()=>{e.target.updateMatrixWorld()}))},mi=(t,e)=>{const i=Ft(),n=e,s=e,o=e,r=e,a=e;let l,h;const p=[],d={color:`#${e.color.getHexString().toUpperCase()}`,helper:!1,shadowHelper:!1};if("isAmbientLight"in e||t.addInput(d,"helper").on("change",(()=>e[d.helper?"add":"remove"](l))),t.addInput(d,"color").on("change",(()=>e.color.set(d.color))),t.addInput(e,"intensity"),"DirectionalLight"===e.type?(t.addInput(e,"castShadow"),ti(t,e),vi(t,n),l=new i.DirectionalLightHelper(n)):"HemisphereLight"===e.type?(t.addInput(s,"groundColor"),l=new i.HemisphereLightHelper(s,10)):"PointLight"===e.type?(t.addInput(o,"decay"),t.addInput(o,"distance"),t.addInput(o,"power"),t.addInput(o,"castShadow"),ti(t,o),l=new i.PointLightHelper(o,10)):"SpotLight"===e.type?(t.addInput(r,"angle",{max:Math.PI/2,min:0}),t.addInput(r,"decay"),t.addInput(r,"distance"),t.addInput(r,"penumbra",pi),t.addInput(r,"power"),t.addInput(r,"castShadow"),ti(t,r),vi(t,r),l=new i.SpotLightHelper(r)):"RectAreaLight"===e.type&&(t.addInput(a,"power"),t.addInput(a,"width"),t.addInput(a,"height"),ti(t,a),l=((t,e)=>{const i=Ft(),n=new i.BufferGeometry;n.setAttribute("position",new i.Float32BufferAttribute(ci,3)),n.computeBoundingSphere();const s=new i.LineBasicMaterial({fog:!1}),o=new i.Line;o.type="RectAreaLightHelper";const r=new i.BufferGeometry;return r.setAttribute("position",new i.Float32BufferAttribute(ui,3)),r.computeBoundingSphere(),o.add(new i.Mesh(r,new i.MeshBasicMaterial({fog:!1,side:i.BackSide}))),o.updateMatrixWorld=()=>{if(o.scale.set(.5*t.width,.5*t.height,1),void 0===e){s.color.copy(t.color).multiplyScalar(t.intensity);const{color:e}=s,i=Math.max(e.r,e.g,e.b);i>1&&e.multiplyScalar(1/i),o.children[0].material.color.copy(e)}else s.color.set(e),o.children[0].material.color.set(e);o.matrixWorld.extractRotation(t.matrixWorld).scale(o.scale).copyPosition(t.matrixWorld),o.children[0].matrixWorld.copy(o.matrixWorld)},o.dispose=()=>{o.geometry.dispose(),o.material.dispose();const t=o.children[0];t.geometry.dispose(),t.material.dispose()},o})(a)),void 0!==l&&(l.userData.threeDebugOmit=!0),e.castShadow){const s=t.addFolder({index:e.id,title:"Shadow Camera"});s.addInput(e.shadow,"autoUpdate"),s.addInput(d,"shadowHelper",{label:"helper"}).on("change",(()=>e[d.shadowHelper?"add":"remove"](h)));const o={mapSize:e.shadow.mapSize.x},a=()=>{e.shadow.mapSize.width=o.mapSize,e.shadow.mapSize.height=o.mapSize,e.shadow.dispose(),e.shadow.map=null};if(s.addInput(o,"mapSize",{options:di}).on("change",a),s.addInput(e.shadow,"bias",{max:.09,min:0,step:.001}),s.addInput(e.shadow,"normalBias").on("change",a),s.addInput(e.shadow,"radius").on("change",a),"DirectionalLight"===e.type){const{camera:t}=n.shadow;s.addInput(t,"near").on("change",a),s.addInput(t,"far").on("change",a),s.addInput(t,"left").on("change",a),s.addInput(t,"right").on("change",a),s.addInput(t,"top").on("change",a),s.addInput(t,"bottom").on("change",a),ti(s,t)}else if("SpotLight"===e.type){const{camera:t}=r.shadow;s.addInput(t,"near").on("change",a),s.addInput(t,"far").on("change",a),s.addInput(t,"focus",pi),ti(s,t)}h=new i.CameraHelper(e.shadow.camera),h.userData.threeDebugOmit=!0}return t.on("change",(()=>{var t,e;null==(t=null==l?void 0:l.update)||t.call(l),null==(e=null==h?void 0:h.update)||e.call(h)})),p.push(ei(t,e)),p.push((()=>{var t;void 0!==l&&(e.remove(l),null==(t=l.dispose)||t.call(l)),void 0!==h&&(e.remove(h),h.dispose())})),p},gi=(()=>{const t=document.createElement("canvas");t.width=1,t.height=1;const e=t.getContext("2d");e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1);const i=document.createElement("img");return i.src=t.toDataURL("image/png"),i})(),bi=(t,e,i)=>{const n=Ft(),s=e[i],o={current:()=>{}},r={ClampToEdgeWrapping:n.ClampToEdgeWrapping,MirroredRepeatWrapping:n.MirroredRepeatWrapping,RepeatWrapping:n.RepeatWrapping},a={LinearFilter:n.LinearFilter,NearestFilter:n.NearestFilter},l={...a,LinearMipmapLinearFilter:n.LinearMipmapLinearFilter,LinearMipmapNearestFilter:n.LinearMipmapNearestFilter,NearestMipmapLinearFilter:n.NearestMipmapLinearFilter,NearestMipmapNearestFilter:n.NearestMipmapNearestFilter},h={0:0,16:16,2:2,4:4,8:8},p={AlphaFormat:n.AlphaFormat,DepthFormat:n.DepthFormat,DepthStencilFormat:n.DepthStencilFormat,LuminanceAlphaFormat:n.LuminanceAlphaFormat,LuminanceFormat:n.LuminanceFormat,RGBAFormat:n.RGBAFormat,RGBAIntegerFormat:n.RGBAIntegerFormat,RGFormat:n.RGFormat,RGIntegerFormat:n.RGIntegerFormat,RedFormat:n.RedFormat,RedIntegerFormat:n.RedIntegerFormat},d={BasicDepthPacking:n.BasicDepthPacking,LinearEncoding:n.LinearEncoding,RGBADepthPacking:n.RGBADepthPacking,sRGBEncoding:n.sRGBEncoding},c={map:(null==s?void 0:s.image)??gi},u=t=>{v.hidden=!1,v.title=`${t.name} (Texture)`.trim();const i=()=>t.needsUpdate=!0;v.addInput(t,"wrapS",{options:r}).on("change",i),v.addInput(t,"wrapT",{options:r}).on("change",i),v.addInput(t,"magFilter",{options:a}),v.addInput(t,"minFilter",{options:l}),v.addInput(t,"offset",{step:.01}),v.addInput(t,"rotation",{step:.01}),v.addInput(t,"anisotropy",{options:h}).on("change",i),v.addInput(t,"format",{options:p}).on("change",i),v.addInput(t,"repeat",{step:1}),v.addInput(t,"center"),v.addInput(t,"flipY"),v.addInput(t,"encoding",{options:d}).on("change",(()=>{i(),e instanceof n.Material&&(e.needsUpdate=!0)})),o.current=()=>v.children.forEach((t=>t.dispose()))};t.addInput(c,"map",{label:i,view:"input-image"}).on("change",(({value:t})=>{var s;if(t.src===gi.src)return;null==(s=e[i])||s.dispose();const r=new n.Texture(t);e[i]=r,r.needsUpdate=!0,e instanceof n.Material&&(e.needsUpdate=!0),o.current(),u(r)}));const v=t.addFolder({hidden:!0,title:""});return s&&u(s),()=>o.current()},wi=(t,e)=>{const i=Ft(),n=e.material,s=t.addFolder({index:e.id,title:`${n.name} (${n.type})`.trim()}),o={BackSide:i.BackSide,DoubleSide:i.DoubleSide,FrontSide:i.FrontSide},r={ObjectSpaceNormalMap:i.ObjectSpaceNormalMap,TangentSpaceNormalMap:i.TangentSpaceNormalMap},a={color:"",emissive:""},l=()=>{n.needsUpdate=!0},h=()=>{const t=n;a.color=`#${t.color.getHexString()}`,s.addInput(a,"color").on("change",(()=>t.color.set(a.color)))},p=()=>{const t=n;a.emissive=`#${t.emissive.getHexString()}`,s.addInput(a,"emissive").on("change",(()=>t.emissive.set(a.emissive))),s.addInput(t,"emissiveIntensity",{min:0})};if(s.addInput(n,"visible"),s.addInput(n,"side",{options:o}),s.addInput(n,"transparent").on("change",l),s.addInput(n,"opacity",pi),s.addInput(n,"vertexColors"),s.addSeparator(),"LineBasicMaterial"===n.type||"LineDashedMaterial"===n.type){h();const t=n;s.addInput(t,"fog"),s.addInput(t,"linewidth")}else if("MeshBasicMaterial"===n.type){h();const t=n;s.addInput(t,"fog"),s.addInput(t,"reflectivity",pi),s.addInput(t,"refractionRatio",pi),s.addInput(t,"wireframe")}else if("MeshDepthMaterial"===n.type)s.addInput(n,"fog");else if("MeshLambertMaterial"===n.type){h(),p();const t=n;s.addInput(t,"flatShading").on("change",l),s.addInput(t,"fog"),s.addInput(t,"reflectivity",pi),s.addInput(t,"refractionRatio",pi),s.addInput(t,"wireframe")}else if("MeshPhongMaterial"===n.type){h(),p();const t=n;s.addInput(t,"flatShading").on("change",l),s.addInput(t,"fog"),s.addInput(t,"reflectivity",pi),s.addInput(t,"refractionRatio",pi),s.addInput(t,"shininess",pi),s.addInput(t,"wireframe")}else if("MeshStandardMaterial"===n.type||"MeshPhysicalMaterial"===n.type){h(),p();const t=n;if(s.addInput(t,"roughness",pi),s.addInput(t,"metalness",pi),s.addInput(t,"flatShading").on("change",l),s.addInput(t,"fog"),s.addInput(t,"wireframe"),s.addInput(t,"envMapIntensity"),"MeshPhysicalMaterial"===n.type){const t=n;s.addInput(t,"reflectivity",pi),s.addInput(t,"clearcoat",pi),s.addInput(t,"clearcoatRoughness",pi)}}else if("ShaderMaterial"===n.type){const t=n;s.addInput(t,"uniforms",{view:"textarea"}).on("change",l),s.addInput(t,"vertexShader",{view:"textarea"}).on("change",l),s.addInput(t,"fragmentShader",{view:"textarea"}).on("change",l)}if("MeshBasicMaterial"===n.type||"MeshLambertMaterial"===n.type||"MeshPhongMaterial"===n.type||"MeshStandardMaterial"===n.type||"MeshPhysicalMaterial"===n.type){const t=n;s.addSeparator(),bi(s,t,"map"),bi(s,t,"alphaMap"),bi(s,t,"aoMap"),s.addInput(t,"aoMapIntensity",pi),bi(s,t,"lightMap"),s.addInput(t,"lightMapIntensity",pi),("MeshLambertMaterial"===n.type||"MeshPhongMaterial"===n.type||"MeshStandardMaterial"===n.type||"MeshPhysicalMaterial"===n.type)&&(bi(s,t,"bumpMap"),s.addInput(t,"bumpScale",pi),bi(s,t,"displacementMap"),s.addInput(t,"displacementScale"),s.addInput(t,"displacementBias"),bi(s,t,"emissiveMap"),bi(s,t,"normalMap"),s.addInput(t,"normalMapType",{options:r})),("MeshStandardMaterial"===n.type||"MeshPhysicalMaterial"===n.type)&&(bi(s,t,"metalnessMap"),bi(s,t,"roughnessMap"))}return s.addSeparator(),s.addInput(n,"alphaTest",pi),s.addInput(n,"blendDst"),s.addInput(n,"clipShadows"),s.addInput(n,"depthTest"),s.addInput(n,"depthWrite"),s.addInput(n,"polygonOffset"),s.addInput(n,"polygonOffsetFactor"),s.addInput(n,"dithering"),()=>s.dispose()},fi=(t,e)=>{t.addInput(e,"castShadow"),t.addInput(e,"receiveShadow"),t.addInput(e,"frustumCulled"),t.addInput(e,"matrixAutoUpdate"),t.addInput(e,"visible");const i=[];e.type.toLowerCase().includes("helper")||i.push(((t,e)=>{const i=new(Ft().ArrowHelper);i.name="Forward helper",i.setLength(1),i.userData.threeDebugOmit=!0;const n={forwardHelper:!1},s=t.addInput(n,"forwardHelper").on("change",(()=>{n.forwardHelper?e.add(i):e.remove(i)}));return()=>{var t;s.dispose(),e.remove(i),null==(t=i.dispose)||t.call(i)}})(t,e)),i.push(ti(t,e));const n=e;if(Array.isArray(n.material))for(let s=0,o=n.material.length;s<o;s+=1)"isMaterial"in n.material[s]&&i.push(wi(t,n));else void 0!==n.material&&"isMaterial"in n.material&&i.push(wi(t,n));return i.push(ei(t,e)),i},_i={axes:void 0,grid:void 0},xi=null!==Dt.get("grid"),yi=null!==Dt.get("axes"),Ci={axes:yi,background:gi,fogColor:"#000000",grid:xi,gridDivisions:Dt.getNumber("gridDivisions")??4,gridSize:Dt.getNumber("gridSize")??10},ki=(t,e,i)=>{const n=Ft(),s=[],o=t=>{e[Ci[t]?"add":"remove"](_i[t]),Ci[t]?Dt.set(t,""):Dt.remove(t)},r=t=>{var i,s;e.remove(_i.grid),null==(s=(i=_i.grid).dispose)||s.call(i),_i.grid=new n.GridHelper(Ci.gridSize,Ci.gridDivisions),e.add(_i.grid),Dt.setNumber(t,Ci[t])};if(t.addInput(Ci,"axes",{label:"axes"}).on("change",(()=>o("axes"))),t.addInput(Ci,"grid",{label:"grid"}).on("change",(()=>o("grid"))),t.addInput(Ci,"gridSize",{label:"grid size"}).on("change",(()=>r("gridSize"))),t.addInput(Ci,"gridDivisions",{label:"grid divisions",step:1}).on("change",(()=>r("gridDivisions"))),null!==e.fog){Ci.fogColor=`#${e.fog.color.getHexString().toUpperCase()}`;const i=t.addFolder({title:"Fog"});i.addInput(Ci,"fogColor",{label:"color"}).on("change",(()=>{var t;null==(t=e.fog)||t.color.set(Ci.fogColor)})),"near"in e.fog&&i.addInput(e.fog,"near"),"far"in e.fog&&i.addInput(e.fog,"far")}return t.addSeparator(),s.push(bi(t,e,"background")),t.addSeparator(),s.push(((t,e)=>{const i=Ft(),n=new i.Color;e.getClearColor(n);const s={clearColor:`#${n.getHexString().toUpperCase()}`,maxAnisotropy:e.capabilities.getMaxAnisotropy()};t.addInput(s,"clearColor").on("change",(()=>{e.setClearColor(s.clearColor)}));const o=()=>{e.shadowMap.needsUpdate=!0};t.addSeparator(),t.addInput(e.shadowMap,"enabled",{label:"shadowmap"}).on("change",o),t.addInput(e.shadowMap,"autoUpdate").on("change",o),t.addInput(e.shadowMap,"type",{options:{Basic:i.BasicShadowMap,PCF:i.PCFShadowMap,"PCF Soft":i.PCFSoftShadowMap,VSM:i.VSMShadowMap}}).on("change",(()=>{e.shadowMap.needsUpdate=!0})),t.addSeparator(),t.addInput(e,"toneMapping",{options:{ACESFilmic:i.ACESFilmicToneMapping,Cineon:i.CineonToneMapping,Custom:i.CustomToneMapping,Linear:i.LinearToneMapping,None:i.NoToneMapping,Reinhard:i.ReinhardToneMapping}}),t.addInput(e,"toneMappingExposure",{label:"exposure"}),t.addSeparator();const r={interval:3e3};t.addMonitor(e.info.memory,"geometries",r),t.addMonitor(e.info.memory,"textures",r),t.addMonitor(e.info.render,"calls",r),t.addMonitor(e.info.render,"lines",r),t.addMonitor(e.info.render,"points",r),t.addMonitor(e.info.render,"triangles",r),t.addSeparator();const a={interval:1e5};return t.addMonitor(s,"maxAnisotropy",a),t.addMonitor(e.capabilities,"maxAttributes",a),t.addMonitor(e.capabilities,"maxCubemapSize",a),t.addMonitor(e.capabilities,"maxFragmentUniforms",a),t.addMonitor(e.capabilities,"maxTextureSize",a),t.addMonitor(e.capabilities,"maxTextures",a),t.addMonitor(e.capabilities,"maxVaryings",a),t.addMonitor(e.capabilities,"maxVertexTextures",a),t.addMonitor(e.capabilities,"maxVertexUniforms",a),t.addMonitor(e.capabilities,"precision",a),()=>null})(t,i)),s.push((()=>{var t,e;null==(e=(t=_i.grid).dispose)||e.call(t),_i.axes.dispose()})),s},Ei=t=>{const e=Ft(),i=e.Object3D.prototype.add,n=e.Object3D.prototype.remove,s=e.Object3D.prototype.clear;return e.Object3D.prototype.add=function(...e){for(let i=0,n=e.length;i<n;i+=1)hi(t,e[i],this);return i.call(this,...e),this},e.Object3D.prototype.remove=function(...t){for(let e=0,i=t.length;e<i;e+=1)li(t[e]);return n.call(this,...t),this},e.Object3D.prototype.clear=function(){const{children:t}=this;for(let e=0,i=t.length;e<i;e+=1)li(t[e]);return s.call(this),this},()=>{e.Object3D.prototype.add=i,e.Object3D.prototype.remove=n,e.Object3D.prototype.clear=s}},Pi=(t,e,i,n,s,o)=>{const r=Ei(e);let a=null;t.on("deselect",(()=>{null==a||a(),a=null})),t.on("select",(t=>{const e="Scene"===t.text?n:ai(t);a=((t,e,i,n)=>{const s=Ze(t);let o;return o="isPerspectiveCamera"in e||"isOrthographicCamera"in e?si(s,e,i,n):"isScene"in e?ki(s,e,i):"isLight"in e?mi(s,e):fi(s,e),()=>{o.forEach((t=>t())),s.dispose()}})(i,e,s,o)})),t.on("reparent",(t=>{for(let e=0,i=t.length;e<i;e+=1){const{item:i,newParent:s}=t[e],o=ai(i);("Scene"===s.text?n:ai(s)).attach(o)}}));{const{children:t}=n;for(let i=0,s=t.length;i<s;i+=1)hi(e,t[i],n)}return()=>{r(),t.clearTreeItems(),(()=>{const{children:t}=n;for(let e=0,i=t.length;e<i;e+=1)li(t[e])})()}},Mi=(t,e,i)=>{const n=[],s=document.createElement("div");s.className="absolute top-0 left-0 w-screen h-screen";const o=(t=>{const e=new ve;return e.resizable="right",e.resizeMax=1/0,e.dom.classList.add("relative","h-screen","float-left"),e.dom.style.width=window.innerWidth-300+"px",t.domElement.setAttribute("style","\n    width: 100% !important;\n    height: 100% !important;\n  "),e.dom.append(t.domElement),e})(e),{controls:r,nav:a,treeroot:l,treeview:h,pane:p}=(()=>{const t=document.createElement("div");t.className="relative flex flex-col h-screen bg-[#28292e] w-auto";const e=document.createElement("nav");e.className="tp-rotv sticky top-0 three-debug-nav",t.append(e);const i=document.createElement("section");i.className="h-screen flex flex-col overflow-x-hidden overflow-y-auto",i.dataset.pane="World",t.append(i);const n=new Ke;n.dom.classList.add("sticky","top-0"),n.allowRenaming=!1,n.resizable="bottom",n.resizeMax=1/0,n.dom.style.height="300px",i.append(n.dom);const s=new Pe({text:"Scene"});n.append(s);const o=document.createElement("div");return o.className="grow",i.append(o),{controls:t,nav:e,pane:o,treeroot:s,treeview:n}})(),{addPane:d}=((t,e)=>{let i="";const n=n=>{var s,o,r,a;i!==n&&(Dt.set("selectedPane",n),null==(s=t.querySelector(`[data-pane="${i}"]`))||s.classList.add("hidden"),null==(o=e.querySelector(`[data-nav="${i}"]`))||o.classList.remove("selected"),null==(r=t.querySelector(`[data-pane="${n}"]`))||r.classList.remove("hidden"),null==(a=e.querySelector(`[data-nav="${n}"]`))||a.classList.add("selected"),i=n)},s=t=>{const i=document.createElement("button");i.className="tp-fldv_b nav-button",i.dataset.nav=t,i.textContent=t,i.addEventListener("click",(()=>n(t)),{passive:!0}),e.append(i)};return s("World"),n("World"),{addPane:e=>{const i=document.createElement("section");return i.className="h-screen flex flex-col overflow-x-hidden overflow-y-auto hidden",i.dataset.pane=e,t.insertBefore(i,t.children[t.children.length-2]),s(e),Ze(i)}}})(r,a);n.push((t=>{const e=document.createElement("div");e.className="sticky bottom-0",t.append(e);const i=new St.exports.Pane({container:e});i.registerPlugin($e),i.addSeparator();const n=1048576,{memory:s}=performance,o={memory:s?s.usedJSHeapSize/n:0,time:""},r=performance.now();let a=0;const l=()=>{a=(performance.now()-r)/1e3;const t=a%60|0,e=a/60|0,i=a/60/60|0;o.time=`${i<10?`0${i}`:i}:${e<10?`0${e}`:e}:${t<10?`0${t}`:t}`};l();const h=setInterval(l,1e3);i.addMonitor(o,"time",{interval:1e3});const p=i.addBlade({label:"fps",lineCount:2,view:"fpsgraph"});let d=-1;s&&(i.addMonitor(o,"memory",{max:s.jsHeapSizeLimit/n,min:0,view:"graph"}),d=setInterval((()=>{o.memory=s.usedJSHeapSize/n}),3e3));const c=()=>{const t=p;t.end(),t.begin()};return Jt(c),()=>{i.dispose(),clearInterval(h),clearInterval(d),te(c)}})(r)),n.push(Pi(h,l,p,t,e,i)),s.append(o.dom),s.append(r),document.body.append(s);let c=window.innerWidth;const u=()=>{const t=window.innerWidth,e=t-c;o.width+=e,c=t};return window.addEventListener("resize",u,{passive:!0}),n.push((()=>window.removeEventListener("resize",u))),{addPane:d,disposers:n}},Li=document.createElement("style");Li.textContent='*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.visible{visibility:visible}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.top-0{top:0}.left-0{left:0}.bottom-0{bottom:0}.z-10{z-index:10}.z-\\[4\\]{z-index:4}.float-left{float:left}.-mt-1{margin-top:-.25rem}.-ml-1{margin-left:-.25rem}.block{display:block}.inline{display:inline}.flex{display:flex}.grid{display:grid}.contents{display:contents}.hidden{display:none}.h-screen{height:100vh}.h-\\[20px\\]{height:20px}.w-auto{width:auto}.w-screen{width:100vw}.min-w-max{min-width:max-content}.grow{flex-grow:1}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.resize{resize:both}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.overflow-auto{overflow:auto}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.whitespace-nowrap{white-space:nowrap}.bg-\\[\\#28292e\\],.bg-default-gray{--tw-bg-opacity: 1;background-color:rgb(40 41 46 / var(--tw-bg-opacity))}.pl-8{padding-left:2rem}.align-middle{vertical-align:middle}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.text-\\[11px\\]{font-size:11px}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.invert{--tw-invert: invert(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}*{--bs-br: 0px !important;scrollbar-width:none}*::-webkit-scrollbar{display:none}.tp-grlv_g{height:30px!important}.three-debug.visible{transform:translate(0)}.three-debug-nav{position:sticky;top:0;display:flex;overflow-x:auto;background-color:#28292e!important;z-index:1}.nav-button{width:auto!important;padding-right:6px!important;padding-left:6px!important}.selected{background:#bbb!important;color:#333!important}.noSelect,.pcui-label.pcui-selectable:hover{user-select:none}.font-icon,.pcui-treeview-item-icon:after,.pcui-treeview-item:not(.pcui-treeview-item-empty)>.pcui-treeview-item-contents:before{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-smoothing:antialiased;font-family:pc-icon}.fixedFont,.pcui-text-input>input{font-family:inconsolatamedium,Monaco,Menlo,Ubuntu Mono,Consolas,source-code-pro,monospace;font-weight:400}.pcui-container.pcui-resizable>.pcui-resizable-handle{position:absolute;z-index:1000;opacity:.5;background-color:transparent}.pcui-container.pcui-resizable>*{overflow:auto;max-height:100%}.pcui-container.pcui-resizable>.pcui-resizable-handle:hover{opacity:1}.pcui-container.pcui-resizable.pcui-resizable-resizing>.pcui-resizable-handle{opacity:1}.pcui-container.pcui-resizable.pcui-resizable-left>.pcui-resizable-handle,.pcui-container.pcui-resizable.pcui-resizable-right>.pcui-resizable-handle{top:0;bottom:0;width:1px;height:auto;cursor:ew-resize}.pcui-container.pcui-resizable.pcui-resizable-left>.pcui-resizable-handle{left:0;border-left:3px solid #202020}.pcui-container.pcui-resizable.pcui-resizable-right>.pcui-resizable-handle{right:0;border-right:3px solid #202020}.pcui-container.pcui-resizable.pcui-resizable-top>.pcui-resizable-handle,.pcui-container.pcui-resizable.pcui-resizable-bottom>.pcui-resizable-handle{left:0;right:0;width:auto;height:1px;cursor:ns-resize}.pcui-container.pcui-resizable.pcui-resizable-top>.pcui-resizable-handle{top:0;border-top:3px solid #202020}.pcui-container.pcui-resizable.pcui-resizable-bottom>.pcui-resizable-handle{bottom:0;border-bottom:3px solid #202020}.pcui-container-dragged{outline:2px solid #fff;box-sizing:border-box;opacity:.7;z-index:1}.pcui-container-dragged-child{outline:1px dotted #f60;box-sizing:border-box}@keyframes pcui-flash-animation{0%{outline-color:#f60}to{outline-color:#f600}}.pcui-element{border:0 solid #aaa}.pcui-element.flash{outline:1px solid #f60;-webkit-animation:pcui-flash-animation .2s ease-in-out forwards;animation:pcui-flash-animation .2s ease-in-out forwards}.pcui-element:focus{outline:none}.pcui-element::-moz-focus-inner{border:0}.pcui-label{display:inline-block;box-sizing:border-box;margin:6px;vertical-align:middle;transition:opacity .1s;color:#aaa;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;user-select:none}.pcui-label.pcui-default-mousedown{user-select:initial}.pcui-label.pcui-error{color:#d34141}.pcui-label.pcui-selectable:hover{color:#f60;text-decoration:underline}.pcui-label[placeholder]{position:relative}.pcui-label[placeholder]:after{content:attr(placeholder);position:absolute;top:0;right:0;padding:0 8px;color:#999;pointer-events:none}.pcui-text-input{border-radius:2px;min-height:24px;height:24px;background-color:#282828;vertical-align:top;transition:color .1s,background-color .1s,box-shadow .1s;position:relative;color:#aaa}.pcui-text-input>input{height:100%;width:calc(100% - 16px);padding:0 6px;line-height:1;color:inherit;background:transparent;border:none;outline:none;box-shadow:none}.pcui-text-input:before{color:inherit}.pcui-text-input:not(.pcui-disabled):not(.pcui-readonly):hover{background-color:#202020;color:#fff}.pcui-text-input:not(.pcui-disabled):not(.pcui-readonly):not(.pcui-error):hover{box-shadow:0 0 2px 1px #ff66004d}.pcui-text-input:not(.pcui-disabled):not(.pcui-readonly).pcui-focus{background-color:#202020;box-shadow:0 0 0 1px #ff66004d}.pcui-text-input.pcui-focus:after,.pcui-text-input:hover:after,.pcui-text-input.pcui-focus:before,.pcui-text-input:hover:before{display:none}.pcui-text-input.pcui-readonly{background-color:#282828b3;border-color:transparent}.pcui-text-input.pcui-disabled{color:#aaaaaa80}.pcui-text-input.pcui-error{color:#aaa;box-shadow:0 0 0 1px #d34141}.pcui-text-input[placeholder]{position:relative}.pcui-text-input[placeholder]:after{content:attr(placeholder);background-color:#282828;position:absolute;top:0;right:0;padding:0 8px;line-height:22px;font-size:10px;font-weight:600;white-space:nowrap;color:#829193;pointer-events:none}.pcui-treeview-item{position:relative;padding-left:24px;height:max-content;min-width:max-content}.pcui-treeview-item:before{content:"\\a0";position:absolute;background-color:#2e2e2e;width:2px;left:14px;top:-12px;bottom:12px}.pcui-treeview-item:last-child:before{height:25px;bottom:auto}.pcui-treeview-item.pcui-disabled>.pcui-treeview-item-contents>.pcui-treeview-item-text{opacity:.4}.pcui-treeview-item-contents{position:relative;color:#aaa;margin-left:3px;border:1px solid transparent;align-items:center;height:24px;box-sizing:border-box}.pcui-treeview-item-contents:hover{cursor:pointer;color:#fff;background-color:#282828}.pcui-treeview-item-contents:hover>.pcui-treeview-item-icon{color:#fff}.pcui-treeview-item-icon{color:#aaaaaa80;margin:0 2px 0 0;flex-shrink:0}.pcui-treeview-item-icon:before{content:"\\a0";position:absolute;background-color:#2e2e2e;left:-12px;top:10px;width:24px;height:2px}.pcui-treeview-item-icon:after{content:attr(data-icon);display:inline-block;vertical-align:sub;width:22px;height:22px;position:relative;z-index:1;text-align:center}.pcui-treeview-item-text{margin:0;flex-shrink:0;position:relative;z-index:1;transition:opacity .1s;padding-right:8px;color:inherit}.pcui-treeview-item-contents.pcui-treeview-item-selected{background-color:#202020;color:#fff}.pcui-treeview-item-contents.pcui-treeview-item-selected>.pcui-treeview-item-icon{color:#fff}.pcui-treeview-item:not(.pcui-treeview-item-empty)>.pcui-treeview-item-contents:before{content:"+";position:absolute;font-size:10px;font-weight:700;text-align:center;color:#aaa;background-color:#4f4f5c;top:-1px;left:-23px;width:14px;height:14px;line-height:14px;margin:3px;cursor:pointer;z-index:1}.pcui-treeview-item:not(.pcui-treeview-item-empty).pcui-treeview-item-open>.pcui-treeview-item-contents:before{content:"\\2212"}.pcui-treeview>.pcui-treeview-item{padding-left:0}.pcui-treeview>.pcui-treeview-item:before{content:none}.pcui-treeview>.pcui-treeview-item>.pcui-treeview-item-contents{margin-left:0}.pcui-treeview>.pcui-treeview-item>.pcui-treeview-item-contents>.pcui-treeview-item-icon:before{content:none}.pcui-treeview>.pcui-treeview-item>.pcui-treeview-item-contents>.pcui-treeview-item-icon:after{margin-left:0}.pcui-treeview>.pcui-treeview-item>.pcui-treeview-item{padding-left:21px}.pcui-treeview>.pcui-treeview-item>.pcui-treeview-item:before{left:11px}.pcui-treeview:not(.pcui-treeview-filtering)>.pcui-treeview-item .pcui-treeview-item:not(.pcui-treeview-item-open):not(.pcui-treeview-item-empty)>.pcui-treeview-item{display:none}.pcui-treeview-item-dragged>.pcui-treeview-item-contents{background-color:#28282880;color:#fff}.pcui-treeview-drag-handle{pointer-events:none;position:fixed;z-index:4;margin-top:-1px;margin-left:-1px}.pcui-treeview-drag-handle.before{margin-top:-2px;border-top:4px solid rgba(255,255,255,.5);padding-right:8px}.pcui-treeview-drag-handle.inside{border:4px solid rgba(255,255,255,.5)}.pcui-treeview-drag-handle.after{margin-top:2px;border-bottom:4px solid rgba(255,255,255,.5);padding-right:8px}.pcui-treeview-item-contents:after{content:" ";display:block;clear:both}.pcui-treeview-item.pcui-treeview-item-rename>.pcui-treeview-item-contents>.pcui-treeview-item-text{display:none}.pcui-treeview-item.pcui-treeview-item-rename>.pcui-treeview-item-contents>.pcui-text-input{margin:0;flex-grow:1;box-shadow:none!important;border:0;background-color:transparent}.pcui-treeview-item.pcui-treeview-item-rename>.pcui-treeview-item-contents>.pcui-text-input>input{font-family:inherit;font-size:14px;padding:0}.pcui-treeview.pcui-treeview-filtering .pcui-treeview-item{padding-left:0}.pcui-treeview.pcui-treeview-filtering .pcui-treeview-item:before{display:none}.pcui-treeview.pcui-treeview-filtering .pcui-treeview-item:not(.pcui-treeview-filtering-result)>.pcui-treeview-item-contents{display:none}.pcui-treeview.pcui-treeview-filtering .pcui-treeview-item-contents{margin-left:0}.pcui-treeview-filtering-result .pcui-treeview-item-contents:before,.pcui-treeview-filtering-result .pcui-treeview-item-icon:before{display:none}\n',document.head.append(Li);const Vi=new class{constructor(t,e,i,n,s){ft(this,"disposers",[]),ft(this,"addPane"),Nt=t;const{disposers:o,addPane:r}=Mi(e,n,s);this.addPane=r,this.disposers.push(...o),this.disposers.push((t=>{const e=Ft();return _i.axes=new e.AxesHelper(1e3),_i.axes.name="Axes helper",_i.axes.userData.threeDebugOmit=!0,_i.grid=new e.GridHelper(Ci.gridSize,Ci.gridDivisions),_i.grid.name="Grid helper",_i.grid.userData.threeDebugOmit=!0,xi&&t.add(_i.grid),yi&&t.add(_i.axes),()=>{t.remove(_i.grid,_i.axes)}})(e)),Xt(i,n,Dt.getNumber("controls")??Wt.NONE),Gt=requestAnimationFrame(Qt)}registerPlugin(t){this.disposers.push(t(this))}dispose(){cancelAnimationFrame(Gt);for(let t=this.disposers.length-1;t>-1;t-=1)this.disposers[t]();this.disposers.slice(0,this.disposers.length)}}(Et,Pt,Mt,Lt,Vt);export{Vi as d};
