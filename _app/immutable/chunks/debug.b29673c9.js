var t=Object.defineProperty,e=(e,n,i)=>(((e,n,i)=>{n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i})(e,"symbol"!=typeof n?n+"":n,i),i);import{M as n,C as i,V as s,B as o,A as r,F as a,T as l,a as h,L as d,b as c,S as p,P as u,D as v,c as m,d as g,e as b,f as _,I as f,O as w,g as x,h as y,i as C,j as E,k as P,R as k,l as A,m as L,n as M,o as I,p as T,q as z,r as S,t as V,u as R,v as D,w as N,x as O,y as j,z as F,G as B,E as H,H as K,J as U,K as $,N as G,Q as q,U as Y,W as X,X as W,Y as Z,Z as Q,_ as J,$ as tt,a0 as et,a1 as nt,a2 as it,a3 as st,a4 as ot,a5 as rt,a6 as at,a7 as lt,a8 as ht,a9 as dt,aa as ct,ab as pt,ac as ut,ad as vt,ae as mt,af as gt,ag as bt,ah as _t,ai as ft,aj as wt,ak as xt,al as yt,am as Ct,an as Et,ao as Pt,ap as kt,aq as At,ar as Lt,as as Mt,at as It,au as Tt,av as zt,aw as St,ax as Vt,ay as Rt,az as Dt,aA as Nt,aB as Ot,aC as jt,aD as Ft,aE as Bt,aF as Ht,aG as Kt,aH as Ut,aI as $t,aJ as Gt,aK as qt,aL as Yt,aM as Xt,aN as Wt,aO as Zt,aP as Qt,aQ as Jt,aR as te,aS as ee,aT as ne,aU as ie,aV as se,aW as oe,aX as re,aY as ae,aZ as le,a_ as he,a$ as de,b0 as ce,b1 as pe,b2 as ue,b3 as ve,b4 as me,b5 as ge,b6 as be}from"./trzy.7fd33118.js";function _e(t,e){for(var n=0;n<e.length;n++){const i=e[n];if("string"!=typeof i&&!Array.isArray(i))for(const e in i)if("default"!==e&&!(e in t)){const n=Object.getOwnPropertyDescriptor(i,e);n&&Object.defineProperty(t,e,n.get?n:{enumerable:!0,get:()=>i[e]})}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"&&self;function fe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var we={exports:{}};
/*! Tweakpane 3.1.9 (c) 2016 cocopon, licensed under the MIT license. */!function(t){class e{constructor(t){const[e,n]=t.split("-"),i=e.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=n??null}toString(){const t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}class n{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class i{constructor(t){this.target=t}}class s extends i{constructor(t,e,n,i){super(t),this.value=e,this.presetKey=n,this.last=i??!0}}class o extends i{constructor(t,e,n){super(t),this.value=e,this.presetKey=n}}class r extends i{constructor(t,e){super(t),this.expanded=e}}class a extends i{constructor(t,e){super(t),this.index=e}}function l(t){return null==t}function h(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function d(t,e){let n=t;do{const t=Object.getOwnPropertyDescriptor(n,e);if(t&&(void 0!==t.set||!0===t.writable))return!0;n=Object.getPrototypeOf(n)}while(null!==n);return!1}const c={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class p{static alreadyDisposed(){return new p({type:"alreadydisposed"})}static notBindable(){return new p({type:"notbindable"})}static propertyNotFound(t){return new p({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new p({type:"shouldneverhappen"})}constructor(t){var e;this.message=null!==(e=c[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}}class u{constructor(t,e,n){this.obj_=t,this.key_=e,this.presetKey_=n??e}static isBindable(t){return!(null===t||"object"!=typeof t&&"function"!=typeof t)}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const n=this.read();if(!u.isBindable(n))throw p.notBindable();if(!(t in n))throw p.propertyNotFound(t);n[t]=e}}class v extends n{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const n=e.bind(this);return this.controller_.valueController.emitter.on(t,(()=>{n(new i(this))})),this}}class m{constructor(){this.observers_={}}on(t,e){let n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}off(t,e){const n=this.observers_[t];return n&&(this.observers_[t]=n.filter((t=>t.handler!==e))),this}emit(t,e){const n=this.observers_[t];n&&n.forEach((t=>{t.handler(e)}))}}const g="tp";function b(t){return(e,n)=>[g,"-",t,"v",e?`_${e}`:"",n?`-${n}`:""].join("")}function _(t,e){return n=>e(t(n))}function f(t){return t.rawValue}function w(t,e){t.emitter.on("change",_(f,e)),e(t.rawValue)}function x(t,e,n){w(t.value(e),n)}function y(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function C(t,e){return n=>{y(t,e,n)}}function E(t,e){w(t,(t=>{e.textContent=t??""}))}const P=b("btn");class k{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(P()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("button");n.classList.add(P("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(P("t")),E(e.props.value("title"),i),this.buttonElement.appendChild(i)}}class A{constructor(t,e){this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new k(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class L{constructor(t,e){var n;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(n=null==e?void 0:e.equals)&&void 0!==n?n:(t,e)=>t===e,this.emitter=new m,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=e??{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t,s=this.rawValue_;this.equals_(s,i)&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:i,sender:this}))}}class M{constructor(t){this.emitter=new m,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=e??{forceEmit:!1,last:!0},i=this.value_;i===t&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,previousRawValue:i,rawValue:this.value_,sender:this}))}}function I(t,e){const n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new L(t,e):new M(t)}class T{constructor(t){this.emitter=new m,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,n)=>Object.assign(e,{[n]:I(t[n])})),{})}static fromObject(t){const e=this.createCore(t);return new T(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function z(t,e){return Object.keys(e).reduce(((n,i)=>{if(void 0===n)return;const s=(0,e[i])(t[i]);return s.succeeded?Object.assign(Object.assign({},n),{[i]:s.value}):void 0}),{})}function S(t,e){return t.reduce(((t,n)=>{if(void 0===t)return;const i=e(n);return i.succeeded&&void 0!==i.value?[...t,i.value]:void 0}),[])}function V(t){return null!==t&&"object"==typeof t}function R(t){return e=>n=>{if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};const i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function D(t){return{custom:e=>R(e)(t),boolean:R((t=>"boolean"==typeof t?t:void 0))(t),number:R((t=>"number"==typeof t?t:void 0))(t),string:R((t=>"string"==typeof t?t:void 0))(t),function:R((t=>"function"==typeof t?t:void 0))(t),constant:e=>R((t=>t===e?e:void 0))(t),raw:R((t=>t))(t),object:e=>R((t=>{if(V(t))return z(t,e)}))(t),array:e=>R((t=>{if(Array.isArray(t))return S(t,e)}))(t)}}const N={optional:D(!0),required:D(!1)};function O(t,e){const n=N.required.object(e)(t);return n.succeeded?n.value:void 0}function j(t){console.warn([`Missing '${t.key}' of ${t.target} in ${t.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function F(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}class B{constructor(t){this.value_=t}static create(t){return[new B(t),(e,n)=>{t.setRawValue(e,n)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const H=b("");function K(t,e){return C(t,H(void 0,e))}class U extends T{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=B.create(I(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,n,i;const s=t??{};return new U(T.createCore({disabled:null!==(e=s.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(n=s.hidden)&&void 0!==n&&n,parent:null!==(i=s.parent)&&void 0!==i?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){w(this.globalDisabled_,K(t,"disabled")),x(this,"hidden",K(t,"hidden"))}bindDisabled(t){w(this.globalDisabled_,(e=>{t.disabled=e}))}bindTabIndex(t){w(this.globalDisabled_,(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}getGlobalDisabled_(){const t=this.get("parent");return!!t&&t.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const n=t.previousRawValue;null==n||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function $(){return["veryfirst","first","last","verylast"]}const G=b(""),q={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class Y{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{$().forEach((t=>{e.classList.remove(G(void 0,q[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(G(void 0,q[t]))}))})),this.viewProps.handleDispose((()=>{F(e)}))}get parent(){return this.parent_}set parent(t){this.parent_=t,"parent"in this.viewProps.valMap_?this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null):j({key:"parent",target:U.name,place:"BladeController.parent"})}}const X="http://www.w3.org/2000/svg";function W(t){t.offsetHeight}function Z(t,e){const n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function Q(t){return void 0!==t.ontouchstart}function J(){return globalThis}function tt(){return J().document}function et(t){const e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d",{willReadFrequently:!0}):null}const nt={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function it(t,e){const n=t.createElementNS(X,"svg");return n.innerHTML=nt[e],n}function st(t,e,n){t.insertBefore(e,t.children[n])}function ot(t){t.parentElement&&t.parentElement.removeChild(t)}function rt(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function at(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function lt(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const ht=b("lbl");function dt(t,e){const n=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,i)=>{i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}class ct{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ht()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(ht("l")),x(e.props,"label",(e=>{l(e)?this.element.classList.add(ht(void 0,"nol")):(this.element.classList.remove(ht(void 0,"nol")),at(n),n.appendChild(dt(t,e)))})),this.element.appendChild(n),this.labelElement=n;const i=t.createElement("div");i.classList.add(ht("v")),this.element.appendChild(i),this.valueElement=i}}class pt extends Y{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new ct(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const ut={id:"button",type:"blade",accept(t){const e=N,n=O(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return n?{params:n}:null},controller:t=>new pt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:new A(t.document,{props:T.fromObject({title:t.params.title}),viewProps:t.viewProps})}),api:t=>t.controller instanceof pt&&t.controller.valueController instanceof A?new v(t.controller):null};class vt extends Y{constructor(t){super(t),this.value=t.value}}function mt(){return new T({positions:I([],{equals:h})})}class gt extends T{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=T.createCore(e);return new gt(n)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!l(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const n=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};x(this,"expanded",n),x(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function bt(t,e){let n=0;return Z(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),W(e),n=e.clientHeight,t.set("temporaryExpanded",null),W(e)})),n}function _t(t,e){e.style.height=t.styleHeight}function ft(t,e){t.value("expanded").emitter.on("beforechange",(()=>{if(t.set("completed",!1),l(t.get("expandedHeight"))){const n=bt(t,e);n>0&&t.set("expandedHeight",n)}t.set("shouldFixHeight",!0),W(e)})),t.emitter.on("change",(()=>{_t(t,e)})),_t(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&t.cleanUpTransition()}))}class wt extends n{constructor(t,e){super(t),this.rackApi_=e}}function xt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function yt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function Ct(t,e){const n=e??{};return t.addBlade(Object.assign(Object.assign({},n),{view:"separator"}))}function Et(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}class Pt{constructor(t){this.emitter=new m,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw p.shouldNeverHappen();const n=void 0!==e?e:this.items_.length;this.items_.splice(n,0,t),this.cache_.add(t);const i=this.extract_(t);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((t=>{this.cache_.add(t)}))),this.emitter.emit("add",{index:n,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const n=this.extract_(t);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}class kt extends n{constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new m,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new s(this,e,this.controller_.binding.target.presetKey,t.options.last)})}}class At extends pt{constructor(t,e){super(t,e),this.binding=e.binding}}class Lt extends n{constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new m,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new o(this,e,this.controller_.binding.target.presetKey)})}}class Mt extends pt{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function It(t){return t instanceof St?t.apiSet_:t instanceof wt?t.rackApi_.apiSet_:null}function Tt(t,e){const n=t.find((t=>t.controller_===e));if(!n)throw p.shouldNeverHappen();return n}function zt(t,e,n){if(!u.isBindable(t))throw p.notBindable();return new u(t,e,n)}class St extends n{constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new m,this.apiSet_=new Pt(It),this.pool_=e;const n=this.controller_.rack;n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),n.emitter.on("inputchange",this.onRackInputChange_),n.emitter.on("monitorupdate",this.onRackMonitorUpdate_),n.children.forEach((t=>{this.setUpApi_(t)}))}get children(){return this.controller_.rack.children.map((t=>Tt(this.apiSet_,t)))}addInput(t,e,n){const i=n??{},s=this.controller_.view.element.ownerDocument,o=this.pool_.createInput(s,zt(t,e,i.presetKey),i),r=new kt(o);return this.add(r,i.index)}addMonitor(t,e,n){const i=n??{},s=this.controller_.view.element.ownerDocument,o=this.pool_.createMonitor(s,zt(t,e),i),r=new Lt(o);return this.add(r,i.index)}addFolder(t){return yt(this,t)}addButton(t){return xt(this,t)}addSeparator(t){return Ct(this,t)}addTab(t){return Et(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const n=this.apiSet_.find((e=>e.controller_===t.controller_));return n&&this.apiSet_.remove(n),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,n=this.pool_.createBlade(e,t),i=this.pool_.createBladeApi(n);return this.add(i,t.index)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpApi_(t){this.apiSet_.find((e=>e.controller_===t))||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=Tt(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof At){const n=Tt(this.apiSet_,e),i=e.binding;this.emitter_.emit("change",{event:new s(n,i.target.read(),i.target.presetKey,t.options.last)})}else if(e instanceof vt){const n=Tt(this.apiSet_,e);this.emitter_.emit("change",{event:new s(n,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof Mt))throw p.shouldNeverHappen();const e=Tt(this.apiSet_,t.bladeController),n=t.bladeController.binding;this.emitter_.emit("update",{event:new o(e,n.target.read(),n.target.presetKey)})}}class Vt extends wt{constructor(t,e){super(t,new St(t.rackController,e)),this.emitter_=new m,this.controller_.foldable.value("expanded").emitter.on("change",(t=>{this.emitter_.emit("fold",{event:new r(this,t.sender.rawValue)})})),this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})}))}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class Rt extends Y{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class Dt{constructor(t,e){const n=b(e.viewName);this.element=t.createElement("div"),this.element.classList.add(n()),e.viewProps.bindClassModifiers(this.element)}}function Nt(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof At&&i.binding===e)return i}return null}function Ot(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof Mt&&i.binding===e)return i}return null}function jt(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof vt&&i.value===e)return i}return null}function Ft(t){return t instanceof Kt?t.rack:t instanceof Rt?t.rackController.rack:null}function Bt(t){const e=Ft(t);return e?e.bcSet_:null}class Ht{constructor(t){var e,n;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new m,this.blade_=null!==(e=t.blade)&&void 0!==e?e:null,null===(n=this.blade_)||void 0===n||n.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=t.viewProps,this.bcSet_=new Pt(Bt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){var n;null===(n=t.parent)||void 0===n||n.remove(t),d(t,"parent")?t.parent=this:(t.parent_=this,j({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(t,e)}remove(t){d(t,"parent")?t.parent=null:(t.parent_=null,j({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter((e=>e instanceof t))}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const n=t.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),n instanceof At)n.binding.emitter.on("change",this.onChildInputChange_);else if(n instanceof Mt)n.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(n instanceof vt)n.value.emitter.on("change",this.onChildValueChange_);else{const t=Ft(n);if(t){const e=t.emitter;e.on("layout",this.onDescendantLayout_),e.on("inputchange",this.onDescendantInputChange_),e.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const n=t.item;if(n instanceof At)n.binding.emitter.off("change",this.onChildInputChange_);else if(n instanceof Mt)n.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(n instanceof vt)n.value.emitter.off("change",this.onChildValueChange_);else{const t=Ft(n);if(t){const e=t.emitter;e.off("layout",this.onDescendantLayout_),e.off("inputchange",this.onDescendantInputChange_),e.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter((t=>!t.viewProps.get("hidden"))),e=t[0],n=t[t.length-1];this.bcSet_.items.forEach((t=>{const i=[];t===e&&(i.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&i.push("veryfirst")),t===n&&(i.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&i.push("verylast")),t.blade.set("positions",i)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((t=>t.viewProps.get("disposed"))).forEach((t=>{this.bcSet_.remove(t)}))}onChildInputChange_(t){const e=Nt(this.find(At),t.sender);if(!e)throw p.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=Ot(this.find(Mt),t.sender);if(!e)throw p.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=jt(this.find(vt),t.sender);if(!e)throw p.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Kt extends Y{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Dt(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const n=new Ht({blade:e.root?void 0:e.blade,viewProps:e.viewProps});n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),this.rack=n,this.viewProps.handleDispose((()=>{for(let t=this.rack.children.length-1;t>=0;t--)this.rack.children[t].viewProps.set("disposed",!0)}))}onRackAdd_(t){t.isRoot&&st(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.isRoot&&ot(t.bladeController.view.element)}}const Ut=b("cnt");class $t{constructor(t,e){var n;this.className_=b(null!==(n=e.viewName)&&void 0!==n?n:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),Ut()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),x(this.foldable_,"completed",C(this.element,this.className_(void 0,"cpl")));const i=t.createElement("button");i.classList.add(this.className_("b")),x(e.props,"title",(t=>{l(t)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=t.createElement("div");s.classList.add(this.className_("i")),this.element.appendChild(s);const o=t.createElement("div");o.classList.add(this.className_("t")),E(e.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const r=t.createElement("div");r.classList.add(this.className_("m")),this.buttonElement.appendChild(r);const a=e.containerElement;a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}}class Gt extends Rt{constructor(t,e){var n;const i=gt.create(null===(n=e.expanded)||void 0===n||n),s=new Kt(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:s,view:new $t(t,{containerElement:s.view.element,foldable:i,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=i,ft(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const qt={id:"folder",type:"blade",accept(t){const e=N,n=O(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return n?{params:n}:null},controller:t=>new Gt(t.document,{blade:t.blade,expanded:t.params.expanded,props:T.fromObject({title:t.params.title}),viewProps:t.viewProps}),api:t=>t.controller instanceof Gt?new Vt(t.controller,t.pool):null};class Yt extends vt{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new ct(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Xt extends n{}const Wt=b("spr");class Zt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Wt()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("hr");n.classList.add(Wt("r")),this.element.appendChild(n)}}class Qt extends Y{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Zt(t,{viewProps:e.viewProps})}))}}const Jt={id:"separator",type:"blade",accept(t){const e=O(t,{view:N.required.constant("separator")});return e?{params:e}:null},controller:t=>new Qt(t.document,{blade:t.blade,viewProps:t.viewProps}),api:t=>t.controller instanceof Qt?new Xt(t.controller):null},te=b("tbi");class ee{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(te()),e.viewProps.bindClassModifiers(this.element),x(e.props,"selected",(t=>{t?this.element.classList.add(te(void 0,"sel")):this.element.classList.remove(te(void 0,"sel"))}));const n=t.createElement("button");n.classList.add(te("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(te("t")),E(e.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class ne{constructor(t,e){this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new ee(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ie{constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new ne(t,{props:e.itemProps,viewProps:U.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Kt(t,{blade:mt(),viewProps:U.create()}),this.props=e.props,x(this.props,"selected",(t=>{this.itemController.props.set("selected",t),this.contentController.viewProps.set("hidden",!t)}))}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class se{constructor(t,e){this.controller_=t,this.rackApi_=e}get title(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addBlade(t){return this.rackApi_.addBlade(t)}}class oe extends wt{constructor(t,e){super(t,new St(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new m,this.pageApiMap_=new Map,this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})})),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((t=>{this.setUpPageApi_(t)}))}get pages(){return this.controller_.pageSet.items.map((t=>{const e=this.pageApiMap_.get(t);if(!e)throw p.shouldNeverHappen();return e}))}addPage(t){const e=this.controller_.view.element.ownerDocument,n=new ie(e,{itemProps:T.fromObject({selected:!1,title:t.title}),props:T.fromObject({selected:!1})});this.controller_.add(n,t.index);const i=this.pageApiMap_.get(n);if(!i)throw p.shouldNeverHappen();return i}removePage(t){this.controller_.remove(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find((e=>e.controller_===t.contentController));if(!e)throw p.shouldNeverHappen();const n=new se(t,e);this.pageApiMap_.set(t,n)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw p.shouldNeverHappen();this.pageApiMap_.delete(t.item)}onSelect_(t){this.emitter_.emit("select",{event:new a(this,t.rawValue)})}}const re=-1;class ae{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=I(!0),this.selectedIndex=I(re),this.items_=[]}add(t,e){const n=e??this.items_.length;this.items_.splice(n,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=re,void(this.empty.rawValue=!0);const t=this.items_.findIndex((t=>t.rawValue));t<0?(this.items_.forEach(((t,e)=>{t.rawValue=0===e})),this.selectedIndex.rawValue=0):(this.items_.forEach(((e,n)=>{e.rawValue=n===t})),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex((e=>e===t.sender));this.items_.forEach(((t,n)=>{t.rawValue=n===e})),this.selectedIndex.rawValue=e}else this.keepSelection_()}}const le=b("tab");class he{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(le(),Ut()),e.viewProps.bindClassModifiers(this.element),w(e.empty,C(this.element,le(void 0,"nop")));const n=t.createElement("div");n.classList.add(le("t")),this.element.appendChild(n),this.itemsElement=n;const i=t.createElement("div");i.classList.add(le("i")),this.element.appendChild(i);const s=e.contentsElement;s.classList.add(le("c")),this.element.appendChild(s),this.contentsElement=s}}class de extends Rt{constructor(t,e){const n=new Kt(t,{blade:e.blade,viewProps:e.viewProps}),i=new ae;super({blade:e.blade,rackController:n,view:new he(t,{contentsElement:n.view.element,empty:i.empty,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new Pt((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=i}get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,e)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}onPageAdd_(t){const e=t.item;st(this.view.itemsElement,e.itemController.view.element,t.index),e.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(e.contentController,t.index),this.tab.add(e.props.value("selected"))}onPageRemove_(t){const e=t.item;ot(e.itemController.view.element),e.itemController.viewProps.set("parent",null),this.rackController.rack.remove(e.contentController),this.tab.remove(e.props.value("selected"))}}const ce={id:"tab",type:"blade",accept(t){const e=N,n=O(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return n&&0!==n.pages.length?{params:n}:null},controller(t){const e=new de(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((n=>{const i=new ie(t.document,{itemProps:T.fromObject({selected:!1,title:n.title}),props:T.fromObject({selected:!1})});e.add(i)})),e},api:t=>t.controller instanceof de?new oe(t.controller,t.pool):null};function pe(t,e){const n=t.accept(e.params);if(!n)return null;const i=N.optional.boolean(e.params.disabled).value,s=N.optional.boolean(e.params.hidden).value;return t.controller({blade:mt(),document:e.document,params:Object.assign(Object.assign({},n.params),{disabled:i,hidden:s}),viewProps:U.create({disabled:i,hidden:s})})}class ue{constructor(){this.disabled=!1,this.emitter=new m}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class ve{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new m,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class me{constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new m,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}read(){const t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}function ge(t,e){for(;t.length<e;)t.push(void 0)}function be(t){const e=[];return ge(e,t),I(e)}function _e(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function fe(t,e){const n=[..._e(t),e];return n.length>t.length?n.splice(0,n.length-t.length):ge(n,t.length),n}class we{constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new m,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(void 0===t)return;const e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=fe(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}onTick_(t){this.read()}}class xe{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function ye(t,e){if(t instanceof e)return t;if(t instanceof xe){const n=t.constraints.reduce(((t,n)=>t||(n instanceof e?n:null)),null);if(n)return n}return null}class Ce{constructor(t){this.values=T.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(t,n),e)}}class Ee{constructor(t){this.values=T.fromObject({options:t})}get options(){return this.values.get("options")}constrain(t){const e=this.values.get("options");return 0===e.length||e.filter((e=>e.value===t)).length>0?t:e[0].value}}class Pe{constructor(t){this.values=T.fromObject({max:t.max,min:t.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(t){const e=this.values.get("max"),n=this.values.get("min");let i=t;return l(n)||(i=Math.max(i,n)),l(e)||(i=Math.min(i,e)),i}}class ke{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}const Ae=b("lst");class Le{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(Ae()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("select");n.classList.add(Ae("s")),x(this.props_,"options",(e=>{rt(n),e.forEach(((e,i)=>{const s=t.createElement("option");s.dataset.index=String(i),s.textContent=e.text,s.value=String(e.value),n.appendChild(s)}))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const i=t.createElement("div");i.classList.add(Ae("m")),i.appendChild(it(t,"dropdown")),this.element.appendChild(i),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Me{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Le(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=t.currentTarget.selectedOptions.item(0);if(!e)return;const n=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[n].value}}const Ie=b("pop");class Te{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ie()),e.viewProps.bindClassModifiers(this.element),w(e.shows,C(this.element,Ie(void 0,"v")))}}class ze{constructor(t,e){this.shows=I(!1),this.viewProps=e.viewProps,this.view=new Te(t,{shows:this.shows,viewProps:this.viewProps})}}const Se=b("txt");class Ve{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Se()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const n=t.createElement("input");n.classList.add(Se("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class Re{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Ve(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,n=this.parser_(e);l(n)||(this.value.rawValue=n),this.view.refresh()}}function De(t){return String(t)}function Ne(t){return"false"!==t&&!!t}function Oe(t){return De(t)}class je{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const Fe={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class Be{constructor(t,e,n){this.left=e,this.operator=t,this.right=n}evaluate(){const t=Fe[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const He={"+":t=>t,"-":t=>-t,"~":t=>~t};class Ke{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=He[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Ue(t){return(e,n)=>{for(let i=0;i<t.length;i++){const s=t[i](e,n);if(""!==s)return s}return""}}function $e(t,e){var n;const i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ge(t,e){const n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function qe(t,e){var n;const i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ye(t,e){const n=qe(t,e);if(""!==n)return n;const i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";const s=qe(t,e+=1);return""===s?"":i+s}function Xe(t,e){const n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";const i=Ye(t,e);return""===i?"":n+i}function We(t,e){const n=t.substr(e,1);if("0"===n)return n;const i=Ge(t,e);return e+=i.length,""===i?"":i+qe(t,e)}function Ze(t,e){const n=We(t,e);if(e+=n.length,""===n)return"";const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const s=qe(t,e);return n+i+s+Xe(t,e+=s.length)}function Qe(t,e){const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const i=qe(t,e);return e+=i.length,""===i?"":n+i+Xe(t,e)}function Je(t,e){const n=We(t,e);return e+=n.length,""===n?"":n+Xe(t,e)}const tn=Ue([Ze,Qe,Je]);function en(t,e){var n;const i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function nn(t,e){const n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";const i=en(t,e);return""===i?"":n+i}function sn(t,e){var n;const i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function on(t,e){const n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";const i=sn(t,e);return""===i?"":n+i}function rn(t,e){var n;const i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}function an(t,e){const n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";const i=rn(t,e);return""===i?"":n+i}const ln=Ue([nn,on,an]),hn=Ue([ln,tn]);function dn(t,e){const n=hn(t,e);return e+=n.length,""===n?null:{evaluable:new je(n),cursor:e}}function cn(t,e){const n=t.substr(e,1);if(e+=n.length,"("!==n)return null;const i=bn(t,e);if(!i)return null;e=i.cursor,e+=$e(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:i.evaluable,cursor:e}}function pn(t,e){var n;return null!==(n=dn(t,e))&&void 0!==n?n:cn(t,e)}function un(t,e){const n=pn(t,e);if(n)return n;const i=t.substr(e,1);if(e+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;const s=un(t,e);return s?{cursor:e=s.cursor,evaluable:new Ke(i,s.evaluable)}:null}function vn(t,e,n){n+=$e(e,n).length;const i=t.filter((t=>e.startsWith(t,n)))[0];return i?(n+=i.length,{cursor:n+=$e(e,n).length,operator:i}):null}function mn(t,e){return(n,i)=>{const s=t(n,i);if(!s)return null;i=s.cursor;let o=s.evaluable;for(;;){const s=vn(e,n,i);if(!s)break;i=s.cursor;const r=t(n,i);if(!r)return null;i=r.cursor,o=new Be(s.operator,o,r.evaluable)}return o?{cursor:i,evaluable:o}:null}}const gn=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>mn(t,e)),un);function bn(t,e){return e+=$e(t,e).length,gn(t,e)}function _n(t){const e=bn(t,0);return e&&e.cursor+$e(t,e.cursor).length===t.length?e.evaluable:null}function fn(t){var e;const n=_n(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function wn(t){if("number"==typeof t)return t;if("string"==typeof t){const e=fn(t);if(!l(e))return e}return 0}function xn(t){return String(t)}function yn(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}const Cn=yn(0);function En(t){return Cn(t)+"%"}function Pn(t){return String(t)}function kn(t){return t}function An({primary:t,secondary:e,forward:n,backward:i}){let s=!1;function o(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(i=>{o((()=>{e.setRawValue(n(t,e),i.options)}))})),e.emitter.on("change",(s=>{o((()=>{t.setRawValue(i(t,e),s.options)})),o((()=>{e.setRawValue(n(t,e),s.options)}))})),o((()=>{e.setRawValue(n(t,e),{forceEmit:!1,last:!0})}))}function Ln(t,e){const n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function Mn(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function In(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Tn(t){return"ArrowUp"===t||"ArrowDown"===t}function zn(t){return Tn(t)||"ArrowLeft"===t||"ArrowRight"===t}function Sn(t,e){var n,i;const s=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:t.pageX-((null!==(n=s&&s.scrollX)&&void 0!==n?n:0)+o.left),y:t.pageY-((null!==(i=s&&s.scrollY)&&void 0!==i?i:0)+o.top)}}class Vn{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new m,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Sn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Sn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Sn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Rn(t,e,n,i,s){return i+(t-e)/(n-e)*(s-i)}function Dn(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Nn(t,e,n){return Math.min(Math.max(t,e),n)}function On(t,e){return(t%e+e)%e}const jn=b("txt");class Fn{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(jn(),jn(void 0,"num")),e.arrayPosition&&this.element.classList.add(jn(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(jn("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(jn()),this.inputElement.classList.add(jn("i"));const i=t.createElement("div");i.classList.add(jn("k")),this.element.appendChild(i),this.knobElement=i;const s=t.createElementNS(X,"svg");s.classList.add(jn("g")),this.knobElement.appendChild(s);const o=t.createElementNS(X,"path");o.classList.add(jn("gb")),s.appendChild(o),this.guideBodyElem_=o;const r=t.createElementNS(X,"path");r.classList.add(jn("gh")),s.appendChild(r),this.guideHeadElem_=r;const a=t.createElement("div");a.classList.add(b("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(jn(void 0,"drg"));this.element.classList.add(jn(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=Nn(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Bn{constructor(t,e){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=null!==(n=e.sliderProps)&&void 0!==n?n:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=I(null),this.view=new Fn(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Vn(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,n;const i=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("minValue"),s=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("maxValue");let o=t;return void 0!==i&&(o=Math.max(o,i)),void 0!==s&&(o=Math.min(o,s)),o}onInputChange_(t){const e=t.currentTarget.value,n=this.parser_(e);l(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}onInputKeyDown_(t){const e=Ln(this.baseStep_,Mn(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==Ln(this.baseStep_,Mn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Hn=b("sld");class Kn{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Hn()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(Hn("t")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const i=t.createElement("div");i.classList.add(Hn("k")),this.trackElement.appendChild(i),this.knobElement=i,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=Nn(Rn(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}}class Un{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new Kn(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Vn(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(Rn(Nn(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Ln(this.baseStep_,In(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Ln(this.baseStep_,In(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const $n=b("sldtxt");class Gn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add($n());const n=t.createElement("div");n.classList.add($n("s")),this.sliderView_=e.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=t.createElement("div");i.classList.add($n("t")),this.textView_=e.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class qn{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new Un(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new Bn(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new Gn(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Yn(t,e){t.write(e)}function Xn(t){const e=N;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function Wn(t){if("inline"===t||"popup"===t)return t}function Zn(t){const e=N;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function Qn(t){if(Array.isArray(t))return t;const e=[];return Object.keys(t).forEach((n=>{e.push({text:n,value:t[n]})})),e}function Jn(t){return l(t)?null:new Ee(Qn(t))}function ti(t){const e=t?ye(t,ke):null;return e?e.step:null}function ei(t,e){const n=t&&ye(t,ke);return n?Dn(n.step):Math.max(Dn(e),2)}function ni(t){return ti(t)??1}function ii(t,e){var n;const i=t&&ye(t,ke),s=Math.abs(null!==(n=null==i?void 0:i.step)&&void 0!==n?n:e);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}const si=b("ckb");class oi{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(si()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("label");n.classList.add(si("l")),this.element.appendChild(n);const i=t.createElement("input");i.classList.add(si("i")),i.type="checkbox",n.appendChild(i),this.inputElement=i,e.viewProps.bindDisabled(this.inputElement);const s=t.createElement("div");s.classList.add(si("w")),n.appendChild(s);const o=it(t,"check");s.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class ri{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new oi(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked}}function ai(t){const e=[],n=Jn(t.options);return n&&e.push(n),new xe(e)}const li={id:"input-bool",type:"input",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=O(e,{options:N.optional.custom(Xn)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Ne,constraint:t=>ai(t.params),writer:t=>Yn},controller:t=>{const e=t.document,n=t.value,i=t.constraint,s=i&&ye(i,Ee);return s?new Me(e,{props:new T({options:s.values.value("options")}),value:n,viewProps:t.viewProps}):new ri(e,{value:n,viewProps:t.viewProps})}},hi=b("col");class di{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(hi()),e.foldable.bindExpandedClass(this.element,hi(void 0,"expanded")),x(e.foldable,"completed",C(this.element,hi(void 0,"cpl")));const n=t.createElement("div");n.classList.add(hi("h")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(hi("s")),n.appendChild(i),this.swatchElement=i;const s=t.createElement("div");if(s.classList.add(hi("t")),n.appendChild(s),this.textElement=s,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(hi("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}function ci(t,e,n){const i=Nn(t/255,0,1),s=Nn(e/255,0,1),o=Nn(n/255,0,1),r=Math.max(i,s,o),a=Math.min(i,s,o),l=r-a;let h=0,d=0;const c=(a+r)/2;return 0!==l&&(d=l/(1-Math.abs(r+a-1)),h=i===r?(s-o)/l:s===r?2+(o-i)/l:4+(i-s)/l,h=h/6+(h<0?1:0)),[360*h,100*d,100*c]}function pi(t,e,n){const i=(t%360+360)%360,s=Nn(e/100,0,1),o=Nn(n/100,0,1),r=(1-Math.abs(2*o-1))*s,a=r*(1-Math.abs(i/60%2-1)),l=o-r/2;let h,d,c;return[h,d,c]=i>=0&&i<60?[r,a,0]:i>=60&&i<120?[a,r,0]:i>=120&&i<180?[0,r,a]:i>=180&&i<240?[0,a,r]:i>=240&&i<300?[a,0,r]:[r,0,a],[255*(h+l),255*(d+l),255*(c+l)]}function ui(t,e,n){const i=Nn(t/255,0,1),s=Nn(e/255,0,1),o=Nn(n/255,0,1),r=Math.max(i,s,o),a=r-Math.min(i,s,o);let l;return l=0===a?0:r===i?((s-o)/a%6+6)%6*60:r===s?60*((o-i)/a+2):60*((i-s)/a+4),[l,100*(0===r?0:a/r),100*r]}function vi(t,e,n){const i=On(t,360),s=Nn(e/100,0,1),o=Nn(n/100,0,1),r=o*s,a=r*(1-Math.abs(i/60%2-1)),l=o-r;let h,d,c;return[h,d,c]=i>=0&&i<60?[r,a,0]:i>=60&&i<120?[a,r,0]:i>=120&&i<180?[0,r,a]:i>=180&&i<240?[0,a,r]:i>=240&&i<300?[a,0,r]:[r,0,a],[255*(h+l),255*(d+l),255*(c+l)]}function mi(t,e,n){const i=n+e*(100-Math.abs(2*n-100))/200;return[t,0!==i?e*(100-Math.abs(2*n-100))/i:0,n+e*(100-Math.abs(2*n-100))/200]}function gi(t,e,n){const i=100-Math.abs(n*(200-e)/100-100);return[t,0!==i?e*n/i:0,n*(200-e)/200]}function bi(t){return[t[0],t[1],t[2]]}function _i(t,e){return[t[0],t[1],t[2],e]}const fi={hsl:{hsl:(t,e,n)=>[t,e,n],hsv:mi,rgb:pi},hsv:{hsl:gi,hsv:(t,e,n)=>[t,e,n],rgb:vi},rgb:{hsl:ci,hsv:ui,rgb:(t,e,n)=>[t,e,n]}};function wi(t,e){return["float"===e?1:"rgb"===t?255:360,"float"===e?1:"rgb"===t?255:100,"float"===e?1:"rgb"===t?255:100]}function xi(t,e){return t===e?e:On(t,e)}function yi(t,e,n){var i;const s=wi(e,n);return["rgb"===e?Nn(t[0],0,s[0]):xi(t[0],s[0]),Nn(t[1],0,s[1]),Nn(t[2],0,s[2]),Nn(null!==(i=t[3])&&void 0!==i?i:1,0,1)]}function Ci(t,e,n,i){const s=wi(e,n),o=wi(e,i);return t.map(((t,e)=>t/s[e]*o[e]))}function Ei(t,e,n){const i=Ci(t,e.mode,e.type,"int");return Ci(fi[e.mode][n.mode](...i),n.mode,"int",n.type)}function Pi(t,e){return"object"==typeof t&&!l(t)&&e in t&&"number"==typeof t[e]}class ki{static black(t="int"){return new ki([0,0,0],"rgb",t)}static fromObject(t,e="int"){const n="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new ki(n,"rgb",e)}static toRgbaObject(t,e="int"){return t.toRgbaObject(e)}static isRgbColorObject(t){return Pi(t,"r")&&Pi(t,"g")&&Pi(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&Pi(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode!==e.mode)return!1;const n=t.comps_,i=e.comps_;for(let s=0;s<n.length;s++)if(n[s]!==i[s])return!1;return!0}constructor(t,e,n="int"){this.mode=e,this.type=n,this.comps_=yi(t,e,n)}getComponents(t,e="int"){return _i(Ei(bi(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:e}),this.comps_[3])}toRgbaObject(t="int"){const e=this.getComponents("rgb",t);return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const Ai=b("colp");class Li{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(Ai()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(Ai("hsv"));const i=t.createElement("div");i.classList.add(Ai("sv")),this.svPaletteView_=e.svPaletteView,i.appendChild(this.svPaletteView_.element),n.appendChild(i);const s=t.createElement("div");s.classList.add(Ai("h")),this.hPaletteView_=e.hPaletteView,s.appendChild(this.hPaletteView_.element),n.appendChild(s),this.element.appendChild(n);const o=t.createElement("div");if(o.classList.add(Ai("rgb")),this.textView_=e.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const n=t.createElement("div");n.classList.add(Ai("a"));const i=t.createElement("div");i.classList.add(Ai("ap")),i.appendChild(this.alphaViews_.palette.element),n.appendChild(i);const s=t.createElement("div");s.classList.add(Ai("at")),s.appendChild(this.alphaViews_.text.element),n.appendChild(s),this.element.appendChild(n)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((t=>t.inputElement))];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function Mi(t){return"int"===t?"int":"float"===t?"float":void 0}function Ii(t){const e=N;return O(t,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Mi)}),expanded:e.optional.boolean,picker:e.optional.custom(Wn)})}function Ti(t){return t?.1:1}function zi(t){var e;return null===(e=t.color)||void 0===e?void 0:e.type}function Si(t,e){return t.alpha===e.alpha&&t.mode===e.mode&&t.notation===e.notation&&t.type===e.type}function Vi(t,e){const n=t.match(/^(.+)%$/);return Math.min(n?.01*parseFloat(n[1])*e:parseFloat(t),e)}const Ri={deg:t=>t,grad:t=>360*t/400,rad:t=>360*t/(2*Math.PI),turn:t=>360*t};function Di(t){const e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);const n=parseFloat(e[1]),i=e[2];return Ri[i](n)}function Ni(t){const e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Vi(e[1],255),Vi(e[2],255),Vi(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Oi(t){return e=>{const n=Ni(e);return n?new ki(n,"rgb",t):null}}function ji(t){const e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Vi(e[1],255),Vi(e[2],255),Vi(e[3],255),Vi(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Fi(t){return e=>{const n=ji(e);return n?new ki(n,"rgb",t):null}}function Bi(t){const e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Di(e[1]),Vi(e[2],100),Vi(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Hi(t){return e=>{const n=Bi(e);return n?new ki(n,"hsl",t):null}}function Ki(t){const e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Di(e[1]),Vi(e[2],100),Vi(e[3],100),Vi(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Ui(t){return e=>{const n=Ki(e);return n?new ki(n,"hsl",t):null}}function $i(t){const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const n=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function Gi(t){const e=$i(t);return e?new ki(e,"rgb","int"):null}function qi(t){const e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Rn(parseInt(e[4]+e[4],16),0,255,0,1)];const n=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Rn(parseInt(n[4],16),0,255,0,1)]:null}function Yi(t){const e=qi(t);return e?new ki(e,"rgb","int"):null}function Xi(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const n=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Wi(t){return e=>{const n=Xi(e);return n?new ki(n,"rgb",t):null}}function Zi(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const n=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Qi(t){return e=>{const n=Zi(e);return n?new ki(n,"rgb",t):null}}const Ji=[{parser:$i,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:qi,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Ni,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:ji,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Bi,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Ki,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Xi,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Zi,result:{alpha:!0,mode:"rgb",notation:"object"}}];function ts(t){return Ji.reduce(((e,{parser:n,result:i})=>e||(n(t)?i:null)),null)}function es(t,e="int"){const n=ts(t);return n?"hex"===n.notation&&"float"!==e?Object.assign(Object.assign({},n),{type:"int"}):"func"===n.notation?Object.assign(Object.assign({},n),{type:e}):null:null}const ns={int:[Gi,Yi,Oi("int"),Fi("int"),Hi("int"),Ui("int"),Wi("int"),Qi("int")],float:[Oi("float"),Fi("float"),Hi("float"),Ui("float"),Wi("float"),Qi("float")]};function is(t){const e=ns[t];return n=>"string"!=typeof n?ki.black(t):e.reduce(((t,e)=>t||e(n)),null)??ki.black(t)}function ss(t){const e=ns[t];return t=>e.reduce(((e,n)=>e||n(t)),null)}function os(t){const e=Nn(Math.floor(t),0,255).toString(16);return 1===e.length?`0${e}`:e}function rs(t,e="#"){return`${e}${bi(t.getComponents("rgb")).map(os).join("")}`}function as(t,e="#"){const n=t.getComponents("rgb");return`${e}${[n[0],n[1],n[2],255*n[3]].map(os).join("")}`}function ls(t,e){const n=yn("float"===e?2:0);return`rgb(${bi(t.getComponents("rgb",e)).map((t=>n(t))).join(", ")})`}function hs(t){return e=>ls(e,t)}function ds(t,e){const n=yn(2),i=yn("float"===e?2:0);return`rgba(${t.getComponents("rgb",e).map(((t,e)=>(3===e?n:i)(t))).join(", ")})`}function cs(t){return e=>ds(e,t)}function ps(t){const e=[yn(0),En,En];return`hsl(${bi(t.getComponents("hsl")).map(((t,n)=>e[n](t))).join(", ")})`}function us(t){const e=[yn(0),En,En,yn(2)];return`hsla(${t.getComponents("hsl").map(((t,n)=>e[n](t))).join(", ")})`}function vs(t,e){const n=yn("float"===e?2:0),i=["r","g","b"];return`{${bi(t.getComponents("rgb",e)).map(((t,e)=>`${i[e]}: ${n(t)}`)).join(", ")}}`}function ms(t){return e=>vs(e,t)}function gs(t,e){const n=yn(2),i=yn("float"===e?2:0),s=["r","g","b","a"];return`{${t.getComponents("rgb",e).map(((t,e)=>{const o=3===e?n:i;return`${s[e]}: ${o(t)}`})).join(", ")}}`}function bs(t){return e=>gs(e,t)}const _s=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:rs},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:as},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:ps},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:us},...["int","float"].reduce(((t,e)=>[...t,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:hs(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:cs(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:ms(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:bs(e)}]),[])];function fs(t){return _s.reduce(((e,n)=>e||(Si(n.format,t)?n.stringifier:null)),null)}const ws=b("apl");class xs{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(ws()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(ws("b")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(ws("c")),n.appendChild(i),this.colorElem_=i;const s=t.createElement("div");s.classList.add(ws("m")),this.element.appendChild(s),this.markerElem_=s;const o=t.createElement("div");o.classList.add(ws("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),n=new ki([e[0],e[1],e[2],0],"rgb"),i=new ki([e[0],e[1],e[2],255],"rgb"),s=["to right",ds(n),ds(i)];this.colorElem_.style.background=`linear-gradient(${s.join(",")})`,this.previewElem_.style.backgroundColor=ds(t);const o=Rn(e[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}}class ys{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new xs(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Vn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=t.point.x/t.bounds.width,i=this.value.rawValue,[s,o,r]=i.getComponents("hsv");this.value.setRawValue(new ki([s,o,r,n],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Ln(Ti(!0),In(t));if(0===e)return;const n=this.value.rawValue,[i,s,o,r]=n.getComponents("hsv");this.value.setRawValue(new ki([i,s,o,r+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Ln(Ti(!0),In(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Cs=b("coltxt");function Es(t){const e=t.createElement("select"),n=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(n.reduce(((e,n)=>{const i=t.createElement("option");return i.textContent=n.text,i.value=n.value,e.appendChild(i),e}),t.createDocumentFragment())),e}class Ps{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Cs()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(Cs("m")),this.modeElem_=Es(t),this.modeElem_.classList.add(Cs("ms")),n.appendChild(this.modeSelectElement),e.viewProps.bindDisabled(this.modeElem_);const i=t.createElement("div");i.classList.add(Cs("mm")),i.appendChild(it(t,"dropdown")),n.appendChild(i),this.element.appendChild(n);const s=t.createElement("div");s.classList.add(Cs("w")),this.element.appendChild(s),this.textsElem_=s,this.textViews_=e.textViews,this.applyTextViews_(),w(e.colorMode,(t=>{this.modeElem_.value=t}))}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){rt(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach((e=>{const n=t.createElement("div");n.classList.add(Cs("c")),n.appendChild(e.element),this.textsElem_.appendChild(n)}))}}function ks(t){return yn("float"===t?2:0)}function As(t,e,n){const i=wi(t,e)[n];return new Ce({min:0,max:i})}function Ls(t,e,n){return new Bn(t,{arrayPosition:0===n?"fst":2===n?"lst":"mid",baseStep:Ti(!1),parser:e.parser,props:T.fromObject({draggingScale:"float"===e.colorType?.01:1,formatter:ks(e.colorType)}),value:I(0,{constraint:As(e.colorMode,e.colorType,n)}),viewProps:e.viewProps})}class Ms{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=I(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new Ps(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},n=[Ls(t,e,0),Ls(t,e,1),Ls(t,e,2)];return n.forEach(((t,e)=>{An({primary:this.value,secondary:t.value,forward:t=>t.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[e],backward:(t,n)=>{const i=this.colorMode.rawValue,s=t.rawValue.getComponents(i,this.colorType_);return s[e]=n.rawValue,new ki(_i(bi(s),s[3]),i,this.colorType_)}})})),n}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Is=b("hpl");class Ts{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Is()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(Is("c")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(Is("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=ls(new ki([e,100,100],"hsv"));const n=Rn(e,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}}class zs{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Ts(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Vn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=Rn(Nn(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),i=this.value.rawValue,[,s,o,r]=i.getComponents("hsv");this.value.setRawValue(new ki([n,s,o,r],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Ln(Ti(!1),In(t));if(0===e)return;const n=this.value.rawValue,[i,s,o,r]=n.getComponents("hsv");this.value.setRawValue(new ki([i+e,s,o,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Ln(Ti(!1),In(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ss=b("svp"),Vs=64;class Rs{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Ss()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const n=t.createElement("canvas");n.height=Vs,n.width=Vs,n.classList.add(Ss("c")),this.element.appendChild(n),this.canvasElement=n;const i=t.createElement("div");i.classList.add(Ss("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=et(this.canvasElement);if(!t)return;const e=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,s=t.getImageData(0,0,n,i),o=s.data;for(let l=0;l<i;l++)for(let t=0;t<n;t++){const s=Rn(t,0,n,0,100),r=Rn(l,0,i,100,0),a=vi(e[0],s,r),h=4*(l*n+t);o[h]=a[0],o[h+1]=a[1],o[h+2]=a[2],o[h+3]=255}t.putImageData(s,0,0);const r=Rn(e[1],0,100,0,100);this.markerElem_.style.left=`${r}%`;const a=Rn(e[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class Ds{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Rs(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Vn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=Rn(t.point.x,0,t.bounds.width,0,100),i=Rn(t.point.y,0,t.bounds.height,100,0),[s,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new ki([s,n,i,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){zn(t.key)&&t.preventDefault();const[e,n,i,s]=this.value.rawValue.getComponents("hsv"),o=Ti(!1),r=Ln(o,In(t)),a=Ln(o,Mn(t));0===r&&0===a||this.value.setRawValue(new ki([e,n+r,i+a,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=Ti(!1),n=Ln(e,In(t)),i=Ln(e,Mn(t));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Ns{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new zs(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Ds(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new ys(t,{value:this.value,viewProps:this.viewProps}),text:new Bn(t,{parser:fn,baseStep:.1,props:T.fromObject({draggingScale:.01,formatter:yn(2)}),value:I(0,{constraint:new Ce({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&An({primary:this.value,secondary:this.alphaIcs_.text.value,forward:t=>t.rawValue.getComponents()[3],backward:(t,e)=>{const n=t.rawValue.getComponents();return n[3]=e.rawValue,new ki(n,t.rawValue.mode)}}),this.textC_=new Ms(t,{colorType:e.colorType,parser:fn,value:this.value,viewProps:this.viewProps}),this.view=new Li(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}get textController(){return this.textC_}}const Os=b("colsw");class js{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(Os()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(Os("sw")),this.element.appendChild(n),this.swatchElem_=n;const i=t.createElement("button");i.classList.add(Os("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=as(t)}onValueChange_(){this.update_()}}class Fs{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new js(t,{value:this.value,viewProps:this.viewProps})}}class Bs{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=gt.create(e.expanded),this.swatchC_=new Fs(t,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new Re(t,{parser:e.parser,props:T.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new di(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new ze(t,{viewProps:this.viewProps}):null;const i=new Ns(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),An({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ft(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=t.relatedTarget;(!n||!e.contains(n))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=lt(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!Q(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function Hs(t,e){return ki.isColorObject(t)?ki.fromObject(t,e):ki.black(e)}function Ks(t){return bi(t.getComponents("rgb")).reduce(((t,e)=>t<<8|255&Math.floor(e)),0)}function Us(t){return t.getComponents("rgb").reduce(((t,e,n)=>t<<8|255&Math.floor(3===n?255*e:e)),0)>>>0}function $s(t){return new ki([t>>16&255,t>>8&255,255&t],"rgb")}function Gs(t){return new ki([t>>24&255,t>>16&255,t>>8&255,Rn(255&t,0,255,0,1)],"rgb")}function qs(t){return"number"!=typeof t?ki.black():$s(t)}function Ys(t){return"number"!=typeof t?ki.black():Gs(t)}function Xs(t){const e=fs(t);return e?(t,n)=>{Yn(t,e(n))}:null}function Ws(t){const e=t?Us:Ks;return(t,n)=>{Yn(t,e(n))}}function Zs(t,e,n){const i=e.toRgbaObject(n);t.writeProperty("r",i.r),t.writeProperty("g",i.g),t.writeProperty("b",i.b),t.writeProperty("a",i.a)}function Qs(t,e,n){const i=e.toRgbaObject(n);t.writeProperty("r",i.r),t.writeProperty("g",i.g),t.writeProperty("b",i.b)}function Js(t,e){return(n,i)=>{t?Zs(n,i,e):Qs(n,i,e)}}function to(t){var e;return!!((null==t?void 0:t.alpha)||null!==(e=null==t?void 0:t.color)&&void 0!==e&&e.alpha)}function eo(t){return t?t=>as(t,"0x"):t=>rs(t,"0x")}function no(t){return"color"in t||"view"in t&&"color"===t.view}const io={id:"input-color-number",type:"input",accept:(t,e)=>{if("number"!=typeof t||!no(e))return null;const n=Ii(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>to(t.params)?Ys:qs,equals:ki.equals,writer:t=>Ws(to(t.params))},controller:t=>{const e=to(t.params),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0;return new Bs(t.document,{colorType:"int",expanded:n??!1,formatter:eo(e),parser:ss("int"),pickerLayout:i??"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};function so(t){return ki.isRgbaColorObject(t)}function oo(t){return e=>Hs(e,t)}function ro(t,e){return n=>t?gs(n,e):vs(n,e)}const ao={id:"input-color-object",type:"input",accept:(t,e)=>{if(!ki.isColorObject(t))return null;const n=Ii(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>oo(zi(t.params)),equals:ki.equals,writer:t=>Js(so(t.initialValue),zi(t.params))},controller:t=>{var e;const n=ki.isRgbaColorObject(t.initialValue),i="expanded"in t.params?t.params.expanded:void 0,s="picker"in t.params?t.params.picker:void 0,o=null!==(e=zi(t.params))&&void 0!==e?e:"int";return new Bs(t.document,{colorType:o,expanded:i??!1,formatter:ro(n,o),parser:ss(o),pickerLayout:s??"popup",supportsAlpha:n,value:t.value,viewProps:t.viewProps})}},lo={id:"input-color-string",type:"input",accept:(t,e)=>{if("string"!=typeof t||"view"in e&&"text"===e.view)return null;const n=es(t,zi(e));if(!n||!fs(n))return null;const i=Ii(e);return i?{initialValue:t,params:i}:null},binding:{reader:t=>{var e;return is(null!==(e=zi(t.params))&&void 0!==e?e:"int")},equals:ki.equals,writer:t=>{const e=es(t.initialValue,zi(t.params));if(!e)throw p.shouldNeverHappen();const n=Xs(e);if(!n)throw p.notBindable();return n}},controller:t=>{const e=es(t.initialValue,zi(t.params));if(!e)throw p.shouldNeverHappen();const n=fs(e);if(!n)throw p.shouldNeverHappen();const i="expanded"in t.params?t.params.expanded:void 0,s="picker"in t.params?t.params.picker:void 0;return new Bs(t.document,{colorType:e.type,expanded:i??!1,formatter:n,parser:ss(e.type),pickerLayout:s??"popup",supportsAlpha:e.alpha,value:t.value,viewProps:t.viewProps})}};class ho{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var n,i;return null!==(i=null===(n=this.components[e])||void 0===n?void 0:n.constrain(t))&&void 0!==i?i:t}));return this.asm_.fromComponents(e)}}const co=b("pndtxt");class po{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(co()),this.textViews.forEach((e=>{const n=t.createElement("div");n.classList.add(co("a")),n.appendChild(e.element),this.element.appendChild(n)}))}}function uo(t,e,n){return new Bn(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:I(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}class vo{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((n,i)=>uo(t,e,i))),this.acs_.forEach(((t,n)=>{An({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[n],backward:(t,i)=>{const s=e.assembly.toComponents(t.rawValue);return s[n]=i.rawValue,e.assembly.fromComponents(s)}})})),this.view=new po(t,{textViews:this.acs_.map((t=>t.view))})}}function mo(t,e){return"step"in t&&!l(t.step)?new ke(t.step,e):null}function go(t){return l(t.max)||l(t.min)?l(t.max)&&l(t.min)?null:new Pe({max:t.max,min:t.min}):new Ce({max:t.max,min:t.min})}function bo(t){const e=ye(t,Ce);if(e)return[e.values.get("min"),e.values.get("max")];const n=ye(t,Pe);return n?[n.minValue,n.maxValue]:[void 0,void 0]}function _o(t,e){const n=[],i=mo(t,e);i&&n.push(i);const s=go(t);s&&n.push(s);const o=Jn(t.options);return o&&n.push(o),new xe(n)}const fo={id:"input-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;const n=N,i=O(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,options:n.optional.custom(Xn),step:n.optional.number});return i?{initialValue:t,params:i}:null},binding:{reader:t=>wn,constraint:t=>_o(t.params,t.initialValue),writer:t=>Yn},controller:t=>{var e;const n=t.value,i=t.constraint,s=i&&ye(i,Ee);if(s)return new Me(t.document,{props:new T({options:s.values.value("options")}),value:n,viewProps:t.viewProps});const o=null!==(e="format"in t.params?t.params.format:void 0)&&void 0!==e?e:yn(ei(i,n.rawValue)),r=i&&ye(i,Ce);return r?new qn(t.document,{baseStep:ni(i),parser:fn,sliderProps:new T({maxValue:r.values.value("max"),minValue:r.values.value("min")}),textProps:T.fromObject({draggingScale:ii(i,n.rawValue),formatter:o}),value:n,viewProps:t.viewProps}):new Bn(t.document,{baseStep:ni(i),parser:fn,props:T.fromObject({draggingScale:ii(i,n.rawValue),formatter:o}),value:n,viewProps:t.viewProps})}};class wo{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(l(t))return!1;const e=t.x,n=t.y;return!("number"!=typeof e||"number"!=typeof n)}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const xo={toComponents:t=>t.getComponents(),fromComponents:t=>new wo(...t)},yo=b("p2d");class Co{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(yo()),e.viewProps.bindClassModifiers(this.element),w(e.expanded,C(this.element,yo(void 0,"expanded")));const n=t.createElement("div");n.classList.add(yo("h")),this.element.appendChild(n);const i=t.createElement("button");i.classList.add(yo("b")),i.appendChild(it(t,"p2dpad")),e.viewProps.bindDisabled(i),n.appendChild(i),this.buttonElement=i;const s=t.createElement("div");if(s.classList.add(yo("t")),n.appendChild(s),this.textElement=s,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(yo("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const Eo=b("p2dp");class Po{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(Eo()),"popup"===e.layout&&this.element.classList.add(Eo(void 0,"p")),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(Eo("p")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=t.createElementNS(X,"svg");i.classList.add(Eo("g")),this.padElement.appendChild(i),this.svgElem_=i;const s=t.createElementNS(X,"line");s.classList.add(Eo("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const o=t.createElementNS(X,"line");o.classList.add(Eo("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const r=t.createElementNS(X,"line");r.classList.add(Eo("l")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(r),this.lineElem_=r;const a=t.createElement("div");a.classList.add(Eo("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),n=this.maxValue_,i=Rn(t,-n,+n,0,100),s=Rn(e,-n,+n,0,100),o=this.invertsY_?100-s:s;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function ko(t,e,n){return[Ln(e[0],In(t)),Ln(e[1],Mn(t))*(n?1:-1)]}class Ao{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new Po(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Vn(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=this.maxValue_,i=Rn(t.point.x,0,t.bounds.width,-n,+n),s=Rn(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-n,+n);this.value.setRawValue(new wo(i,s),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){zn(t.key)&&t.preventDefault();const[e,n]=ko(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(new wo(this.value.rawValue.x+e,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,n]=ko(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Lo{constructor(t,e){var n,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=gt.create(e.expanded),this.popC_="popup"===e.pickerLayout?new ze(t,{viewProps:this.viewProps}):null;const s=new Ao(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=s,this.textC_=new vo(t,{assembly:xo,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Co(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),An({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ft(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=t.relatedTarget;(!n||!e.contains(n))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=lt(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!Q(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}class Mo{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(l(t))return!1;const e=t.x,n=t.y,i=t.z;return!("number"!=typeof e||"number"!=typeof n||"number"!=typeof i)}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Io={toComponents:t=>t.getComponents(),fromComponents:t=>new Mo(...t)};function To(t){return Mo.isObject(t)?new Mo(t.x,t.y,t.z):new Mo}function zo(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function So(t,e){return new ho({assembly:Io,components:[mr("x"in t?t.x:void 0,e.x),mr("y"in t?t.y:void 0,e.y),mr("z"in t?t.z:void 0,e.z)]})}function Vo(t,e){return{baseStep:ni(e),constraint:e,textProps:T.fromObject({draggingScale:ii(e,t),formatter:yn(ei(e,t))})}}const Ro={id:"input-point3d",type:"input",accept:(t,e)=>{if(!Mo.isObject(t))return null;const n=N,i=O(e,{x:n.optional.custom(Zn),y:n.optional.custom(Zn),z:n.optional.custom(Zn)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>To,constraint:t=>So(t.params,t.initialValue),equals:Mo.equals,writer:t=>zo},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof ho))throw p.shouldNeverHappen();return new vo(t.document,{assembly:Io,axes:[Vo(e.rawValue.x,n.components[0]),Vo(e.rawValue.y,n.components[1]),Vo(e.rawValue.z,n.components[2])],parser:fn,value:e,viewProps:t.viewProps})}};class Do{constructor(t=0,e=0,n=0,i=0){this.x=t,this.y=e,this.z=n,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(l(t))return!1;const e=t.x,n=t.y,i=t.z,s=t.w;return!("number"!=typeof e||"number"!=typeof n||"number"!=typeof i||"number"!=typeof s)}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const No={toComponents:t=>t.getComponents(),fromComponents:t=>new Do(...t)};function Oo(t){return Do.isObject(t)?new Do(t.x,t.y,t.z,t.w):new Do}function jo(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function Fo(t,e){return new ho({assembly:No,components:[mr("x"in t?t.x:void 0,e.x),mr("y"in t?t.y:void 0,e.y),mr("z"in t?t.z:void 0,e.z),mr("w"in t?t.w:void 0,e.w)]})}function Bo(t,e){return{baseStep:ni(e),constraint:e,textProps:T.fromObject({draggingScale:ii(e,t),formatter:yn(ei(e,t))})}}const Ho={id:"input-point4d",type:"input",accept:(t,e)=>{if(!Do.isObject(t))return null;const n=N,i=O(e,{x:n.optional.custom(Zn),y:n.optional.custom(Zn),z:n.optional.custom(Zn),w:n.optional.custom(Zn)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Oo,constraint:t=>Fo(t.params,t.initialValue),equals:Do.equals,writer:t=>jo},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof ho))throw p.shouldNeverHappen();return new vo(t.document,{assembly:No,axes:e.rawValue.getComponents().map(((t,e)=>Bo(t,n.components[e]))),parser:fn,value:e,viewProps:t.viewProps})}};function Ko(t){const e=[],n=Jn(t.options);return n&&e.push(n),new xe(e)}const Uo={id:"input-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;const n=O(e,{options:N.optional.custom(Xn)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Pn,constraint:t=>Ko(t.params),writer:t=>Yn},controller:t=>{const e=t.document,n=t.value,i=t.constraint,s=i&&ye(i,Ee);return s?new Me(e,{props:new T({options:s.values.value("options")}),value:n,viewProps:t.viewProps}):new Re(e,{parser:t=>t,props:T.fromObject({formatter:kn}),value:n,viewProps:t.viewProps})}},$o={monitor:{defaultInterval:200,defaultLineCount:3}},Go=b("mll");class qo{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Go()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("textarea");n.classList.add(Go("i")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,n.readOnly=!0,e.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,n=[];this.value.rawValue.forEach((t=>{void 0!==t&&n.push(this.formatter_(t))})),t.textContent=n.join("\n"),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class Yo{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new qo(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const Xo=b("sgl");class Wo{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Xo()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(Xo("i")),n.readOnly=!0,n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class Zo{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Wo(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const Qo={id:"monitor-bool",type:"monitor",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=O(e,{lineCount:N.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Ne},controller:t=>{var e;return 1===t.value.rawValue.length?new Zo(t.document,{formatter:Oe,value:t.value,viewProps:t.viewProps}):new Yo(t.document,{formatter:Oe,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:$o.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}},Jo=b("grl");class tr{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Jo()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=t.createElementNS(X,"svg");n.classList.add(Jo("g")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const i=t.createElementNS(X,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const s=t.createElement("div");s.classList.add(Jo("t"),b("tt")()),this.element.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.props_.get("minValue"),i=this.props_.get("maxValue"),s=[];this.value.rawValue.forEach(((o,r)=>{if(void 0===o)return;const a=Rn(r,0,e,0,t.width),l=Rn(o,n,i,t.height,0);s.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const o=this.tooltipElem_,r=this.value.rawValue[this.cursor_.rawValue];if(void 0===r)return void o.classList.remove(Jo("t","a"));const a=Rn(this.cursor_.rawValue,0,e,0,t.width),l=Rn(r,n,i,t.height,0);o.style.left=`${a}px`,o.style.top=`${l}px`,o.textContent=`${this.formatter_(r)}`,o.classList.contains(Jo("t","a"))||(o.classList.add(Jo("t","a"),Jo("t","in")),W(o),o.classList.remove(Jo("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class er{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=I(-1),this.view=new tr(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),Q(t)){const t=new Vn(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(Rn(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.rawValue=Math.floor(Rn(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function nr(t){return"format"in t&&!l(t.format)?t.format:yn(2)}function ir(t){var e;return 1===t.value.rawValue.length?new Zo(t.document,{formatter:nr(t.params),value:t.value,viewProps:t.viewProps}):new Yo(t.document,{formatter:nr(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:$o.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}function sr(t){var e,n,i;return new er(t.document,{formatter:nr(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:$o.monitor.defaultLineCount,props:T.fromObject({maxValue:null!==(n="max"in t.params?t.params.max:null)&&void 0!==n?n:100,minValue:null!==(i="min"in t.params?t.params.min:null)&&void 0!==i?i:0}),value:t.value,viewProps:t.viewProps})}function or(t){return"view"in t&&"graph"===t.view}const rr={id:"monitor-number",type:"monitor",accept:(t,e)=>{if("number"!=typeof t)return null;const n=N,i=O(e,{format:n.optional.function,lineCount:n.optional.number,max:n.optional.number,min:n.optional.number,view:n.optional.string});return i?{initialValue:t,params:i}:null},binding:{defaultBufferSize:t=>or(t)?64:1,reader:t=>wn},controller:t=>or(t.params)?sr(t):ir(t)},ar={id:"monitor-string",type:"monitor",accept:(t,e)=>{if("string"!=typeof t)return null;const n=N,i=O(e,{lineCount:n.optional.number,multiline:n.optional.boolean});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Pn},controller:t=>{var e;const n=t.value;return n.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new Yo(t.document,{formatter:kn,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:$o.monitor.defaultLineCount,value:n,viewProps:t.viewProps}):new Zo(t.document,{formatter:kn,value:n,viewProps:t.viewProps})}};function lr(t,e){var n;const i=t.accept(e.target.read(),e.params);if(l(i))return null;const s=N,o={target:e.target,initialValue:i.initialValue,params:i.params},r=t.binding.reader(o),a=t.binding.constraint?t.binding.constraint(o):void 0,h=I(r(i.initialValue),{constraint:a,equals:t.binding.equals}),d=new me({reader:r,target:e.target,value:h,writer:t.binding.writer(o)}),c=s.optional.boolean(e.params.disabled).value,p=s.optional.boolean(e.params.hidden).value,u=t.controller({constraint:a,document:e.document,initialValue:i.initialValue,params:i.params,value:d.value,viewProps:U.create({disabled:c,hidden:p})});return new At(e.document,{binding:d,blade:mt(),props:T.fromObject({label:"label"in e.params?null!==(n=s.optional.string(e.params.label).value)&&void 0!==n?n:null:e.target.key}),valueController:u})}function hr(t,e){return 0===e?new ue:new ve(t,e??$o.monitor.defaultInterval)}function dr(t,e){var n,i,s;const o=N,r=t.accept(e.target.read(),e.params);if(l(r))return null;const a={target:e.target,initialValue:r.initialValue,params:r.params},h=t.binding.reader(a),d=null!==(i=null!==(n=o.optional.number(e.params.bufferSize).value)&&void 0!==n?n:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(r.params))&&void 0!==i?i:1,c=o.optional.number(e.params.interval).value,p=new we({reader:h,target:e.target,ticker:hr(e.document,c),value:be(d)}),u=o.optional.boolean(e.params.disabled).value,v=o.optional.boolean(e.params.hidden).value,m=t.controller({document:e.document,params:r.params,value:p.value,viewProps:U.create({disabled:u,hidden:v})});return new Mt(e.document,{binding:p,blade:mt(),props:T.fromObject({label:"label"in e.params?null!==(s=o.optional.string(e.params.label).value)&&void 0!==s?s:null:e.target.key}),valueController:m})}class cr{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,n){if(l(e.read()))throw new p({context:{key:e.key},type:"nomatchingcontroller"});const i=this.pluginsMap_.inputs.reduce(((i,s)=>i??lr(s,{document:t,target:e,params:n})),null);if(i)return i;throw new p({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,n){const i=this.pluginsMap_.monitors.reduce(((i,s)=>i??dr(s,{document:t,params:n,target:e})),null);if(i)return i;throw new p({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const n=this.pluginsMap_.blades.reduce(((n,i)=>n??pe(i,{document:t,params:e})),null);if(!n)throw new p({type:"nomatchingview",context:{params:e}});return n}createBladeApi(t){if(t instanceof At)return new kt(t);if(t instanceof Mt)return new Lt(t);if(t instanceof Kt)return new St(t,this);const e=this.pluginsMap_.blades.reduce(((e,n)=>e??n.api({controller:t,pool:this})),null);if(!e)throw p.shouldNeverHappen();return e}}function pr(){const t=new cr;return[xr,Ro,Ho,Uo,fo,lo,ao,io,li,Qo,ar,rr,ut,qt,Jt,ce].forEach((e=>{t.register(e)})),t}function ur(t){return wo.isObject(t)?new wo(t.x,t.y):new wo}function vr(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function mr(t,e){if(!t)return;const n=[],i=mo(t,e);i&&n.push(i);const s=go(t);return s&&n.push(s),new xe(n)}function gr(t,e){return new ho({assembly:xo,components:[mr("x"in t?t.x:void 0,e.x),mr("y"in t?t.y:void 0,e.y)]})}function br(t,e){const[n,i]=t?bo(t):[];if(!l(n)||!l(i))return Math.max(Math.abs(n??0),Math.abs(i??0));const s=ni(t);return Math.max(10*Math.abs(s),10*Math.abs(e))}function _r(t,e){const n=e instanceof ho?e.components[0]:void 0,i=e instanceof ho?e.components[1]:void 0,s=br(n,t.x),o=br(i,t.y);return Math.max(s,o)}function fr(t,e){return{baseStep:ni(e),constraint:e,textProps:T.fromObject({draggingScale:ii(e,t),formatter:yn(ei(e,t))})}}function wr(t){if(!("y"in t))return!1;const e=t.y;return!(!e||!("inverted"in e)||!e.inverted)}const xr={id:"input-point2d",type:"input",accept:(t,e)=>{if(!wo.isObject(t))return null;const n=N,i=O(e,{expanded:n.optional.boolean,picker:n.optional.custom(Wn),x:n.optional.custom(Zn),y:n.optional.object({inverted:n.optional.boolean,max:n.optional.number,min:n.optional.number,step:n.optional.number})});return i?{initialValue:t,params:i}:null},binding:{reader:t=>ur,constraint:t=>gr(t.params,t.initialValue),equals:wo.equals,writer:t=>vr},controller:t=>{const e=t.document,n=t.value,i=t.constraint;if(!(i instanceof ho))throw p.shouldNeverHappen();const s="expanded"in t.params?t.params.expanded:void 0,o="picker"in t.params?t.params.picker:void 0;return new Lo(e,{axes:[fr(n.rawValue.x,i.components[0]),fr(n.rawValue.y,i.components[1])],expanded:s??!1,invertsY:wr(t.params),maxValue:_r(n.rawValue,i),parser:fn,pickerLayout:o??"popup",value:n,viewProps:t.viewProps})}};class yr extends n{constructor(t){super(t),this.emitter_=new m,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new s(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class Cr extends n{constructor(t){super(t),this.emitter_=new m,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new s(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class Er extends n{constructor(t){super(t),this.emitter_=new m,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new s(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}const Pr={id:"list",type:"blade",accept(t){const e=N,n=O(t,{options:e.required.custom(Xn),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return n?{params:n}:null},controller(t){const e=new Ee(Qn(t.params.options)),n=I(t.params.value,{constraint:e}),i=new Me(t.document,{props:new T({options:e.values.value("options")}),value:n,viewProps:t.viewProps});return new Yt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:i})},api:t=>t.controller instanceof Yt&&t.controller.valueController instanceof Me?new yr(t.controller):null};function kr(t){return t.reduce(((t,e)=>Object.assign(t,{[e.presetKey]:e.read()})),{})}function Ar(t,e){t.forEach((t=>{const n=e[t.target.presetKey];void 0!==n&&t.writer(t.target,t.reader(n))}))}class Lr extends Vt{constructor(t,e){super(t,e)}get element(){return this.controller_.view.element}importPreset(t){Ar(this.controller_.rackController.rack.find(At).map((t=>t.binding)),t),this.refresh()}exportPreset(){return kr(this.controller_.rackController.rack.find(At).map((t=>t.binding.target)))}refresh(){this.controller_.rackController.rack.find(At).forEach((t=>{t.binding.read()})),this.controller_.rackController.rack.find(Mt).forEach((t=>{t.binding.read()}))}}class Mr extends Gt{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const Ir={id:"slider",type:"blade",accept(t){const e=N,n=O(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return n?{params:n}:null},controller(t){var e,n;const i=null!==(e=t.params.value)&&void 0!==e?e:0,s=new Ce({max:t.params.max,min:t.params.min}),o=new qn(t.document,{baseStep:1,parser:fn,sliderProps:new T({maxValue:s.values.value("max"),minValue:s.values.value("min")}),textProps:T.fromObject({draggingScale:ii(void 0,i),formatter:null!==(n=t.params.format)&&void 0!==n?n:xn}),value:I(i,{constraint:s}),viewProps:t.viewProps});return new Yt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:o})},api:t=>t.controller instanceof Yt&&t.controller.valueController instanceof qn?new Cr(t.controller):null},Tr={id:"text",type:"blade",accept(t){const e=N,n=O(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return n?{params:n}:null},controller(t){var e;const n=new Re(t.document,{parser:t.params.parse,props:T.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:t=>String(t)}),value:I(t.params.value),viewProps:t.viewProps});return new Yt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:n})},api:t=>t.controller instanceof Yt&&t.controller.valueController instanceof Re?new Er(t.controller):null};function zr(t){const e=t.createElement("div");return e.classList.add(b("dfw")()),t.body&&t.body.appendChild(e),e}function Sr(t,e,n){if(t.querySelector(`style[data-tp-style=${e}]`))return;const i=t.createElement("style");i.dataset.tpStyle=e,i.textContent=n,t.head.appendChild(i)}class Vr extends Lr{constructor(t){var e,n;const i=t??{},s=null!==(e=i.document)&&void 0!==e?e:tt(),o=pr();super(new Mr(s,{expanded:i.expanded,blade:mt(),props:T.fromObject({title:i.title}),viewProps:U.create()}),o),this.pool_=o,this.containerElem_=null!==(n=i.container)&&void 0!==n?n:zr(s),this.containerElem_.appendChild(this.element),this.doc_=s,this.usesDefaultWrapper_=!i.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw p.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw p.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((t=>{this.pool_.register(t),this.embedPluginStyle_(t)}))}embedPluginStyle_(t){t.css&&Sr(this.document,`plugin-${t.id}`,t.css)}setUpDefaultPlugins_(){Sr(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach((t=>{this.embedPluginStyle_(t)})),this.registerPlugin({plugins:[Ir,Pr,ce,Tr]})}}const Rr=new e("3.1.9");t.BladeApi=n,t.ButtonApi=v,t.FolderApi=Vt,t.InputBindingApi=kt,t.ListApi=yr,t.MonitorBindingApi=Lt,t.Pane=Vr,t.SeparatorApi=Xt,t.SliderApi=Cr,t.TabApi=oe,t.TabPageApi=se,t.TextApi=Er,t.TpChangeEvent=s,t.VERSION=Rr,Object.defineProperty(t,"__esModule",{value:!0})}(we.exports);var xe=we.exports;function ye(t,e){if(e===J)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===tt||e===et){let n=t.getIndex();if(null===n){const e=[],i=t.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(let t=0;t<i.count;t++)e.push(t);t.setIndex(e),n=t.getIndex()}const i=n.count-2,s=[];if(e===tt)for(let t=1;t<=i;t++)s.push(n.getX(0)),s.push(n.getX(t)),s.push(n.getX(t+1));else for(let t=0;t<i;t++)t%2==0?(s.push(n.getX(t)),s.push(n.getX(t+1)),s.push(n.getX(t+2))):(s.push(n.getX(t+2)),s.push(n.getX(t+1)),s.push(n.getX(t)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=t.clone();return o.setIndex(s),o.clearGroups(),o}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}class Ce extends d{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(t){return new Me(t)})),this.register((function(t){return new Ne(t)})),this.register((function(t){return new Oe(t)})),this.register((function(t){return new je(t)})),this.register((function(t){return new Te(t)})),this.register((function(t){return new ze(t)})),this.register((function(t){return new Se(t)})),this.register((function(t){return new Ve(t)})),this.register((function(t){return new Le(t)})),this.register((function(t){return new Re(t)})),this.register((function(t){return new Ie(t)})),this.register((function(t){return new De(t)})),this.register((function(t){return new ke(t)})),this.register((function(t){return new Fe(t)})),this.register((function(t){return new Be(t)}))}load(t,e,n,i){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:c.extractUrlBase(t),this.manager.itemStart(t);const r=function(e){i?i(e):console.error(e),s.manager.itemError(t),s.manager.itemEnd(t)},l=new a(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,(function(n){try{s.parse(n,o,(function(n){e(n),s.manager.itemEnd(t)}),r)}catch(i){r(i)}}),n,r)}setDRACOLoader(t){return this.dracoLoader=t,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this}unregister(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,e,n,i){let s;const o={},r={},a=new TextDecoder;if("string"==typeof t)s=JSON.parse(t);else if(t instanceof ArrayBuffer)if(a.decode(new Uint8Array(t,0,4))===He){try{o[Pe.KHR_BINARY_GLTF]=new $e(t)}catch(h){return void(i&&i(h))}s=JSON.parse(o[Pe.KHR_BINARY_GLTF].content)}else s=JSON.parse(a.decode(t));else s=t;if(void 0===s.asset||s.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new bn(s,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const t=this.pluginCallbacks[d](l);r[t.name]=t,o[t.name]=!0}if(s.extensionsUsed)for(let d=0;d<s.extensionsUsed.length;++d){const t=s.extensionsUsed[d],e=s.extensionsRequired||[];switch(t){case Pe.KHR_MATERIALS_UNLIT:o[t]=new Ae;break;case Pe.KHR_DRACO_MESH_COMPRESSION:o[t]=new Ge(s,this.dracoLoader);break;case Pe.KHR_TEXTURE_TRANSFORM:o[t]=new qe;break;case Pe.KHR_MESH_QUANTIZATION:o[t]=new Ye;break;default:e.indexOf(t)>=0&&void 0===r[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(o),l.setPlugins(r),l.parse(n,i)}parseAsync(t,e){const n=this;return new Promise((function(i,s){n.parse(t,e,i,s)}))}}function Ee(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const Pe={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ke{constructor(t){this.parser=t,this.name=Pe.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,e=this.parser.json.nodes||[];for(let n=0,i=e.length;n<i;n++){const i=e[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&t._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(t){const e=this.parser,n="light:"+t;let s=e.cache.get(n);if(s)return s;const o=e.json,r=((o.extensions&&o.extensions[this.name]||{}).lights||[])[t];let a;const l=new i(16777215);void 0!==r.color&&l.fromArray(r.color);const h=void 0!==r.range?r.range:0;switch(r.type){case"directional":a=new v(l),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new u(l),a.distance=h;break;case"spot":a=new p(l),a.distance=h,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,a.angle=r.spot.outerConeAngle,a.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+r.type)}return a.position.set(0,0,0),a.decay=2,cn(a,r),void 0!==r.intensity&&(a.intensity=r.intensity),a.name=e.createUniqueName(r.name||"light_"+t),s=Promise.resolve(a),e.cache.add(n,s),s}getDependency(t,e){if("light"===t)return this._loadLight(e)}createNodeAttachment(t){const e=this,n=this.parser,i=n.json.nodes[t],s=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then((function(t){return n._getNodeRef(e.cache,s,t)}))}}class Ae{constructor(){this.name=Pe.KHR_MATERIALS_UNLIT}getMaterialType(){return m}extendParams(t,e,n){const s=[];t.color=new i(1,1,1),t.opacity=1;const o=e.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const e=o.baseColorFactor;t.color.fromArray(e),t.opacity=e[3]}void 0!==o.baseColorTexture&&s.push(n.assignTexture(t,"map",o.baseColorTexture,g))}return Promise.all(s)}}class Le{constructor(t){this.parser=t,this.name=Pe.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(t,e){const n=this.parser.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name].emissiveStrength;return void 0!==i&&(e.emissiveIntensity=i),Promise.resolve()}}class Me{constructor(t){this.parser=t,this.name=Pe.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?b:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(void 0!==o.clearcoatFactor&&(e.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(n.assignTexture(e,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(e.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(n.assignTexture(e,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(n.assignTexture(e,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const t=o.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new _(t,t)}return Promise.all(s)}}class Ie{constructor(t){this.parser=t,this.name=Pe.KHR_MATERIALS_IRIDESCENCE}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?b:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return void 0!==o.iridescenceFactor&&(e.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(n.assignTexture(e,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(e.iridescenceIOR=o.iridescenceIor),void 0===e.iridescenceThicknessRange&&(e.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(e.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(e.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(n.assignTexture(e,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class Te{constructor(t){this.parser=t,this.name=Pe.KHR_MATERIALS_SHEEN}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?b:null}extendMaterialParams(t,e){const n=this.parser,s=n.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[];e.sheenColor=new i(0,0,0),e.sheenRoughness=0,e.sheen=1;const r=s.extensions[this.name];return void 0!==r.sheenColorFactor&&e.sheenColor.fromArray(r.sheenColorFactor),void 0!==r.sheenRoughnessFactor&&(e.sheenRoughness=r.sheenRoughnessFactor),void 0!==r.sheenColorTexture&&o.push(n.assignTexture(e,"sheenColorMap",r.sheenColorTexture,g)),void 0!==r.sheenRoughnessTexture&&o.push(n.assignTexture(e,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(o)}}class ze{constructor(t){this.parser=t,this.name=Pe.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?b:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return void 0!==o.transmissionFactor&&(e.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(n.assignTexture(e,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Se{constructor(t){this.parser=t,this.name=Pe.KHR_MATERIALS_VOLUME}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?b:null}extendMaterialParams(t,e){const n=this.parser,s=n.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],r=s.extensions[this.name];e.thickness=void 0!==r.thicknessFactor?r.thicknessFactor:0,void 0!==r.thicknessTexture&&o.push(n.assignTexture(e,"thicknessMap",r.thicknessTexture)),e.attenuationDistance=r.attenuationDistance||1/0;const a=r.attenuationColor||[1,1,1];return e.attenuationColor=new i(a[0],a[1],a[2]),Promise.all(o)}}class Ve{constructor(t){this.parser=t,this.name=Pe.KHR_MATERIALS_IOR}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?b:null}extendMaterialParams(t,e){const n=this.parser.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name];return e.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}class Re{constructor(t){this.parser=t,this.name=Pe.KHR_MATERIALS_SPECULAR}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?b:null}extendMaterialParams(t,e){const n=this.parser,s=n.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],r=s.extensions[this.name];e.specularIntensity=void 0!==r.specularFactor?r.specularFactor:1,void 0!==r.specularTexture&&o.push(n.assignTexture(e,"specularIntensityMap",r.specularTexture));const a=r.specularColorFactor||[1,1,1];return e.specularColor=new i(a[0],a[1],a[2]),void 0!==r.specularColorTexture&&o.push(n.assignTexture(e,"specularColorMap",r.specularColorTexture,g)),Promise.all(o)}}class De{constructor(t){this.parser=t,this.name=Pe.KHR_MATERIALS_ANISOTROPY}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?b:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return void 0!==o.anisotropyStrength&&(e.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(e.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(n.assignTexture(e,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class Ne{constructor(t){this.parser=t,this.name=Pe.KHR_TEXTURE_BASISU}loadTexture(t){const e=this.parser,n=e.json,i=n.textures[t];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],o=e.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,s.source,o)}}class Oe{constructor(t){this.parser=t,this.name=Pe.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(t){const e=this.name,n=this.parser,i=n.json,s=i.textures[t];if(!s.extensions||!s.extensions[e])return null;const o=s.extensions[e],r=i.images[o.source];let a=n.textureLoader;if(r.uri){const t=n.options.manager.getHandler(r.uri);null!==t&&(a=t)}return this.detectSupport().then((function(s){if(s)return n.loadTextureImage(t,o.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(t){const e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported}}class je{constructor(t){this.parser=t,this.name=Pe.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(t){const e=this.name,n=this.parser,i=n.json,s=i.textures[t];if(!s.extensions||!s.extensions[e])return null;const o=s.extensions[e],r=i.images[o.source];let a=n.textureLoader;if(r.uri){const t=n.options.manager.getHandler(r.uri);null!==t&&(a=t)}return this.detectSupport().then((function(s){if(s)return n.loadTextureImage(t,o.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(t)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(t){const e=new Image;e.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported}}class Fe{constructor(t){this.name=Pe.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){const t=n.extensions[this.name],i=this.parser.getDependency("buffer",t.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then((function(e){const n=t.byteOffset||0,i=t.byteLength||0,o=t.count,r=t.byteStride,a=new Uint8Array(e,n,i);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(o,r,a,t.mode,t.filter).then((function(t){return t.buffer})):s.ready.then((function(){const e=new ArrayBuffer(o*r);return s.decodeGltfBuffer(new Uint8Array(e),o,r,a,t.mode,t.filter),e}))}))}return null}}class Be{constructor(t){this.name=Pe.EXT_MESH_GPU_INSTANCING,this.parser=t}createNodeMesh(t){const e=this.parser.json,i=e.nodes[t];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const o=e.meshes[i.mesh];for(const n of o.primitives)if(n.mode!==Qe.TRIANGLES&&n.mode!==Qe.TRIANGLE_STRIP&&n.mode!==Qe.TRIANGLE_FAN&&void 0!==n.mode)return null;const r=i.extensions[this.name].attributes,a=[],l={};for(const n in r)a.push(this.parser.getDependency("accessor",r[n]).then((t=>(l[n]=t,l[n]))));return a.length<1?null:(a.push(this.parser.createNodeMesh(t)),Promise.all(a).then((t=>{const e=t.pop(),i=e.isGroup?e.children:[e],o=t[0].count,r=[];for(const a of i){const t=new n,e=new s,i=new nt,h=new s(1,1,1),d=new f(a.geometry,a.material,o);for(let n=0;n<o;n++)l.TRANSLATION&&e.fromBufferAttribute(l.TRANSLATION,n),l.ROTATION&&i.fromBufferAttribute(l.ROTATION,n),l.SCALE&&h.fromBufferAttribute(l.SCALE,n),d.setMatrixAt(n,t.compose(e,i,h));for(const n in l)"TRANSLATION"!==n&&"ROTATION"!==n&&"SCALE"!==n&&a.geometry.setAttribute(n,l[n]);w.prototype.copy.call(d,a),this.parser.assignFinalMaterial(d),r.push(d)}return e.isGroup?(e.clear(),e.add(...r),e):r[0]})))}}const He="glTF",Ke=1313821514,Ue=5130562;class $e{constructor(t){this.name=Pe.KHR_BINARY_GLTF,this.content=null,this.body=null;const e=new DataView(t,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==He)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,s=new DataView(t,12);let o=0;for(;o<i;){const e=s.getUint32(o,!0);o+=4;const i=s.getUint32(o,!0);if(o+=4,i===Ke){const i=new Uint8Array(t,12+o,e);this.content=n.decode(i)}else if(i===Ue){const n=12+o;this.body=t.slice(n,n+e)}o+=e}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Ge{constructor(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Pe.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(t,e){const n=this.json,i=this.dracoLoader,s=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,r={},a={},l={};for(const h in o){const t=sn[h]||h.toLowerCase();r[t]=o[h]}for(const h in t.attributes){const e=sn[h]||h.toLowerCase();if(void 0!==o[h]){const i=n.accessors[t.attributes[h]],s=Je[i.componentType];l[e]=s.name,a[e]=!0===i.normalized}}return e.getDependency("bufferView",s).then((function(t){return new Promise((function(e){i.decodeDracoFile(t,(function(t){for(const e in t.attributes){const n=t.attributes[e],i=a[e];void 0!==i&&(n.normalized=i)}e(t)}),r,l)}))}))}}class qe{constructor(){this.name=Pe.KHR_TEXTURE_TRANSFORM}extendTexture(t,e){return(void 0===e.texCoord||e.texCoord===t.channel)&&void 0===e.offset&&void 0===e.rotation&&void 0===e.scale||(t=t.clone(),void 0!==e.texCoord&&(t.channel=e.texCoord),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),t.needsUpdate=!0),t}}class Ye{constructor(){this.name=Pe.KHR_MESH_QUANTIZATION}}class Xe extends bt{constructor(t,e,n,i){super(t,e,n,i)}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=t*i*3+i;for(let o=0;o!==i;o++)e[o]=n[s+o];return e}interpolate_(t,e,n,i){const s=this.resultBuffer,o=this.sampleValues,r=this.valueSize,a=2*r,l=3*r,h=i-e,d=(n-e)/h,c=d*d,p=c*d,u=t*l,v=u-l,m=-2*p+3*c,g=p-c,b=1-m,_=g-c+d;for(let f=0;f!==r;f++){const t=o[v+f+r],e=o[v+f+a]*h,n=o[u+f+r],i=o[u+f]*h;s[f]=b*t+_*e+m*n+g*i}return s}}const We=new nt;class Ze extends Xe{interpolate_(t,e,n,i){const s=super.interpolate_(t,e,n,i);return We.fromArray(s).normalize().toArray(s),s}}const Qe={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Je={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},tn={9728:it,9729:E,9984:st,9985:ot,9986:rt,9987:P},en={33071:at,33648:lt,10497:k},nn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sn={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},on={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},rn={CUBICSPLINE:void 0,LINEAR:G,STEP:ht},an="OPAQUE",ln="MASK",hn="BLEND";function dn(t,e,n){for(const i in n.extensions)void 0===t[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=n.extensions[i])}function cn(t,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function pn(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(let n=0,i=e.weights.length;n<i;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let e=0,i=n.length;e<i;e++)t.morphTargetDictionary[n[e]]=e}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function un(t){let e;const n=t.extensions&&t.extensions[Pe.KHR_DRACO_MESH_COMPRESSION];if(e=n?"draco:"+n.bufferView+":"+n.indices+":"+vn(n.attributes):t.indices+":"+vn(t.attributes)+":"+t.mode,void 0!==t.targets)for(let i=0,s=t.targets.length;i<s;i++)e+=":"+vn(t.targets[i]);return e}function vn(t){let e="";const n=Object.keys(t).sort();for(let i=0,s=n.length;i<s;i++)e+=n[i]+":"+t[n[i]]+";";return e}function mn(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const gn=new n;class bn{constructor(t={},e={}){this.json=t,this.extensions={},this.plugins={},this.options=e,this.cache=new Ee,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,s=-1;typeof navigator<"u"&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||i&&s<98?this.textureLoader=new l(this.options.manager):this.textureLoader=new x(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new a(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,e){const n=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all(this._invokeAll((function(t){return t.beforeRoot&&t.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(e){const o={scene:e[0][i.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:i.asset,parser:n,userData:{}};dn(s,o,i),cn(o,i),Promise.all(n._invokeAll((function(t){return t.afterRoot&&t.afterRoot(o)}))).then((function(){t(o)}))})).catch(e)}_markDefs(){const t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[];for(let i=0,s=e.length;i<s;i++){const n=e[i].joints;for(let e=0,i=n.length;e<i;e++)t[n[e]].isBone=!0}for(let i=0,s=t.length;i<s;i++){const e=t[i];void 0!==e.mesh&&(this._addNodeRef(this.meshCache,e.mesh),void 0!==e.skin&&(n[e.mesh].isSkinnedMesh=!0)),void 0!==e.camera&&this._addNodeRef(this.cameraCache,e.camera)}}_addNodeRef(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)}_getNodeRef(t,e,n){if(t.refs[e]<=1)return n;const i=n.clone(),s=(t,e)=>{const n=this.associations.get(t);null!=n&&this.associations.set(e,n);for(const[i,o]of t.children.entries())s(o,e.children[i])};return s(n,i),i.name+="_instance_"+t.uses[e]++,i}_invokeOne(t){const e=Object.values(this.plugins);e.push(this);for(let n=0;n<e.length;n++){const i=t(e[n]);if(i)return i}return null}_invokeAll(t){const e=Object.values(this.plugins);e.unshift(this);const n=[];for(let i=0;i<e.length;i++){const s=t(e[i]);s&&n.push(s)}return n}getDependency(t,e){const n=t+":"+e;let i=this.cache.get(n);if(!i){switch(t){case"scene":i=this.loadScene(e);break;case"node":i=this._invokeOne((function(t){return t.loadNode&&t.loadNode(e)}));break;case"mesh":i=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(e)}));break;case"accessor":i=this.loadAccessor(e);break;case"bufferView":i=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(e)}));break;case"buffer":i=this.loadBuffer(e);break;case"material":i=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(e)}));break;case"texture":i=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(e)}));break;case"skin":i=this.loadSkin(e);break;case"animation":i=this._invokeOne((function(t){return t.loadAnimation&&t.loadAnimation(e)}));break;case"camera":i=this.loadCamera(e);break;default:if(i=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(t,e)})),!i)throw new Error("Unknown type: "+t)}this.cache.add(n,i)}return i}getDependencies(t){let e=this.cache.get(t);if(!e){const n=this,i=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(i.map((function(e,i){return n.getDependency(t,i)}))),this.cache.add(t,e)}return e}loadBuffer(t){const e=this.json.buffers[t],n=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[Pe.KHR_BINARY_GLTF].body);const i=this.options;return new Promise((function(t,s){n.load(c.resolveURL(e.uri,i.path),t,void 0,(function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))}loadBufferView(t){const e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){const n=e.byteLength||0,i=e.byteOffset||0;return t.slice(i,i+n)}))}loadAccessor(t){const e=this,n=this.json,i=this.json.accessors[t];if(void 0===i.bufferView&&void 0===i.sparse){const t=nn[i.type],e=Je[i.componentType],n=!0===i.normalized,s=new e(i.count*t);return Promise.resolve(new y(s,t,n))}const s=[];return void 0!==i.bufferView?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),void 0!==i.sparse&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then((function(t){const s=t[0],o=nn[i.type],r=Je[i.componentType],a=r.BYTES_PER_ELEMENT,l=a*o,h=i.byteOffset||0,d=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,c=!0===i.normalized;let p,u;if(d&&d!==l){const t=Math.floor(h/d),n="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+t+":"+i.count;let l=e.cache.get(n);l||(p=new r(s,t*d,i.count*d/a),l=new C(p,d/a),e.cache.add(n,l)),u=new ct(l,o,h%d/a,c)}else p=null===s?new r(i.count*o):new r(s,h,i.count*o),u=new y(p,o,c);if(void 0!==i.sparse){const e=nn.SCALAR,n=Je[i.sparse.indices.componentType],a=i.sparse.indices.byteOffset||0,l=i.sparse.values.byteOffset||0,h=new n(t[1],a,i.sparse.count*e),d=new r(t[2],l,i.sparse.count*o);null!==s&&(u=new y(u.array.slice(),u.itemSize,u.normalized));for(let t=0,i=h.length;t<i;t++){const e=h[t];if(u.setX(e,d[t*o]),o>=2&&u.setY(e,d[t*o+1]),o>=3&&u.setZ(e,d[t*o+2]),o>=4&&u.setW(e,d[t*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return u}))}loadTexture(t){const e=this.json,n=this.options,i=e.textures[t].source,s=e.images[i];let o=this.textureLoader;if(s.uri){const t=n.manager.getHandler(s.uri);null!==t&&(o=t)}return this.loadTextureImage(t,i,o)}loadTextureImage(t,e,n){const i=this,s=this.json,o=s.textures[t],r=s.images[e],a=(r.uri||r.bufferView)+":"+o.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(e,n).then((function(e){e.flipY=!1,e.name=o.name||r.name||"",""===e.name&&"string"==typeof r.uri&&!1===r.uri.startsWith("data:image/")&&(e.name=r.uri);const n=(s.samplers||{})[o.sampler]||{};return e.magFilter=tn[n.magFilter]||E,e.minFilter=tn[n.minFilter]||P,e.wrapS=en[n.wrapS]||k,e.wrapT=en[n.wrapT]||k,i.associations.set(e,{textures:t}),e})).catch((function(){return null}));return this.textureCache[a]=l,l}loadImageSource(t,e){const n=this.json,i=this.options;if(void 0!==this.sourceCache[t])return this.sourceCache[t].then((t=>t.clone()));const s=n.images[t],o=self.URL||self.webkitURL;let r=s.uri||"",a=!1;if(void 0!==s.bufferView)r=this.getDependency("bufferView",s.bufferView).then((function(t){a=!0;const e=new Blob([t],{type:s.mimeType});return r=o.createObjectURL(e),r}));else if(void 0===s.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const l=Promise.resolve(r).then((function(t){return new Promise((function(n,s){let o=n;!0===e.isImageBitmapLoader&&(o=function(t){const e=new A(t);e.needsUpdate=!0,n(e)}),e.load(c.resolveURL(t,i.path),o,void 0,s)}))})).then((function(t){return!0===a&&o.revokeObjectURL(r),t.userData.mimeType=s.mimeType||((e=s.uri).search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/)?"image/jpeg":e.search(/\.webp($|\?)/i)>0||0===e.search(/^data\:image\/webp/)?"image/webp":"image/png"),t;var e})).catch((function(t){throw console.error("THREE.GLTFLoader: Couldn't load texture",r),t}));return this.sourceCache[t]=l,l}assignTexture(t,e,n,i){const s=this;return this.getDependency("texture",n.index).then((function(o){if(!o)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((o=o.clone()).channel=n.texCoord),s.extensions[Pe.KHR_TEXTURE_TRANSFORM]){const t=void 0!==n.extensions?n.extensions[Pe.KHR_TEXTURE_TRANSFORM]:void 0;if(t){const e=s.associations.get(o);o=s.extensions[Pe.KHR_TEXTURE_TRANSFORM].extendTexture(o,t),s.associations.set(o,e)}}return void 0!==i&&(o.colorSpace=i),t[e]=o,o}))}assignFinalMaterial(t){const e=t.geometry;let n=t.material;const i=void 0===e.attributes.tangent,s=void 0!==e.attributes.color,o=void 0===e.attributes.normal;if(t.isPoints){const t="PointsMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new L,M.prototype.copy.call(e,n),e.color.copy(n.color),e.map=n.map,e.sizeAttenuation=!1,this.cache.add(t,e)),n=e}else if(t.isLine){const t="LineBasicMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new I,M.prototype.copy.call(e,n),e.color.copy(n.color),e.map=n.map,this.cache.add(t,e)),n=e}if(i||s||o){let t="ClonedMaterial:"+n.uuid+":";i&&(t+="derivative-tangents:"),s&&(t+="vertex-colors:"),o&&(t+="flat-shading:");let e=this.cache.get(t);e||(e=n.clone(),s&&(e.vertexColors=!0),o&&(e.flatShading=!0),i&&(e.normalScale&&(e.normalScale.y*=-1),e.clearcoatNormalScale&&(e.clearcoatNormalScale.y*=-1)),this.cache.add(t,e),this.associations.set(e,this.associations.get(n))),n=e}t.material=n}getMaterialType(){return T}loadMaterial(t){const e=this,n=this.json,s=this.extensions,o=n.materials[t];let r;const a={},l=[];if((o.extensions||{})[Pe.KHR_MATERIALS_UNLIT]){const t=s[Pe.KHR_MATERIALS_UNLIT];r=t.getMaterialType(),l.push(t.extendParams(a,o,e))}else{const n=o.pbrMetallicRoughness||{};if(a.color=new i(1,1,1),a.opacity=1,Array.isArray(n.baseColorFactor)){const t=n.baseColorFactor;a.color.fromArray(t),a.opacity=t[3]}void 0!==n.baseColorTexture&&l.push(e.assignTexture(a,"map",n.baseColorTexture,g)),a.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,a.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(l.push(e.assignTexture(a,"metalnessMap",n.metallicRoughnessTexture)),l.push(e.assignTexture(a,"roughnessMap",n.metallicRoughnessTexture))),r=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),l.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,a)}))))}!0===o.doubleSided&&(a.side=z);const h=o.alphaMode||an;if(h===hn?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===ln&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&r!==m&&(l.push(e.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new _(1,1),void 0!==o.normalTexture.scale)){const t=o.normalTexture.scale;a.normalScale.set(t,t)}return void 0!==o.occlusionTexture&&r!==m&&(l.push(e.assignTexture(a,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&r!==m&&(a.emissive=(new i).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&r!==m&&l.push(e.assignTexture(a,"emissiveMap",o.emissiveTexture,g)),Promise.all(l).then((function(){const n=new r(a);return o.name&&(n.name=o.name),cn(n,o),e.associations.set(n,{materials:t}),o.extensions&&dn(s,n,o),n}))}createUniqueName(t){const e=S.sanitizeNodeName(t||"");return e in this.nodeNamesUsed?e+"_"+ ++this.nodeNamesUsed[e]:(this.nodeNamesUsed[e]=0,e)}loadGeometries(t){const e=this,n=this.extensions,i=this.primitiveCache;function s(t){return n[Pe.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(n){return _n(n,t,e)}))}const o=[];for(let r=0,a=t.length;r<a;r++){const n=t[r],a=un(n),l=i[a];if(l)o.push(l.promise);else{let t;t=n.extensions&&n.extensions[Pe.KHR_DRACO_MESH_COMPRESSION]?s(n):_n(new V,n,e),i[a]={primitive:n,promise:t},o.push(t)}}return Promise.all(o)}loadMesh(t){const e=this,n=this.json,i=this.extensions,s=n.meshes[t],o=s.primitives,r=[];for(let l=0,h=o.length;l<h;l++){const t=void 0===o[l].material?(void 0===(a=this.cache).DefaultMaterial&&(a.DefaultMaterial=new T({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:dt})),a.DefaultMaterial):this.getDependency("material",o[l].material);r.push(t)}var a;return r.push(e.loadGeometries(o)),Promise.all(r).then((function(n){const r=n.slice(0,n.length-1),a=n[n.length-1],l=[];for(let d=0,c=a.length;d<c;d++){const n=a[d],h=o[d];let c;const p=r[d];if(h.mode===Qe.TRIANGLES||h.mode===Qe.TRIANGLE_STRIP||h.mode===Qe.TRIANGLE_FAN||void 0===h.mode)c=!0===s.isSkinnedMesh?new R(n,p):new D(n,p),!0===c.isSkinnedMesh&&c.normalizeSkinWeights(),h.mode===Qe.TRIANGLE_STRIP?c.geometry=ye(c.geometry,et):h.mode===Qe.TRIANGLE_FAN&&(c.geometry=ye(c.geometry,tt));else if(h.mode===Qe.LINES)c=new N(n,p);else if(h.mode===Qe.LINE_STRIP)c=new O(n,p);else if(h.mode===Qe.LINE_LOOP)c=new j(n,p);else{if(h.mode!==Qe.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);c=new F(n,p)}Object.keys(c.geometry.morphAttributes).length>0&&pn(c,s),c.name=e.createUniqueName(s.name||"mesh_"+t),cn(c,s),h.extensions&&dn(i,c,h),e.assignFinalMaterial(c),l.push(c)}for(let i=0,s=l.length;i<s;i++)e.associations.set(l[i],{meshes:t,primitives:i});if(1===l.length)return s.extensions&&dn(i,l[0],s),l[0];const h=new B;s.extensions&&dn(i,h,s),e.associations.set(h,{meshes:t});for(let t=0,e=l.length;t<e;t++)h.add(l[t]);return h}))}loadCamera(t){let e;const n=this.json.cameras[t],i=n[n.type];if(i)return"perspective"===n.type?e=new H(K.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(e=new U(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),cn(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(t){const e=this.json.skins[t],i=[];for(let n=0,s=e.joints.length;n<s;n++)i.push(this._loadNodeShallow(e.joints[n]));return void 0!==e.inverseBindMatrices?i.push(this.getDependency("accessor",e.inverseBindMatrices)):i.push(null),Promise.all(i).then((function(t){const i=t.pop(),s=t,o=[],r=[];for(let a=0,l=s.length;a<l;a++){const t=s[a];if(t){o.push(t);const e=new n;null!==i&&e.fromArray(i.array,16*a),r.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[a])}return new $(o,r)}))}loadAnimation(t){const e=this.json.animations[t],n=e.name?e.name:"animation_"+t,i=[],s=[],o=[],r=[],a=[];for(let l=0,h=e.channels.length;l<h;l++){const t=e.channels[l],n=e.samplers[t.sampler],h=t.target,d=h.node,c=void 0!==e.parameters?e.parameters[n.input]:n.input,p=void 0!==e.parameters?e.parameters[n.output]:n.output;void 0!==h.node&&(i.push(this.getDependency("node",d)),s.push(this.getDependency("accessor",c)),o.push(this.getDependency("accessor",p)),r.push(n),a.push(h))}return Promise.all([Promise.all(i),Promise.all(s),Promise.all(o),Promise.all(r),Promise.all(a)]).then((function(t){const e=t[0],i=t[1],s=t[2],o=t[3],r=t[4],a=[];for(let n=0,l=e.length;n<l;n++){const t=e[n],l=i[n],h=s[n],d=o[n],c=r[n];if(void 0===t)continue;let p;switch(t.updateMatrix(),on[c.path]){case on.weights:p=vt;break;case on.rotation:p=ut;break;default:p=pt}const u=t.name?t.name:t.uuid,v=void 0!==d.interpolation?rn[d.interpolation]:G,m=[];on[c.path]===on.weights?t.traverse((function(t){t.morphTargetInfluences&&m.push(t.name?t.name:t.uuid)})):m.push(u);let g=h.array;if(h.normalized){const t=mn(g.constructor),e=new Float32Array(g.length);for(let n=0,i=g.length;n<i;n++)e[n]=g[n]*t;g=e}for(let e=0,n=m.length;e<n;e++){const t=new p(m[e]+"."+on[c.path],l.array,g,v);"CUBICSPLINE"===d.interpolation&&(t.createInterpolant=function(t){return new(this instanceof ut?Ze:Xe)(this.times,this.values,this.getValueSize()/3,t)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),a.push(t)}}return new q(n,void 0,a)}))}createNodeMesh(t){const e=this.json,n=this,i=e.nodes[t];return void 0===i.mesh?null:n.getDependency("mesh",i.mesh).then((function(t){const e=n._getNodeRef(n.meshCache,i.mesh,t);return void 0!==i.weights&&e.traverse((function(t){if(t.isMesh)for(let e=0,n=i.weights.length;e<n;e++)t.morphTargetInfluences[e]=i.weights[e]})),e}))}loadNode(t){const e=this,n=this.json.nodes[t],i=e._loadNodeShallow(t),s=[],o=n.children||[];for(let a=0,l=o.length;a<l;a++)s.push(e.getDependency("node",o[a]));const r=void 0===n.skin?Promise.resolve(null):e.getDependency("skin",n.skin);return Promise.all([i,Promise.all(s),r]).then((function(t){const e=t[0],n=t[1],i=t[2];null!==i&&e.traverse((function(t){t.isSkinnedMesh&&t.bind(i,gn)}));for(let s=0,o=n.length;s<o;s++)e.add(n[s]);return e}))}_loadNodeShallow(t){const e=this.json,i=this.extensions,s=this;if(void 0!==this.nodeCache[t])return this.nodeCache[t];const o=e.nodes[t],r=o.name?s.createUniqueName(o.name):"",a=[],l=s._invokeOne((function(e){return e.createNodeMesh&&e.createNodeMesh(t)}));return l&&a.push(l),void 0!==o.camera&&a.push(s.getDependency("camera",o.camera).then((function(t){return s._getNodeRef(s.cameraCache,o.camera,t)}))),s._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(t){a.push(t)})),this.nodeCache[t]=Promise.all(a).then((function(e){let a;if(a=!0===o.isBone?new Y:e.length>1?new B:1===e.length?e[0]:new w,a!==e[0])for(let t=0,n=e.length;t<n;t++)a.add(e[t]);if(o.name&&(a.userData.name=o.name,a.name=r),cn(a,o),o.extensions&&dn(i,a,o),void 0!==o.matrix){const t=new n;t.fromArray(o.matrix),a.applyMatrix4(t)}else void 0!==o.translation&&a.position.fromArray(o.translation),void 0!==o.rotation&&a.quaternion.fromArray(o.rotation),void 0!==o.scale&&a.scale.fromArray(o.scale);return s.associations.has(a)||s.associations.set(a,{}),s.associations.get(a).nodes=t,a})),this.nodeCache[t]}loadScene(t){const e=this.extensions,n=this.json.scenes[t],i=this,s=new B;n.name&&(s.name=i.createUniqueName(n.name)),cn(s,n),n.extensions&&dn(e,s,n);const o=n.nodes||[],r=[];for(let a=0,l=o.length;a<l;a++)r.push(i.getDependency("node",o[a]));return Promise.all(r).then((function(t){for(let e=0,n=t.length;e<n;e++)s.add(t[e]);return i.associations=(t=>{const e=new Map;for(const[n,s]of i.associations)(n instanceof M||n instanceof A)&&e.set(n,s);return t.traverse((t=>{const n=i.associations.get(t);null!=n&&e.set(t,n)})),e})(s),s}))}}function _n(t,e,n){const i=e.attributes,o=[];function r(e,i){return n.getDependency("accessor",e).then((function(e){t.setAttribute(i,e)}))}for(const s in i){const e=sn[s]||s.toLowerCase();e in t.attributes||o.push(r(i[s],e))}if(void 0!==e.indices&&!t.index){const i=n.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));o.push(i)}return cn(t,e),function(t,e,n){const i=e.attributes,o=new mt;if(void 0===i.POSITION)return;{const t=n.json.accessors[i.POSITION],e=t.min,r=t.max;if(void 0===e||void 0===r)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(o.set(new s(e[0],e[1],e[2]),new s(r[0],r[1],r[2])),t.normalized){const e=mn(Je[t.componentType]);o.min.multiplyScalar(e),o.max.multiplyScalar(e)}}const r=e.targets;if(void 0!==r){const t=new s,e=new s;for(let i=0,s=r.length;i<s;i++){const s=r[i];if(void 0!==s.POSITION){const i=n.json.accessors[s.POSITION],o=i.min,r=i.max;if(void 0!==o&&void 0!==r){if(e.setX(Math.max(Math.abs(o[0]),Math.abs(r[0]))),e.setY(Math.max(Math.abs(o[1]),Math.abs(r[1]))),e.setZ(Math.max(Math.abs(o[2]),Math.abs(r[2]))),i.normalized){const t=mn(Je[i.componentType]);e.multiplyScalar(t)}t.max(e)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(t)}t.boundingBox=o;const a=new gt;o.getCenter(a.center),a.radius=o.min.distanceTo(o.max)/2,t.boundingSphere=a}(t,e,n),Promise.all(o).then((function(){return void 0!==e.targets?function(t,e,n){let i=!1,s=!1,o=!1;for(let h=0,d=e.length;h<d;h++){const t=e[h];if(void 0!==t.POSITION&&(i=!0),void 0!==t.NORMAL&&(s=!0),void 0!==t.COLOR_0&&(o=!0),i&&s&&o)break}if(!i&&!s&&!o)return Promise.resolve(t);const r=[],a=[],l=[];for(let h=0,d=e.length;h<d;h++){const d=e[h];if(i){const e=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):t.attributes.position;r.push(e)}if(s){const e=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):t.attributes.normal;a.push(e)}if(o){const e=void 0!==d.COLOR_0?n.getDependency("accessor",d.COLOR_0):t.attributes.color;l.push(e)}}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(l)]).then((function(e){const n=e[0],r=e[1],a=e[2];return i&&(t.morphAttributes.position=n),s&&(t.morphAttributes.normal=r),o&&(t.morphAttributes.color=a),t.morphTargetsRelative=!0,t}))}(t,e.targets,n):t}))}const fn={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};async function wn(t){const e=await fetch(t);if(e.ok)return e.json();throw new Error(e.statusText)}async function xn(t,e,n=null,i=!0){if(!t)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const s=await async function(t){if(!t)throw new Error("No basePath supplied");return await wn(`${t}/profilesList.json`)}(e);let o;if(t.profiles.some((t=>{const n=s[t];return n&&(o={profileId:t,profilePath:`${e}/${n.path}`,deprecated:!!n.deprecated}),!!o})),!o){if(!n)throw new Error("No matching profile name found");const t=s[n];if(!t)throw new Error(`No matching profile name found and default profile "${n}" missing.`);o={profileId:n,profilePath:`${e}/${t.path}`,deprecated:!!t.deprecated}}const r=await wn(o.profilePath);let a;if(i){let e;if(e="any"===t.handedness?r.layouts[Object.keys(r.layouts)[0]]:r.layouts[t.handedness],!e)throw new Error(`No matching handedness, ${t.handedness}, in profile ${o.profileId}`);e.assetPath&&(a=o.profilePath.replace("profile.json",e.assetPath))}return{profile:r,assetPath:a}}const yn={xAxis:0,yAxis:0,button:0,state:fn.ComponentState.DEFAULT};class Cn{constructor(t){this.componentProperty=t.componentProperty,this.states=t.states,this.valueNodeName=t.valueNodeName,this.valueNodeProperty=t.valueNodeProperty,this.valueNodeProperty===fn.VisualResponseProperty.TRANSFORM&&(this.minNodeName=t.minNodeName,this.maxNodeName=t.maxNodeName),this.value=0,this.updateFromComponent(yn)}updateFromComponent({xAxis:t,yAxis:e,button:n,state:i}){const{normalizedXAxis:s,normalizedYAxis:o}=function(t=0,e=0){let n=t,i=e;if(Math.sqrt(t*t+e*e)>1){const s=Math.atan2(e,t);n=Math.cos(s),i=Math.sin(s)}return{normalizedXAxis:.5*n+.5,normalizedYAxis:.5*i+.5}}(t,e);switch(this.componentProperty){case fn.ComponentProperty.X_AXIS:this.value=this.states.includes(i)?s:.5;break;case fn.ComponentProperty.Y_AXIS:this.value=this.states.includes(i)?o:.5;break;case fn.ComponentProperty.BUTTON:this.value=this.states.includes(i)?n:0;break;case fn.ComponentProperty.STATE:this.valueNodeProperty===fn.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(i):this.value=this.states.includes(i)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class En{constructor(t,e){if(!(t&&e&&e.visualResponses&&e.gamepadIndices&&0!==Object.keys(e.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=t,this.type=e.type,this.rootNodeName=e.rootNodeName,this.touchPointNodeName=e.touchPointNodeName,this.visualResponses={},Object.keys(e.visualResponses).forEach((t=>{const n=new Cn(e.visualResponses[t]);this.visualResponses[t]=n})),this.gamepadIndices=Object.assign({},e.gamepadIndices),this.values={state:fn.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(t){if(this.values.state=fn.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&t.buttons.length>this.gamepadIndices.button){const e=t.buttons[this.gamepadIndices.button];this.values.button=e.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,e.pressed||1===this.values.button?this.values.state=fn.ComponentState.PRESSED:(e.touched||this.values.button>fn.ButtonTouchThreshold)&&(this.values.state=fn.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&t.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=t.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===fn.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>fn.AxisTouchThreshold&&(this.values.state=fn.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&t.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=t.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===fn.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>fn.AxisTouchThreshold&&(this.values.state=fn.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach((t=>{t.updateFromComponent(this.values)}))}}class Pn{constructor(t,e,n){if(!t)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No profile supplied");this.xrInputSource=t,this.assetUrl=n,this.id=e.profileId,this.layoutDescription=e.layouts[t.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach((t=>{const e=this.layoutDescription.components[t];this.components[t]=new En(t,e)})),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const t=[];return Object.values(this.components).forEach((e=>{t.push(e.data)})),t}updateFromGamepad(){Object.values(this.components).forEach((t=>{t.updateFromGamepad(this.xrInputSource.gamepad)}))}}class kn extends w{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(t){return this.envMap==t||(this.envMap=t,this.traverse((t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)}))),this}updateMatrixWorld(t){super.updateMatrixWorld(t),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach((t=>{Object.values(t.visualResponses).forEach((t=>{const{valueNode:e,minNode:n,maxNode:i,value:s,valueNodeProperty:o}=t;e&&(o===fn.VisualResponseProperty.VISIBILITY?e.visible=s:o===fn.VisualResponseProperty.TRANSFORM&&(e.quaternion.slerpQuaternions(n.quaternion,i.quaternion,s),e.position.lerpVectors(n.position,i.position,s)))}))})))}}function An(t,e){(function(t,e){Object.values(t.components).forEach((t=>{const{type:n,touchPointNodeName:i,visualResponses:s}=t;if(n===fn.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(i),t.touchPointNode){const e=new _t(.001),n=new m({color:255}),i=new D(e,n);t.touchPointNode.add(i)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach((t=>{const{valueNodeName:n,minNodeName:i,maxNodeName:s,valueNodeProperty:o}=t;if(o===fn.VisualResponseProperty.TRANSFORM){if(t.minNode=e.getObjectByName(i),t.maxNode=e.getObjectByName(s),!t.minNode)return void console.warn(`Could not find ${i} in the model`);if(!t.maxNode)return void console.warn(`Could not find ${s} in the model`)}t.valueNode=e.getObjectByName(n),t.valueNode||console.warn(`Could not find ${n} in the model`)}))}))})(t.motionController,e),t.envMap&&e.traverse((e=>{e.isMesh&&(e.material.envMap=t.envMap,e.material.needsUpdate=!0)})),t.add(e)}new i;new s;const Ln=(t,e)=>{if(0===e)return t;const n=t.replace("#","");let i=Number.parseInt(n.substring(0,2),16),s=Number.parseInt(n.substring(2,4),16),o=Number.parseInt(n.substring(4,6),16);i=Math.round(i*(1-e/100)),s=Math.round(s*(1-e/100)),o=Math.round(o*(1-e/100)),i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o;return`#${`${i<16?"0":""}${i.toString(16)}`}${`${s<16?"0":""}${s.toString(16)}`}${`${o<16?"0":""}${o.toString(16)}`}`},Mn="#ff3653",In="#8adb00",Tn="#2c8fff",zn=Ln(Mn,50),Sn=Ln(In,50),Vn=Ln(Tn,50),Rn=128*window.devicePixelRatio,Dn=3*Math.PI,Nn=new nt,On=new nt,jn=new o(.8,.05,.05).translate(.4,0,0),Fn=t=>{const{context:e,text:n}=t.userData;e.beginPath(),e.arc(32,32,16,0,2*Math.PI),e.closePath(),e.fillStyle=t.userData.color,e.fill(),""!==n&&(e.font="bold 23px system-ui",e.textAlign="center",e.fillStyle="#000000",e.fillText(n,32,41)),t.material.needsUpdate=!0,t.material.map.needsUpdate=!0},Bn=t=>{const e=new m({color:t,toneMapped:!1});return new D(jn,e)},Hn=(t,e="")=>{const n=document.createElement("canvas");n.width=64,n.height=64;const i=n.getContext("2d"),s=new At(n),o=new Lt({map:s,toneMapped:!1}),r=new kt(o);return r.userData.color=t,r.userData.text=e,r.userData.context=i,Fn(r),r};class Kn extends w{constructor(t,n){super(),e(this,"isViewHelper",!0),e(this,"animating",!1),e(this,"center",new s),e(this,"point",new s),e(this,"viewport",new Ct),e(this,"targetQuaternion",new nt),e(this,"radius",0),e(this,"orthoCamera",new U(-2,2,2,-2,-4,4)),e(this,"axes"),e(this,"btns"),e(this,"camera"),e(this,"renderer"),e(this,"render",(t=>{if(this.animating){const e=t*Dn/1e3;Nn.rotateTowards(On,e),this.camera.position.set(0,0,1).applyQuaternion(Nn).multiplyScalar(this.radius).add(this.center),this.camera.quaternion.rotateTowards(this.targetQuaternion,e),0===Nn.angleTo(On)&&(this.animating=!1)}this.quaternion.copy(this.camera.quaternion).invert(),this.updateMatrixWorld();const{x:e,y:n,z:i}=this.point.set(0,0,1).applyQuaternion(this.camera.quaternion);this.btns[0].userData.color=e>=0?Mn:zn,this.btns[1].userData.color=n>=0?In:Sn,this.btns[2].userData.color=i>=0?Tn:Vn,this.btns[3].userData.color=e<0?Mn:zn,this.btns[4].userData.color=n<0?In:Sn,this.btns[5].userData.color=i<0?Tn:Vn;for(const s of this.btns)Fn(s);console.log(this.btns[0].userData);{const t=this.renderer.domElement.offsetWidth*window.devicePixelRatio-Rn,e=this.renderer.domElement.offsetHeight*window.devicePixelRatio-Rn,{autoClear:n,outputColorSpace:i}=this.renderer;this.renderer.autoClear=!1,this.renderer.outputColorSpace="srgb-linear",this.renderer.getViewport(this.viewport),this.renderer.setViewport(t,e,Rn,Rn),this.renderer.render(this,this.orthoCamera),this.renderer.setViewport(this.viewport),this.renderer.autoClear=n,this.renderer.outputColorSpace=i}})),e(this,"dispose",(()=>{var t;for(let e of[...this.axes,...this.btns])e instanceof kt&&(null==(t=e.material.map)||t.dispose()),e.material instanceof M&&e.material.dispose()})),this.camera=t,this.renderer=n;const i=new _,o=new w;this.orthoCamera.position.set(0,0,2),this.axes=[Bn(Mn),Bn(In),Bn(Tn)],this.btns=[Hn(Mn,"X"),Hn(In,"Y"),Hn(Tn,"Z"),Hn(Mn),Hn(In),Hn(Tn)],this.axes[1].rotation.z=Math.PI/2,this.axes[2].rotation.y=-Math.PI/2,this.btns[0].position.x=1,this.btns[1].position.y=1,this.btns[2].position.z=1,this.btns[3].position.x=-1,this.btns[4].position.y=-1,this.btns[5].position.z=-1,this.btns[3].scale.setScalar(.8),this.btns[4].scale.setScalar(.8),this.btns[5].scale.setScalar(.8),this.add(...this.axes,...this.btns);const r=[...this.btns],a=new s,l=new Et;n.domElement.addEventListener("click",(t=>{if(!0===this.animating)return!1;const{domElement:e}=n,s=e.getBoundingClientRect();i.x=t.clientX-s.left-s.width+128,i.y=t.clientY-s.top,i.x=i.x/128*2-1,i.y=i.y/128*2-1,l.setFromCamera(i,this.orthoCamera);const o=l.intersectObjects(r),[a]=o;if(console.log(a),a){const t=a.object;return d(t,this.center),this.animating=!0,!0}return!1}));const h=new Pt,d=(e,n)=>{1===e.position.x?(a.set(1,0,0),this.targetQuaternion.setFromEuler(h.set(0,.5*Math.PI,0))):1===e.position.y?(a.set(0,1,0),this.targetQuaternion.setFromEuler(h.set(.5*-Math.PI,0,0))):1===e.position.z?(a.set(0,0,1),this.targetQuaternion.setFromEuler(h.set(0,0,0))):-1===e.position.x?(a.set(-1,0,0),this.targetQuaternion.setFromEuler(h.set(0,.5*-Math.PI,0))):-1===e.position.y?(a.set(0,-1,0),this.targetQuaternion.setFromEuler(h.set(.5*Math.PI,0,0))):-1===e.position.z&&(a.set(0,0,-1),this.targetQuaternion.setFromEuler(h.set(0,Math.PI,0))),this.radius=t.position.distanceTo(n),a.multiplyScalar(this.radius).add(n),o.position.copy(n),o.lookAt(t.position),Nn.copy(o.quaternion),o.lookAt(a),On.copy(o.quaternion)}}}new s,new s,new s,performance.now(),performance.now(),Z.enabled=!0,Q.enabled=!0,new r,new a,new Ce,new l;const Un=(t,e)=>localStorage.setItem(t,JSON.stringify(e)),$n=t=>{try{return JSON.parse(localStorage.getItem(t)??"null")}catch{return null}};new class{constructor(t=null){this.gltfLoader=t,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new Ce)}createControllerModel(t){const e=new kn;let n=null;return t.addEventListener("connected",(t=>{const i=t.data;"tracked-pointer"!==i.targetRayMode||!i.gamepad||xn(i,this.path,"generic-trigger").then((({profile:t,assetPath:s})=>{e.motionController=new Pn(i,t,s);const o=this._assetCache[e.motionController.assetUrl];if(o)n=o.scene.clone(),An(e,n);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(e.motionController.assetUrl,(t=>{this._assetCache[e.motionController.assetUrl]=t,n=t.scene.clone(),An(e,n)}),null,(()=>{throw new Error(`Asset ${e.motionController.assetUrl} missing or malformed.`)}))}})).catch((t=>{console.warn(t)}))})),t.addEventListener("disconnected",(()=>{e.motionController=null,e.remove(n),n=null})),e}},new n;const Gn=xe.FolderApi.prototype.addFolder,qn=xe.FolderApi.prototype.dispose;xe.FolderApi.prototype.addFolder=function(t){const e=`${String(t.index??-1)}.${t.title}`,n=Gn.call(this,{expanded:null!==$n(`pane.${e}`),...t});return n.element.id=e,n.on("fold",(t=>{const n=`pane.${e}`;t.expanded?Un(n,!0):Un(n,null)})),n},xe.FolderApi.prototype.dispose=function(){qn.call(this)};const Yn={type:"change"},Xn={type:"start"},Wn={type:"end"};class Zn extends ft{constructor(t,e){super(),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new s,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:wt.ROTATE,MIDDLE:wt.DOLLY,RIGHT:wt.PAN},this.touches={ONE:xt.ROTATE,TWO:xt.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",U),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",U),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(Yn),n.update(),o=i.NONE},this.update=function(){const e=new s,p=(new nt).setFromUnitVectors(t.up,new s(0,1,0)),u=p.clone().invert(),v=new s,m=new nt,g=new s,b=2*Math.PI;return function(){const t=n.object.position;e.copy(t).sub(n.target),e.applyQuaternion(p),a.setFromVector3(e),n.autoRotate&&o===i.NONE&&P(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(a.theta+=l.theta*n.dampingFactor,a.phi+=l.phi*n.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let s=n.minAzimuthAngle,_=n.maxAzimuthAngle;return isFinite(s)&&isFinite(_)&&(s<-Math.PI?s+=b:s>Math.PI&&(s-=b),_<-Math.PI?_+=b:_>Math.PI&&(_-=b),a.theta=s<=_?Math.max(s,Math.min(_,a.theta)):a.theta>(s+_)/2?Math.max(s,a.theta):Math.min(_,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=h,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),!0===n.enableDamping?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),e.setFromSpherical(a),e.applyQuaternion(u),t.copy(n.target).add(e),n.object.lookAt(n.target),!0===n.enableDamping?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),d.set(0,0,0)),h=1,!!(c||v.distanceToSquared(n.object.position)>r||8*(1-m.dot(n.object.quaternion))>r||g.distanceToSquared(n.target)>0)&&(n.dispatchEvent(Yn),v.copy(n.object.position),m.copy(n.object.quaternion),g.copy(n.target),c=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",$),n.domElement.removeEventListener("pointerdown",F),n.domElement.removeEventListener("pointercancel",H),n.domElement.removeEventListener("wheel",K),n.domElement.removeEventListener("pointermove",B),n.domElement.removeEventListener("pointerup",H),null!==n._domElementKeyEvents&&(n._domElementKeyEvents.removeEventListener("keydown",U),n._domElementKeyEvents=null)};const n=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=i.NONE;const r=1e-6,a=new yt,l=new yt;let h=1;const d=new s;let c=!1;const p=new _,u=new _,v=new _,m=new _,g=new _,b=new _,f=new _,w=new _,x=new _,y=[],C={};function E(){return Math.pow(.95,n.zoomSpeed)}function P(t){l.theta-=t}function k(t){l.phi-=t}const A=function(){const t=new s;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),d.add(t)}}(),L=function(){const t=new s;return function(e,i){!0===n.screenSpacePanning?t.setFromMatrixColumn(i,1):(t.setFromMatrixColumn(i,0),t.crossVectors(n.object.up,t)),t.multiplyScalar(e),d.add(t)}}(),M=function(){const t=new s;return function(e,i){const s=n.domElement;if(n.object.isPerspectiveCamera){const o=n.object.position;t.copy(o).sub(n.target);let r=t.length();r*=Math.tan(n.object.fov/2*Math.PI/180),A(2*e*r/s.clientHeight,n.object.matrix),L(2*i*r/s.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(A(e*(n.object.right-n.object.left)/n.object.zoom/s.clientWidth,n.object.matrix),L(i*(n.object.top-n.object.bottom)/n.object.zoom/s.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function I(t){n.object.isPerspectiveCamera?h/=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*t)),n.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function T(t){n.object.isPerspectiveCamera?h*=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/t)),n.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function z(t){p.set(t.clientX,t.clientY)}function S(t){m.set(t.clientX,t.clientY)}function V(){if(1===y.length)p.set(y[0].pageX,y[0].pageY);else{const t=.5*(y[0].pageX+y[1].pageX),e=.5*(y[0].pageY+y[1].pageY);p.set(t,e)}}function R(){if(1===y.length)m.set(y[0].pageX,y[0].pageY);else{const t=.5*(y[0].pageX+y[1].pageX),e=.5*(y[0].pageY+y[1].pageY);m.set(t,e)}}function D(){const t=y[0].pageX-y[1].pageX,e=y[0].pageY-y[1].pageY,n=Math.sqrt(t*t+e*e);f.set(0,n)}function N(t){if(1==y.length)u.set(t.pageX,t.pageY);else{const e=q(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);u.set(n,i)}v.subVectors(u,p).multiplyScalar(n.rotateSpeed);const e=n.domElement;P(2*Math.PI*v.x/e.clientHeight),k(2*Math.PI*v.y/e.clientHeight),p.copy(u)}function O(t){if(1===y.length)g.set(t.pageX,t.pageY);else{const e=q(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);g.set(n,i)}b.subVectors(g,m).multiplyScalar(n.panSpeed),M(b.x,b.y),m.copy(g)}function j(t){const e=q(t),i=t.pageX-e.x,s=t.pageY-e.y,o=Math.sqrt(i*i+s*s);w.set(0,o),x.set(0,Math.pow(w.y/f.y,n.zoomSpeed)),I(x.y),f.copy(w)}function F(t){!1!==n.enabled&&(0===y.length&&(n.domElement.setPointerCapture(t.pointerId),n.domElement.addEventListener("pointermove",B),n.domElement.addEventListener("pointerup",H)),function(t){y.push(t)}(t),"touch"===t.pointerType?function(t){switch(G(t),y.length){case 1:switch(n.touches.ONE){case xt.ROTATE:if(!1===n.enableRotate)return;V(),o=i.TOUCH_ROTATE;break;case xt.PAN:if(!1===n.enablePan)return;R(),o=i.TOUCH_PAN;break;default:o=i.NONE}break;case 2:switch(n.touches.TWO){case xt.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&D(),n.enablePan&&R(),o=i.TOUCH_DOLLY_PAN;break;case xt.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&D(),n.enableRotate&&V(),o=i.TOUCH_DOLLY_ROTATE;break;default:o=i.NONE}break;default:o=i.NONE}o!==i.NONE&&n.dispatchEvent(Xn)}(t):function(t){let e;switch(t.button){case 0:e=n.mouseButtons.LEFT;break;case 1:e=n.mouseButtons.MIDDLE;break;case 2:e=n.mouseButtons.RIGHT;break;default:e=-1}switch(e){case wt.DOLLY:if(!1===n.enableZoom)return;(function(t){f.set(t.clientX,t.clientY)})(t),o=i.DOLLY;break;case wt.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enablePan)return;S(t),o=i.PAN}else{if(!1===n.enableRotate)return;z(t),o=i.ROTATE}break;case wt.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enableRotate)return;z(t),o=i.ROTATE}else{if(!1===n.enablePan)return;S(t),o=i.PAN}break;default:o=i.NONE}o!==i.NONE&&n.dispatchEvent(Xn)}(t))}function B(t){!1!==n.enabled&&("touch"===t.pointerType?function(t){switch(G(t),o){case i.TOUCH_ROTATE:if(!1===n.enableRotate)return;N(t),n.update();break;case i.TOUCH_PAN:if(!1===n.enablePan)return;O(t),n.update();break;case i.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function(t){n.enableZoom&&j(t),n.enablePan&&O(t)})(t),n.update();break;case i.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function(t){n.enableZoom&&j(t),n.enableRotate&&N(t)})(t),n.update();break;default:o=i.NONE}}(t):function(t){switch(o){case i.ROTATE:if(!1===n.enableRotate)return;!function(t){u.set(t.clientX,t.clientY),v.subVectors(u,p).multiplyScalar(n.rotateSpeed);const e=n.domElement;P(2*Math.PI*v.x/e.clientHeight),k(2*Math.PI*v.y/e.clientHeight),p.copy(u),n.update()}(t);break;case i.DOLLY:if(!1===n.enableZoom)return;!function(t){w.set(t.clientX,t.clientY),x.subVectors(w,f),x.y>0?I(E()):x.y<0&&T(E()),f.copy(w),n.update()}(t);break;case i.PAN:if(!1===n.enablePan)return;!function(t){g.set(t.clientX,t.clientY),b.subVectors(g,m).multiplyScalar(n.panSpeed),M(b.x,b.y),m.copy(g),n.update()}(t)}}(t))}function H(t){(function(t){delete C[t.pointerId];for(let e=0;e<y.length;e++)if(y[e].pointerId==t.pointerId)return void y.splice(e,1)})(t),0===y.length&&(n.domElement.releasePointerCapture(t.pointerId),n.domElement.removeEventListener("pointermove",B),n.domElement.removeEventListener("pointerup",H)),n.dispatchEvent(Wn),o=i.NONE}function K(t){!1===n.enabled||!1===n.enableZoom||o!==i.NONE||(t.preventDefault(),n.dispatchEvent(Xn),function(t){t.deltaY<0?T(E()):t.deltaY>0&&I(E()),n.update()}(t),n.dispatchEvent(Wn))}function U(t){!1===n.enabled||!1===n.enablePan||function(t){let e=!1;switch(t.code){case n.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?k(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):M(0,n.keyPanSpeed),e=!0;break;case n.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?k(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):M(0,-n.keyPanSpeed),e=!0;break;case n.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?P(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):M(n.keyPanSpeed,0),e=!0;break;case n.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?P(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):M(-n.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),n.update())}(t)}function $(t){!1!==n.enabled&&t.preventDefault()}function G(t){let e=C[t.pointerId];void 0===e&&(e=new _,C[t.pointerId]=e),e.set(t.pageX,t.pageY)}function q(t){const e=t.pointerId===y[0].pointerId?y[1]:y[0];return C[e.pointerId]}n.domElement.addEventListener("contextmenu",$),n.domElement.addEventListener("pointerdown",F),n.domElement.addEventListener("pointercancel",H),n.domElement.addEventListener("wheel",K,{passive:!1}),this.update()}}const Qn={camera:void 0,composer:void 0,debugRoot:void 0,renderer:void 0,root:void 0,scene:void 0};var Jn=(t=>(t[t.NONE=0]="NONE",t[t.ORBIT=1]="ORBIT",t))(Jn||{});let ti;const ei=(t,e)=>{const{renderer:n}=Qn,i=()=>{Un("three-inspect.camera",{position:e.position.toArray(),quaternion:e.quaternion.toArray(),target:null==ti?void 0:ti.target.toArray(),zoom:e.zoom})};void 0!==ti&&(ti.dispose(),window.removeEventListener("pointerup",i),window.removeEventListener("wheel",i)),1===t?(Un("three-inspect.controls",1),ti=new Zn(e,n.domElement),window.addEventListener("pointerup",i,{passive:!0}),window.addEventListener("wheel",i,{passive:!0}),(()=>{const{camera:t,renderer:e}=Qn,n=new Kn(t,e)})()):(Un("three-inspect.camera",null),Un("controls",null))};let ni=-1;const ii=[],si=()=>{for(let t=0,e=ii.length;t<e;t+=1)ii[t]();ni=requestAnimationFrame(si)},oi=t=>{ii.push(t)},ri=t=>{ii.splice(ii.indexOf(t),1)},ai="tv-flex",li="tv-grid",hi="tv-hidden",di="tv-scrollable",ci="tv-resizable",pi="tv-readonly",ui="tv-disabled",vi="tv-focus",mi="tv-multiple-values",gi="tv-error",bi="flash",_i="font-regular";class fi{constructor(t,n,i){e(this,"owner"),e(this,"name"),e(this,"fn"),this.owner=t,this.name=n,this.fn=i}unbind(){this.owner&&(this.owner.unbind(this.name??void 0,this.fn),this.owner=null,this.name=null,this.fn=null)}call(...t){this.fn&&this.fn.call(this.owner,...t)}on(t,e){var n;return null==(n=this.owner)?void 0:n.on(t,e)}}class wi{constructor(){e(this,"_suspendEvents",!1),e(this,"_additionalEmitters",[]),e(this,"_events"),Object.defineProperty(this,"_events",{configurable:!1,enumerable:!1,value:{},writable:!0})}set suspendEvents(t){this._suspendEvents=!!t}get suspendEvents(){return this._suspendEvents}on(t,e){const n=this._events[t];return void 0===n?this._events[t]=[e]:-1===n.indexOf(e)&&n.push(e),new fi(this,t,e)}once(t,e){const n=this.on(t,((...t)=>{e.call(this,...t),n.unbind()}));return n}emit(t,...e){if(this._suspendEvents)return this;let n=this._events[t];if(null==n?void 0:n.length){n=n.slice(0);for(let s=0;s<n.length;s+=1)if(n[s])try{n[s].call(this,...e)}catch(i){console.error("%c%s %c(event error)","color: #06f",t,"color: #f00"),console.error(i.stack)}}if(this._additionalEmitters.length){const n=this._additionalEmitters.slice();for(let i=0,s=n.length;i<s;i+=1)n[i].emit(t,...e)}return this}unbind(t,e){if(t){const n=this._events[t];if(!n)return this;if(e){const i=n.indexOf(e);-1!==i&&(1===n.length?delete this._events[t]:n.splice(i,1))}else delete this._events[t]}else this._events={};return this}addEmitter(t){this._additionalEmitters.includes(t)||this._additionalEmitters.push(t)}removeEmitter(t){const e=this._additionalEmitters.indexOf(t);-1!==e&&this._additionalEmitters.splice(e,1)}}const xi=["flexDirection","flexGrow","flexBasis","flexShrink","flexWrap","alignItems","alignSelf","justifyContent","justifySelf"];class yi extends wi{constructor(t={}){if(super(),e(this,"_destroyed",!1),e(this,"_parent",null),e(this,"_eventsParent",[]),e(this,"_dom"),e(this,"_hiddenParents"),e(this,"_flashTimeout",null),e(this,"_suppressChange",!1),e(this,"_ignoreParent",!1),e(this,"_enabled",!0),e(this,"_readOnly",!1),e(this,"_hidden",!1),e(this,"_hasError",!1),e(this,"_domContent",null),e(this,"_onMouseOver",(t=>{this.emit("hover",t)})),e(this,"_onMouseOut",(t=>{this.emit("hoverend",t)})),"string"==typeof t.dom?this._dom=document.createElement(t.dom):t.dom instanceof Node?this._dom=t.dom:this._dom=document.createElement("div"),void 0!==t.id&&(this._dom.id=t.id),this._dom.ui=this,this._dom.addEventListener("mouseover",this._onMouseOver),this._dom.addEventListener("mouseout",this._onMouseOut),this._dom.classList.add("tv-element",_i),t.class){const e=Array.isArray(t.class)?t.class:[t.class];for(const t of e)this._dom.classList.add(t)}this.enabled=t.enabled??!0,this._hiddenParents=!t.isRoot,this.hidden=t.hidden??!1,this.readOnly=t.readOnly??!1,this.ignoreParent=t.ignoreParent??!1,void 0!==t.width&&(this.width=t.width),void 0!==t.height&&(this.height=t.height),void 0!==t.tabIndex&&(this.tabIndex=t.tabIndex);for(const e in t)void 0!==t[e]&&-1!==xi.indexOf(e)&&(this[e]=t[e])}destroy(){if(this._destroyed)return;if(this._destroyed=!0,this.parent){const t=this.parent;for(const e of this._eventsParent)e.unbind();this._eventsParent.length=0,"remove"in t&&!t._destroyed&&t.remove(this),this._parent=null,!t._destroyed&&this._dom&&this._dom.parentElement&&this._dom.parentElement.removeChild(this._dom)}const t=this._dom;t&&(t.removeEventListener("mouseover",this._onMouseOver),t.removeEventListener("mouseout",this._onMouseOut),delete t.ui,this._dom=null),this._flashTimeout&&window.clearTimeout(this._flashTimeout),this.emit("destroy",t,this),this.unbind()}flash(){this._flashTimeout||(this.class.add(bi),this._flashTimeout=window.setTimeout((()=>{this._flashTimeout=null,this.class.remove(bi)}),200))}_onClick(t){this.enabled&&this.emit("click",t)}_onHiddenToRootChange(t){this.emit(t?"hideToRoot":"showToRoot")}_onEnabledChange(t){t?this.class.remove(ui):this.class.add(ui),this.emit(t?"enable":"disable")}_onParentDestroy(){this.destroy()}_onParentDisable(){this._ignoreParent||this._enabled&&this._onEnabledChange(!1)}_onParentEnable(){this._ignoreParent||this._enabled&&this._onEnabledChange(!0)}_onParentShowToRoot(){const t=this.hiddenToRoot;this._hiddenParents=!1,t!==this.hiddenToRoot&&this._onHiddenToRootChange(this.hiddenToRoot)}_onParentHideToRoot(){const t=this.hiddenToRoot;this._hiddenParents=!0,t!==this.hiddenToRoot&&this._onHiddenToRootChange(this.hiddenToRoot)}_onReadOnlyChange(t){t?this.class.add(pi):this.class.remove(pi),this.emit("readOnly",t)}_onParentReadOnlyChange(t){this._ignoreParent||(t?this._readOnly||this._onReadOnlyChange(!0):this._readOnly||this._onReadOnlyChange(!1))}set enabled(t){if(this._enabled===t)return;const e=this.enabled;this._enabled=t,e!==t&&this._onEnabledChange(t)}get enabled(){return this._ignoreParent?this._enabled:this._enabled&&(!this._parent||this._parent.enabled)}set ignoreParent(t){this._ignoreParent=t,this._onEnabledChange(this.enabled),this._onReadOnlyChange(this.readOnly)}get ignoreParent(){return this._ignoreParent}get dom(){return this._dom}set parent(t){if(t===this._parent)return;const e=this.enabled,n=this.readOnly,i=this.hiddenToRoot;if(this._parent){for(let t=0;t<this._eventsParent.length;t+=1)this._eventsParent[t].unbind();this._eventsParent.length=0}this._parent=t,this._parent?(this._eventsParent.push(this._parent.once("destroy",this._onParentDestroy.bind(this))),this._eventsParent.push(this._parent.on("disable",this._onParentDisable.bind(this))),this._eventsParent.push(this._parent.on("enable",this._onParentEnable.bind(this))),this._eventsParent.push(this._parent.on("readOnly",this._onParentReadOnlyChange.bind(this))),this._eventsParent.push(this._parent.on("showToRoot",this._onParentShowToRoot.bind(this))),this._eventsParent.push(this._parent.on("hideToRoot",this._onParentHideToRoot.bind(this))),this._hiddenParents=this._parent.hiddenToRoot):this._hiddenParents=!0,this.emit("parent",this._parent);const s=this.enabled;s!==e&&this._onEnabledChange(s);const o=this.readOnly;o!==n&&this._onReadOnlyChange(o);const r=this.hiddenToRoot;r!==i&&this._onHiddenToRootChange(r)}get parent(){return this._parent}set hidden(t){if(t===this._hidden)return;const e=this.hiddenToRoot;this._hidden=t,t?this.class.add(hi):this.class.remove(hi),this.emit(t?"hide":"show"),this.hiddenToRoot!==e&&this._onHiddenToRootChange(this.hiddenToRoot)}get hidden(){return this._hidden}get hiddenToRoot(){return this._hidden||this._hiddenParents}set readOnly(t){this._readOnly!==t&&(this._readOnly=t,this._onReadOnlyChange(t))}get readOnly(){var t;return this._ignoreParent?this._readOnly:this._readOnly||!!(null==(t=this._parent)?void 0:t.readOnly)}set error(t){this._hasError!==t&&(this._hasError=t,t?this.class.add(gi):this.class.remove(gi))}get error(){return this._hasError}get style(){return this._dom.style}get class(){return this._dom.classList}set width(t){this.style.width="number"==typeof t?`${String(t)}px`:t}get width(){return this._dom.clientWidth}set height(t){this.style.height="number"==typeof t?`${String(t)}px`:t}get height(){return this._dom.clientHeight}set tabIndex(t){this._dom.tabIndex=t}get tabIndex(){return this._dom.tabIndex}get destroyed(){return this._destroyed}set flexDirection(t){this.style.flexDirection=t}get flexDirection(){return this.style.flexDirection}set flexGrow(t){this.style.flexGrow=t}get flexGrow(){return this.style.flexGrow}set flexBasis(t){this.style.flexBasis=t}get flexBasis(){return this.style.flexBasis}set flexShrink(t){this.style.flexShrink=t}get flexShrink(){return this.style.flexShrink}set flexWrap(t){this.style.flexWrap=t}get flexWrap(){return this.style.flexWrap}set alignItems(t){this.style.alignItems=t}get alignItems(){return this.style.alignItems}set alignSelf(t){this.style.alignSelf=t}get alignSelf(){return this.style.alignSelf}set justifyContent(t){this.style.justifyContent=t}get justifyContent(){return this.style.justifyContent}set justifySelf(t){this.style.justifySelf=t}get justifySelf(){return this.style.justifySelf}set disabled(t){this.enabled=!t}get disabled(){return!this.enabled}set element(t){this._dom=t}get element(){return this.dom}set innerElement(t){this._domContent=t}get innerElement(){return this._domContent}}e(yi,"EVENT_ENABLE","enable"),e(yi,"EVENT_DISABLE","disable"),e(yi,"EVENT_HIDE","hide"),e(yi,"EVENT_HIDE_TO_ROOT","hideToRoot"),e(yi,"EVENT_SHOW","show"),e(yi,"EVENT_SHOW_TO_ROOT","showToRoot"),e(yi,"EVENT_READ_ONLY","readOnly"),e(yi,"EVENT_PARENT","parent"),e(yi,"EVENT_CLICK","click"),e(yi,"EVENT_HOVER","hover"),e(yi,"EVENT_HOVER_END","hoverend"),e(yi,"EVENT_DESTROY","destroy");const Ci=[null,"top","right","bottom","left"],Ei=`${ci}-resizing`,Pi="tv-container-dragged",ki=`${Pi}-child`,Ai=t=>"dom"in t?t.dom:t;class Li extends yi{constructor(t={}){super(t),e(this,"_scrollable",!1),e(this,"_flex",!1),e(this,"_grid",!1),e(this,"_domResizeHandle",null),e(this,"_resizeTouchId",null),e(this,"_resizeData",null),e(this,"_resizeHorizontally",!0),e(this,"_resizeMin",100),e(this,"_resizeMax",300),e(this,"_draggedStartIndex",-1),e(this,"_domContent"),e(this,"_resizable",null),e(this,"_onScroll",(t=>{this.emit("scroll",t)})),e(this,"_onResizeStart",(t=>{t.preventDefault(),t.stopPropagation(),window.addEventListener("mousemove",this._onResizeMove),window.addEventListener("mouseup",this._onResizeEnd),this._resizeStart()})),e(this,"_onResizeMove",(t=>{t.preventDefault(),t.stopPropagation(),this._resizeMove(t.clientX,t.clientY)})),e(this,"_onResizeEnd",(t=>{t.preventDefault(),t.stopPropagation(),window.removeEventListener("mousemove",this._onResizeMove),window.removeEventListener("mouseup",this._onResizeEnd),this._resizeEnd()})),e(this,"_onResizeTouchStart",(t=>{t.preventDefault(),t.stopPropagation();for(let e=0;e<t.changedTouches.length;e+=1){const n=t.changedTouches[e];n.target===this._domResizeHandle&&(this._resizeTouchId=n.identifier)}window.addEventListener("touchmove",this._onResizeTouchMove),window.addEventListener("touchend",this._onResizeTouchEnd),this._resizeStart()})),e(this,"_onResizeTouchMove",(t=>{for(let e=0;e<t.changedTouches.length;e+=1){const n=t.changedTouches[e];if(n.identifier===this._resizeTouchId){t.stopPropagation(),t.preventDefault(),this._resizeMove(n.clientX,n.clientY);break}}})),e(this,"_onResizeTouchEnd",(t=>{for(let e=0;e<t.changedTouches.length;e+=1)if(t.changedTouches[e].identifier!==this._resizeTouchId){this._resizeTouchId=null,t.preventDefault(),t.stopPropagation(),window.removeEventListener("touchmove",this._onResizeTouchMove),window.removeEventListener("touchend",this._onResizeTouchEnd),this._resizeEnd();break}})),this.class.add("tv-container"),this.domContent=this._dom,this._domContent=this._dom,t.scrollable&&(this.scrollable=!0),this.flex=!!t.flex;let n=!!t.grid;n&&this.flex&&(console.error('Invalid Container arguments: "grid" and "flex" cannot both be true.'),n=!1),this.grid=n,this.resizable=t.resizable??null,void 0!==t.resizeMin&&(this.resizeMin=t.resizeMin),void 0!==t.resizeMax&&(this.resizeMax=t.resizeMax)}destroy(){this._destroyed||(this.domContent=null,this._domResizeHandle&&(this._domResizeHandle.removeEventListener("mousedown",this._onResizeStart),window.removeEventListener("mousemove",this._onResizeMove),window.removeEventListener("mouseup",this._onResizeEnd),this._domResizeHandle.removeEventListener("touchstart",this._onResizeTouchStart),window.removeEventListener("touchmove",this._onResizeTouchMove),window.removeEventListener("touchend",this._onResizeTouchEnd)),super.destroy())}append(t){const e=Ai(t);this._domContent.appendChild(e),this._onAppendChild(t)}appendBefore(t,e){const n=Ai(t);this._domContent.appendChild(n);const i=e&&Ai(e);this._domContent.insertBefore(n,i),this._onAppendChild(t)}appendAfter(t,e){const n=Ai(t),i=e&&Ai(e),s=i?i.nextSibling:null;s?this._domContent.insertBefore(n,s):this._domContent.appendChild(n),this._onAppendChild(t)}prepend(t){const e=Ai(t),n=this._domContent.firstChild;n?this._domContent.insertBefore(e,n):this._domContent.appendChild(e),this._onAppendChild(t)}remove(t){if(t.parent!==this)return;const e=Ai(t);this._domContent.removeChild(e),this._onRemoveChild(t)}move(t,e){let n=-1;for(let i=0;i<this.dom.childNodes.length;i+=1)if(this.dom.childNodes[i].ui===t){n=i;break}-1===n?this.appendBefore(t,this.dom.childNodes[e]):e!==n&&(this.remove(t),e<n?this.appendBefore(t,this.dom.childNodes[e]):this.appendAfter(t,this.dom.childNodes[e-1]))}clear(){for(let t=this._domContent.childNodes.length-1;t>-1;t-=1){const e=this._domContent.childNodes[t];e.ui&&e.ui!==this&&e.ui.destroy()}this._domResizeHandle&&(this._domResizeHandle.removeEventListener("mousedown",this._onResizeStart),this._domResizeHandle.removeEventListener("touchstart",this._onResizeTouchStart),this._domResizeHandle=null),this._domContent.innerHTML="",this.resizable&&(this._domResizeHandle=this._createResizeHandle(),this._dom.appendChild(this._domResizeHandle))}_onAppendChild(t){t.parent=this,this.emit("append",t)}_onRemoveChild(t){t.parent=null,this.emit("remove",t)}_createResizeHandle(){const t=document.createElement("div");return t.classList.add("tv-resizable-handle"),t.ui=this,t.addEventListener("mousedown",this._onResizeStart),t.addEventListener("touchstart",this._onResizeTouchStart,{passive:!1}),t}_resizeStart(){this.class.add(Ei)}_resizeMove(t,e){if(this._resizeData){if(this._resizeHorizontally){let e=this._resizeData.x-t;"right"===this._resizable&&(e=-e),this.width=4+Math.max(this._resizeMin,Math.min(this._resizeMax,this._resizeData.width+e))}else{let t=this._resizeData.y-e;"bottom"===this._resizable&&(t=-t),this.height=Math.max(this._resizeMin,Math.min(this._resizeMax,this._resizeData.height+t))}this.emit("resize")}else this._resizeData={height:this.dom.clientHeight,width:this.dom.clientWidth,x:t,y:e}}_resizeEnd(){this._resizeData=null,this.class.remove(Ei)}resize(t=0,e=0){this._resizeStart(),this._resizeMove(0,0),this._resizeMove(4-t,-e),this._resizeEnd()}_getDraggedChildIndex(t){for(let e=0;e<this.dom.childNodes.length;e+=1)if(this.dom.childNodes[e].ui===t)return e;return-1}_onChildDragStart(t,e){this.class.add(ki),this._draggedStartIndex=this._getDraggedChildIndex(e),e.class.add(Pi),this.emit("child:dragstart",e,this._draggedStartIndex)}_onChildDragMove(t,e){const n=this.dom.getBoundingClientRect(),i=t.clientX<n.left||t.clientX>n.right||t.clientY<n.top||t.clientY>n.bottom,s=this._getDraggedChildIndex(e);if(i)return e.class.remove(Pi),void(this._draggedStartIndex!==s&&(this.remove(e),this._draggedStartIndex<s?this.appendBefore(e,this.dom.childNodes[this._draggedStartIndex]):this.appendAfter(e,this.dom.childNodes[this._draggedStartIndex-1])));e.class.add(Pi);const o=t.clientY-n.top;let r=null;for(let a=0;a<this.dom.childNodes.length;a+=1){const t=this.dom.childNodes[a].ui,n=t.dom.offsetTop;if(a<s){if(o<=n+t.header.height){r=a;break}}else if(a>s&&o+e.height>=n+t.height){r=a;break}}null!==r&&s!==r&&(this.remove(e),r<s?this.appendBefore(e,this.dom.childNodes[r]):this.appendAfter(e,this.dom.childNodes[r-1]))}_onChildDragEnd(t,e){this.class.remove(ki),e.class.remove(Pi);const n=this._getDraggedChildIndex(e);this.emit("child:dragend",e,n,this._draggedStartIndex),this._draggedStartIndex=-1}forEachChild(t){for(let e=0;e<this.dom.childNodes.length;e+=1){const n=this.dom.childNodes[e].ui;if(n&&!1===t(n,e))break}}set flex(t){t!==this._flex&&(this._flex=t,t?this.class.add(ai):this.class.remove(ai))}get flex(){return this._flex}set grid(t){t!==this._grid&&(this._grid=t,t?this.class.add(li):this.class.remove(li))}get grid(){return this._grid}set scrollable(t){this._scrollable!==t&&(this._scrollable=t,t?this.class.add(di):this.class.remove(di))}get scrollable(){return this._scrollable}set resizable(t){if(t!==this._resizable){if(-1===Ci.indexOf(t))return void console.error(`Invalid resizable value: must be one of ${Ci.join(",")}`);this._resizable&&this.class.remove(`${ci}-${this._resizable}`),this._resizable=t,this._resizeHorizontally="right"===t||"left"===t,t?(this.class.add(ci),this.class.add(`${ci}-${t}`),this._domResizeHandle||(this._domResizeHandle=this._createResizeHandle()),this._dom.appendChild(this._domResizeHandle)):(this.class.remove(ci),this._domResizeHandle&&this._dom.removeChild(this._domResizeHandle))}}get resizable(){return this._resizable}set resizeMin(t){this._resizeMin=Math.max(0,Math.min(t,this._resizeMax))}get resizeMin(){return this._resizeMin}set resizeMax(t){this._resizeMax=Math.max(this._resizeMin,t)}get resizeMax(){return this._resizeMax}set domContent(t){this._domContent!==t&&(this._domContent&&this._domContent.removeEventListener("scroll",this._onScroll),this._domContent=t,this._domContent&&this._domContent.addEventListener("scroll",this._onScroll))}get domContent(){return this._domContent}}e(Li,"EVENT_APPEND","append"),e(Li,"EVENT_REMOVE","remove"),e(Li,"EVENT_SCROLL","scroll"),e(Li,"EVENT_RESIZE","resize");class Mi extends yi{constructor(t={}){super({dom:"span",...t}),e(this,"_unsafe"),e(this,"_text",""),e(this,"renderChanges",!1),this.class.add("tv-label"),this._unsafe=t.unsafe??!1,this.text=t.text??t.value??"",t.allowTextSelection&&this.class.add("tv-default-mousedown"),t.nativeTooltip&&(this.dom.title=this.text),this.placeholder=t.placeholder??null,this.renderChanges=t.renderChanges??!1,this.on("change",(()=>{this.renderChanges&&this.flash()}))}_updateText(t){return this.class.remove(mi),this._text!==t&&(this._text=t,this._unsafe?this._dom.innerHTML=t:this._dom.textContent=t,this.emit("change",t),!0)}set text(t){this._updateText(t??"")}get text(){return this._text}set value(t){this.text=t}get value(){return this.text}set values(t){t.some((e=>e!==t[0]))?(this._updateText(""),this.class.add(mi)):this._updateText(t[0])}set placeholder(t){t?this.dom.setAttribute("placeholder",t):this.dom.removeAttribute("placeholder")}get placeholder(){return this.dom.getAttribute("placeholder")??""}}class Ii extends yi{constructor(t={}){super(t),e(this,"_domInput"),e(this,"_suspendInputChangeEvt"),e(this,"_prevValue"),e(this,"_keyChange",!1),e(this,"_renderChanges",!1),e(this,"_blurOnEnter",!0),e(this,"_blurOnEscape",!0),e(this,"_onInputKeyDownEvt"),e(this,"_onInputChangeEvt"),e(this,"_onInputFocus",(t=>{this.class.add(vi),this.emit("focus",t),this._prevValue=this._domInput.value})),e(this,"_onInputBlur",(t=>{this.class.remove(vi),this.emit("blur",t)})),e(this,"_onInputKeyUp",(t=>{"Escape"!==t.key&&this._onInputChange(t),this.emit("keyup",t)})),e(this,"_onInputCtxMenu",(t=>{this._domInput.select()})),e(this,"_updateInputReadOnly",(()=>{!this.enabled||this.readOnly?this._domInput.setAttribute("readonly","true"):this._domInput.removeAttribute("readonly")})),this.class.add("tv-input-element");let n=t.input;n||(n=document.createElement("input"),n.type="text"),n.ui=this,n.tabIndex=0,n.autocomplete="off",this._onInputKeyDownEvt=this._onInputKeyDown.bind(this),this._onInputChangeEvt=this._onInputChange.bind(this),n.addEventListener("change",this._onInputChangeEvt),n.addEventListener("keydown",this._onInputKeyDownEvt),n.addEventListener("focus",this._onInputFocus),n.addEventListener("blur",this._onInputBlur),n.addEventListener("contextmenu",this._onInputCtxMenu,!1),this.dom.appendChild(n),this._domInput=n,this._suspendInputChangeEvt=!1,void 0!==t.value&&(this._domInput.value=t.value),this.placeholder=t.placeholder??"",this.renderChanges=t.renderChanges??!1,this.blurOnEnter=t.blurOnEnter??!0,this.blurOnEscape=t.blurOnEscape??!0,this.keyChange=t.keyChange??!1,this._prevValue=null,this.on("change",(()=>{this.renderChanges&&this.flash()})),this.on("disable",this._updateInputReadOnly),this.on("enable",this._updateInputReadOnly),this.on("readOnly",this._updateInputReadOnly),this._updateInputReadOnly()}destroy(){if(this._destroyed)return;const t=this._domInput;t.removeEventListener("change",this._onInputChangeEvt),t.removeEventListener("keydown",this._onInputKeyDownEvt),t.removeEventListener("focus",this._onInputFocus),t.removeEventListener("blur",this._onInputBlur),t.removeEventListener("keyup",this._onInputKeyUp),t.removeEventListener("contextmenu",this._onInputCtxMenu),super.destroy()}_onInputKeyDown(t){if("Enter"===t.key&&this.blurOnEnter)this._suspendInputChangeEvt=this.keyChange,this._domInput.blur(),this._suspendInputChangeEvt=!1;else if("Escape"===t.key){this._suspendInputChangeEvt=!0;const e=this._domInput.value;this._domInput.value=this._prevValue??"",this._suspendInputChangeEvt=!1,this.keyChange&&e!==this._prevValue&&this._onInputChange(t),this.blurOnEscape&&this._domInput.blur()}this.emit("keydown",t)}_onInputChange(t){}focus(t){this._domInput.focus(),t&&this._domInput.select()}blur(){this._domInput.blur()}set placeholder(t){t?this.dom.setAttribute("placeholder",t):this.dom.removeAttribute("placeholder")}get placeholder(){return this.dom.getAttribute("placeholder")??""}set keyChange(t){this._keyChange!==t&&(this._keyChange=t,t?this._domInput.addEventListener("keyup",this._onInputKeyUp):this._domInput.removeEventListener("keyup",this._onInputKeyUp))}get keyChange(){return this._keyChange}get input(){return this._domInput}set blurOnEnter(t){this._blurOnEnter=t}get blurOnEnter(){return this._blurOnEnter}set blurOnEscape(t){this._blurOnEnter=t}get blurOnEscape(){return this._blurOnEnter}set renderChanges(t){this._renderChanges=t}get renderChanges(){return this._renderChanges}}class Ti extends Ii{constructor(t={}){super(t),e(this,"_onValidate"),this.class.add("tv-text-input"),t.onValidate&&(this.onValidate=t.onValidate)}_onInputChange(){if(!this._suspendInputChangeEvt){if(this._onValidate){const t=!this._onValidate(this.value);if(this.error=t,t)return}else this.error=!1;this.emit("change",this.value)}}_updateValue(t){let e=t;if(this.class.remove(mi),e&&"object"==typeof e)if(Array.isArray(e)){let t=!1;for(let n=0;n<e.length;n+=1)if(e[n]&&"object"==typeof e[n]){t=!0;break}e=t?"[Not available]":e.map((t=>null===t?"null":t)).join(",")}else e="[Not available]";return e!==this.value&&(this._suspendInputChangeEvt=!0,this._domInput.value=null==e?"":String(e),this._suspendInputChangeEvt=!1,this.emit("change",e),!0)}set value(t){this._updateValue(t)&&(this.error=!1)}get value(){return this._domInput.value}set values(t){t.some((e=>e!==t[0]))?(this._updateValue(null),this.class.add(mi)):this._updateValue(t[0])}set onValidate(t){this._onValidate=t}get onValidate(){return this._onValidate}}const zi="tv-item-selected",Si="tv-item-open",Vi="tv-item-empty",Ri="tv-item-rename",Di=class extends Li{constructor(t={}){super(t),e(this,"_containerContents"),e(this,"_labelIcon"),e(this,"_labelText"),e(this,"_numChildren",0),e(this,"_treeView"),e(this,"_allowDrag",!0),e(this,"_allowDrop",!0),e(this,"_allowSelect",!0),e(this,"_icon"),e(this,"_onContentKeyDown",(t=>{"INPUT"!==t.target.tagName&&this.allowSelect&&this._treeView&&this._treeView._onChildKeyDown(t,this)})),e(this,"_onContentMouseDown",(t=>{var e;!(null==(e=this._treeView)?void 0:e.allowDrag)||!this._allowDrag||(this._treeView._updateModifierKeys(t),t.stopPropagation())})),e(this,"_onContentMouseUp",(t=>{t.stopPropagation(),t.preventDefault(),window.removeEventListener("mouseup",this._onContentMouseUp),this._treeView&&this._treeView._onChildDragEnd(t,this)})),e(this,"_onContentMouseOver",(t=>{t.stopPropagation(),this._treeView&&this._treeView._onChildDragOver(t,this),this.emit("hover",t)})),e(this,"_onContentDragStart",(t=>{var e;t.stopPropagation(),t.preventDefault(),(null==(e=this._treeView)?void 0:e.allowDrag)&&(this.class.contains(Ri)||(this._treeView._onChildDragStart(t,this),window.addEventListener("mouseup",this._onContentMouseUp)))})),e(this,"_onContentClick",(t=>{if(!this.allowSelect||0!==t.button||"INPUT"===t.target.tagName)return;t.stopPropagation();const e=this._containerContents.dom.getBoundingClientRect();this._numChildren>0&&t.clientX-e.left<0?(this.open=!this.open,t.altKey&&this._dfs((t=>{t.open=this.open})),this.focus()):this._treeView&&this._treeView._onChildClick(t,this)})),e(this,"_onContentDblClick",(t=>{var e;if(!(null==(e=this._treeView)?void 0:e.allowRenaming)||0!==t.button||"INPUT"===t.target.tagName)return;t.stopPropagation();const n=this._containerContents.dom.getBoundingClientRect();this.numChildren&&t.clientX-n.left<0||(this.allowSelect&&(this._treeView.deselect(),this._treeView._onChildClick(t,this)),this.rename())})),e(this,"_onContentContextMenu",(t=>{var e,n;null==(n=null==(e=this._treeView)?void 0:e._onContextMenu)||n.call(e,t,this)})),e(this,"_onContentFocus",(t=>{this.emit("focus")})),e(this,"_onContentBlur",(t=>{this.emit("blur")})),this.class.add("tv-item",Vi),this._containerContents=new Li({class:"tv-item-contents",flex:!0,flexDirection:"row",tabIndex:0}),this.append(this._containerContents),this._containerContents.dom.innerHTML+='<svg class="icon-minus" viewBox="0 0 32 32"><path fill="#fff" d="M8 14.656h16v2.688h-16v-2.688z"></path></svg>',this._containerContents.dom.innerHTML+='<svg class="icon-plus" viewBox="0 0 768 768"><path fill="#fff" d="M607.5 415.5h-192v192h-63v-192h-192v-63h192v-192h63v192h192v63z"></path></svg>',this._containerContents.dom.draggable=!0,this._labelIcon=new Mi({class:"tv-item-icon"}),this._containerContents.append(this._labelIcon),this.icon=t.icon,this._labelText=new Mi({class:"tv-item-text"}),this._containerContents.append(this._labelText),this.allowSelect=t.allowSelect??!0,this.allowDrop=t.allowDrop??!0,this.allowDrag=t.allowDrag??!0,t.text&&(this.text=t.text),t.selected&&(this.selected=t.selected);const n=this._containerContents.dom;n.addEventListener("focus",this._onContentFocus),n.addEventListener("blur",this._onContentBlur),n.addEventListener("keydown",this._onContentKeyDown),n.addEventListener("dragstart",this._onContentDragStart),n.addEventListener("mousedown",this._onContentMouseDown),n.addEventListener("mouseover",this._onContentMouseOver),n.addEventListener("click",this._onContentClick),n.addEventListener("dblclick",this._onContentDblClick),n.addEventListener("contextmenu",this._onContentContextMenu)}destroy(){if(this._destroyed)return;const{dom:t}=this._containerContents;t.removeEventListener("focus",this._onContentFocus),t.removeEventListener("blur",this._onContentBlur),t.removeEventListener("keydown",this._onContentKeyDown),t.removeEventListener("dragstart",this._onContentDragStart),t.removeEventListener("mousedown",this._onContentMouseDown),t.removeEventListener("mouseover",this._onContentMouseOver),t.removeEventListener("click",this._onContentClick),t.removeEventListener("dblclick",this._onContentDblClick),t.removeEventListener("contextmenu",this._onContentContextMenu),window.removeEventListener("mouseup",this._onContentMouseUp),super.destroy()}_onAppendChild(t){super._onAppendChild(t),t instanceof Di&&(this._numChildren+=1,this._parent!==this._treeView&&this.class.remove(Vi),this._treeView&&this._treeView._onAppendTreeViewItem(t))}_onRemoveChild(t){t instanceof Di&&(this._numChildren-=1,0===this._numChildren&&this.class.add(Vi),this._treeView&&this._treeView._onRemoveTreeViewItem(t)),super._onRemoveChild(t)}_dfs(t){t(this);let e=this.firstChild;for(;e;)e._dfs(t),e=e.nextSibling}rename(){this.class.add(Ri);const t=new Ti({class:_i,renderChanges:!1,value:this.text});t.on("blur",(()=>{t.destroy()})),t.on("destroy",(()=>{this.class.remove(Ri),this.focus()})),t.on("change",(e=>{const n=e.trim();n&&(this.text=n,t.destroy())})),t.on("disable",(()=>{t.input.removeAttribute("readonly")})),this._containerContents.append(t),t.focus(!0)}focus(){this._containerContents.dom.focus()}blur(){this._containerContents.dom.blur()}set selected(t){t!==this.selected?t?(this._containerContents.class.add(zi),this.emit("select",this),this._treeView&&this._treeView._onChildSelected(this),this.focus()):(this._containerContents.class.remove(zi),this.blur(),this.emit("deselect",this),this._treeView&&this._treeView._onChildDeselected(this)):t&&this.focus()}get selected(){return this._containerContents.class.contains(zi)}set text(t){this._labelText.value!==t&&(this._labelText.value=t,this._treeView&&this._treeView._onChildRename(this,t))}get text(){return this._labelText.value}get textLabel(){return this._labelText}get iconLabel(){return this._labelIcon}set open(t){if(this.open!==t)if(t){if(!this.numChildren)return;this.class.add(Si),this.emit("open",this)}else this.class.remove(Si),this.emit("close",this)}get open(){return this.class.contains(Si)||this.parent===this._treeView}set parentsOpen(t){let e=this.parent;for(;e&&e instanceof Di;)e.open=t,e=e.parent}get parentsOpen(){let t=this.parent;for(;t&&t instanceof Di;){if(!t.open)return!1;t=t.parent}return!0}set allowDrop(t){this._allowDrop=t}get allowDrop(){return this._allowDrop}set allowDrag(t){this._allowDrag=t}get allowDrag(){return this._allowDrag}set allowSelect(t){this._allowSelect=t}get allowSelect(){return this._allowSelect}set treeView(t){this._treeView=t}get treeView(){return this._treeView}get numChildren(){return this._numChildren}get firstChild(){if(this._numChildren)for(let t=0;t<this.dom.childNodes.length;t+=1)if(this.dom.childNodes[t].ui instanceof Di)return this.dom.childNodes[t].ui;return null}get lastChild(){if(this._numChildren)for(let t=this.dom.childNodes.length-1;t>=0;t-=1)if(this.dom.childNodes[t].ui instanceof Di)return this.dom.childNodes[t].ui;return null}get nextSibling(){let t=this.dom.nextSibling;for(;t&&!(t.ui instanceof Di);)t=t.nextSibling;return t&&t.ui}get previousSibling(){let t=this.dom.previousSibling;for(;t&&!(t.ui instanceof Di);)t=t.previousSibling;return t&&t.ui}set icon(t){this._icon!==t&&(this._icon=t,t?this._labelIcon.dom.setAttribute("data-icon",String.fromCodePoint(Number.parseInt(t,16))):(this._labelIcon.dom.style.display="none",this._labelIcon.dom.removeAttribute("data-icon")))}get icon(){return this._icon}};let Ni=Di;e(Ni,"EVENT_SELECT","select"),e(Ni,"EVENT_DESELECT","deselect"),e(Ni,"EVENT_OPEN","open"),e(Ni,"EVENT_CLOSE","close");const Oi=(t,e)=>{if(0===t.length)return e.length;if(0===e.length)return t.length;if(t===e)return 0;const n=[];for(let i=0;i<=e.length;i++)n[i]=[i];for(let i=0;i<=t.length;i++)n[0][i]=i;for(let i=1;i<=e.length;i++)for(let s=1;s<=t.length;s++)e.charAt(i-1)===t.charAt(s-1)?n[i][s]=n[i-1][s-1]:n[i][s]=Math.min(n[i-1][s-1]+1,Math.min(n[i][s-1]+1,n[i-1][s]+1));return n[e.length][t.length]},ji=(t,e)=>{if(t===e)return t.length;let n=0;const i=new Set;for(let s=0;s<e.length;s++)i.add(e.charAt(s));for(let s=0;s<t.length;s++)i.has(t.charAt(s))&&n++;return n},Fi=t=>{const e=[],n=t.replace(/([^A-Z])([A-Z][^A-Z])/g,"$1 $2").replace(/([A-Z0-9]{2,})/g," $1").split(/(\s|\-|_)/g);for(let i=0;i<n.length;i++)n[i]=n[i].toLowerCase().trim(),n[i]&&"-"!==n[i]&&"_"!==n[i]&&e.push(n[i]);return e},Bi=(t,e,n)=>{const i=[];for(const s of t){if(s.subFull!==1/0){i.push(s),s.edits===1/0&&(s.edits=0),s.sub===1/0&&(s.sub=s.subFull);continue}if(s.name===e||s.name.startsWith(e)){i.push(s),s.edits===1/0&&(s.edits=0),s.sub===1/0&&(s.sub=0);continue}if(ji(e,s.name)/e.length<(n.containsCharsTolerance??0))continue;let t=1/0,o=1/0;for(let i=0;i<s.tokens.length;i++){if(s.tokens[i]===e){t=0,o=i;break}const r=Oi(e,s.tokens[i]);(o===1/0||r<t)&&-1!==s.tokens[i].indexOf(e)?(o=i,t=r):o===1/0&&r<t&&r/Math.max(e.length,s.tokens[i].length)<=(n.editsDistanceTolerance??0)&&(t=r)}t!==1/0&&(i.push(s),s.edits=s.edits===1/0?t:s.edits+t,s.sub=s.sub===1/0?o:s.sub+o)}return i},Hi="tv-item-dragged",Ki="tv-filtering",Ui="tv-filtering-result",$i="inside",Gi="before",qi="after",Yi=(t,e)=>Array.prototype.indexOf.call(e.dom.childNodes,t.dom)-1,Xi=t=>{t.parentsOpen=!0},Wi=t=>{if(t.numChildren>0&&t.open)return t.firstChild;const e=t.nextSibling;if(e)return e;let n=t.parent;if(!(n instanceof Ni))return null;let i=n.nextSibling;for(;!i&&(n=n.parent,n instanceof Ni);)i=n.nextSibling;return i},Zi=t=>{const e=t.previousSibling;if(e)return e.numChildren>0&&e.open?(t=>{if(!t.numChildren||!t.open)return null;let e=t.lastChild;for(;(null==e?void 0:e.numChildren)&&e.open;)e=e.lastChild;return e})(e):e;const n=t.parent;return n instanceof Ni?n:null};class Qi extends Li{constructor(t={}){super(t),e(this,"_selectedItems",[]),e(this,"_dragItems",[]),e(this,"_allowDrag"),e(this,"_allowReordering"),e(this,"_allowRenaming"),e(this,"_dragging",!1),e(this,"_dragOverItem",null),e(this,"_dragArea",$i),e(this,"_dragScroll",0),e(this,"_dragScrollInterval",null),e(this,"_dragHandle"),e(this,"_dragScrollElement"),e(this,"_onContextMenu"),e(this,"_onReparentFn"),e(this,"_pressedCtrl",!1),e(this,"_pressedShift",!1),e(this,"_filter",null),e(this,"_filterResults",[]),e(this,"_wasDraggingAllowedBeforeFiltering"),e(this,"_updateModifierKeys",(t=>{this._pressedCtrl=(null==t?void 0:t.ctrlKey)??(null==t?void 0:t.metaKey)??!1,this._pressedShift=(null==t?void 0:t.shiftKey)??!1})),e(this,"_onMouseLeave",(t=>{!this._allowDrag||!this._dragging||(this._dragOverItem=null,this._updateDragHandle())})),e(this,"_onMouseMove",(t=>{if(!this._dragging)return;const e=this.dom.getBoundingClientRect();this._dragScroll=0;let n=e.top,i=e.bottom;if(this._dragScrollElement!==this){const t=this._dragScrollElement.dom.getBoundingClientRect();n=Math.max(n+this._dragScrollElement.dom.scrollTop,t.top),i=Math.min(i+this._dragScrollElement.dom.scrollTop,t.bottom)}n=Math.max(0,n),i=Math.min(i,document.body.clientHeight),t.pageY<n+32&&this._dragScrollElement.dom.scrollTop>0?this._dragScroll=-1:t.pageY>i-32&&this._dragScrollElement.dom.scrollHeight>this._dragScrollElement.height+this._dragScrollElement.dom.scrollTop&&(this._dragScroll=1)})),e(this,"_onDragMove",(t=>{if(t.preventDefault(),t.stopPropagation(),!this._allowDrag||!this._dragOverItem)return;const e=this._dragHandle.dom.getBoundingClientRect(),n=Math.floor((t.clientY-e.top)/e.height*5),i=this._dragArea,s=this._dragOverItem;if(this._dragOverItem.parent===this){let t=!1;for(let e=0;e<this._dragItems.length;e+=1)if(this._dragItems[e].parent===this._dragOverItem){t=!0,this._dragOverItem=null;break}t||(this._dragArea=$i)}else{let t=!1;for(let e=0;e<this._dragItems.length;e+=1)if(this._dragItems[e].dom.contains(this._dragOverItem.dom)){t=!0;break}if(t)this._dragOverItem=null;else if(this._allowReordering&&n<=1&&this._dragOverItem.previousSibling&&-1===this._dragItems.indexOf(this._dragOverItem.previousSibling))this._dragArea=Gi;else if(this._allowReordering&&n>=4&&this._dragOverItem.nextSibling&&-1===this._dragItems.indexOf(this._dragOverItem.nextSibling)&&(0===this._dragOverItem.numChildren||!this._dragOverItem.open))this._dragArea=qi;else{let t=!1;if(this._allowReordering&&this._dragOverItem.open)for(let e=0;e<this._dragItems.length;e+=1)if(this._dragItems[e].parent===this._dragOverItem){t=!0,this._dragArea=Gi;break}t||(this._dragArea=$i)}}(i!==this._dragArea||s!==this._dragOverItem)&&this._updateDragHandle()}));const n=document.createElement("style");n.innerHTML='@charset "UTF-8";:host{--font-family: inconsolatamedium, Monaco, Menlo, "Ubuntu Mono", Consolas, source-code-pro, monospace;--bg-darkest: #202020;--bg-darker: #202020;--bg-dark: #282828;--bg-primary: #333333;--color-line: #333333;--color-icon: #666666;--text-darkest: rgb(170 170 170 / 50%);--text-dark: rgb(170 170 170 / 50%);--text-secondary: #aaaaaa;--text-primary: #ffffff;--text-active: #4CAF50;--error: #fb222f;--error-secondary: #d34141;--border-primary: #aaaaaa;--element-shadow-hover: 0 0 2px 1px rgba(255, 102, 0, .3);--element-shadow-active: 0 0 0 1px rgba(255, 102, 0, .3);--element-shadow-error: 0 0 0 1px var(--error-secondary);--element-color-placeholder: #829193;--field-padding: 3px;--disabled-opacity: .4;--element-margin: 6px;--element-opacity-disabled: .4;--element-opacity-readonly: .7}.tv-container{position:relative;min-width:0;min-height:0}.tv-container.tv-resizable>.tv-resizable-handle{position:absolute;z-index:1;opacity:0;background-color:transparent}.tv-container.tv-resizable>.tv-resizable-handle:hover{opacity:1}.tv-container.tv-resizable.tv-resizable-resizing>.tv-resizable-handle{opacity:1}.tv-container.tv-resizable.tv-resizable-left>.tv-resizable-handle,.tv-container.tv-resizable.tv-resizable-right>.tv-resizable-handle{top:0;bottom:0;width:1px;height:auto;cursor:ew-resize}.tv-container.tv-resizable.tv-resizable-left>.tv-resizable-handle{left:0;border-left:3px solid var(--bg-darkest)}.tv-container.tv-resizable.tv-resizable-right>.tv-resizable-handle{right:0;border-right:3px solid var(--bg-darkest)}.tv-container.tv-resizable.tv-resizable-top>.tv-resizable-handle,.tv-container.tv-resizable.tv-resizable-bottom>.tv-resizable-handle{left:0;right:0;width:auto;height:1px;cursor:ns-resize}.tv-container.tv-resizable.tv-resizable-top>.tv-resizable-handle{top:0;border-top:3px solid var(--bg-darkest)}.tv-container.tv-resizable.tv-resizable-bottom>.tv-resizable-handle{bottom:0;border-bottom:3px solid var(--bg-darkest)}.tv-container-dragged{outline:2px solid var(--text-primary);box-sizing:border-box;opacity:.7;z-index:1}.tv-container-dragged-child{outline:1px dotted var(--text-active);box-sizing:border-box}@keyframes tv-flash-animation{0%{outline-color:var(--text-active)}to{outline-color:rgba(var(--text-active),0)}}.tv-element{font-weight:400;font-style:normal;border:0 solid var(--border-primary)}.tv-element.flash{outline:1px solid var(--text-active);animation:tv-flash-animation .2s ease-in-out forwards}.tv-element:focus{outline:none}.tv-element::-moz-focus-inner{border:0}.tv-element.tv-hidden{display:none}.tv-input-element{display:inline-block;border:1px solid var(--bg-darker);border-radius:2px;box-sizing:border-box;margin:var(--element-margin);min-height:24px;height:24px;background-color:var(--bg-dark);vertical-align:top;transition:color .1s,background-color .1s,box-shadow .1s;position:relative;color:var(--text-secondary)}.tv-input-element>input{height:100%;width:calc(100% - 16px);padding:0 var(--element-margin);line-height:1;color:inherit;background:transparent;border:none;outline:none;box-shadow:none;font-family:var(--font-family);font-weight:400;font-size:12px}.tv-input-element:before{color:inherit}.tv-input-element.tv-multiple-values:before{position:absolute;padding:0 8px;content:"...";white-space:nowrap;font-family:var(--font-family);font-weight:400;font-size:12px;top:5px}.tv-input-element:not(.tv-disabled,.tv-readonly):hover{background-color:var(--bg-darker);color:var(--text-primary)}.tv-input-element:not(.tv-disabled,.tv-readonly):not(.tv-error):hover{box-shadow:var(--element-shadow-hover)}.tv-input-element:not(.tv-disabled,.tv-readonly).tv-focus{background-color:var(--bg-darkest);box-shadow:var(--element-shadow-active)}.tv-input-element.tv-focus:after,.tv-input-element.tv-focus:before,.tv-input-element:hover:after,.tv-input-element:hover:before{display:none}.tv-input-element.tv-readonly{border-color:transparent}.tv-input-element.tv-disabled{color:var(--text-darkest)}.tv-input-element.tv-error{color:var(--text-secondary);box-shadow:var(--element-shadow-error)}.tv-input-element[placeholder]{position:relative}.tv-input-element[placeholder]:after{content:attr(placeholder);background-color:var(--bg-dark);position:absolute;top:0;right:0;padding:0 8px;line-height:22px;font-size:10px;font-weight:600;white-space:nowrap;color:var(--element-color-placeholder);pointer-events:none}.tv-label{display:inline-block;box-sizing:border-box;margin:var(--element-margin);vertical-align:middle;transition:opacity .1s;color:var(--text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;user-select:none}.tv-label.tv-default-mousedown{user-select:initial}.tv-label.tv-multiple-values{position:relative;color:transparent}.tv-label.tv-multiple-values:before{content:"...";color:var(--text-secondary);white-space:nowrap;font-family:var(--font-family);font-weight:400;font-size:12px}.tv-label.tv-error{color:var(--error-secondary)}.tv-label.tv-selectable:hover{color:var(--text-active);text-decoration:underline;-webkit-touch-callout:none;user-select:none}.tv-label[placeholder]{position:relative}.tv-label[placeholder]:after{content:attr(placeholder);position:absolute;top:0;right:0;padding:0 8px;color:#999;pointer-events:none}@font-face{font-family:plusminus;font-weight:400;font-style:normal;font-display:block;src:url(data:application/octet-stream;base64,d09GMgABAAAAAAIwAA0AAAAABfgAAAHdAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP0ZGVE0cGh4GYACCXhEICoEEdwsQAAE2AiQDGgQgBYMbB08b9ATIngXlmGuJ8SoMIRZRsZl/ekTw/n6fc8598IHUlkA1VShRNdXA8c3GF5hkhanQ64qWQG+qm8oPha05+yUS9oRC13hgWQsEyteqVv9/VZNP3eT/L9AsHJO6TDJaYF1i4dgYYNp5gIGOTZsyCtADo6yd/1efyWczfAZJsv8mymY0CgHfr5/vw5//JurZwgAzkEJohAqJUi7EAzX5Mj/iPlXHXxujS9XERO12mo8yN52zvUABAdKVhLLtUgIHpASWStsMPR0phZXzMTUY5ufM9IJaEXoAQiEaogCRSABAUMETIaaNQQtGqLEYVgNUgECIVpioB3Hj4ZpRnC5nrwxiWPo5BIAp+4zEVxfZE94PBHDnzXA1rm3+1+lXvNcOytr8hI4EgV9slUY8fiM0FSD2AiQqwWeB1kCABADAyGsBQmtCILXWECha2wlUWgcI1PpOEGi0ngjQs9hfEVVXGGEg8YWg4OtAhe+kajMmVGPkSsOeTX5mzZ0dnZ2dMLs8+5xPsMvS2tPB1A1PyPLQm7Em32fp5m7rNwLL43ApGKwfM3eU7gdjbek0hTv1sLRwznwZHeADy+JCG9tqrc78/PnCEpDSupZIGUWJKurmyOF72YTc0dPWe5/JRt17IwA=)}.tv{-webkit-touch-callout:none;user-select:none;min-width:max-content}.tv-item{position:relative;padding-left:24px}.tv-item:before{content:"\\a0";position:absolute;background-color:var(--color-icon);width:2px;left:14px;top:-12px;bottom:12px}.tv-item:last-child:before{height:25px;bottom:auto}.tv-item.tv-disabled>.tv-item-contents>.tv-item-text{opacity:var(--disabled-opacity)}.tv-item-contents{position:relative;color:var(--text-secondary);margin-left:3px;border:1px solid transparent;align-items:center;height:24px;box-sizing:border-box}.tv-item-contents:hover{cursor:pointer;color:var(--text-primary);background-color:var(--bg-dark)}.tv-item-contents:hover>.tv-item-icon{color:var(--text-primary)}.tv-item-icon{color:var(--text-darkest);margin:0 2px 0 0;flex-shrink:0}.tv-item-icon:before{content:"\\a0";position:absolute;background-color:var(--color-icon);left:-12px;top:10px;width:24px;height:2px}.tv-item-icon:after{content:attr(data-icon);display:inline-block;vertical-align:sub;width:22px;height:22px;position:relative;z-index:1;text-align:center}.tv-item-text{margin:0;flex-shrink:0;position:relative;z-index:1;transition:opacity .1s;padding-right:8px;color:inherit}.tv-item-contents.tv-item-selected{background-color:var(--bg-darkest);color:var(--text-primary)}.tv-item-contents.tv-item-selected>.tv-item-icon{color:var(--text-primary)}.tv-item .icon-plus,.tv-item .icon-minus{position:absolute;font-size:10px;font-weight:700;text-align:center;color:var(--text-secondary);background-color:var(--bg-dark);top:0;left:-24px;width:16px;height:16px;line-height:16px;margin:3px;cursor:pointer;z-index:1;box-sizing:border-box;padding:2px}.tv-item .tv-item.tv-item-empty .icon-plus,.tv-item .tv-item.tv-item-empty .icon-minus{display:none}.tv-item>.tv-item-contents .icon-minus{display:none}.tv-item.tv-item-open>.tv-item-contents .icon-minus{display:block}.tv-item.tv-item-open>.tv-item-contents .icon-plus{display:none}.tv>.tv-item{padding-left:0}.tv>.tv-item:before{content:none}.tv>.tv-item>.tv-item-contents{margin-left:0}.tv>.tv-item>.tv-item-contents>.tv-item-icon:before{content:none}.tv>.tv-item>.tv-item-contents>.tv-item-icon:after{margin-left:0}.tv>.tv-item>.tv-item{padding-left:21px}.tv>.tv-item>.tv-item:before{left:11px}.tv:not(.tv-filtering)>.tv-item .tv-item:not(.tv-item-open,.tv-item-empty)>.tv-item{display:none}.tv-item-dragged>.tv-item-contents{background-color:rgba(var(--bg-dark),.5);color:var(--text-primary)}.tv-drag-handle{position:fixed;width:32px;height:20px;top:0;bottom:0;z-index:4;margin-top:-1px;margin-left:-1px}.tv-drag-handle.before{border-top:4px solid var(--text-active);padding-right:8px;height:24px}.tv-drag-handle.inside{border:4px solid var(--text-active)}.tv-drag-handle.after{border-bottom:4px solid var(--text-active);padding-right:8px;height:24px}.tv-item-contents:after{content:" ";display:block;clear:both}.tv-item.tv-item-rename>.tv-item-contents>.tv-item-text{display:none}.tv-item.tv-item-rename>.tv-item-contents>.tv-text-input{margin:0;flex-grow:1;box-shadow:none!important;border:0;background-color:transparent}.tv-item.tv-item-rename>.tv-item-contents>.tv-text-input>input{font-family:inherit;font-size:14px;padding:0}.tv.tv-filtering .tv-item{padding-left:0}.tv.tv-filtering .tv-item:before{display:none}.tv.tv-filtering .tv-item:not(.tv-filtering-result)>.tv-item-contents{display:none}.tv.tv-filtering .tv-item-contents{margin-left:0}.tv-filtering-result .tv-item-contents:before,.tv-filtering-result .tv-item-icon:before{display:none}.tv-no-select{-webkit-touch-callout:none;user-select:none}.tv-flex{flex-direction:column}.tv-flex:not(.tv-hidden){display:flex}.tv-grid{display:grid}.tv-scrollable{overflow:auto}.tv-hidden{display:none}.font-thin{font-weight:100;font-style:normal}.font-light{font-weight:200;font-style:normal}.font-regular{font-weight:400;font-style:normal}.font-bold{font-weight:700;font-style:normal}.fixed-font{font-family:var(--font-family);font-weight:400;font-size:12px}\n',this.dom.append(n),this.class.add("tv"),this._allowDrag=t.allowDrag??!0,this._allowReordering=t.allowReordering??!0,this._allowRenaming=t.allowRenaming??!1,this._dragHandle=new yi({class:"tv-drag-handle"}),this._dragScrollElement=t.dragScrollElement??this,this.append(this._dragHandle),this._onContextMenu=t.onContextMenu,this._onReparentFn=t.onReparent,this._wasDraggingAllowedBeforeFiltering=this._allowDrag,window.addEventListener("keydown",this._updateModifierKeys),window.addEventListener("keyup",this._updateModifierKeys),window.addEventListener("mousedown",(()=>this._updateModifierKeys())),this.dom.addEventListener("mouseleave",this._onMouseLeave),this._dragHandle.dom.addEventListener("mousemove",this._onDragMove),this._dragHandle.on("destroy",(t=>{t.removeEventListener("mousemove",this._onDragMove)}))}destroy(){this._destroyed||(window.removeEventListener("keydown",this._updateModifierKeys),window.removeEventListener("keyup",this._updateModifierKeys),window.removeEventListener("mousedown",(()=>this._updateModifierKeys())),window.removeEventListener("mousemove",this._onMouseMove),this.dom.removeEventListener("mouseleave",this._onMouseLeave),this._dragScrollInterval&&(window.clearInterval(this._dragScrollInterval),this._dragScrollInterval=null),super.destroy())}_getChildrenRange(t,e){const n=[];if(this._filterResults.length){const i=this.dom.querySelectorAll(`.tv-item.${Ui}`);let s=-1,o=-1;for(let r=0;r<i.length;r+=1){const a=i[r].ui;if(a===t?s=r:a===e&&(o=r),-1!==s&&-1!==o){const t=s<o?o:s;for(let e=s<o?s:o;e<=t;e+=1)n.push(i[e].ui);break}}}else{let i=t;const s=t.dom.getBoundingClientRect(),o=e.dom.getBoundingClientRect();if(s.top<o.top)for(;i&&i!==e;)i=Wi(i),i&&i!==e&&n.push(i);else for(;i&&i!==e;)i=Zi(i),i&&i!==e&&n.push(i);n.push(e)}return n}_onAppendChild(t){super._onAppendChild(t),t instanceof Ni&&this._onAppendTreeViewItem(t)}_onRemoveChild(t){t instanceof Ni&&this._onRemoveTreeViewItem(t),super._onRemoveChild(t)}_onAppendTreeViewItem(t){t.treeView=this,this._filter&&this._searchItems([[t.text,t]],this._filter),t.forEachChild((t=>{t instanceof Ni&&this._onAppendTreeViewItem(t)}))}_onRemoveTreeViewItem(t){t.selected=!1,t.forEachChild(((t,e)=>{t instanceof Ni&&this._onRemoveTreeViewItem(t)}))}_onChildKeyDown(t,e){if(-1!==["Tab","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].indexOf(t.key))if(t.preventDefault(),t.stopPropagation(),"ArrowDown"===t.key){if(this._selectedItems.length){const t=Wi(e);t&&(this._pressedShift||this._pressedCtrl?t.selected=!0:this._selectSingleItem(t))}}else if("ArrowUp"===t.key){if(this._selectedItems.length){const t=Zi(e);t&&(this._pressedShift||this._pressedCtrl?t.selected=!0:this._selectSingleItem(t))}}else"ArrowLeft"===t.key?e.parent!==this&&(e.open=!1):"ArrowRight"===t.key?e.open=!0:t.key}_onChildClick(t,e){if(0===t.button&&e.allowSelect)if(this._pressedCtrl)e.selected=!e.selected;else if(this._pressedShift){if(!this._selectedItems.length||1===this._selectedItems.length&&this._selectedItems[0]===e)return void(e.selected=!0);const t=this._selectedItems[this._selectedItems.length-1];Xi(t),this._getChildrenRange(t,e).forEach((t=>{t.allowSelect&&(t.selected=!0)}))}else this._selectSingleItem(e)}traverseDepthFirst(t){const e=n=>{if(n&&n instanceof Ni&&(t(n),n.numChildren))for(let t=0;t<n.dom.childNodes.length;t+=1)e(n.dom.childNodes[t].ui)};for(let n=0;n<this.dom.childNodes.length;n+=1)e(this.dom.childNodes[n].ui)}_getTreeOrder(){const t=new Map;let e=0;return this.traverseDepthFirst((n=>{e+=1,t.set(n,e)})),t}_onChildDragStart(t,e){if(this.allowDrag&&!this._dragging){if(this._dragItems=[],-1===this._selectedItems.indexOf(e))e.class.add(Hi),this._dragItems.push(e);else{const t=[];let e=-1;for(let n=0;n<this._selectedItems.length;n+=1){let i=this._selectedItems[n].parent,s=0,o=!1;for(;i&&i instanceof Ni;){if(-1!==this._selectedItems.indexOf(i)){o=!0;break}s+=1,i=i.parent}if(!o){if(-1===e)e=s;else if(e!==s)return;t.push(this._selectedItems[n])}}this._dragItems=t}this._dragItems.length&&(this._dragItems.forEach((t=>{t.class.add(Hi)})),this.isDragging=!0,this.emit("dragstart",this._dragItems.slice()))}}_onChildDragEnd(t,e){if(!this.allowDrag||!this._dragging)return;this._dragItems.forEach((t=>t.class.remove(Hi)));let n=!1;for(let s=0;s<this._dragItems.length;s+=1)if(this._dragItems[s].parent===this){n=!0;break}const i=this._dragOverItem;if(!n&&i){if(this._dragItems.length>1){const t=this._getTreeOrder();this._dragItems.sort(((e,n)=>(t.get(e)??0)-(t.get(n)??0)))}if(this._dragItems.length){const t=[];if(this._onReparentFn){const e=[],n=t=>{let n=e.findIndex((e=>e.parent===t));return-1===n&&(e.push({children:[...t.dom.childNodes],parent:t}),n=e.length-1),e[n].children};this._dragItems.forEach((e=>{if(e.parent===i&&this._dragArea===$i||(t.push({item:e,oldParent:e.parent}),!e.parent))return;const s=n(e.parent),o=s.indexOf(e.dom);s.splice(o,1)})),t.forEach(((e,s)=>{if(this._dragArea===Gi){if(e.newParent=i.parent,!i.parent)return;const t=n(i.parent),s=t.indexOf(i.dom);t.splice(s,0,e.item.dom),e.newChildIndex=s}else if(this._dragArea===$i){e.newParent=i;const t=n(i);t.push(e.item.dom),e.newChildIndex=t.length-1}else if(this._dragArea===qi){if(e.newParent=i.parent,!i.parent)return;const o=n(i.parent),r=s>0?t[s-1].item:i,a=o.indexOf(r.dom);o.splice(a+1,0,e.item.dom),e.newChildIndex=a+1}e.newChildIndex-=1}))}else this._dragItems.forEach((e=>{e.parent===this._dragOverItem&&this._dragArea===$i||(t.push({item:e,oldParent:e.parent}),e.parent.remove(e))})),t.forEach(((e,n)=>{this._dragArea===Gi?(e.newParent=i.parent,i.parent.appendBefore(e.item,i),e.newChildIndex=Yi(e.item,e.newParent)):this._dragArea===$i?(e.newParent=i,i.append(e.item),i.open=!0,e.newChildIndex=Yi(e.item,e.newParent)):this._dragArea===qi&&(e.newParent=i.parent,i.parent.appendAfter(e.item,n>0?t[n-1].item:this._dragOverItem),e.newChildIndex=Yi(e.item,e.newParent))}));t.length&&(this._onReparentFn&&this._onReparentFn(t),this.emit("reparent",t))}}this._dragItems=[],this.isDragging=!1,this.emit("dragend")}_onChildDragOver(t,e){!this._allowDrag||!this._dragging||(e.allowDrop&&-1===this._dragItems.indexOf(e)?this._dragOverItem=e:this._dragOverItem=null,this._updateDragHandle(),this._onDragMove(t))}_scrollWhileDragging(){this._dragging&&0!==this._dragScroll&&(this._dragScrollElement.dom.scrollTop+=8*this._dragScroll,this._dragOverItem=null,this._updateDragHandle())}_updateDragHandle(t,e){if(!(e||this._allowDrag&&this._dragging))return;const n=t??this._dragOverItem;if(n&&!n.hidden&&n.parentsOpen){const t=n._containerContents.dom.getBoundingClientRect();this._dragHandle.hidden=!1,this._dragHandle.class.remove(qi,Gi,$i),this._dragHandle.class.add(this._dragArea);const e=t.top;let i=t.left,s=t.width;if(this.dom.parentElement){const t=this.dom.parentElement.getBoundingClientRect();i=Math.max(i,t.left),s=Math.min(s,this.dom.parentElement.clientWidth-i+t.left)}this._dragHandle.style.top=`${e}px`,this._dragHandle.style.left=`${i}px`,this._dragHandle.style.width=s-7+"px"}else this._dragHandle.hidden=!0}_selectSingleItem(t){let e=!1;for(let n=this._selectedItems.length-1;n>-1;n-=1)this._selectedItems[n]&&this._selectedItems[n]!==t&&(this._selectedItems[n].selected=!1,e=!0);t.selected=!!e||!t.selected}_onChildSelected(t){this._selectedItems.push(t),Xi(t),this.emit("select",t)}_onChildDeselected(t){const e=this._selectedItems.indexOf(t);-1!==e&&(this._selectedItems.splice(e,1),this.emit("deselect",t))}_onChildRename(t,e){if(this._filter){t.class.remove(Ui);const e=this._filterResults.indexOf(t);-1!==e&&this._filterResults.splice(e,1),this._searchItems([[t.text,t]],this._filter)}this.emit("rename",t,e)}_searchItems(t,e){const n=((t,e="",n={})=>{if(!(e=e.toLowerCase().trim()))return[];const i=Fi(e);if(!i.length)return[];n.containsCharsTolerance??(n.containsCharsTolerance=.5),n.editsDistanceTolerance??(n.editsDistanceTolerance=.5);let s=[];for(const r of t){const t=r[0].toLowerCase().trim().indexOf(e);s.push({name:r[0],item:r[1],tokens:Fi(r[0]),edits:1/0,subFull:-1!==t?t:1/0,sub:1/0})}for(let r=0;r<i.length;r++)s=Bi(s,i[r],n);s.sort(((t,e)=>t.subFull!==e.subFull?t.subFull-e.subFull:t.sub!==e.sub?t.sub-e.sub:t.edits!==e.edits?t.edits-e.edits:t.name.length-e.name.length));let o=s.map((t=>t.item));return n.hasOwnProperty("limitResults")&&o.length>(n.limitResults??0)&&(o=o.slice(0,n.limitResults)),o})(t,e);n.length&&n.forEach((t=>{this._filterResults.push(t),t.class.add(Ui)}))}_applyFilter(t){this._clearFilter(),this._wasDraggingAllowedBeforeFiltering=this._allowDrag,this._allowDrag=!1,this.class.add(Ki);const e=[];this.traverseDepthFirst((t=>{e.push([t.text,t])})),this._searchItems(e,t)}_clearFilter(){this._filterResults.forEach((t=>{t.destroyed||t.class.remove(Ui)})),this._filterResults.length=0,this.class.remove(Ki),this._allowDrag=this._wasDraggingAllowedBeforeFiltering}showDragHandle(t){this._updateDragHandle(t,!0)}deselect(){for(let t=this._selectedItems.length-1;t>-1;t-=1)this._selectedItems[t]&&(this._selectedItems[t].selected=!1)}clearTreeItems(){for(let t=this.dom.childNodes.length-1;t>-1;t-=1){const e=this.dom.childNodes[t];if(!e)continue;const n=e.ui;n instanceof Ni&&n.destroy()}this._selectedItems=[],this._dragItems=[],this._allowDrag=this._wasDraggingAllowedBeforeFiltering}set allowDrag(t){this._allowDrag=t,this._filter&&(this._wasDraggingAllowedBeforeFiltering=t)}get allowDrag(){return this._allowDrag}set allowReordering(t){this._allowReordering=t}get allowReordering(){return this._allowReordering}set allowRenaming(t){this._allowRenaming=t}get allowRenaming(){return this._allowRenaming}set isDragging(t){this._dragging!==t&&(t?(this._dragging=!0,this._updateDragHandle(),(this.scrollable||this._dragScrollElement!==this)&&(window.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("mousemove",this._onMouseMove),this._dragScrollInterval||(this._dragScrollInterval=window.setInterval((()=>{this._scrollWhileDragging()}),1e3/60)))):(this._dragOverItem=null,this._updateDragHandle(),this._dragging=!1,window.removeEventListener("mousemove",this._onMouseMove),this._dragScrollInterval&&(window.clearInterval(this._dragScrollInterval),this._dragScrollInterval=null)))}get isDragging(){return this._dragging}get selected(){return this._selectedItems.slice()}set filter(t){this._filter!==t&&(this._filter=t,t?this._applyFilter(t):this._clearFilter())}get filter(){return this._filter}get pressedCtrl(){return this._pressedCtrl}get pressedShift(){return this._pressedShift}}e(Qi,"EVENT_DRAGSTART","dragstart"),e(Qi,"EVENT_DRAGEND","dragend"),e(Qi,"EVENT_REPARENT","reparent"),e(Qi,"EVENT_SELECT","select"),e(Qi,"EVENT_DESELECT","deselect"),e(Qi,"EVENT_RENAME","rename");class Ji extends Qi{constructor(t={}){super(t),e(this,"wc",document.createElement("tree-view")),e(this,"shadowRoot",this.wc.attachShadow({mode:"open"})),this.shadowRoot.append(this.dom)}}var ts={exports:{}};!function(t){class e{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class n{constructor(t){this.target=t}}class i extends n{constructor(t,e,n,i){super(t),this.value=e,this.presetKey=n,this.last=i??!0}}function s(t){return null==t}const o={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class r{constructor(t){var e;this.message=null!==(e=o[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new r({type:"alreadydisposed"})}static notBindable(){return new r({type:"notbindable"})}static propertyNotFound(t){return new r({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new r({type:"shouldneverhappen"})}}class a{constructor(){this.observers_={}}on(t,e){let n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}off(t,e){const n=this.observers_[t];return n&&(this.observers_[t]=n.filter((t=>t.handler!==e))),this}emit(t,e){const n=this.observers_[t];n&&n.forEach((t=>{t.handler(e)}))}}const l="tp";function h(t){return(e,n)=>[l,"-",t,"v",e?`_${e}`:"",n?`-${n}`:""].join("")}function d(t,e){return n=>e(t(n))}function c(t){return t.rawValue}function p(t,e){t.emitter.on("change",d(c,e)),e(t.rawValue)}function u(t,e,n){p(t.value(e),n)}function v(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function m(t,e){return n=>{v(t,e,n)}}function g(t,e){p(t,(t=>{e.textContent=t??""}))}const b=h("btn");class _{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(b()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("button");n.classList.add(b("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(b("t")),g(e.props.value("title"),i),this.buttonElement.appendChild(i)}}class f{constructor(t,e){this.emitter=new a,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new _(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class w{constructor(t,e){var n;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(n=null==e?void 0:e.equals)&&void 0!==n?n:(t,e)=>t===e,this.emitter=new a,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=e??{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t,s=this.rawValue_;this.equals_(s,i)&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:i,sender:this}))}}class x{constructor(t){this.emitter=new a,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=e??{forceEmit:!1,last:!0},i=this.value_;i===t&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,previousRawValue:i,rawValue:this.value_,sender:this}))}}function y(t,e){const n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new w(t,e):new x(t)}class C{constructor(t){this.emitter=new a,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,n)=>Object.assign(e,{[n]:y(t[n])})),{})}static fromObject(t){const e=this.createCore(t);return new C(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function E(t,e){return Object.keys(e).reduce(((n,i)=>{if(void 0===n)return;const s=(0,e[i])(t[i]);return s.succeeded?Object.assign(Object.assign({},n),{[i]:s.value}):void 0}),{})}function P(t,e){return t.reduce(((t,n)=>{if(void 0===t)return;const i=e(n);return i.succeeded&&void 0!==i.value?[...t,i.value]:void 0}),[])}function k(t){return null!==t&&"object"==typeof t}function A(t){return e=>n=>{if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};const i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function L(t){return{custom:e=>A(e)(t),boolean:A((t=>"boolean"==typeof t?t:void 0))(t),number:A((t=>"number"==typeof t?t:void 0))(t),string:A((t=>"string"==typeof t?t:void 0))(t),function:A((t=>"function"==typeof t?t:void 0))(t),constant:e=>A((t=>t===e?e:void 0))(t),raw:A((t=>t))(t),object:e=>A((t=>{if(k(t))return E(t,e)}))(t),array:e=>A((t=>{if(Array.isArray(t))return P(t,e)}))(t)}}const M={optional:L(!0),required:L(!1)};function I(t,e){const n=M.required.object(e)(t);return n.succeeded?n.value:void 0}function T(t){console.warn([`Missing '${t.key}' of ${t.target} in ${t.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function z(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}class S{constructor(t){this.value_=t}static create(t){return[new S(t),(e,n)=>{t.setRawValue(e,n)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const V=h("");function R(t,e){return m(t,V(void 0,e))}class D extends C{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=S.create(y(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,n,i;const s=t??{};return new D(C.createCore({disabled:null!==(e=s.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(n=s.hidden)&&void 0!==n&&n,parent:null!==(i=s.parent)&&void 0!==i?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){p(this.globalDisabled_,R(t,"disabled")),u(this,"hidden",R(t,"hidden"))}bindDisabled(t){p(this.globalDisabled_,(e=>{t.disabled=e}))}bindTabIndex(t){p(this.globalDisabled_,(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}getGlobalDisabled_(){const t=this.get("parent");return!!t&&t.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const n=t.previousRawValue;null==n||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function N(){return["veryfirst","first","last","verylast"]}const O=h(""),j={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class F{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{N().forEach((t=>{e.classList.remove(O(void 0,j[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(O(void 0,j[t]))}))})),this.viewProps.handleDispose((()=>{z(e)}))}get parent(){return this.parent_}set parent(t){this.parent_=t,"parent"in this.viewProps.valMap_?this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null):T({key:"parent",target:D.name,place:"BladeController.parent"})}}const B="http://www.w3.org/2000/svg";function H(t){t.offsetHeight}function K(t,e){const n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function U(t){return void 0!==t.ontouchstart}function $(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function G(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const q=h("lbl");function Y(t,e){const n=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,i)=>{i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}class X{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(q()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(q("l")),u(e.props,"label",(e=>{s(e)?this.element.classList.add(q(void 0,"nol")):(this.element.classList.remove(q(void 0,"nol")),$(n),n.appendChild(Y(t,e)))})),this.element.appendChild(n),this.labelElement=n;const i=t.createElement("div");i.classList.add(q("v")),this.element.appendChild(i),this.valueElement=i}}class W extends F{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new X(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Z extends F{constructor(t){super(t),this.value=t.value}}class Q extends C{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=C.createCore(e);return new Q(n)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!s(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const n=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};u(this,"expanded",n),u(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function J(t){return Q.create(t)}function tt(t,e){let n=0;return K(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),H(e),n=e.clientHeight,t.set("temporaryExpanded",null),H(e)})),n}function et(t,e){e.style.height=t.styleHeight}function nt(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),s(t.get("expandedHeight"))&&t.set("expandedHeight",tt(t,e)),t.set("shouldFixHeight",!0),H(e)})),t.emitter.on("change",(()=>{et(t,e)})),et(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&t.cleanUpTransition()}))}class it{constructor(t,e){const n=h(e.viewName);this.element=t.createElement("div"),this.element.classList.add(n()),e.viewProps.bindClassModifiers(this.element)}}class st extends Z{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new X(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class ot{constructor(){this.disabled=!1,this.emitter=new a}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class rt{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new a,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class at{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function lt(t,e){if(t instanceof e)return t;if(t instanceof at){const n=t.constraints.reduce(((t,n)=>t||(n instanceof e?n:null)),null);if(n)return n}return null}class ht{constructor(t){this.values=C.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(t,n),e)}}class dt{constructor(t){this.values=C.fromObject({max:t.max,min:t.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(t){const e=this.values.get("max"),n=this.values.get("min");let i=t;return s(n)||(i=Math.max(i,n)),s(e)||(i=Math.min(i,e)),i}}class ct{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}const pt=h("pop");class ut{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(pt()),e.viewProps.bindClassModifiers(this.element),p(e.shows,m(this.element,pt(void 0,"v")))}}class vt{constructor(t,e){this.shows=y(!1),this.viewProps=e.viewProps,this.view=new ut(t,{shows:this.shows,viewProps:this.viewProps})}}const mt=h("txt");class gt{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(mt()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const n=t.createElement("input");n.classList.add(mt("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class bt{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new gt(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,n=this.parser_(e);s(n)||(this.value.rawValue=n),this.view.refresh()}}function _t(t){return"false"!==t&&!!t}class ft{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const wt={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class xt{constructor(t,e,n){this.left=e,this.operator=t,this.right=n}evaluate(){const t=wt[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const yt={"+":t=>t,"-":t=>-t,"~":t=>~t};class Ct{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=yt[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Et(t){return(e,n)=>{for(let i=0;i<t.length;i++){const s=t[i](e,n);if(""!==s)return s}return""}}function Pt(t,e){var n;const i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function kt(t,e){const n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function At(t,e){var n;const i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Lt(t,e){const n=At(t,e);if(""!==n)return n;const i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";const s=At(t,e+=1);return""===s?"":i+s}function Mt(t,e){const n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";const i=Lt(t,e);return""===i?"":n+i}function It(t,e){const n=t.substr(e,1);if("0"===n)return n;const i=kt(t,e);return e+=i.length,""===i?"":i+At(t,e)}function Tt(t,e){const n=It(t,e);if(e+=n.length,""===n)return"";const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const s=At(t,e);return n+i+s+Mt(t,e+=s.length)}function zt(t,e){const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const i=At(t,e);return e+=i.length,""===i?"":n+i+Mt(t,e)}function St(t,e){const n=It(t,e);return e+=n.length,""===n?"":n+Mt(t,e)}const Vt=Et([Tt,zt,St]);function Rt(t,e){var n;const i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Dt(t,e){const n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";const i=Rt(t,e);return""===i?"":n+i}function Nt(t,e){var n;const i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ot(t,e){const n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";const i=Nt(t,e);return""===i?"":n+i}function jt(t,e){var n;const i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ft(t,e){const n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";const i=jt(t,e);return""===i?"":n+i}const Bt=Et([Dt,Ot,Ft]),Ht=Et([Bt,Vt]);function Kt(t,e){const n=Ht(t,e);return e+=n.length,""===n?null:{evaluable:new ft(n),cursor:e}}function Ut(t,e){const n=t.substr(e,1);if(e+=n.length,"("!==n)return null;const i=Wt(t,e);if(!i)return null;e=i.cursor,e+=Pt(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:i.evaluable,cursor:e}}function $t(t,e){var n;return null!==(n=Kt(t,e))&&void 0!==n?n:Ut(t,e)}function Gt(t,e){const n=$t(t,e);if(n)return n;const i=t.substr(e,1);if(e+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;const s=Gt(t,e);return s?{cursor:e=s.cursor,evaluable:new Ct(i,s.evaluable)}:null}function qt(t,e,n){n+=Pt(e,n).length;const i=t.filter((t=>e.startsWith(t,n)))[0];return i?(n+=i.length,{cursor:n+=Pt(e,n).length,operator:i}):null}function Yt(t,e){return(n,i)=>{const s=t(n,i);if(!s)return null;i=s.cursor;let o=s.evaluable;for(;;){const s=qt(e,n,i);if(!s)break;i=s.cursor;const r=t(n,i);if(!r)return null;i=r.cursor,o=new xt(s.operator,o,r.evaluable)}return o?{cursor:i,evaluable:o}:null}}const Xt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>Yt(t,e)),Gt);function Wt(t,e){return e+=Pt(t,e).length,Xt(t,e)}function Zt(t){const e=Wt(t,0);return e&&e.cursor+Pt(t,e.cursor).length===t.length?e.evaluable:null}function Qt(t){var e;const n=Zt(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function Jt(t){if("number"==typeof t)return t;if("string"==typeof t){const e=Qt(t);if(!s(e))return e}return 0}function te(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}function ee(t){return String(t)}function ne(t,e){for(;t.length<e;)t.push(void 0)}function ie(t){const e=[];return ne(e,t),y(e)}function se(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function oe(t,e){const n=[...se(t),e];return n.length>t.length?n.splice(0,n.length-t.length):ne(n,t.length),n}function re({primary:t,secondary:e,forward:n,backward:i}){let s=!1;function o(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(i=>{o((()=>{e.setRawValue(n(t,e),i.options)}))})),e.emitter.on("change",(s=>{o((()=>{t.setRawValue(i(t,e),s.options)})),o((()=>{e.setRawValue(n(t,e),s.options)}))})),o((()=>{e.setRawValue(n(t,e),{forceEmit:!1,last:!0})}))}function ae(t,e){const n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function le(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function he(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function de(t){return"ArrowUp"===t||"ArrowDown"===t}function ce(t){return de(t)||"ArrowLeft"===t||"ArrowRight"===t}function pe(t,e){var n,i;const s=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:t.pageX-((null!==(n=s&&s.scrollX)&&void 0!==n?n:0)+o.left),y:t.pageY-((null!==(i=s&&s.scrollY)&&void 0!==i?i:0)+o.top)}}class ue{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new a,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(pe(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(pe(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(pe(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function ve(t,e,n,i,s){return i+(t-e)/(n-e)*(s-i)}function me(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function ge(t,e,n){return Math.min(Math.max(t,e),n)}const be=h("txt");class _e{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(be(),be(void 0,"num")),e.arrayPosition&&this.element.classList.add(be(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(be("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(be()),this.inputElement.classList.add(be("i"));const i=t.createElement("div");i.classList.add(be("k")),this.element.appendChild(i),this.knobElement=i;const s=t.createElementNS(B,"svg");s.classList.add(be("g")),this.knobElement.appendChild(s);const o=t.createElementNS(B,"path");o.classList.add(be("gb")),s.appendChild(o),this.guideBodyElem_=o;const r=t.createElementNS(B,"path");r.classList.add(be("gh")),s.appendChild(r),this.guideHeadElem_=r;const a=t.createElement("div");a.classList.add(h("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(be(void 0,"drg"));this.element.classList.add(be(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=ge(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class fe{constructor(t,e){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=null!==(n=e.sliderProps)&&void 0!==n?n:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=y(null),this.view=new _e(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new ue(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,n;const i=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("minValue"),s=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("maxValue");let o=t;return void 0!==i&&(o=Math.max(o,i)),void 0!==s&&(o=Math.min(o,s)),o}onInputChange_(t){const e=t.currentTarget.value,n=this.parser_(e);s(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}onInputKeyDown_(t){const e=ae(this.baseStep_,le(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==ae(this.baseStep_,le(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function we(t,e){t.write(e)}function xe(t){const e=t?lt(t,ct):null;return e?e.step:null}function ye(t,e){const n=t&&lt(t,ct);return n?me(n.step):Math.max(me(e),2)}function Ce(t){return xe(t)??1}function Ee(t,e){var n;const i=t&&lt(t,ct),s=Math.abs(null!==(n=null==i?void 0:i.step)&&void 0!==n?n:e);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}function Pe(t){return[t[0],t[1],t[2]]}function ke(t,e){const n=te("float"===e?2:0);return`rgb(${Pe(t.getComponents("rgb",e)).map((t=>n(t))).join(", ")})`}function Ae(t){return e=>ke(e,t)}function Le(t,e){const n=te(2),i=te("float"===e?2:0);return`rgba(${t.getComponents("rgb",e).map(((t,e)=>(3===e?n:i)(t))).join(", ")})`}function Me(t){return e=>Le(e,t)}function Ie(t,e){const n=te("float"===e?2:0),i=["r","g","b"];return`{${Pe(t.getComponents("rgb",e)).map(((t,e)=>`${i[e]}: ${n(t)}`)).join(", ")}}`}function Te(t){return e=>Ie(e,t)}function ze(t,e){const n=te(2),i=te("float"===e?2:0),s=["r","g","b","a"];return`{${t.getComponents("rgb",e).map(((t,e)=>{const o=3===e?n:i;return`${s[e]}: ${o(t)}`})).join(", ")}}`}function Se(t){return e=>ze(e,t)}["int","float"].reduce(((t,e)=>[...t,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:Ae(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:Me(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:Te(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:Se(e)}]),[]);class Ve{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var n,i;return null!==(i=null===(n=this.components[e])||void 0===n?void 0:n.constrain(t))&&void 0!==i?i:t}));return this.asm_.fromComponents(e)}}const Re=h("pndtxt");class De{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Re()),this.textViews.forEach((e=>{const n=t.createElement("div");n.classList.add(Re("a")),n.appendChild(e.element),this.element.appendChild(n)}))}}function Ne(t,e,n){return new fe(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:y(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}class Oe{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((n,i)=>Ne(t,e,i))),this.acs_.forEach(((t,n)=>{re({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[n],backward:(t,i)=>{const s=e.assembly.toComponents(t.rawValue);return s[n]=i.rawValue,e.assembly.fromComponents(s)}})})),this.view=new De(t,{textViews:this.acs_.map((t=>t.view))})}}function je(t,e){return"step"in t&&!s(t.step)?new ct(t.step,e):null}function Fe(t){return s(t.max)||s(t.min)?s(t.max)&&s(t.min)?null:new dt({max:t.max,min:t.min}):new ht({max:t.max,min:t.min})}const Be={monitor:{defaultInterval:200,defaultLineCount:3}},He=h("grl");class Ke{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(He()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=t.createElementNS(B,"svg");n.classList.add(He("g")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const i=t.createElementNS(B,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const s=t.createElement("div");s.classList.add(He("t"),h("tt")()),this.element.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.props_.get("minValue"),i=this.props_.get("maxValue"),s=[];this.value.rawValue.forEach(((o,r)=>{if(void 0===o)return;const a=ve(r,0,e,0,t.width),l=ve(o,n,i,t.height,0);s.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const o=this.tooltipElem_,r=this.value.rawValue[this.cursor_.rawValue];if(void 0===r)return void o.classList.remove(He("t","a"));const a=ve(this.cursor_.rawValue,0,e,0,t.width),l=ve(r,n,i,t.height,0);o.style.left=`${a}px`,o.style.top=`${l}px`,o.textContent=`${this.formatter_(r)}`,o.classList.contains(He("t","a"))||(o.classList.add(He("t","a"),He("t","in")),H(o),o.classList.remove(He("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Ue{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=y(-1),this.view=new Ke(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),U(t)){const t=new ue(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(ve(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.rawValue=Math.floor(ve(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}class $e{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}on(t,e){const i=e.bind(this);return this.controller_.emitter.on(t,(()=>{i(new n(this))})),this}}class Ge extends n{constructor(t,e,n){super(t),this.cell=e,this.index=n}}class qe extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.emitter_=new a;const e=this.controller_.valueController;e.cellControllers.forEach(((t,n)=>{const i=new $e(t);this.cellToApiMap_.set(t,i),t.emitter.on("click",(()=>{const t=n%e.size[0],s=Math.floor(n/e.size[0]);this.emitter_.emit("click",{event:new Ge(this,i,[t,s])})}))}))}cell(t,e){const n=this.controller_.valueController,i=n.cellControllers[e*n.size[0]+t];return this.cellToApiMap_.get(i)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class Ye{constructor(t,e){this.size=e.size;const[n,i]=this.size,s=[];for(let o=0;o<i;o++)for(let i=0;i<n;i++){const n=new f(t,{props:C.fromObject(Object.assign({},e.cellConfig(i,o))),viewProps:D.create()});s.push(n)}this.cellCs_=s,this.viewProps=D.create(),this.viewProps.handleDispose((()=>{this.cellCs_.forEach((t=>{t.viewProps.set("disposed",!0)}))})),this.view=new it(t,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach((t=>{this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}}const Xe={id:"buttongrid",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(t){const e=M,n=I(t,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return n?{params:n}:null},controller:t=>new W(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:new Ye(t.document,{cellConfig:t.params.cells,size:t.params.size})}),api:t=>t.controller instanceof W&&t.controller.valueController instanceof Ye?new qe(t.controller):null};class We extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.controller_.valueController.value.emitter.on(t,(t=>{n(new i(this,t.rawValue,void 0,t.options.last))})),this}}function Ze(t,e,n){return t*(1-n)+e*n}const Qe=20,Je=.001,tn=100;function en(t,e){let n=.25,i=.5,s=-1;for(let o=0;o<Qe;o++){const[o,r]=t.curve(i);if(i+=n*(o<e?1:-1),s=r,n*=.5,Math.abs(e-o)<Je)break}return s}class nn{constructor(t=0,e=0,n=1,i=1){this.cache_=[],this.comps_=[t,e,n,i]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(t){return!(s(t)||!Array.isArray(t))&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}static equals(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}curve(t){const e=Ze(0,this.x1,t),n=Ze(0,this.y1,t),i=Ze(this.x1,this.x2,t),s=Ze(this.y1,this.y2,t),o=Ze(this.x2,1,t),r=Ze(this.y2,1,t),a=Ze(e,i,t),l=Ze(n,s,t),h=Ze(i,o,t),d=Ze(s,r,t);return[Ze(a,h,t),Ze(l,d,t)]}y(t){if(0===this.cache_.length){const t=[];for(let e=0;e<tn;e++)t.push(en(this,ve(e,0,tn-1,0,1)));this.cache_=t}return this.cache_[Math.round(ve(ge(t,0,1),0,1,0,tn-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const sn={toComponents:t=>t.toObject(),fromComponents:t=>new nn(...t)};function on(t){const e=te(2);return`cubic-bezier(${t.toObject().map((t=>e(t))).join(", ")})`}const rn=[0,.5,.5,1];function an(t){const e=t.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return new nn(...rn);const n=[e[1],e[2],e[3],e[4]].reduce(((t,e)=>{if(!t)return null;const n=Number(e);return isNaN(n)?null:[...t,n]}),[]);return new nn(...n??rn)}const ln=h("cbz");class hn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ln()),e.viewProps.bindClassModifiers(this.element),e.foldable.bindExpandedClass(this.element,ln(void 0,"expanded")),u(e.foldable,"completed",m(this.element,ln(void 0,"cpl")));const n=t.createElement("div");n.classList.add(ln("h")),this.element.appendChild(n);const i=t.createElement("button");i.classList.add(ln("b")),e.viewProps.bindDisabled(i);const s=t.createElementNS(B,"svg");s.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',i.appendChild(s),n.appendChild(i),this.buttonElement=i;const o=t.createElement("div");if(o.classList.add(ln("t")),n.appendChild(o),this.textElement=o,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(ln("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const dn=h("cbzp");class cn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(dn()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(dn("g")),this.element.appendChild(n),this.graphElement=n;const i=t.createElement("div");i.classList.add(dn("t")),this.element.appendChild(i),this.textElement=i}}function pn(t,e){const n=new MutationObserver((t=>{for(const i of t)"childList"===i.type&&i.addedNodes.forEach((t=>{t.contains(t)&&(e(),n.disconnect())}))})),i=t.ownerDocument;n.observe(i.body,{attributes:!0,childList:!0,subtree:!0})}const un=h("cbzg");function vn(t,e){return n=>e(t(n))}class mn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(un()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(un("p")),this.element.appendChild(n),this.previewElement=n;const i=t.createElementNS(B,"svg");i.classList.add(un("g")),this.element.appendChild(i),this.svgElem_=i;const s=t.createElementNS(B,"path");s.classList.add(un("u")),this.svgElem_.appendChild(s),this.guideElem_=s;const o=t.createElementNS(B,"polyline");o.classList.add(un("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[t.createElement("div"),t.createElement("div")],this.handleElems_.forEach((t=>{t.classList.add(un("h")),this.element.appendChild(t)})),this.vectorElems_=[t.createElementNS(B,"line"),t.createElementNS(B,"line")],this.vectorElems_.forEach((t=>{t.classList.add(un("v")),this.svgElem_.appendChild(t)})),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=e.selection,this.handleElems_.forEach(((t,e)=>{p(this.sel_,vn((t=>t===e),m(t,un("h","sel"))))})),pn(this.element,(()=>{this.refresh()}))}getVertMargin_(t){return.25*t}valueToPosition(t,e){const n=this.element.getBoundingClientRect(),i=n.width,s=n.height,o=this.getVertMargin_(s);return{x:ve(t,0,1,0,i),y:ve(e,0,1,s-o,o)}}positionToValue(t,e){const n=this.element.getBoundingClientRect(),i=n.width,s=n.height,o=this.getVertMargin_(s);return{x:ge(ve(t,0,i,0,1),0,1),y:ve(e,s-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map((t=>{const e=this.valueToPosition(0,t),n=this.valueToPosition(1,t);return[`M ${e.x},${e.y}`,`L ${n.x},${n.y}`].join(" ")})).join(" "));const t=this.value_.rawValue,e=[];let n=0;for(;;){const i=this.valueToPosition(...t.curve(n));if(e.push([i.x,i.y].join(",")),n>=1)break;n=Math.min(n+.05,1)}this.lineElem_.setAttributeNS(null,"points",e.join(" "));const i=t.toObject();[0,1].forEach((t=>{const e=this.valueToPosition(t,t),n=this.valueToPosition(i[2*t],i[2*t+1]),s=this.vectorElems_[t];s.setAttributeNS(null,"x1",String(e.x)),s.setAttributeNS(null,"y1",String(e.y)),s.setAttributeNS(null,"x2",String(n.x)),s.setAttributeNS(null,"y2",String(n.y));const o=this.handleElems_[t];o.style.left=`${n.x}px`,o.style.top=`${n.y}px`}))}onValueChange_(){this.refresh()}}const gn=24,bn=400,_n=1e3,fn=h("cbzprv");class wn{constructor(t,e){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(fn()),e.viewProps.bindClassModifiers(this.element);const n=t.createElementNS(B,"svg");n.classList.add(fn("g")),this.element.appendChild(n),this.svgElem_=n;const i=t.createElementNS(B,"path");i.classList.add(fn("t")),this.svgElem_.appendChild(i),this.ticksElem_=i;const s=t.createElement("div");s.classList.add(fn("m")),this.element.appendChild(s),this.markerElem_=s,this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_),e.viewProps.handleDispose(this.onDispose_),pn(this.element,(()=>{this.refresh()}))}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(fn("m","a")),this.startTime_=(new Date).getTime()+bn,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(fn("m","a"))}onDispose_(){this.stop()}updateMarker_(t){const e=this.value_.rawValue.y(ge(t,0,1));this.markerElem_.style.left=100*e+"%"}refresh(){const t=this.svgElem_.getBoundingClientRect(),e=t.width,n=t.height,i=[],s=this.value_.rawValue;for(let o=0;o<gn;o++){const t=ve(o,0,gn-1,0,1),r=ve(s.y(t),0,1,0,e);i.push(`M ${r},0 v${n}`)}this.ticksElem_.setAttributeNS(null,"d",i.join(" "))}onTimer_(){if(null===this.startTime_)return;const t=(new Date).getTime()-this.startTime_,e=t/_n;this.updateMarker_(e),t>_n+bn&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function xn(t,e,n,i){const s=n-t,o=i-e;return Math.sqrt(s*s+o*o)}function yn(t,e,n,i){const s=xn(t,e,n,i),o=Math.atan2(i-e,n-t),r=Math.round(o/(Math.PI/4))*Math.PI/4;return{x:t+Math.cos(r)*s,y:e+Math.sin(r)*s}}class Cn{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.sel_=y(0),this.viewProps=e.viewProps,this.view=new mn(t,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new wn(t,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",(t=>{t.stopImmediatePropagation(),t.preventDefault(),this.prevView_.play()})),this.view.previewElement.appendChild(this.prevView_.element);const n=new ue(this.view.element);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(t,e,n){const i=this.sel_.rawValue,s=this.value.rawValue.toObject(),o=this.view.positionToValue(t.x,t.y),r=e?yn(i,i,o.x,o.y):o;s[2*i]=r.x,s[2*i+1]=r.y,this.value.setRawValue(new nn(...s),n)}onPointerDown_(t){const e=t.data;if(!e.point)return;const n=this.value.rawValue,i=this.view.valueToPosition(n.x1,n.y1),s=xn(e.point.x,e.point.y,i.x,i.y),o=this.view.valueToPosition(n.x2,n.y2),r=xn(e.point.x,e.point.y,o.x,o.y);this.sel_.rawValue=s<=r?0:1,this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(t){ce(t.key)&&t.preventDefault();const e=this.sel_.rawValue,n=this.value.rawValue.toObject();n[2*e]+=ae(this.baseStep_,he(t)),n[2*e+1]+=ae(this.baseStep_,le(t)),this.value.setRawValue(new nn(...n),{forceEmit:!1,last:!1})}onKeyUp_(t){ce(t.key)&&t.preventDefault();const e=ae(this.baseStep_,he(t)),n=ae(this.baseStep_,le(t));0===e&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class En{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new cn(t,{viewProps:this.viewProps}),this.gc_=new Cn(t,{baseStep:e.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const n=Object.assign(Object.assign({},e.axis),{constraint:new dt({max:1,min:0})}),i=Object.assign(Object.assign({},e.axis),{constraint:void 0});this.tc_=new Oe(t,{assembly:sn,axes:[n,i,n,i],parser:Qt,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map((t=>t.inputElement))]}refresh(){this.gc_.refresh()}}class Pn{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=J(e.expanded),this.view=new hn(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new bt(t,{parser:an,props:C.fromObject({formatter:on}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_="popup"===e.pickerLayout?new vt(t,{viewProps:this.viewProps}):null;const n=new En(t,{axis:e.axis,value:this.value,viewProps:this.viewProps});n.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),p(this.popC_.shows,(t=>{t&&n.refresh()})),re({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),nt(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=t.relatedTarget;(!e||!this.popC_.view.element.contains(e))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=G(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!U(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_&&"Escape"===t.key&&(this.popC_.shows.rawValue=!1)}}function kn(){return new Ve({assembly:sn,components:[0,1,2,3].map((t=>t%2==0?new dt({min:0,max:1}):void 0))})}const An={id:"cubic-bezier",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(t){const e=M,n=I(t,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom((t=>"inline"===t||"popup"===t?t:void 0))});return n?{params:n}:null},controller(t){var e,n;const i=y(new nn(...t.params.value),{constraint:kn(),equals:nn.equals}),s=new Pn(t.document,{axis:{baseStep:.1,textProps:C.fromObject({draggingScale:.01,formatter:te(2)})},expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,pickerLayout:null!==(n=t.params.picker)&&void 0!==n?n:"popup",value:i,viewProps:t.viewProps});return new st(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:s})},api:t=>t.controller instanceof st&&t.controller.valueController instanceof Pn?new We(t.controller):null};class Ln extends e{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}const Mn=20;class In{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(t){this.start_=t.getTime()}calculateFps_(t){if(0===this.timestamps_.length)return null;const e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}compactTimestamps_(){if(this.timestamps_.length<=Mn)return;const t=this.timestamps_.length-Mn;this.timestamps_.splice(0,t);const e=this.timestamps_[0].frameCount;this.timestamps_.forEach((t=>{t.frameCount-=e})),this.frameCount_-=e}end(t){if(null===this.start_)return;const e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}const Tn=h("fps");class zn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Tn()),e.viewProps.bindClassModifiers(this.element),this.graphElement=t.createElement("div"),this.graphElement.classList.add(Tn("g")),this.element.appendChild(this.graphElement);const n=t.createElement("div");n.classList.add(Tn("l")),this.element.appendChild(n);const i=t.createElement("span");i.classList.add(Tn("v")),i.textContent="--",n.appendChild(i),this.valueElement=i;const s=t.createElement("span");s.classList.add(Tn("u")),s.textContent="FPS",n.appendChild(s)}}class Sn{constructor(t,e){this.stopwatch_=new In,this.onTick_=this.onTick_.bind(this),this.ticker_=e.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=e.value,this.viewProps=e.viewProps,this.view=new zn(t,{viewProps:this.viewProps}),this.graphC_=new Ue(t,{formatter:te(0),lineCount:e.lineCount,props:C.fromObject({maxValue:e.maxValue,minValue:e.minValue}),value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose((()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()}))}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const t=this.stopwatch_.fps;if(null!==t){const e=this.value_.rawValue;this.value_.rawValue=oe(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}function Vn(t,e){return 0===e?new ot:new rt(t,e??Be.monitor.defaultInterval)}const Rn={id:"fpsgraph",type:"blade",accept(t){const e=M,n=I(t,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return n?{params:n}:null},controller(t){var e,n,i,s;const o=null!==(e=t.params.interval)&&void 0!==e?e:500;return new W(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:new Sn(t.document,{lineCount:null!==(n=t.params.lineCount)&&void 0!==n?n:2,maxValue:null!==(i=t.params.max)&&void 0!==i?i:90,minValue:null!==(s=t.params.min)&&void 0!==s?s:0,ticker:Vn(t.document,o),value:ie(80),viewProps:t.viewProps})})},api:t=>t.controller instanceof W&&t.controller.valueController instanceof Sn?new Ln(t.controller):null};class Dn{constructor(t,e){this.min=t,this.max=e}static isObject(t){if("object"!=typeof t||null===t)return!1;const e=t.min,n=t.max;return!("number"!=typeof e||"number"!=typeof n)}static equals(t,e){return t.min===e.min&&t.max===e.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Nn={fromComponents:t=>new Dn(t[0],t[1]),toComponents:t=>[t.min,t.max]};class On{constructor(t){this.edge=t}constrain(t){var e,n,i,s,o,r,a,l;if(t.min<=t.max)return new Dn(null!==(n=null===(e=this.edge)||void 0===e?void 0:e.constrain(t.min))&&void 0!==n?n:t.min,null!==(s=null===(i=this.edge)||void 0===i?void 0:i.constrain(t.max))&&void 0!==s?s:t.max);const h=(t.min+t.max)/2;return new Dn(null!==(r=null===(o=this.edge)||void 0===o?void 0:o.constrain(h))&&void 0!==r?r:h,null!==(l=null===(a=this.edge)||void 0===a?void 0:a.constrain(h))&&void 0!==l?l:h)}}const jn=h("rsltxt");class Fn{constructor(t,e){this.sliderView_=e.sliderView,this.textView_=e.textView,this.element=t.createElement("div"),this.element.classList.add(jn());const n=t.createElement("div");n.classList.add(jn("s")),n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(jn("t")),i.appendChild(this.textView_.element),this.element.appendChild(i)}}const Bn=h("rsl");class Hn{constructor(t,e){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=e.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=t.createElement("div"),this.element.classList.add(Bn()),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_);const n=t.createElement("div");n.classList.add(Bn("t")),this.element.appendChild(n),this.trackElement=n;const i=t.createElement("div");i.classList.add(Bn("b")),n.appendChild(i),this.barElement=i;const s=["min","max"].map((e=>{const i=t.createElement("div");return i.classList.add(Bn("k"),Bn("k",e)),n.appendChild(i),i}));this.knobElements=[s[0],s[1]],this.update_()}valueToX_(t){return 100*ge(ve(t,this.sliderProps_.get("minValue"),this.sliderProps_.get("maxValue"),0,1),0,1)}update_(){const t=this.value_.rawValue;0===t.length?this.element.classList.add(Bn(void 0,"zero")):this.element.classList.remove(Bn(void 0,"zero"));const e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left=`${e[0]}%`,this.barElement.style.right=100-e[1]+"%",this.knobElements.forEach(((t,n)=>{t.style.left=`${e[n]}%`}))}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class Kn{constructor(t,e){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=e.sliderProps,this.viewProps=e.viewProps,this.value=e.value,this.view=new Hn(t,{sliderProps:this.sliderProps,value:this.value,viewProps:e.viewProps});const n=new ue(this.view.trackElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}ofs_(){return"min"===this.grabbing_?this.view.knobElements[0].getBoundingClientRect().width/2:"max"===this.grabbing_?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(t){return t.point?ve((t.point.x+this.ofs_())/t.bounds.width,0,1,this.sliderProps.get("minValue"),this.sliderProps.get("maxValue")):null}onPointerDown_(t){if(!t.data.point)return;const e=t.data.point.x/t.data.bounds.width,n=this.value.rawValue,i=this.sliderProps.get("minValue"),s=this.sliderProps.get("maxValue"),o=ve(n.min,i,s,0,1),r=ve(n.max,i,s,0,1);Math.abs(r-e)<=.025?this.grabbing_="max":Math.abs(o-e)<=.025?this.grabbing_="min":e>=o&&e<=r?(this.grabbing_="length",this.grabOffset_=ve(e-o,0,1,0,s-i)):e<o?(this.grabbing_="min",this.onPointerMove_(t)):e>r&&(this.grabbing_="max",this.onPointerMove_(t))}applyPointToValue_(t,e){const n=this.valueFromData_(t);if(null===n)return;const i=this.sliderProps.get("minValue"),s=this.sliderProps.get("maxValue");if("min"===this.grabbing_)this.value.setRawValue(new Dn(n,this.value.rawValue.max),e);else if("max"===this.grabbing_)this.value.setRawValue(new Dn(this.value.rawValue.min,n),e);else if("length"===this.grabbing_){const t=this.value.rawValue.length;let o=n-this.grabOffset_,r=o+t;o<i?(o=i,r=i+t):r>s&&(o=s-t,r=s),this.value.setRawValue(new Dn(o,r),e)}}onPointerMove_(t){this.applyPointToValue_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.applyPointToValue_(t.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Un{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sc_=new Kn(t,e);const n={baseStep:e.baseStep,constraint:e.constraint,textProps:C.fromObject({draggingScale:e.draggingScale,formatter:e.formatter})};this.tc_=new Oe(t,{assembly:Nn,axes:[n,n],parser:e.parser,value:this.value,viewProps:e.viewProps}),this.view=new Fn(t,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function $n(t){return Dn.isObject(t)?new Dn(t.min,t.max):new Dn(0,0)}function Gn(t,e){t.writeProperty("max",e.max),t.writeProperty("min",e.min)}function qn(t){const e=[],n=Fe(t);n&&e.push(n);const i=je(t);return i&&e.push(i),new On(new at(e))}const Yn={id:"input-interval",type:"input",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept:(t,e)=>{if(!Dn.isObject(t))return null;const n=M,i=I(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,step:n.optional.number});return i?{initialValue:new Dn(t.min,t.max),params:i}:null},binding:{reader:t=>$n,constraint:t=>qn(t.params),equals:Dn.equals,writer:t=>Gn},controller(t){var e;const n=t.value,i=t.constraint;if(!(i instanceof On))throw r.shouldNeverHappen();const s=(n.rawValue.min+n.rawValue.max)/2,o=null!==(e=t.params.format)&&void 0!==e?e:te(ye(i.edge,s)),a=i.edge&&lt(i.edge,ht);if(a)return new Un(t.document,{baseStep:Ce(i.edge),constraint:i.edge,draggingScale:Ee(i.edge,s),formatter:o,parser:Qt,sliderProps:new C({maxValue:a.values.value("max"),minValue:a.values.value("min")}),value:n,viewProps:t.viewProps});const l={baseStep:Ce(i.edge),constraint:i.edge,textProps:C.fromObject({draggingScale:s,formatter:o})};return new Oe(t.document,{assembly:Nn,axes:[l,l],parser:Qt,value:n,viewProps:t.viewProps})}};class Xn{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}}class Wn extends i{constructor(t,e,n,i,s){super(t,i,s),this.cell=e,this.index=n}}class Zn extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach((t=>{const e=new Xn(t);this.cellToApiMap_.set(t,e)}))}get value(){return this.controller_.value}cell(t,e){const n=this.controller_.valueController,i=n.cellControllers[e*n.size[0]+t];return this.cellToApiMap_.get(i)}on(t,e){const n=e.bind(this);this.controller_.value.emitter.on(t,(t=>{const e=this.controller_.valueController,i=e.findCellByValue(t.rawValue);if(!i)return;const s=this.cellToApiMap_.get(i);if(!s)return;const o=e.cellControllers.indexOf(i);n(new Wn(this,s,[o%e.size[0],Math.floor(o/e.size[0])],t.rawValue,void 0))}))}}const Qn=h("rad");class Jn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Qn()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("label");n.classList.add(Qn("l")),this.element.appendChild(n);const i=t.createElement("input");i.classList.add(Qn("i")),i.name=e.name,i.type="radio",e.viewProps.bindDisabled(i),n.appendChild(i),this.inputElement=i;const s=t.createElement("div");s.classList.add(Qn("b")),n.appendChild(s);const o=t.createElement("div");o.classList.add(Qn("t")),s.appendChild(o),u(e.props,"title",(t=>{o.textContent=t}))}}class ti{constructor(t,e){this.props=e.props,this.viewProps=e.viewProps,this.view=new Jn(t,{name:e.name,props:this.props,viewProps:this.viewProps})}}class ei{constructor(t,e){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=e.size;const[n,i]=this.size;for(let s=0;s<i;s++)for(let i=0;i<n;i++){const n=new ti(t,{name:e.groupName,props:C.fromObject(Object.assign({},e.cellConfig(i,s))),viewProps:D.create()});this.cellCs_.push(n),this.cellValues_.push(e.cellConfig(i,s).value)}this.value=e.value,p(this.value,(t=>{const e=this.findCellByValue(t);e&&(e.view.inputElement.checked=!0)})),this.viewProps=D.create(),this.view=new it(t,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach((t=>{t.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}findCellByValue(t){const e=this.cellValues_.findIndex((e=>e===t));return e<0?null:this.cellCs_[e]}onCellInputChange_(t){const e=t.currentTarget,n=this.cellCs_.findIndex((t=>t.view.inputElement===e));n<0||(this.value.rawValue=this.cellValues_[n])}}const ni={id:"radiogrid",type:"blade",accept(t){const e=M,n=I(t,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return n?{params:n}:null},controller:t=>new st(t.document,{blade:t.blade,props:C.fromObject({label:t.params.label}),valueController:new ei(t.document,{groupName:t.params.groupName,cellConfig:t.params.cells,size:t.params.size,value:y(t.params.value)})}),api:t=>t.controller instanceof st&&t.controller.valueController instanceof ei?new Zn(t.controller):null};function ii(t){return{id:"input-radiogrid",type:"input",accept(e,n){if(!t.isType(e))return null;const i=M,s=I(n,{cells:i.required.function,groupName:i.required.string,size:i.required.array(i.required.number),view:i.required.constant("radiogrid")});return s?{initialValue:e,params:s}:null},binding:t.binding,controller:t=>new ei(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})}}const si=ii({isType:t=>"number"==typeof t,binding:{reader:t=>Jt,writer:t=>we}}),oi=ii({isType:t=>"string"==typeof t,binding:{reader:t=>ee,writer:t=>we}}),ri=ii({isType:t=>"boolean"==typeof t,binding:{reader:t=>_t,writer:t=>we}}),ai=[Xe,An,Rn,Yn,ni,ri,si,oi];t.ButtonCellApi=$e,t.ButtonGridApi=qe,t.ButtonGridController=Ye,t.CubicBezier=nn,t.CubicBezierApi=We,t.CubicBezierAssembly=sn,t.CubicBezierController=Pn,t.CubicBezierGraphController=Cn,t.CubicBezierGraphView=mn,t.CubicBezierPickerController=En,t.CubicBezierPickerView=cn,t.CubicBezierPreviewView=wn,t.CubicBezierView=hn,t.FpsGraphBladeApi=Ln,t.FpsGraphController=Sn,t.FpsView=zn,t.Fpswatch=In,t.Interval=Dn,t.IntervalAssembly=Nn,t.IntervalConstraint=On,t.RadioCellApi=Xn,t.RadioController=ti,t.RadioGridApi=Zn,t.RadioGridController=ei,t.RadioView=Jn,t.RangeSliderController=Kn,t.RangeSliderTextController=Un,t.RangeSliderTextView=Fn,t.RangeSliderView=Hn,t.TpRadioGridChangeEvent=Wn,t.plugins=ai,Object.defineProperty(t,"__esModule",{value:!0})}(ts.exports);var es=ts.exports;const ns=_e({__proto__:null,default:fe(es)},[es]);var is={exports:{}};!function(t){const e="tp";function n(t){return(n,i)=>[e,"-",t,"v",n?`_${n}`:"",i?`-${i}`:""].join("")}function i(t,e){return Object.keys(e).reduce(((n,i)=>{if(void 0===n)return;const s=(0,e[i])(t[i]);return s.succeeded?Object.assign(Object.assign({},n),{[i]:s.value}):void 0}),{})}function s(t,e){return t.reduce(((t,n)=>{if(void 0===t)return;const i=e(n);return i.succeeded&&void 0!==i.value?[...t,i.value]:void 0}),[])}function o(t){return null!==t&&"object"==typeof t}function r(t){return e=>n=>{if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};const i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function a(t){return{custom:e=>r(e)(t),boolean:r((t=>"boolean"==typeof t?t:void 0))(t),number:r((t=>"number"==typeof t?t:void 0))(t),string:r((t=>"string"==typeof t?t:void 0))(t),function:r((t=>"function"==typeof t?t:void 0))(t),constant:e=>r((t=>t===e?e:void 0))(t),raw:r((t=>t))(t),object:e=>r((t=>{if(o(t))return i(t,e)}))(t),array:e=>r((t=>{if(Array.isArray(t))return s(t,e)}))(t)}}const l={optional:a(!0),required:a(!1)};function h(t,e){const n=l.required.object(e)(t);return n.succeeded?n.value:void 0}function d(t,e,n,i){function s(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(e){o(e)}}function a(t){try{l(i.throw(t))}catch(e){o(e)}}function l(t){t.done?n(t.value):s(t.value).then(r,a)}l((i=i.apply(t,e||[])).next())}))}function c(){const t=document.createElement("canvas");t.width=128,t.height=64;const e=t.getContext("2d");return e.fillStyle="#222",e.fillRect(0,0,t.width,t.height),e.fillStyle="#ddd",e.font="monospaced",e.textAlign="center",e.textBaseline="middle",e.fillText("No image",.5*t.width,.5*t.height),new Promise((e=>{t.toBlob((t=>{const n=new Image;n.src=URL.createObjectURL(t),n.onload=()=>{e(n)}}))}))}function p(t){return d(this,void 0,void 0,(function*(){const e=new Image;return e.crossOrigin="anonymous",new Promise((n=>{e.src=t,e.onload=()=>{n(e)}}))}))}function u(t){const e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0);const n=new Image;return new Promise((t=>{e.toBlob((e=>{n.src=URL.createObjectURL(e),n.onload=()=>{t(n)}}))}))}const v=n("img");class m{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(v()),e.viewProps.bindClassModifiers(this.element),this.input=t.createElement("input"),this.input.classList.add(v("input")),this.input.setAttribute("type","file"),this.input.setAttribute("accept",e.extensions.join(",")),this.element.appendChild(this.input),this.image_=t.createElement("img"),this.image_.classList.add(v("image")),this.image_.classList.add(v(`image_${e.imageFit}`)),this.element.classList.add(v("area_root")),this.element.appendChild(this.image_)}changeImage(t){this.image_.src=t}changeDraggingState(t){const e=this.element;t?null==e||e.classList.add(v("area_dragging")):null==e||e.classList.remove(v("area_dragging"))}}class g{constructor(t,e){this.placeholderImage=null,this.value=e.value,this.viewProps=e.viewProps,this.view=new m(t,{viewProps:this.viewProps,extensions:e.extensions,imageFit:e.imageFit}),this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.viewProps.handleDispose((()=>{this.view.input.removeEventListener("change",this.onFile),this.view.input.removeEventListener("drop",this.onDrop),this.view.input.removeEventListener("dragover",this.onDragOver),this.view.input.removeEventListener("dragleave",this.onDragLeave)})),this.value.emitter.on("change",this.handleValueChange.bind(this)),this.handleValueChange()}onFile(t){const e=(null==t?void 0:t.target).files;if(!e||!e.length)return;const n=e[0],i=URL.createObjectURL(n);this.setValue(i),this.updateImage(i)}onDrop(t){return d(this,void 0,void 0,(function*(){t.preventDefault();try{const{dataTransfer:e}=t,n=null==e?void 0:e.files[0];if(n){const t=URL.createObjectURL(n);this.updateImage(t),this.setValue(t)}else{const t=null==e?void 0:e.getData("url");if(!t)throw new Error("No url");p(t).then((t=>d(this,void 0,void 0,(function*(){const e=yield u(t);this.updateImage(e.src),this.setValue(e)}))))}}catch(e){console.error("Could not parse the dropped image",e)}finally{this.view.changeDraggingState(!1)}}))}onDragOver(t){t.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}handleImage(t){return d(this,void 0,void 0,(function*(){if(t instanceof HTMLImageElement)u(t).then((t=>{this.updateImage(t.src)}));else if("string"==typeof t){let e="";try{if("placeholder"===t)throw new Error("placeholder");new URL(t),e=(yield p(t)).src}catch{e=(yield this.handlePlaceholderImage()).src}finally{this.updateImage(e),this.setValue(e)}}}))}updateImage(t){this.view.changeImage(t)}setValue(t){return d(this,void 0,void 0,(function*(){t instanceof HTMLImageElement?this.value.setRawValue(t):t?this.value.setRawValue(yield p(t)):this.value.setRawValue(yield this.handlePlaceholderImage())}))}handleValueChange(){this.handleImage(this.value.rawValue)}handlePlaceholderImage(){return d(this,void 0,void 0,(function*(){return this.placeholderImage||(this.placeholderImage=yield c()),this.placeholderImage}))}}const b=[".jpg",".png",".gif"],_={id:"input-image",type:"input",css:".tp-imgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-imgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-imgv:hover{background-color:var(--in-bg-h)}.tp-imgv:focus{background-color:var(--in-bg-f)}.tp-imgv:active{background-color:var(--in-bg-a)}.tp-imgv:disabled{opacity:0.5}:root{--tp-plugin-image-dragging-color: hsla(230, 100%, 66%, 1.00)}.tp-imgv{cursor:pointer;display:grid;height:calc(var(--bld-us) * 3);overflow:hidden;position:relative}.tp-imgv.tp-v-disabled{opacity:0.5}.tp-imgv_input{width:100%;height:100%;opacity:0}.tp-imgv_image{width:100%;height:100%;position:absolute;pointer-events:none;border:0}.tp-imgv_image_contain{-o-object-fit:contain;object-fit:contain}.tp-imgv_image_cover{-o-object-fit:cover;object-fit:cover}.tp-imgv_area_root{transition:opacity 0.16s ease-in-out}.tp-imgv_area_dragging{border:2px dashed var(--tp-plugin-image-dragging-color);border-radius:6px;opacity:0.6}",accept(t,e){if(!(t instanceof HTMLImageElement||"string"==typeof t))return null;const n=l,i=h(e,{view:n.required.constant("input-image"),acceptUrl:n.optional.boolean,imageFit:n.optional.custom((t=>"contain"===t||"cover"===t?t:void 0)),extensions:n.optional.array(n.required.string)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>t=>t instanceof HTMLImageElement?""===t.src?"placeholder":t.src:"string"==typeof t?t:"placeholder",writer:t=>(t,e)=>{t.write(e)}},controller(t){var e,n;return new g(t.document,{value:t.value,imageFit:null!==(e=t.params.imageFit)&&void 0!==e?e:"cover",viewProps:t.viewProps,extensions:null!==(n=t.params.extensions)&&void 0!==n?n:b})}};t.plugin=_,Object.defineProperty(t,"__esModule",{value:!0})}(is.exports);var ss=is.exports;const os=_e({__proto__:null,default:fe(ss)},[ss]);var rs={exports:{}};!function(t){function e(t){return null==t}const n={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class i{constructor(t){var e;this.message=null!==(e=n[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new i({type:"alreadydisposed"})}static notBindable(){return new i({type:"notbindable"})}static propertyNotFound(t){return new i({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new i({type:"shouldneverhappen"})}}class s{constructor(){this.observers_={}}on(t,e){let n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}off(t,e){const n=this.observers_[t];return n&&(this.observers_[t]=n.filter((t=>t.handler!==e))),this}emit(t,e){const n=this.observers_[t];n&&n.forEach((t=>{t.handler(e)}))}}const o="tp";function r(t){return(e,n)=>[o,"-",t,"v",e?`_${e}`:"",n?`-${n}`:""].join("")}function a(t,e){return n=>e(t(n))}function l(t){return t.rawValue}function h(t,e){t.emitter.on("change",a(l,e)),e(t.rawValue)}function d(t,e,n){h(t.value(e),n)}function c(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function p(t,e){return n=>{c(t,e,n)}}class u{constructor(t,e){var n;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(n=null==e?void 0:e.equals)&&void 0!==n?n:(t,e)=>t===e,this.emitter=new s,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=e??{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t;this.equals_(this.rawValue_,i)&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,rawValue:i,sender:this}))}}class v{constructor(t){this.emitter=new s,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=e??{forceEmit:!1,last:!0};this.value_===t&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,rawValue:this.value_,sender:this}))}}function m(t,e){const n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new u(t,e):new v(t)}class g{constructor(t){this.emitter=new s,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,n)=>Object.assign(e,{[n]:m(t[n])})),{})}static fromObject(t){const e=this.createCore(t);return new g(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function b(t,e){return Object.keys(e).reduce(((n,i)=>{if(void 0===n)return;const s=(0,e[i])(t[i]);return s.succeeded?Object.assign(Object.assign({},n),{[i]:s.value}):void 0}),{})}function _(t,e){return t.reduce(((t,n)=>{if(void 0===t)return;const i=e(n);return i.succeeded&&void 0!==i.value?[...t,i.value]:void 0}),[])}function f(t){return null!==t&&"object"==typeof t}function w(t){return e=>n=>{if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};const i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function x(t){return{custom:e=>w(e)(t),boolean:w((t=>"boolean"==typeof t?t:void 0))(t),number:w((t=>"number"==typeof t?t:void 0))(t),string:w((t=>"string"==typeof t?t:void 0))(t),function:w((t=>"function"==typeof t?t:void 0))(t),constant:e=>w((t=>t===e?e:void 0))(t),raw:w((t=>t))(t),object:e=>w((t=>{if(f(t))return b(t,e)}))(t),array:e=>w((t=>{if(Array.isArray(t))return _(t,e)}))(t)}}const y={optional:x(!0),required:x(!1)};function C(t,e){const n=y.required.object(e)(t);return n.succeeded?n.value:void 0}const E="http://www.w3.org/2000/svg";function P(t){t.offsetHeight}function k(t,e){const n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function A(t){return void 0!==t.ontouchstart}function L(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}class M extends g{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=g.createCore(e);return new M(n)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!e(t)?`${t}px`:"auto"}bindExpandedClass(t,e){d(this,"expanded",(()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)}))}}function I(t,e){let n=0;return k(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),P(e),n=e.clientHeight,t.set("temporaryExpanded",null),P(e)})),n}function T(t,e){e.style.height=t.styleHeight}function z(t,n){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),e(t.get("expandedHeight"))&&t.set("expandedHeight",I(t,n)),t.set("shouldFixHeight",!0),P(n)})),t.emitter.on("change",(()=>{T(t,n)})),T(t,n),n.addEventListener("transitionend",(e=>{"height"===e.propertyName&&(t.set("shouldFixHeight",!1),t.set("expandedHeight",null),t.set("completed",!0))}))}class S{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}class V{constructor(t){this.maxValue=t.max,this.minValue=t.min}constrain(t){let n=t;return e(this.minValue)||(n=Math.max(n,this.minValue)),e(this.maxValue)||(n=Math.min(n,this.maxValue)),n}}class R{constructor(t){this.step=t}constrain(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}const D=r("pop");class N{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(D()),e.viewProps.bindClassModifiers(this.element),h(e.shows,p(this.element,D(void 0,"v")))}}class O{constructor(t,e){this.shows=m(!1),this.viewProps=e.viewProps,this.view=new N(t,{shows:this.shows,viewProps:this.viewProps})}}class j{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const F={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class B{constructor(t,e,n){this.left=e,this.operator=t,this.right=n}evaluate(){const t=F[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const H={"+":t=>t,"-":t=>-t,"~":t=>~t};class K{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=H[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function U(t){return(e,n)=>{for(let i=0;i<t.length;i++){const s=t[i](e,n);if(""!==s)return s}return""}}function $(t,e){var n;const i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function G(t,e){const n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function q(t,e){var n;const i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Y(t,e){const n=q(t,e);if(""!==n)return n;const i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";const s=q(t,e+=1);return""===s?"":i+s}function X(t,e){const n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";const i=Y(t,e);return""===i?"":n+i}function W(t,e){const n=t.substr(e,1);if("0"===n)return n;const i=G(t,e);return e+=i.length,""===i?"":i+q(t,e)}function Z(t,e){const n=W(t,e);if(e+=n.length,""===n)return"";const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const s=q(t,e);return n+i+s+X(t,e+=s.length)}function Q(t,e){const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const i=q(t,e);return e+=i.length,""===i?"":n+i+X(t,e)}function J(t,e){const n=W(t,e);return e+=n.length,""===n?"":n+X(t,e)}const tt=U([Z,Q,J]);function et(t,e){var n;const i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function nt(t,e){const n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";const i=et(t,e);return""===i?"":n+i}function it(t,e){var n;const i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function st(t,e){const n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";const i=it(t,e);return""===i?"":n+i}function ot(t,e){var n;const i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}function rt(t,e){const n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";const i=ot(t,e);return""===i?"":n+i}const at=U([nt,st,rt]),lt=U([at,tt]);function ht(t,e){const n=lt(t,e);return e+=n.length,""===n?null:{evaluable:new j(n),cursor:e}}function dt(t,e){const n=t.substr(e,1);if(e+=n.length,"("!==n)return null;const i=gt(t,e);if(!i)return null;e=i.cursor,e+=$(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:i.evaluable,cursor:e}}function ct(t,e){return ht(t,e)||dt(t,e)}function pt(t,e){const n=ct(t,e);if(n)return n;const i=t.substr(e,1);if(e+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;const s=pt(t,e);return s?{cursor:e=s.cursor,evaluable:new K(i,s.evaluable)}:null}function ut(t,e,n){n+=$(e,n).length;const i=t.filter((t=>e.startsWith(t,n)))[0];return i?(n+=i.length,{cursor:n+=$(e,n).length,operator:i}):null}function vt(t,e){return(n,i)=>{const s=t(n,i);if(!s)return null;i=s.cursor;let o=s.evaluable;for(;;){const s=ut(e,n,i);if(!s)break;i=s.cursor;const r=t(n,i);if(!r)return null;i=r.cursor,o=new B(s.operator,o,r.evaluable)}return o?{cursor:i,evaluable:o}:null}}const mt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>vt(t,e)),pt);function gt(t,e){return e+=$(t,e).length,mt(t,e)}function bt(t){const e=gt(t,0);return e&&e.cursor+$(t,e.cursor).length===t.length?e.evaluable:null}function _t(t){var e;const n=bt(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function ft(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}function wt({primary:t,secondary:e,forward:n,backward:i}){let s=!1;function o(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(i=>{o((()=>{e.setRawValue(n(t,e),i.options)}))})),e.emitter.on("change",(s=>{o((()=>{t.setRawValue(i(t,e),s.options)})),o((()=>{e.setRawValue(n(t,e),s.options)}))})),o((()=>{e.setRawValue(n(t,e),{forceEmit:!1,last:!0})}))}function xt(t,e){const n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function yt(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Ct(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Et(t){return"ArrowUp"===t||"ArrowDown"===t}function Pt(t){return Et(t)||"ArrowLeft"===t||"ArrowRight"===t}function kt(t,e){const n=e.ownerDocument.defaultView,i=e.getBoundingClientRect();return{x:t.pageX-((n&&n.scrollX||0)+i.left),y:t.pageY-((n&&n.scrollY||0)+i.top)}}class At{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new s,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Lt(t,e,n){return Math.min(Math.max(t,e),n)}const Mt=r("txt");class It{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Mt(),Mt(void 0,"num")),e.arrayPosition&&this.element.classList.add(Mt(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(Mt("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Mt()),this.inputElement.classList.add(Mt("i"));const i=t.createElement("div");i.classList.add(Mt("k")),this.element.appendChild(i),this.knobElement=i;const s=t.createElementNS(E,"svg");s.classList.add(Mt("g")),this.knobElement.appendChild(s);const o=t.createElementNS(E,"path");o.classList.add(Mt("gb")),s.appendChild(o),this.guideBodyElem_=o;const a=t.createElementNS(E,"path");a.classList.add(Mt("gh")),s.appendChild(a),this.guideHeadElem_=a;const l=t.createElement("div");l.classList.add(r("tt")()),this.knobElement.appendChild(l),this.tooltipElem_=l,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(Mt(void 0,"drg"));this.element.classList.add(Mt(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=Lt(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Tt{constructor(t,e){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=m(null),this.view=new It(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new At(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}onInputChange_(t){const n=t.currentTarget.value,i=this.parser_(n);e(i)||(this.value.rawValue=i),this.view.refresh()}onInputKeyDown_(t){const e=xt(this.baseStep_,yt(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==xt(this.baseStep_,yt(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function zt(t){if("inline"===t||"popup"===t)return t}function St(t){const e=y;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}class Vt{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var n,i;return null!==(i=null===(n=this.components[e])||void 0===n?void 0:n.constrain(t))&&void 0!==i?i:t}));return this.asm_.fromComponents(e)}}const Rt=r("pndtxt");class Dt{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Rt()),this.textViews.forEach((e=>{const n=t.createElement("div");n.classList.add(Rt("a")),n.appendChild(e.element),this.element.appendChild(n)}))}}function Nt(t,e,n){return new Tt(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:m(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}class Ot{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((n,i)=>Nt(t,e,i))),this.acs_.forEach(((t,n)=>{wt({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[n],backward:(t,i)=>{const s=e.assembly.toComponents(t.rawValue);return s[n]=i.rawValue,e.assembly.fromComponents(s)}})})),this.view=new Dt(t,{textViews:this.acs_.map((t=>t.view))})}}class jt{multiply(t){return this.format(this.quat.multiply(t.quat))}premultiply(t){return this.format(t.multiply(this))}slerp(t,e){return this.format(this.quat.slerp(t.quat,e))}}function Ft(t,e,n){return Math.min(Math.max(t,e),n)}function Bt(t,e){return Math.floor(t/e)*e}function Ht(t,e){return t-Bt(t,e)}function Kt(t){return Ht(t+Math.PI,2*Math.PI)-Math.PI}class Ut extends jt{constructor(t,e,n,i,s){super(),this.x=t??0,this.y=e??0,this.z=n??0,this.order=i??"XYZ",this.unit=s??"rad"}static fromQuaternion(t,e,n){const i=t.toMat3(),[s,o,r,a]="XYZ"===e?[0,1,2,1]:"XZY"===e?[0,2,1,-1]:"YXZ"===e?[1,0,2,-1]:"YZX"===e?[1,2,0,1]:"ZXY"===e?[2,0,1,1]:[2,1,0,-1],l=[0,0,0],h=i[r+3*s];return l[o]=-a*Math.asin(Ft(h,-1,1)),Math.abs(h)<.999999?(l[s]=a*Math.atan2(i[r+3*o],i[4*r]),l[r]=a*Math.atan2(i[o+3*s],i[4*s])):l[s]=a*Math.atan2(-i[o+3*r],i[4*o]),Math.abs(l[s])+Math.abs(l[r])>Math.PI&&(l[s]=Kt(l[s]+Math.PI),l[o]=Kt(Math.PI-l[o]),l[r]=Kt(l[r]+Math.PI)),new Ut(...l,e).reunit(n)}get quat(){return $t.fromEuler(this)}getComponents(){return[this.x,this.y,this.z]}toEuler(t,e){return this.reorder(t).reunit(e)}format(t){return t instanceof Ut?t.reorder(this.order):t.toEuler(this.order,this.unit)}reorder(t){return t===this.order?this:this.quat.toEuler(t,this.unit)}reunit(t){const e={deg:Math.PI/180,rad:1,turn:2*Math.PI}[this.unit]*{deg:180/Math.PI,rad:1,turn:.5/Math.PI}[t];return new Ut(e*this.x,e*this.y,e*this.z,this.order,t)}}class $t extends jt{constructor(t,e,n,i){super(),this.x=t??0,this.y=e??0,this.z=n??0,this.w=i??1}static fromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return new $t(t.x*i,t.y*i,t.z*i,Math.cos(n))}static fromEuler(t){const e=t.reunit("rad"),[n,i,s,o]="XYZ"===e.order?[0,1,2,1]:"XZY"===e.order?[0,2,1,-1]:"YXZ"===e.order?[1,0,2,-1]:"YZX"===e.order?[1,2,0,1]:"ZXY"===e.order?[2,0,1,1]:[2,1,0,-1],r=e.getComponents(),a=.5*r[n],l=.5*o*r[i],h=.5*r[s],d=Math.cos(a),c=Math.cos(l),p=Math.cos(h),u=Math.sin(a),v=Math.sin(l),m=Math.sin(h),g=[0,0,0,p*c*d+m*v*u];return g[n]=p*c*u-m*v*d,g[i]=o*(p*v*d+m*c*u),g[s]=m*c*d-p*v*u,new $t(...g)}static lookRotation(t,e){const{normal:n,tangent:i,binormal:s}=t.orthoNormalize(e),o=s.x,r=i.x,a=n.x,l=s.y,h=i.y,d=n.y,c=s.z,p=i.z,u=n.z,v=o+h+u;if(v>0){const t=.5/Math.sqrt(v+1);return new $t((p-d)*t,(a-c)*t,(l-r)*t,.25/t)}if(o>h&&o>u){const t=2*Math.sqrt(1+o-h-u);return new $t(.25*t,(r+l)/t,(a+c)/t,(p-d)/t)}if(h>u){const t=2*Math.sqrt(1+h-o-u);return new $t((r+l)/t,.25*t,(d+p)/t,(a-c)/t)}{const t=2*Math.sqrt(1+u-o-h);return new $t((a+c)/t,(d+p)/t,.25*t,(l-r)/t)}}get quat(){return this}getComponents(){return[this.x,this.y,this.z,this.w]}toEuler(t,e){return Ut.fromQuaternion(this,t,e)}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const t=this.length;return 0===t?new $t:new $t(this.x/t,this.y/t,this.z/t,this.w/t)}get negated(){return new $t(-this.x,-this.y,-this.z,-this.w)}get ban360s(){return this.w<0?this.negated:this}multiply(t){const e=t.quat;return new $t(this.w*e.x+this.x*e.w+this.y*e.z-this.z*e.y,this.w*e.y-this.x*e.z+this.y*e.w+this.z*e.x,this.w*e.z+this.x*e.y-this.y*e.x+this.z*e.w,this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z)}format(t){return t.quat}slerp(t,e){let n=t.quat;if(0===e)return this;if(1===e)return n;const i=this.ban360s;n=n.ban360s;let s=i.w*n.w+i.x*n.x+i.y*n.y+i.z*n.z;if(s<0&&(n=n.negated,s=-s),s>=1)return i;const o=1-s*s;if(o<=Number.EPSILON){const t=1-e;return new $t(t*i.x+e*n.x,t*i.y+e*n.y,t*i.z+e*n.z,t*i.w+e*n.w).normalized}const r=Math.sqrt(o),a=Math.atan2(r,s),l=Math.sin((1-e)*a)/r,h=Math.sin(e*a)/r;return new $t(i.x*l+n.x*h,i.y*l+n.y*h,i.z*l+n.z*h,i.w*l+n.w*h)}toMat3(){const{x:t,y:e,z:n,w:i}=this;return[1-2*e*e-2*n*n,2*t*e+2*n*i,2*t*n-2*e*i,2*t*e-2*n*i,1-2*t*t-2*n*n,2*e*n+2*t*i,2*t*n+2*e*i,2*e*n-2*t*i,1-2*t*t-2*e*e]}}class Gt{constructor(){this.offset=[0,0,-5],this.fov=30,this.aspect=1,this.viewport=[0,0,1,1]}project(t){const e=.5*(this.viewport[0]+this.viewport[2]),n=.5*(this.viewport[1]+this.viewport[3]),i=this.viewport[2]-this.viewport[0],s=this.viewport[3]-this.viewport[1],o=1/Math.tan(this.fov*Math.PI/360),r=-(t.z+this.offset[2]);return[e+(t.x+this.offset[0])/r*o*i*.5/this.aspect,n-(t.y+this.offset[1])/r*o*s*.5]}}class qt{constructor(t,e,n){this.element=t.createElementNS(E,"path"),this.vertices=e,this.projector=n}setRotation(t){let e="";return this.vertices.forEach(((n,i)=>{const s=n.applyQuaternion(t),[o,r]=this.projector.project(s);e+=`${0===i?"M":"L"}${o} ${r}`})),this.element.setAttributeNS(null,"d",e),this}}class Yt{constructor(t,e,n){this.x=t??0,this.y=e??0,this.z=n??0}getComponents(){return[this.x,this.y,this.z]}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const t=this.length;return 0===t?new Yt:new Yt(this.x/t,this.y/t,this.z/t)}get negated(){return new Yt(-this.x,-this.y,-this.z)}add(t){return new Yt(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new Yt(this.x-t.x,this.y-t.y,this.z-t.z)}scale(t){return new Yt(this.x*t,this.y*t,this.z*t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){return new Yt(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}orthoNormalize(t){const e=this.normalized;t=t.normalized;let n=e.dot(t);1===n&&(t=Math.abs(e.y)>Math.abs(e.z)?new Yt(0,0,1):new Yt(0,1,0),n=e.dot(t));const i=(t=t.sub(e.scale(n)).normalized).cross(e);return{normal:e,tangent:t,binormal:i}}applyQuaternion(t){const e=t.w*this.x+t.y*this.z-t.z*this.y,n=t.w*this.y+t.z*this.x-t.x*this.z,i=t.w*this.z+t.x*this.y-t.y*this.x,s=-t.x*this.x-t.y*this.y-t.z*this.z;return new Yt(e*t.w+s*-t.x+n*-t.z-i*-t.y,n*t.w+s*-t.y+i*-t.x-e*-t.z,i*t.w+s*-t.z+e*-t.y-n*-t.x)}}function Xt(t,e){const n=e.z>0?new $t(0,0,0,1):new $t(0,0,1,0);return Math.abs(t.z)>.9999?n:$t.lookRotation(t,e)}function Wt(t,e,n,i,s,o=1){const r=[];for(let a=0;a<n;a++){const l=t+e*a/(n-1),h=new Yt;h[i]=o*Math.cos(l),h[s]=o*Math.sin(l),r.push(h)}return r}const Zt=r("rotationgizmo"),Qt=new Yt(0,0,0),Jt=new Yt(1,0,0),te=new Yt(0,1,0),ee=new Yt(0,0,1),ne=new Yt(0,0,-1),ie=new Yt(.7,0,0),se=new Yt(0,.7,0),oe=new Yt(0,0,.7),re=new Yt(-.7,0,0),ae=new Yt(0,-.7,0),le=new Yt(0,0,-.7),he=new $t(0,0,0,1);function de(t,e,n){const i=t.createElementNS(E,"g"),s=t.createElementNS(E,"circle");s.classList.add(Zt(e)),s.setAttributeNS(null,"cx","0"),s.setAttributeNS(null,"cy","0"),s.setAttributeNS(null,"r","8"),i.appendChild(s);const o=t.createElementNS(E,"text");return o.classList.add(Zt("labeltext")),o.setAttributeNS(null,"y","4"),o.setAttributeNS(null,"text-anchor","middle"),o.setAttributeNS(null,"font-size","10"),o.textContent=n,i.appendChild(o),i}class ce{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.onModeChange_=this.onModeChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Zt()),"popup"===e.pickerLayout&&this.element.classList.add(Zt(void 0,"p"));const n=t.createElement("div");n.classList.add(Zt("p")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=t.createElementNS(E,"svg");i.classList.add(Zt("g")),this.padElement.appendChild(i),this.svgElem_=i,this.projector_=new Gt,this.projector_.viewport=[0,0,136,136];const s=Wt(0,Math.PI,33,"x","y"),o=Wt(0,2*Math.PI,65,"x","y",1.1);this.xArcB_=new qt(t,s,this.projector_),this.xArcB_.element.classList.add(Zt("arcx")),this.svgElem_.appendChild(this.xArcB_.element),this.yArcB_=new qt(t,s,this.projector_),this.yArcB_.element.classList.add(Zt("arcy")),this.svgElem_.appendChild(this.yArcB_.element),this.zArcB_=new qt(t,s,this.projector_),this.zArcB_.element.classList.add(Zt("arcz")),this.svgElem_.appendChild(this.zArcB_.element),this.xArcBC_=new qt(t,s,this.projector_),this.xArcBC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.xArcBC_.element),this.yArcBC_=new qt(t,s,this.projector_),this.yArcBC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.yArcBC_.element),this.zArcBC_=new qt(t,s,this.projector_),this.zArcBC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.zArcBC_.element);const r=t.createElementNS(E,"g");i.classList.add(Zt("axes")),this.svgElem_.appendChild(r),this.axesElem_=r,this.xAxis_=new qt(t,[Qt,ie],this.projector_),this.xAxis_.element.classList.add(Zt("axisx")),this.axesElem_.appendChild(this.xAxis_.element),this.yAxis_=new qt(t,[Qt,se],this.projector_),this.yAxis_.element.classList.add(Zt("axisy")),this.axesElem_.appendChild(this.yAxis_.element),this.zAxis_=new qt(t,[Qt,oe],this.projector_),this.zAxis_.element.classList.add(Zt("axisz")),this.axesElem_.appendChild(this.zAxis_.element),this.xnAxis_=new qt(t,[Qt,re],this.projector_),this.xnAxis_.element.classList.add(Zt("axisn")),this.axesElem_.appendChild(this.xnAxis_.element),this.ynAxis_=new qt(t,[Qt,ae],this.projector_),this.ynAxis_.element.classList.add(Zt("axisn")),this.axesElem_.appendChild(this.ynAxis_.element),this.znAxis_=new qt(t,[Qt,le],this.projector_),this.znAxis_.element.classList.add(Zt("axisn")),this.axesElem_.appendChild(this.znAxis_.element),this.xArcF_=new qt(t,s,this.projector_),this.xArcF_.element.classList.add(Zt("arcx")),this.svgElem_.appendChild(this.xArcF_.element),this.yArcF_=new qt(t,s,this.projector_),this.yArcF_.element.classList.add(Zt("arcy")),this.svgElem_.appendChild(this.yArcF_.element),this.zArcF_=new qt(t,s,this.projector_),this.zArcF_.element.classList.add(Zt("arcz")),this.svgElem_.appendChild(this.zArcF_.element),this.xArcFC_=new qt(t,s,this.projector_),this.xArcFC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.xArcFC_.element),this.yArcFC_=new qt(t,s,this.projector_),this.yArcFC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.yArcFC_.element),this.zArcFC_=new qt(t,s,this.projector_),this.zArcFC_.element.classList.add(Zt("arcc")),this.svgElem_.appendChild(this.zArcFC_.element),this.rArc_=new qt(t,o,this.projector_),this.rArc_.element.classList.add(Zt("arcr")),this.rArc_.setRotation(he),this.svgElem_.appendChild(this.rArc_.element),this.rArcC_=new qt(t,o,this.projector_),this.rArcC_.element.classList.add(Zt("arcc")),this.rArcC_.setRotation(he),this.svgElem_.appendChild(this.rArcC_.element);const a=t.createElementNS(E,"g");i.classList.add(Zt("labels")),this.svgElem_.appendChild(a),this.labelsElem_=a,this.xLabel=de(t,"labelcirclex","X"),this.labelsElem_.appendChild(this.xLabel),this.yLabel=de(t,"labelcircley","Y"),this.labelsElem_.appendChild(this.yLabel),this.zLabel=de(t,"labelcirclez","Z"),this.labelsElem_.appendChild(this.zLabel),this.xnLabel=de(t,"labelcirclen","-X"),this.labelsElem_.appendChild(this.xnLabel),this.ynLabel=de(t,"labelcirclen","-Y"),this.labelsElem_.appendChild(this.ynLabel),this.znLabel=de(t,"labelcirclen","-Z"),this.labelsElem_.appendChild(this.znLabel);const l=()=>{this.xArcB_.element.classList.add(Zt("arcx_hover")),this.xArcF_.element.classList.add(Zt("arcx_hover"))},h=()=>{this.xArcB_.element.classList.remove(Zt("arcx_hover")),this.xArcF_.element.classList.remove(Zt("arcx_hover"))};this.xArcBC_.element.addEventListener("mouseenter",l),this.xArcBC_.element.addEventListener("mouseleave",h),this.xArcFC_.element.addEventListener("mouseenter",l),this.xArcFC_.element.addEventListener("mouseleave",h);const d=()=>{this.yArcB_.element.classList.add(Zt("arcy_hover")),this.yArcF_.element.classList.add(Zt("arcy_hover"))},c=()=>{this.yArcB_.element.classList.remove(Zt("arcy_hover")),this.yArcF_.element.classList.remove(Zt("arcy_hover"))};this.yArcBC_.element.addEventListener("mouseenter",d),this.yArcBC_.element.addEventListener("mouseleave",c),this.yArcFC_.element.addEventListener("mouseenter",d),this.yArcFC_.element.addEventListener("mouseleave",c);const p=()=>{this.zArcB_.element.classList.add(Zt("arcz_hover")),this.zArcF_.element.classList.add(Zt("arcz_hover"))},u=()=>{this.zArcB_.element.classList.remove(Zt("arcz_hover")),this.zArcF_.element.classList.remove(Zt("arcz_hover"))};this.zArcBC_.element.addEventListener("mouseenter",p),this.zArcBC_.element.addEventListener("mouseleave",u),this.zArcFC_.element.addEventListener("mouseenter",p),this.zArcFC_.element.addEventListener("mouseleave",u);const v=()=>{this.rArc_.element.classList.add(Zt("arcr_hover"))},m=()=>{this.rArc_.element.classList.remove(Zt("arcr_hover"))};this.rArcC_.element.addEventListener("mouseenter",v),this.rArcC_.element.addEventListener("mouseleave",m),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,e.mode.emitter.on("change",this.onModeChange_),this.mode_=e.mode,this.update_()}get xArcBElement(){return this.xArcBC_.element}get yArcBElement(){return this.yArcBC_.element}get zArcBElement(){return this.zArcBC_.element}get xArcFElement(){return this.xArcFC_.element}get yArcFElement(){return this.yArcFC_.element}get zArcFElement(){return this.zArcFC_.element}get rArcElement(){return this.rArcC_.element}get allFocusableElements(){return[this.padElement]}update_(){const t=this.value.rawValue.quat.normalized;this.xAxis_.setRotation(t),this.yAxis_.setRotation(t),this.zAxis_.setRotation(t),this.xnAxis_.setRotation(t),this.ynAxis_.setRotation(t),this.znAxis_.setRotation(t);const e=Jt.applyQuaternion(t),n=te.applyQuaternion(t),i=ee.applyQuaternion(t),s=e.negated,o=n.negated,r=i.negated;[{el:this.xAxis_.element,v:e},{el:this.yAxis_.element,v:n},{el:this.zAxis_.element,v:i},{el:this.xnAxis_.element,v:s},{el:this.ynAxis_.element,v:o},{el:this.znAxis_.element,v:r}].map((({el:t,v:e})=>(this.axesElem_.removeChild(t),{el:t,v:e}))).sort(((t,e)=>t.v.z-e.v.z)).forEach((({el:t})=>{this.axesElem_.appendChild(t)})),this.xArcB_.setRotation(Xt(e,ne)),this.yArcB_.setRotation(Xt(n,ne)),this.zArcB_.setRotation(Xt(i,ne)),this.xArcBC_.setRotation(Xt(e,ne)),this.yArcBC_.setRotation(Xt(n,ne)),this.zArcBC_.setRotation(Xt(i,ne)),this.xArcF_.setRotation(Xt(e,ee)),this.yArcF_.setRotation(Xt(n,ee)),this.zArcF_.setRotation(Xt(i,ee)),this.xArcFC_.setRotation(Xt(e,ee)),this.yArcFC_.setRotation(Xt(n,ee)),this.zArcFC_.setRotation(Xt(i,ee)),[{el:this.xLabel,v:ie},{el:this.yLabel,v:se},{el:this.zLabel,v:oe},{el:this.xnLabel,v:re},{el:this.ynLabel,v:ae},{el:this.znLabel,v:le}].forEach((({el:e,v:n})=>{const[i,s]=this.projector_.project(n.applyQuaternion(t));e.setAttributeNS(null,"transform",`translate( ${i}, ${s} )`)})),[{el:this.xLabel,v:e},{el:this.yLabel,v:n},{el:this.zLabel,v:i},{el:this.xnLabel,v:s},{el:this.ynLabel,v:o},{el:this.znLabel,v:r}].map((({el:t,v:e})=>(this.labelsElem_.removeChild(t),{el:t,v:e}))).sort(((t,e)=>t.v.z-e.v.z)).forEach((({el:t})=>{this.labelsElem_.appendChild(t)}))}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}onModeChange_(){const t=this.mode_.rawValue,e="angle-x"===t?"add":"remove",n="angle-y"===t?"add":"remove",i="angle-z"===t?"add":"remove",s="angle-r"===t?"add":"remove";this.xArcB_.element.classList[e](Zt("arcx_active")),this.yArcB_.element.classList[n](Zt("arcy_active")),this.zArcB_.element.classList[i](Zt("arcz_active")),this.xArcF_.element.classList[e](Zt("arcx_active")),this.yArcF_.element.classList[n](Zt("arcy_active")),this.zArcF_.element.classList[i](Zt("arcz_active")),this.rArc_.element.classList[s](Zt("arcr_active"))}}function pe(t){return Ft(t,0,1)}function ue(t){if(t<=0)return 0;if(t>=1)return 1;const e=1-t;return pe(1-e*(e*(e*(e*(e*(e*(-6*e+7)))))))}function ve(t,e,n){return pe((n-t)/(e-t))}const me=1/Math.sqrt(2),ge=new Yt(1,0,0),be=new Yt(0,1,0),_e=new Yt(0,0,1),fe=new $t(0,0,0,1),we=new $t(me,0,0,me),xe=new $t(0,-me,0,me),ye=new $t(-me,0,0,me),Ce=new $t(0,me,0,me),Ee=new $t(0,1,0,0);class Pe{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.mode_=m("free"),this.view=new ce(t,{value:this.value,mode:this.mode_,viewProps:this.viewProps,pickerLayout:e.pickerLayout}),this.ptHandler_=new At(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_);const n=new At(this.view.xArcBElement);n.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),n.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const i=new At(this.view.xArcFElement);i.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),i.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const s=new At(this.view.yArcBElement);s.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),s.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const o=new At(this.view.yArcFElement);o.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),o.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const r=new At(this.view.zArcBElement);r.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),r.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const a=new At(this.view.zArcFElement);a.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),a.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const l=new At(this.view.rArcElement);l.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-r"))),l.emitter.on("up",(()=>this.changeModeIfNotAuto_("free"))),[{el:this.view.xLabel,q:xe},{el:this.view.yLabel,q:we},{el:this.view.zLabel,q:fe},{el:this.view.xnLabel,q:Ce},{el:this.view.ynLabel,q:ye},{el:this.view.znLabel,q:Ee}].forEach((({el:t,q:e})=>{new At(t).emitter.on("down",(()=>this.autoRotate_(e)))})),this.px_=null,this.py_=null,this.angleState_=null}handlePointerEvent_(t){if(!t.point)return;const e=this.mode_.rawValue,n=t.point.x,i=t.point.y;if("auto"!==e)if("free"===e){if(null!=this.px_&&null!=this.py_){const t=n-this.px_,e=i-this.py_,s=Math.sqrt(t*t+e*e);if(0===s)return;const o=new Yt(e/s,t/s,0),r=$t.fromAxisAngle(o,s/68);this.value.rawValue=this.value.rawValue.premultiply(r)}this.px_=n,this.py_=i}else if("angle-r"===e){const e=t.bounds.width/2,s=t.bounds.height/2,o=Math.atan2(i-s,n-e);if(null==this.angleState_){const t=new Yt(0,0,1);this.angleState_={initialRotation:this.value.rawValue,initialAngle:o,axis:t,reverseAngle:!0}}else{const{initialRotation:t,initialAngle:e,axis:n}=this.angleState_,i=-Kt(o-e),s=$t.fromAxisAngle(n,i);this.value.rawValue=t.premultiply(s)}}else{const s=t.bounds.width/2,o=t.bounds.height/2,r=Math.atan2(i-o,n-s);if(null==this.angleState_){const t="angle-x"===e?ge:"angle-y"===e?be:_e,n=t.applyQuaternion(this.value.rawValue.quat).z>0;this.angleState_={initialRotation:this.value.rawValue,initialAngle:r,axis:t,reverseAngle:n}}else{const{initialRotation:t,initialAngle:e,axis:n,reverseAngle:i}=this.angleState_;let s=Kt(r-e);s=i?-s:s;const o=$t.fromAxisAngle(n,s);this.value.rawValue=t.multiply(o)}}}onPointerDown_(t){this.handlePointerEvent_(t.data)}onPointerMove_(t){this.handlePointerEvent_(t.data)}onPointerUp_(){this.px_=null,this.py_=null,this.angleState_=null}onPadKeyDown_(t){Pt(t.key)&&t.preventDefault();const e=xt(1,Ct(t)),n=xt(1,yt(t));if(0!==e||0!==n){const t=new Yt(-n,e,0),i=$t.fromAxisAngle(t,Math.PI/16);this.value.rawValue=this.value.rawValue.premultiply(i)}}changeModeIfNotAuto_(t){"auto"!==this.mode_.rawValue&&(this.mode_.rawValue=t)}autoRotate_(t){this.mode_.rawValue="auto";const e=this.value.rawValue,n=Date.now(),i=()=>{const s=ue(ve(0,300,Date.now()-n));this.value.rawValue=e.slerp(t,s),1!==s?requestAnimationFrame(i):this.mode_.rawValue="free"};requestAnimationFrame(i)}}const ke=r("rotationswatch"),Ae=new Yt(1,0,0),Le=new Yt(0,1,0),Me=new Yt(0,0,1),Ie=new $t(0,0,0,1);class Te{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(ke()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("button");n.classList.add(ke("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElementNS(E,"svg");i.classList.add(ke("g")),n.appendChild(i),this.svgElem_=i,this.projector_=new Gt,this.projector_.viewport=[0,0,20,20];const s=Wt(0,Math.PI,33,"x","y"),o=Wt(0,2*Math.PI,65,"x","y");this.rArc_=new qt(t,o,this.projector_),this.rArc_.element.classList.add(ke("arcr")),i.appendChild(this.rArc_.element),this.rArc_.setRotation(Ie),this.xArc_=new qt(t,s,this.projector_),this.xArc_.element.classList.add(ke("arc")),i.appendChild(this.xArc_.element),this.yArc_=new qt(t,s,this.projector_),this.yArc_.element.classList.add(ke("arc")),i.appendChild(this.yArc_.element),this.zArc_=new qt(t,s,this.projector_),this.zArc_.element.classList.add(ke("arc")),i.appendChild(this.zArc_.element),this.update_()}update_(){const t=this.value.rawValue.quat.normalized,e=Ae.applyQuaternion(t),n=Le.applyQuaternion(t),i=Me.applyQuaternion(t);this.xArc_.setRotation(Xt(e,Me)),this.yArc_.setRotation(Xt(n,Me)),this.zArc_.setRotation(Xt(i,Me))}onValueChange_(){this.update_()}}class ze{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Te(t,{value:this.value,viewProps:this.viewProps})}}const Se=r("rotation");class Ve{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Se()),e.foldable.bindExpandedClass(this.element,Se(void 0,"expanded")),d(e.foldable,"completed",p(this.element,Se(void 0,"cpl"))),"quaternion"===e.rotationMode&&this.element.classList.add(Se("quat"));const n=t.createElement("div");n.classList.add(Se("h")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(Se("s")),n.appendChild(i),this.swatchElement=i;const s=t.createElement("div");if(s.classList.add(Se("t")),n.appendChild(s),this.textElement=s,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(Se("g")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}class Re{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=M.create(e.expanded),this.swatchC_=new ze(t,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new Ot(t,{assembly:e.assembly,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Ve(t,{rotationMode:e.rotationMode,foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new O(t,{viewProps:this.viewProps}):null;const i=new Pe(t,{value:this.value,viewProps:this.viewProps,pickerLayout:e.pickerLayout});i.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.gizmoC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),wt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.gizmoC_.view.element),z(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=t.relatedTarget;(!n||!e.contains(n))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.gizmoC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=L(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!A(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function De(t,e){const n=Math.pow(.1,t);return{baseStep:n,constraint:e,textProps:g.fromObject({draggingScale:n,formatter:ft(t)})}}function Ne(t){if(!t)return;const n=[];return e(t.step)||n.push(new R(t.step)),(!e(t.max)||!e(t.min))&&n.push(new V({max:t.max,min:t.min})),new S(n)}function Oe(t,e){return{toComponents:t=>t.getComponents(),fromComponents:n=>new Ut(n[0],n[1],n[2],t,e)}}function je(t,e,n){var i,s,o;return"number"==typeof(null===(i=t)||void 0===i?void 0:i.x)&&"number"==typeof(null===(s=t)||void 0===s?void 0:s.y)&&"number"==typeof(null===(o=t)||void 0===o?void 0:o.z)?new Ut(t.x,t.y,t.z,e,n):new Ut(0,0,0,e,n)}function Fe(t){switch(t){case"XYZ":case"XZY":case"YXZ":case"YZX":case"ZXY":case"ZYX":return t;default:return}}function Be(t){switch(t){case"rad":case"deg":case"turn":return t;default:return}}const He={id:"rotation",type:"input",css:".tp-rotationswatchv_b,.tp-rotationgizmov_p{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-rotationswatchv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-rotationswatchv_b:hover{background-color:var(--btn-bg-h)}.tp-rotationswatchv_b:focus{background-color:var(--btn-bg-f)}.tp-rotationswatchv_b:active{background-color:var(--btn-bg-a)}.tp-rotationswatchv_b:disabled{opacity:0.5}.tp-rotationgizmov_p{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-rotationgizmov_p:hover{background-color:var(--in-bg-h)}.tp-rotationgizmov_p:focus{background-color:var(--in-bg-f)}.tp-rotationgizmov_p:active{background-color:var(--in-bg-a)}.tp-rotationgizmov_p:disabled{opacity:0.5}.tp-rotationv{position:relative}.tp-rotationv_quat .tp-txtv_i{padding-left:0}.tp-rotationv_root{background-color:var(--mo-bg);width:100%;height:calc( 2.0 * var(--bld-us))}.tp-rotationv_h{display:flex}.tp-rotationv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us);margin-right:4px}.tp-rotationv_g{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-rotationv.tp-rotationv-expanded .tp-rotationv_g{margin-top:var(--bld-s);opacity:1}.tp-rotationv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-rotationswatchv path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationswatchv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-rotationswatchv_arc{fill:none;stroke:var(--btn-bg);stroke-width:1px}.tp-rotationswatchv_arcr{fill:var(--btn-fg);stroke:var(--btn-bg);stroke-width:1px}.tp-rotationgizmov{padding-left:calc(var(--bld-us) + 4px)}.tp-rotationgizmov path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationgizmov_p{cursor:move;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-rotationgizmov_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-rotationgizmov_axisx{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_axisy{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_axisz{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_axisn{stroke:var(--in-fg);stroke-width:2px}.tp-rotationgizmov_arcx{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_hover{stroke:#eb103f}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_active{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_arcy{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_hover{stroke:#4eeb10}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_active{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_arcz{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_hover{stroke:#1068eb}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_active{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_arcr{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_hover{stroke:#ebd510}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_active{stroke:#ebd510;stroke-width:2px}.tp-rotationgizmov_arcc{fill:none;stroke:transparent;stroke-width:5px;pointer-events:auto}.tp-rotationgizmov_labelcirclex{fill:#eb103f;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclex:hover{opacity:0.7}.tp-rotationgizmov_labelcircley{fill:#4eeb10;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcircley:hover{opacity:0.7}.tp-rotationgizmov_labelcirclez{fill:#1068eb;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclez:hover{opacity:0.7}.tp-rotationgizmov_labelcirclen{fill:var(--in-fg);cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclen:hover{opacity:0.7}.tp-rotationgizmov_labeltext{fill:var(--btn-fg);stroke:var(--btn-fg);stroke-width:1px}.tp-rotationgizmov_p:focus .tp-rotationgizmov_m{background-color:var(--in-fg);border-width:0}",accept(t,e){var n,i;const s=y,o=C(e,{view:s.required.constant("rotation"),label:s.optional.string,picker:s.optional.custom(zt),expanded:s.optional.boolean,rotationMode:s.required.constant("euler"),x:s.optional.custom(St),y:s.optional.custom(St),z:s.optional.custom(St),order:s.optional.custom(Fe),unit:s.optional.custom(Be)});return o?{initialValue:je(t,null!==(n=o.order)&&void 0!==n?n:"XYZ",null!==(i=o.unit)&&void 0!==i?i:"rad"),params:o}:null},binding:{reader:({params:t})=>e=>{var n,i;return je(e,null!==(n=t.order)&&void 0!==n?n:"XYZ",null!==(i=t.unit)&&void 0!==i?i:"rad")},constraint({params:t}){var e,n;return new Vt({assembly:Oe(null!==(e=t.order)&&void 0!==e?e:"XYZ",null!==(n=t.unit)&&void 0!==n?n:"rad"),components:[Ne("x"in t?t.x:void 0),Ne("y"in t?t.y:void 0),Ne("z"in t?t.z:void 0)]})},writer:t=>(t,e)=>{t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}},controller({document:t,value:e,constraint:n,params:s,viewProps:o}){var r,a;if(!(n instanceof Vt))throw i.shouldNeverHappen();const l="expanded"in s?s.expanded:void 0,h="picker"in s?s.picker:void 0,d=null!==(r=s.unit)&&void 0!==r?r:"rad",c={rad:2,deg:0,turn:2}[d];return new Re(t,{axes:[De(c,n.components[0]),De(c,n.components[1]),De(c,n.components[2])],assembly:Oe(null!==(a=s.order)&&void 0!==a?a:"XYZ",d),rotationMode:"euler",expanded:l??!1,parser:_t,pickerLayout:h??"popup",value:e,viewProps:o})}},Ke={toComponents:t=>[t.x,t.y,t.z,t.w],fromComponents:t=>new $t(t[0],t[1],t[2],t[3])};function Ue(t){return{baseStep:.01,constraint:t,textProps:g.fromObject({draggingScale:.01,formatter:t=>Math.abs(t)<.995?t.toFixed(2).replace("0.","."):t.toFixed(1)})}}function $e(t){var e,n,i,s;return"number"==typeof(null===(e=t)||void 0===e?void 0:e.x)&&"number"==typeof(null===(n=t)||void 0===n?void 0:n.y)&&"number"==typeof(null===(i=t)||void 0===i?void 0:i.z)&&"number"==typeof(null===(s=t)||void 0===s?void 0:s.w)?new $t(t.x,t.y,t.z,t.w):new $t(0,0,0,1)}const Ge={id:"rotation",type:"input",css:".tp-rotationswatchv_b,.tp-rotationgizmov_p{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-rotationswatchv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-rotationswatchv_b:hover{background-color:var(--btn-bg-h)}.tp-rotationswatchv_b:focus{background-color:var(--btn-bg-f)}.tp-rotationswatchv_b:active{background-color:var(--btn-bg-a)}.tp-rotationswatchv_b:disabled{opacity:0.5}.tp-rotationgizmov_p{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-rotationgizmov_p:hover{background-color:var(--in-bg-h)}.tp-rotationgizmov_p:focus{background-color:var(--in-bg-f)}.tp-rotationgizmov_p:active{background-color:var(--in-bg-a)}.tp-rotationgizmov_p:disabled{opacity:0.5}.tp-rotationv{position:relative}.tp-rotationv_quat .tp-txtv_i{padding-left:0}.tp-rotationv_root{background-color:var(--mo-bg);width:100%;height:calc( 2.0 * var(--bld-us))}.tp-rotationv_h{display:flex}.tp-rotationv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us);margin-right:4px}.tp-rotationv_g{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-rotationv.tp-rotationv-expanded .tp-rotationv_g{margin-top:var(--bld-s);opacity:1}.tp-rotationv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-rotationswatchv path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationswatchv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-rotationswatchv_arc{fill:none;stroke:var(--btn-bg);stroke-width:1px}.tp-rotationswatchv_arcr{fill:var(--btn-fg);stroke:var(--btn-bg);stroke-width:1px}.tp-rotationgizmov{padding-left:calc(var(--bld-us) + 4px)}.tp-rotationgizmov path{stroke-linecap:round;stroke-linejoin:round}.tp-rotationgizmov_p{cursor:move;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-rotationgizmov_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-rotationgizmov_axisx{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_axisy{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_axisz{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_axisn{stroke:var(--in-fg);stroke-width:2px}.tp-rotationgizmov_arcx{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_hover{stroke:#eb103f}.tp-rotationgizmov_arcx.tp-rotationgizmov_arcx_active{stroke:#eb103f;stroke-width:2px}.tp-rotationgizmov_arcy{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_hover{stroke:#4eeb10}.tp-rotationgizmov_arcy.tp-rotationgizmov_arcy_active{stroke:#4eeb10;stroke-width:2px}.tp-rotationgizmov_arcz{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_hover{stroke:#1068eb}.tp-rotationgizmov_arcz.tp-rotationgizmov_arcz_active{stroke:#1068eb;stroke-width:2px}.tp-rotationgizmov_arcr{fill:none;stroke:var(--in-fg)}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_hover{stroke:#ebd510}.tp-rotationgizmov_arcr.tp-rotationgizmov_arcr_active{stroke:#ebd510;stroke-width:2px}.tp-rotationgizmov_arcc{fill:none;stroke:transparent;stroke-width:5px;pointer-events:auto}.tp-rotationgizmov_labelcirclex{fill:#eb103f;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclex:hover{opacity:0.7}.tp-rotationgizmov_labelcircley{fill:#4eeb10;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcircley:hover{opacity:0.7}.tp-rotationgizmov_labelcirclez{fill:#1068eb;cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclez:hover{opacity:0.7}.tp-rotationgizmov_labelcirclen{fill:var(--in-fg);cursor:pointer;pointer-events:auto}.tp-rotationgizmov_labelcirclen:hover{opacity:0.7}.tp-rotationgizmov_labeltext{fill:var(--btn-fg);stroke:var(--btn-fg);stroke-width:1px}.tp-rotationgizmov_p:focus .tp-rotationgizmov_m{background-color:var(--in-fg);border-width:0}",accept(t,e){const n=y,i=C(e,{view:n.required.constant("rotation"),label:n.optional.string,picker:n.optional.custom(zt),expanded:n.optional.boolean,rotationMode:n.optional.constant("quaternion"),x:n.optional.custom(St),y:n.optional.custom(St),z:n.optional.custom(St),w:n.optional.custom(St)});return i?{initialValue:$e(t),params:i}:null},binding:{reader:t=>t=>$e(t),constraint:({params:t})=>new Vt({assembly:Ke,components:[Ne("x"in t?t.x:void 0),Ne("y"in t?t.y:void 0),Ne("z"in t?t.z:void 0),Ne("w"in t?t.w:void 0)]}),writer:t=>(t,e)=>{t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}},controller({document:t,value:e,constraint:n,params:s,viewProps:o}){if(!(n instanceof Vt))throw i.shouldNeverHappen();const r="expanded"in s?s.expanded:void 0,a="picker"in s?s.picker:void 0;return new Re(t,{axes:[Ue(n.components[0]),Ue(n.components[1]),Ue(n.components[2]),Ue(n.components[3])],assembly:Ke,rotationMode:"quaternion",expanded:r??!1,parser:_t,pickerLayout:a??"popup",value:e,viewProps:o})}},qe=[He,Ge];t.RotationInputPluginEuler=He,t.RotationInputPluginQuaternion=Ge,t.plugins=qe,Object.defineProperty(t,"__esModule",{value:!0})}(rs.exports);var as=rs.exports;const ls=_e({__proto__:null,default:fe(as)},[as]);var hs={exports:{}};!function(t){const e="tp";function n(t){return(n,i)=>[e,"-",t,"v",n?`_${n}`:"",i?`-${i}`:""].join("")}function i(t,e){return Object.keys(e).reduce(((n,i)=>{if(void 0===n)return;const s=(0,e[i])(t[i]);return s.succeeded?Object.assign(Object.assign({},n),{[i]:s.value}):void 0}),{})}function s(t,e){return t.reduce(((t,n)=>{if(void 0===t)return;const i=e(n);return i.succeeded&&void 0!==i.value?[...t,i.value]:void 0}),[])}function o(t){return null!==t&&"object"==typeof t}function r(t){return e=>n=>{if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};const i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function a(t){return{custom:e=>r(e)(t),boolean:r((t=>"boolean"==typeof t?t:void 0))(t),number:r((t=>"number"==typeof t?t:void 0))(t),string:r((t=>"string"==typeof t?t:void 0))(t),function:r((t=>"function"==typeof t?t:void 0))(t),constant:e=>r((t=>t===e?e:void 0))(t),raw:r((t=>t))(t),object:e=>r((t=>{if(o(t))return i(t,e)}))(t),array:e=>r((t=>{if(Array.isArray(t))return s(t,e)}))(t)}}const l={optional:a(!0),required:a(!1)};function h(t,e){const n=l.required.object(e)(t);return n.succeeded?n.value:void 0}const d=n("txtr");class c{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(d()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("textarea");n.rows=e.lineCount,n.cols=22,n.placeholder=e.placeholder,n.classList.add(d("i")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){this.inputElement.value=this.value_.rawValue}onChange_(){this.refresh()}}class p{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.lineCount=e.lineCount,this.placeholder=e.placeholder,this.view=new c(t,{value:this.value,viewProps:this.viewProps,lineCount:this.lineCount,placeholder:this.placeholder}),this.view.inputElement.addEventListener("keyup",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value;this.value.rawValue=e,this.view.refresh()}}const u=[{id:"input-template",type:"input",css:".tp-txtrv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-txtrv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtrv:hover{background-color:var(--in-bg-h)}.tp-txtrv:focus{background-color:var(--in-bg-f)}.tp-txtrv:active{background-color:var(--in-bg-a)}.tp-txtrv:disabled{opacity:.5}.tp-txtrv{display:block;height:auto;padding-bottom:0;overflow:hidden;position:relative}.tp-txtrv.tp-v-disabled{opacity:.5}.tp-txtrv .tp-txtrv_i{font-family:var(--font-family);background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-size:11px;padding:4px;line-height:16px;min-width:0;width:100%;border:none;height:100%;resize:none;margin-bottom:-8px}.tp-txtrv .tp-txtrv_i:focus{outline:none}",accept(t,e){if("string"!=typeof t)return null;const n=l,i=h(e,{view:n.required.constant("textarea"),lineCount:n.optional.number,placeholder:n.optional.string});return i?{initialValue:t,params:i}:null},binding:{reader:t=>t=>"string"==typeof t?t:"",writer:t=>(t,e)=>{t.write(e)}},controller(t){var e,n;return new p(t.document,{value:t.value,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:3,placeholder:null!==(n=t.params.placeholder)&&void 0!==n?n:"Enter text here",viewProps:t.viewProps})}}];t.plugins=u,Object.defineProperty(t,"__esModule",{value:!0})}(hs.exports);var ds=hs.exports;const cs=_e({__proto__:null,default:fe(ds)},[ds]),ps=t=>{const e=new xe.Pane({container:t});return e.registerPlugin(ns),e.registerPlugin(os),e.registerPlugin(ls),e.registerPlugin(cs),e};const us=new class{constructor(){e(this,"listeners",{})}addEventListener(t,e){const{listeners:n}=this;n[t]??(n[t]=[]);const i=n[t];i.includes(e)||i.push(e)}hasEventListener(t,e){var n;return null==(n=this.listeners[t])?void 0:n.includes(e)}removeEventListener(t,e){const{listeners:n}=this,i=n[t];if(void 0===i)return;const s=i.indexOf(e);-1!==s&&i.splice(s,1)}dispatchEvent(t){const{listeners:e}=this,n=e[t.type];if(void 0===n)return;t.target=this;const i=[...n];for(let s=0,o=i.length;s<o;s+=1)i[s].call(this,t);t.target=void 0}},vs=()=>{const t=Qn.renderer.domElement;t.setAttribute("style","\n    width: 100% !important;\n    height: 100% !important;\n  ");const e=(t=>{const{element:e,side:n,min:i=100,max:s=300}=t;let o=0,r=0,a=0,l=0;const h="right"===n||"left"===n,d=document.createElement("div"),c=document.createElement("div");c.style.cssText=`\n    position: absolute;\n    z-index: 1000;\n    opacity: 0.5;\n    background-color: var(--color-resize-handle, #888);\n    cursor: ${h?"ew":"ns"}-resize;\n    ${h?"width":"height"}: 3px;\n    ${h?"height":"width"}: 100%;\n    ${h?"top: 0; bottom: 0;":"left: 0; right: 0;"}\n    ${(t=>{switch(t){case"left":return"left: 0;";case"right":return"left: calc(100% - 3px);";case"top":return"top: 0;";case"bottom":return"bottom: 0;";default:return""}})(n)}\n  `;const p=t=>{if(t.preventDefault(),t.stopPropagation(),h){let e=o-t.clientX;"right"===n&&(e=-e);const r=3+Math.max(i,Math.min(s,a+e));d.style.width=`${r}px`}else{let e=r-t.clientY;"bottom"===n&&(e=-e);const o=Math.max(i,Math.min(s,l+e));d.style.height=`${o}px`}},u=t=>{t.preventDefault(),t.stopPropagation(),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",u),c.style.opacity="0.5"};return c.addEventListener("mousedown",(t=>{t.preventDefault(),t.stopPropagation(),o=t.clientX,r=t.clientY,a=d.clientWidth,l=d.clientHeight,window.addEventListener("mousemove",p),window.addEventListener("mouseup",u),c.style.opacity="1"})),d.style.position="relative",d.style.overflow="hidden",d.append(e),d.append(c),t.height&&(d.style.height=`${t.height}px`),t.width&&(d.style.width=`${t.width}px`),d})({element:t,max:Number.POSITIVE_INFINITY,side:"right",width:window.innerWidth-335});return e.style.cssText+="--color-resize-handle: #222;",e.classList.add("h-screen"),e},ms={controlling:!1},gs={expanded:!1,picker:"inline",rotationMode:"euler",view:"rotation"},bs=()=>{ms.controlling=!0},_s=()=>{ms.controlling=!1},fs=(t,e)=>{const{element:i}=t,o={rotation:new Pt};t.addSeparator();const r=t.addInput(e,"position",{step:.1}),a=t.addInput(o,"rotation",gs).on("change",(()=>{ms.controlling&&e.rotation.copy(o.rotation)})),l=t.addInput(e,"scale",{step:.1}),h=()=>{ms.controlling||(e.rotation.equals(o.rotation)||(o.rotation.copy(e.rotation),a.refresh()),r.refresh(),l.refresh())};let d;return oi(h),"isInstancedMesh"in e&&(d=((t,e)=>{const i=new n;t.addSeparator();const o={index:0,position:new s,rotation:new Pt,scale:new s},r=t.addInput(o,"index",{label:"instance index",max:e.count-1,min:0,step:1}),a=t.addInput(o,"position",{index:0}),l=t.addInput(o,"rotation",gs),h=t.addInput(o,"scale",{index:0}),d=()=>{e.getMatrixAt(o.index,i),o.position.setFromMatrixPosition(i),o.rotation.setFromRotationMatrix(i),o.scale.setFromMatrixScale(i),a.refresh(),l.refresh(),h.refresh()},c=()=>{i.makeRotationFromEuler(o.rotation),i.setPosition(o.position),i.scale(o.scale),e.setMatrixAt(o.index,i),e.instanceMatrix.needsUpdate=!0};r.on("change",d),a.on("change",c),l.on("change",c),h.on("change",c);const p=()=>{ms.controlling||d()};return oi(p),()=>ri(p)})(t,e)),i.addEventListener("mousedown",bs,{passive:!0}),i.addEventListener("mouseup",_s,{passive:!0}),()=>{i.removeEventListener("mousedown",bs),i.removeEventListener("mouseup",_s),r.dispose(),a.dispose(),l.dispose(),ri(h),null==d||d()}},ws=(t,e)=>{t.addSeparator();const n={userData:JSON.stringify(e.userData,void 0,2)},i=n.userData.split(/\r\n|\r|\n/u).length,s=t.addMonitor(n,"userData",{interval:5e3,lineCount:i,multiline:!0});return()=>s.dispose()},xs=[Jn.NONE,Jn.ORBIT],ys={controls:$n("three-inspect.controls")??Jn.NONE},Cs=(t,e)=>{const n=["none","orbit","map"];t.addInput(ys,"controls",{cells:(t,e)=>({title:n[xs[3*e+t]],value:xs[3*e+t]}),groupName:"controls",label:"inspect controls",size:[2,1],view:"radiogrid"}).on("change",(()=>ei(ys.controls,e)));const i=()=>{e.updateProjectionMatrix()};t.addInput(e,"near").on("change",i),t.addInput(e,"far").on("change",i);const s=t.addInput(e,"zoom").on("change",i),o=()=>s.refresh();window.addEventListener("wheel",o,{passive:!0}),e instanceof U&&(t.addInput(e,"bottom").on("change",i),t.addInput(e,"left").on("change",i),t.addInput(e,"right").on("change",i),t.addInput(e,"top").on("change",i)),e instanceof H&&(t.addInput(e,"fov").on("change",i),t.addInput(e,"filmOffset").on("change",i),t.addInput(e,"filmGauge").on("change",i));const r=[];return r.push(fs(t,e),ws(t,e)),null!==Qn.composer&&r.push((t=>{const{composer:e}=Qn;if(void 0===e)return()=>0;const n=t.addFolder({title:"Postprocessing"}),{passes:i}=e;let s;for(let r=0,a=i.length;r<a;r+=1){const t=i[r];if("effects"in t){s=t;break}}if(void 0===s)return()=>n.dispose();const{effects:o}=s;for(let r=0,a=o.length;r<a;r+=1){const t=o[r];if("SMAAEffect"===t.name)n.addFolder({title:"smaa"});else if("BloomEffect"===t.name){const e=t,i=n.addFolder({title:"bloom"});i.addInput(e,"height"),i.addInput(e,"width"),i.addInput(e,"intensity")}else if("NoiseEffect"===t.name)n.addFolder({title:"noise"}).addInput(t.blendMode.opacity,"value",{label:"opacity"});else if("VignetteEffect"===t.name){const e=t,i=n.addFolder({title:"vignette"});i.addInput(e,"darkness"),i.addInput(e,"technique",{options:{default:0,eskil:1}}),i.addInput(e,"offset")}else if("SSREffect"===t.name){const e=t,i=n.addFolder({title:"ssr"});i.addInput(e,"intensity",{max:3,min:0,step:.01}),i.addInput(e,"exponent",{max:8,min:.125,step:.125}),i.addInput(e,"distance",{max:10,min:.001,step:.1}),i.addInput(e,"fade",{max:20,min:0,step:.01}),i.addInput(e,"roughnessFade",{max:1,min:0,step:.01}),i.addInput(e,"thickness",{max:10,min:0,step:.01}),i.addInput(e,"ior",{max:2.3333,min:1,step:.01}),i.addInput(e,"maxRoughness",{max:1,min:0,step:.01}),i.addInput(e,"maxDepthDifference",{max:100,min:0,step:.1});const s=i.addFolder({index:0,title:"Temporal Resolve"});s.addInput(e,"blend",{max:1,min:0,step:.001}),s.addInput(e,"correction",{max:1,min:0,step:1e-4}),s.addInput(e,"correctionRadius",{max:4,min:1,step:1});const o=i.addFolder({index:0,title:"Blur"});o.addInput(e,"blur",{max:1,min:0,step:.01}),o.addInput(e,"blurKernel",{max:5,min:0,step:1}),o.addInput(e,"blurSharpness",{max:100,min:0,step:1});const r=i.addFolder({index:0,title:"Jitter"});r.addInput(e,"jitter",{max:4,min:0,step:.01}),r.addInput(e,"jitterRoughness",{max:4,min:0,step:.01});const a=i.addFolder({index:0,title:"Tracing"});a.addInput(e,"steps",{max:256,min:1,step:1}),a.addInput(e,"refineSteps",{max:16,min:0,step:1}),a.addInput(e,"missedRays");const l=i.addFolder({index:0,title:"Resolution"});l.addInput(e,"resolutionScale",{max:1,min:.125,step:.125}),l.addInput(e,"velocityResolutionScale",{max:1,min:.125,step:.125})}else console.warn(`three-inspect does not yet support postprocessing effect: ${t.name}`)}return()=>n.dispose()})(t)),r.push((()=>window.removeEventListener("wheel",o))),r},Es=new WeakMap,Ps=new WeakMap,ks=t=>Ps.get(t),As=t=>Es.get(t),Ls=t=>{if(!0===t.userData.THREE_INSPECT_OMIT)return;t.traverse((e=>t!==e&&Ls(e)));const e=Es.get(t);Es.delete(t),void 0!==e&&(Ps.delete(e),e.destroy())},Ms=new Map,Is=(t,e,n)=>{if(!0===e.userData.THREE_INSPECT_OMIT)return;const i=e.name,s="isScene"in n?t:Es.get(n),o=`${i?`${i} `:""}(${(t=>{var e;return"isInstancedMesh"in t?"InstancedMesh":(null==(e=t.geometry)?void 0:e.isMeshLine)?"MeshLine":t.type})(e)})`,r=new Ni({text:o});r.open=!0,Es.set(e,r),Ps.set(r,e),s?s.append(r):e.parent&&Ms.set(e.parent.uuid,r);const a=Ms.get(e.uuid);a&&(r.append(a),Ms.delete(e.uuid));{const{children:n}=e;for(let i=0,s=n.length;i<s;i+=1)Is(t,n[i],e)}},Ts=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],zs=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],Ss={max:1,min:0},Vs=(t,e)=>{t.addSeparator(),t.addInput(e.target,"position",{label:"target position",step:.1}).on("change",(()=>{e.target.updateMatrixWorld()}))},Rs=(t,e)=>{let n,i;const s=[],o={color:`#${e.color.getHexString().toUpperCase()}`,helper:!1,shadowHelper:!1};if(e instanceof Mt||t.addInput(o,"helper").on("change",(()=>n&&e[o.helper?"add":"remove"](n))),t.addInput(o,"color").on("change",(()=>e.color.set(o.color))),t.addInput(e,"intensity"),e instanceof v?(t.addInput(e,"castShadow"),fs(t,e),Vs(t,e),n=new It(e)):e instanceof Tt?(t.addInput(e,"groundColor"),n=new zt(e,10)):e instanceof u?(t.addInput(e,"decay"),t.addInput(e,"distance"),t.addInput(e,"power"),t.addInput(e,"castShadow"),fs(t,e),n=new St(e,10)):e instanceof p?(t.addInput(e,"angle",{max:Math.PI/2,min:0}),t.addInput(e,"decay"),t.addInput(e,"distance"),t.addInput(e,"penumbra",Ss),t.addInput(e,"power"),t.addInput(e,"castShadow"),fs(t,e),Vs(t,e),n=new Vt(e)):e instanceof Rt&&(t.addInput(e,"power"),t.addInput(e,"width"),t.addInput(e,"height"),fs(t,e),n=((t,e)=>{const n=new V;n.setAttribute("position",new Nt(Ts,3)),n.computeBoundingSphere();const i=new I({fog:!1}),s=new O;s.type="RectAreaLightHelper";const o=new V;return o.setAttribute("position",new Nt(zs,3)),o.computeBoundingSphere(),s.add(new D(o,new m({fog:!1,side:Ot}))),s.updateMatrixWorld=()=>{if(s.scale.set(.5*t.width,.5*t.height,1),void 0===e){i.color.copy(t.color).multiplyScalar(t.intensity);const{color:e}=i,n=Math.max(e.r,e.g,e.b);n>1&&e.multiplyScalar(1/n),s.children[0].material.color.copy(e)}else i.color.set(e),s.children[0].material.color.set(e);s.matrixWorld.extractRotation(t.matrixWorld).scale(s.scale).copyPosition(t.matrixWorld),s.children[0].matrixWorld.copy(s.matrixWorld)},s.dispose=()=>{s.geometry.dispose(),s.material.dispose();const t=s.children[0];t.geometry.dispose(),t.material.dispose()},s})(e)),void 0!==n&&(n.userData.THREE_INSPECT_OMIT=!0),e.castShadow&&e.shadow){const n=t.addFolder({index:e.id,title:"Shadow Camera"});n.addInput(e.shadow,"autoUpdate"),n.addInput(o,"shadowHelper",{label:"helper"}).on("change",(()=>i&&e[o.shadowHelper?"add":"remove"](i)));const s={mapSize:e.shadow.mapSize.x},r=()=>{e.shadow&&(e.shadow.mapSize.width=s.mapSize,e.shadow.mapSize.height=s.mapSize,e.shadow.dispose(),e.shadow.map=null)},a=[256,512,1024,2048];if(n.addInput(s,"mapSize",{cells:t=>({title:a[t],value:a[t]}),groupName:"mapSize",size:[4,1],view:"radiogrid"}).on("change",r),n.addInput(e.shadow,"bias",{max:.09,min:0,step:.001}),n.addInput(e.shadow,"normalBias").on("change",r),n.addInput(e.shadow,"radius").on("change",r),e instanceof v){const{camera:t}=e.shadow;n.addInput(t,"near").on("change",r),n.addInput(t,"far").on("change",r),n.addInput(t,"left").on("change",r),n.addInput(t,"right").on("change",r),n.addInput(t,"top").on("change",r),n.addInput(t,"bottom").on("change",r),fs(n,t)}else if(e instanceof p){const{camera:t}=e.shadow;n.addInput(t,"near").on("change",r),n.addInput(t,"far").on("change",r),n.addInput(t,"focus",Ss),fs(n,t)}i=new Dt(e.shadow.camera),i.userData.THREE_INSPECT_OMIT=!0}return t.on("change",(()=>{var t;null==(t=null==n?void 0:n.update)||t.call(n),null==i||i.update()})),s.push(ws(t,e),(()=>{var t;void 0!==n&&(e.remove(n),null==(t=n.dispose)||t.call(n)),void 0!==i&&(e.remove(i),i.dispose())})),s},Ds=(()=>{const t=document.createElement("canvas");t.width=1,t.height=1;const e=t.getContext("2d");null!==e&&(e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1));const n=document.createElement("img");return n.src=t.toDataURL("image/png"),n})(),Ns=(t,e,n)=>{const i=e[n],s={current:()=>{}},o={ClampToEdgeWrapping:at,MirroredRepeatWrapping:lt,RepeatWrapping:k},r={LinearFilter:E,NearestFilter:it},a={...r,LinearMipmapLinearFilter:P,LinearMipmapNearestFilter:ot,NearestMipmapLinearFilter:rt,NearestMipmapNearestFilter:st},l={0:0,16:16,2:2,4:4,8:8},h={AlphaFormat:ne,DepthFormat:ie,DepthStencilFormat:se,LuminanceAlphaFormat:oe,LuminanceFormat:re,RGBAFormat:ae,RGBAIntegerFormat:le,RGFormat:he,RGIntegerFormat:de,RedFormat:ce,RedIntegerFormat:pe},d={BasicDepthPacking:ue,LinearEncoding:ve,RGBADepthPacking:me,sRGBEncoding:ge},c={map:(null==i?void 0:i.image)??Ds},p=t=>{u.hidden=!1,u.title=`${t.name} (Texture)`.trim();const n=()=>t.needsUpdate=!0;u.addInput(t,"wrapS",{options:o}).on("change",n),u.addInput(t,"wrapT",{options:o}).on("change",n),u.addInput(t,"magFilter",{options:r}),u.addInput(t,"minFilter",{options:a}),u.addInput(t,"offset",{step:.01}),u.addInput(t,"rotation",{step:.01}),u.addInput(t,"anisotropy",{options:l}).on("change",n),u.addInput(t,"format",{options:h}).on("change",n),u.addInput(t,"repeat",{x:{step:1},y:{step:1}}),u.addInput(t,"center"),u.addInput(t,"flipY"),u.addInput(t,"encoding",{options:d}).on("change",(()=>{n(),e instanceof M&&(e.needsUpdate=!0)})),s.current=()=>{for(const t of u.children)t.dispose()}};t.addInput(c,"map",{label:n,view:"input-image"}).on("change",(({value:t})=>{var o;if(t.src===Ds.src||t.src===(null==i?void 0:i.image.src))return;null==(o=e[n])||o.dispose();const r=new A(t);e[n]=r,r.needsUpdate=!0,e instanceof M&&(e.needsUpdate=!0),s.current(),p(r)}));const u=t.addFolder({hidden:!0,title:""});return i&&p(i),()=>s.current()},Os=(t,e)=>{const n=e.material,i=t.addFolder({index:e.id,title:`${n.name} (${n.type})`.trim()}),s={ObjectSpaceNormalMap:te,TangentSpaceNormalMap:ee},o=()=>{n.needsUpdate=!0},r=t=>{const e=n,s={[t]:`#${e[t].getHexString()}`};i.addInput(s,t).on("change",(()=>e[t].set(s.color)))};i.addInput(n,"visible"),i.addInput(n,"transparent").on("change",o),i.addInput(n,"opacity",Ss);const a=[["Back",Ot],["Double",z],["Front",dt]];if(i.addInput(n,"side",{cells:t=>({title:a[t][0],value:a[t][1]}),groupName:"side",size:[3,1],view:"radiogrid"}),i.addInput(n,"vertexColors"),i.addSeparator(),n instanceof L)r("color"),i.addInput(n,"size"),i.addInput(n,"sizeAttenuation");else if(n instanceof I||n instanceof Ft)r("color"),i.addInput(n,"fog"),i.addInput(n,"linewidth");else if(n instanceof m)r("color"),i.addInput(n,"fog"),i.addInput(n,"reflectivity",Ss),i.addInput(n,"refractionRatio",Ss),i.addInput(n,"wireframe");else if(n instanceof Bt)i.addInput(n,"fog");else if(n instanceof Ht)r("color"),r("emissive"),i.addInput(n,"emissiveIntensity",{min:0}),i.addInput(n,"flatShading").on("change",o),i.addInput(n,"fog"),i.addInput(n,"reflectivity",Ss),i.addInput(n,"refractionRatio",Ss),i.addInput(n,"wireframe");else if(n instanceof Kt)r("color"),r("emissive"),i.addInput(n,"emissiveIntensity",{min:0}),i.addInput(n,"flatShading").on("change",o),i.addInput(n,"fog"),i.addInput(n,"reflectivity",Ss),i.addInput(n,"refractionRatio",Ss),i.addInput(n,"shininess",Ss),i.addInput(n,"wireframe");else if(n instanceof T)r("color"),r("emissive"),i.addInput(n,"emissiveIntensity",{min:0}),i.addInput(n,"roughness",Ss),i.addInput(n,"metalness",Ss),i.addInput(n,"flatShading").on("change",o),i.addInput(n,"fog"),i.addInput(n,"wireframe"),i.addInput(n,"envMapIntensity"),n instanceof b&&(i.addSeparator(),r("attenuationColor"),i.addInput(n,"clearcoat",Ss),i.addInput(n,"clearcoatRoughness",Ss),i.addInput(n,"transmission",Ss),i.addInput(n,"ior",{max:2.333,min:1}),i.addInput(n,"reflectivity",Ss),i.addInput(n,"sheen",Ss),i.addInput(n,"sheenRoughness",Ss),r("sheenColor"));else if(n instanceof W){const t={uniforms:JSON.stringify(n.uniforms,null,2)};i.addInput(t,"uniforms",{view:"textarea"}).on("change",(()=>{try{n.uniforms=JSON.parse(t.uniforms),o()}catch{}})),i.addInput(n,"vertexShader",{view:"textarea"}).on("change",o),i.addInput(n,"fragmentShader",{view:"textarea"}).on("change",o)}return(n instanceof m||n instanceof Ht||n instanceof Kt||n instanceof T||n instanceof b)&&(i.addSeparator(),Ns(i,n,"map"),Ns(i,n,"alphaMap"),Ns(i,n,"aoMap"),i.addInput(n,"aoMapIntensity",Ss),Ns(i,n,"lightMap"),i.addInput(n,"lightMapIntensity",Ss),(n instanceof Ht||n instanceof Kt||n instanceof T||n instanceof b)&&(Ns(i,n,"bumpMap"),i.addInput(n,"bumpScale",Ss),Ns(i,n,"displacementMap"),i.addInput(n,"displacementScale"),i.addInput(n,"displacementBias"),Ns(i,n,"emissiveMap"),Ns(i,n,"normalMap"),i.addInput(n,"normalMapType",{options:s})),(n instanceof T||n instanceof b)&&(Ns(i,n,"metalnessMap"),Ns(i,n,"roughnessMap"),n instanceof b&&(Ns(i,n,"clearcoatMap"),Ns(i,n,"clearcoatNormalMap"),i.addInput(n,"clearcoatNormalScale",{x:Ss,y:Ss}),Ns(i,n,"clearcoatRoughnessMap"),Ns(i,n,"sheenRoughnessMap")))),i.addSeparator(),i.addInput(n,"alphaTest",Ss),i.addInput(n,"blendDst"),i.addInput(n,"clipShadows"),i.addInput(n,"depthTest"),i.addInput(n,"depthWrite"),i.addInput(n,"polygonOffset"),i.addInput(n,"polygonOffsetFactor"),i.addInput(n,"dithering"),()=>i.dispose()},js=(t,e)=>{e instanceof F&&t.addMonitor(e.geometry.attributes.position,"count"),t.addInput(e,"castShadow"),t.addInput(e,"receiveShadow"),t.addInput(e,"frustumCulled"),t.addInput(e,"matrixAutoUpdate"),t.addInput(e,"visible");const n=[];e.type.toLowerCase().includes("helper")||n.push(((t,e)=>{const n=new jt;n.name="Forward helper",n.setLength(1),n.userData.THREE_INSPECT_OMIT=!0;const i={forwardHelper:!1},s=t.addInput(i,"forwardHelper").on("change",(()=>{i.forwardHelper?e.add(n):e.remove(n)}));return()=>{s.dispose(),e.remove(n),n.dispose()}})(t,e)),n.push(fs(t,e));const i=e;if(Array.isArray(i.material))for(let s=0,o=i.material.length;s<o;s+=1)i.material[s]instanceof M&&n.push(Os(t,i));else void 0!==i.material&&i.material instanceof M&&n.push(Os(t,i));return n.push(ws(t,e)),n},Fs={axes:!!$n("three-inspect.axes"),background:Ds,fogColor:"#000000",grid:!!$n("three-inspect.grid"),gridCellSize:$n("three-inspect.gridCellSize")??1,gridColor:$n("three-inspect.gridColor")??"#ffffff",gridDistance:$n("three-inspect.gridDistance")??100,gridLargeCellSize:$n("three-inspect.largeCellSize")??10},Bs=new i,Hs={axes:new h(1e3),grid:new class extends D{constructor(t=1,n=10,s="white",o=8e3){const r=new X,a=new W({side:z,uniforms:{uCellSize:{value:t},uLargeCellSize:{value:n},uColor:{value:new i(s)},uDistance:{value:o}},transparent:!0,vertexShader:"varying vec3 worldPosition;\n\nuniform float uDistance;\n\nvoid main() {\n  vec3 pos = position.xzy * uDistance;\n  pos.xz += cameraPosition.xz;\n\n  worldPosition = pos;\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n}",fragmentShader:"varying vec3 worldPosition;\n\nuniform float uCellSize;\nuniform float uLargeCellSize;\nuniform vec3 uColor;\nuniform float uDistance;\n\nfloat getGrid(float size) {\n  vec2 r = worldPosition.xz / size;\n  vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n  float line = min(grid.x, grid.y);\n\n  return 1.0 - min(line, 1.0);\n}\n\nvoid main() {\n  float d = 1.0 - min(distance(cameraPosition.xz, worldPosition.xz) / uDistance, 1.0);\n\n  float g1 = getGrid(uCellSize);\n  float g2 = getGrid(uLargeCellSize);\n\n  gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, 3.0));\n  gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2);\n\n  if (gl_FragColor.a <= 0.0) discard;\n}",extensions:{derivatives:!0}});super(r,a),e(this,"frustumCulled",!1),e(this,"material"),this.material=a}get cellSize(){return this.material.uniforms.uCellSize.value}set cellSize(t){this.material.uniforms.uCellSize.value=t}get largeCellSize(){return this.material.uniforms.uLargeCellSize.value}set largeCellSize(t){this.material.uniforms.uLargeCellSize.value=t}get color(){return this.material.uniforms.uColor.value}set color(t){this.material.uniforms.uColor.value=t}get distance(){return this.material.uniforms.uDistance.value}set distance(t){this.material.uniforms.uDistance.value=t}}(Fs.gridCellSize,Fs.gridLargeCellSize,Fs.gridColor,Fs.gridDistance)},Ks=t=>{const{scene:e}=Qn,n=[],s=t=>{e[Fs[t]?"add":"remove"](Hs[t]),Fs[t]?Un(`three-inspect.${t}`,!0):Un(`three-inspect.${t}`,!1)},o=t=>{Bs.set(Fs.gridColor),Hs.grid.cellSize=Fs.gridCellSize,Hs.grid.largeCellSize=Fs.gridLargeCellSize,Hs.grid.color instanceof i?Hs.grid.color.copy(Bs):Hs.grid.color=Bs,Hs.grid.distance=Fs.gridDistance,Un(t,Fs[t])};if(t.addInput(Fs,"axes",{label:"axes"}).on("change",(()=>s("axes"))),t.addInput(Fs,"grid",{label:"grid"}).on("change",(()=>s("grid"))),t.addInput(Fs,"gridCellSize",{label:"cell size"}).on("change",(()=>o("gridCellSize"))),t.addInput(Fs,"gridLargeCellSize",{label:"large cell size",step:1}).on("change",(()=>o("gridLargeCellSize"))),t.addInput(Fs,"gridColor",{label:"color",step:1}).on("change",(()=>o("gridColor"))),t.addInput(Fs,"gridDistance",{label:"distance",step:1}).on("change",(()=>o("gridDistance"))),null!==e.fog){Fs.fogColor=`#${e.fog.color.getHexString().toUpperCase()}`;const n=t.addFolder({title:"Fog"});n.addInput(Fs,"fogColor",{label:"color"}).on("change",(()=>{var t;null==(t=e.fog)||t.color.set(Fs.fogColor)})),"near"in e.fog&&n.addInput(e.fog,"near"),"far"in e.fog&&n.addInput(e.fog,"far")}return t.addSeparator(),n.push(Ns(t,e,"background")),t.addSeparator(),n.push((t=>{const{renderer:e}=Qn,n=new i;e.getClearColor(n);const s={clearColor:`#${n.getHexString().toUpperCase()}`};t.addInput(s,"clearColor").on("change",(()=>{e.setClearColor(s.clearColor)}));const o=()=>{e.shadowMap.needsUpdate=!0};t.addSeparator(),t.addInput(e.shadowMap,"enabled",{label:"shadowmap"}).on("change",o),t.addInput(e.shadowMap,"autoUpdate").on("change",o),t.addInput(e.shadowMap,"type",{options:{Basic:Ut,PCF:$t,"PCF Soft":Gt,VSM:qt}}).on("change",(()=>{e.shadowMap.needsUpdate=!0})),t.addSeparator(),t.addInput(e,"toneMapping",{options:{ACESFilmic:Yt,Cineon:Xt,Custom:Wt,Linear:Zt,None:Qt,Reinhard:Jt}}),t.addInput(e,"toneMappingExposure",{label:"exposure"}),t.addSeparator();const r={calls:"",geometries:"",lines:"",points:"",textures:"",triangles:""},a={maxAnisotropy:e.capabilities.getMaxAnisotropy().toString(),maxAttributes:e.capabilities.maxAttributes.toFixed(0),maxCubemapSize:`${e.capabilities.maxCubemapSize} (h * w)`,maxFragmentUniforms:e.capabilities.maxFragmentUniforms.toFixed(0),maxTextureSize:`${e.capabilities.maxTextureSize.toFixed(0)} (h * w)`,maxTextures:e.capabilities.maxTextures.toFixed(0),maxVaryings:e.capabilities.maxVaryings.toFixed(0),maxVertexTextures:e.capabilities.maxVertexTextures.toFixed(0),maxVertexUniforms:e.capabilities.maxVertexUniforms.toFixed(0)},l={interval:1e6},h=[];h.push(t.addMonitor(r,"calls",l),t.addMonitor(r,"geometries",l),t.addMonitor(r,"lines",l),t.addMonitor(r,"points",l),t.addMonitor(r,"textures",l),t.addMonitor(r,"triangles",l)),t.addSeparator(),t.addMonitor(a,"maxAnisotropy",l),t.addMonitor(a,"maxAttributes",l),t.addMonitor(a,"maxCubemapSize",l),t.addMonitor(a,"maxFragmentUniforms",l),t.addMonitor(a,"maxTextureSize",l),t.addMonitor(a,"maxTextures",l),t.addMonitor(a,"maxVaryings",l),t.addMonitor(a,"maxVertexTextures",l),t.addMonitor(a,"maxVertexUniforms",l),t.addMonitor(e.capabilities,"precision",l);const d=()=>{const{render:t,memory:n}=e.info;r.calls=t.calls.toFixed(0),r.geometries=n.geometries.toFixed(0),r.lines=t.lines.toFixed(0),r.points=t.points.toFixed(0),r.textures=n.textures.toFixed(0),r.triangles=t.triangles.toFixed(0);for(let e=0,i=h.length;e<i;e+=1)h[e].refresh()},c=setInterval(d,2e3);return d(),()=>clearInterval(c)})(t),(()=>{e.remove(Hs.grid),Hs.axes.dispose()})),n},Us=t=>{const e=w.prototype.add,n=w.prototype.remove,i=w.prototype.clear;return w.prototype.add=function(...n){e.call(this,...n);for(let e=0,i=n.length;e<i;e+=1)Is(t,n[e],this);return this},w.prototype.remove=function(...t){n.call(this,...t);for(let e=0,n=t.length;e<n;e+=1)Ls(t[e]);return this},w.prototype.clear=function(){const{children:t}=this;i.call(this);for(let e=0,n=t.length;e<n;e+=1)Ls(t[e]);return this},()=>{w.prototype.add=e,w.prototype.remove=n,w.prototype.clear=i}},$s=(t,e,n)=>{const{scene:i}=Qn,s=Us(e);let o;(t=>{const{renderer:e}=Qn,n=e.domElement,i=new Et,s=new _,o=e=>{const{scene:o,camera:r}=Qn;s.x=e.clientX/n.clientWidth*2-1,s.y=-e.clientY/n.clientHeight*2+1,i.setFromCamera(s,r);const a=i.intersectObjects(o.children).filter((t=>!0!==t.object.userData.THREE_INSPECT_OMIT));t(a)};us.addEventListener("enable-select",(t=>{t.enabled?n.addEventListener("pointerdown",o,{passive:!0}):n.removeEventListener("pointerdown",o)}))})((t=>{if(t.length<1)return;let e;for(;void 0===e;){const n=t.shift();if(void 0===n)break;e=As(n.object)}void 0!==e&&(void 0!==o&&(o.selected=!1),e.selected=!0,e.dom.scrollIntoView())}));let r=null;t.on("deselect",(()=>{null==r||r(),r=null,o=void 0})),t.on("select",(t=>{null==r||r(),r=null,o=t;const e="Scene"===t.text?i:ks(t);void 0!==e&&(r=((t,e)=>{e.name&&Un("three-inspect.selected",e.name);const n=ps(t);let i;return i="isPerspectiveCamera"in e||"isOrthographicCamera"in e?Cs(n,e):"isScene"in e?Ks(n):"isLight"in e?Rs(n,e):js(n,e),()=>{i.forEach((t=>t())),n.dispose()}})(n,e))})),t.on("reparent",(t=>{for(let e=0,n=t.length;e<n;e+=1){const{item:n,newParent:s}=t[e],o=ks(n),r="Scene"===s.text?i:ks(s);void 0!==r&&void 0!==o&&r.attach(o)}}));{const{children:t}=i;for(let n=0,s=t.length;n<s;n+=1)Is(e,t[n],i)}return()=>{s(),t.clearTreeItems(),(()=>{const{children:t}=i;for(let e=0,n=t.length;e<n;e+=1)Ls(t[e])})()}},Gs=t=>{const e=[],n=document.createElement("div");if(n.className="right"===t.location?"z-[100] absolute top-0 left-0 w-screen h-screen flex":"z-[100] absolute top-0 right-0 w-[350px] h-screen flex",Qn.root=n,"right"===t.location){const t=vs();n.append(t);let i=window.innerWidth;const s=()=>{const{innerWidth:e}=window,n=e-i;t.style.width=`${t.clientWidth+n}px`,i=e};window.addEventListener("resize",s,{passive:!0}),e.push((()=>window.removeEventListener("resize",s)))}const{controls:i,nav:s,treeroot:o,treeview:r,pane:a}=(()=>{const t=document.createElement("div");t.className="relative flex flex-col grow bg-[#28292e]",Qn.debugRoot=t;const e=document.createElement("nav");e.className="tp-rotv z-50 sticky flex top-0 w-full overflow-x-auto z-1 bg-[#28292e] font-mono text-[11px]",t.append(e);const n=document.createElement("section");n.className="flex flex-col grow overflow-x-hidden overflow-y-auto",n.dataset.pane="World",t.append(n);const i=new Ji;i.scrollable=!0,i.allowRenaming=!1,i.dom.style.cssText="font-family: monospace; font-size: 11px; height: 300px;",i.wc.classList.add("sticky","top-0","z-10","bg-[#333]"),n.append(i.wc);const s=new Ni({text:"Scene"});i.append(s);const o=document.createElement("div");return n.append(o),{controls:t,nav:e,pane:o,treeroot:s,treeview:i}})(),{addPane:l}=((t,e)=>{let n="";const i=i=>{var s,o;if(n===i)return;Un("three-inspect.selectedPane",i),null==(s=t.querySelector(`[data-pane="${n}"]`))||s.classList.add("hidden");const r=e.querySelector(`[data-nav="${n}"]`);null==r||r.classList.remove("bg-zinc-400","text-zinc-800"),null==r||r.classList.add("text-zinc-400"),null==(o=t.querySelector(`[data-pane="${i}"]`))||o.classList.remove("hidden");const a=e.querySelector(`[data-nav="${i}"]`);null==a||a.classList.add("bg-zinc-400","text-zinc-800"),null==a||a.classList.remove("text-zinc-400"),n=i},s=t=>{const n=document.createElement("button");n.className="py-1.5 px-2 text-zinc-400",n.dataset.nav=t,n.textContent=t,n.addEventListener("click",(()=>i(t)),{passive:!0}),e.append(n)},o=document.createElement("button");return o.title="Select an element to inspect it",o.innerHTML='<svg viewBox="0 0 24 24"><path d="M4.9 4.9 17.2 10l-4.9 1.7a.9.9 0 0 0-.6.6L10 17.2zm8.2 9.6 5.3 5.3a.9.9 0 1 0 1.4-1.4l-5.3-5.3 5.9-2a1 1 0 0 0 0-1.9l-17-7a1 1 0 0 0-1.3 1.3l7 17a1 1 0 0 0 1.9-.1z"/></svg>',o.className="w-6 fill-zinc-400 p-1 hover:fill-zinc-300 hover:bg-[rgba(255,255,255,0.05)]",o.addEventListener("click",(()=>{const t=o.classList.toggle("enabled");o.classList.toggle("bg-zinc-600",t),o.classList.toggle("hover:bg-zinc-600",t),o.classList.toggle("fill-zinc-100",t),o.classList.toggle("hover:fill-zinc-100",t),us.dispatchEvent({enabled:t,type:"enable-select"})}),{passive:!0}),e.append(o),s("World"),i($n("three-inspect.selectedPane")??"World"),{addPane:e=>{const n=document.createElement("section");return n.className="h-screen flex flex-col overflow-x-hidden overflow-y-auto hidden",n.dataset.pane=e,t.insertBefore(n,t.children[t.children.length-2]),s(e),ps(n)}}})(i,s);return e.push((t=>{const e=document.createElement("div");e.className="sticky bottom-0 h-[105px]",t.append(e);const n=new xe.Pane({container:e});n.registerPlugin(ns),n.addSeparator();const i=1048576,{memory:s}=performance,o={memory:s?s.usedJSHeapSize/i:0,time:""},r=performance.now();let a=0;const l=()=>{a=(performance.now()-r)/1e3;const t=a%60|0,e=a/60|0,n=a/60/60|0;o.time=`${n<10?`0${n}`:n}:${e<10?`0${e}`:e}:${t<10?`0${t}`:t}`};l();const h=setInterval(l,1e3);n.addMonitor(o,"time",{interval:1e3});const d=n.addBlade({label:"fps",lineCount:2,view:"fpsgraph"});let c=-1;s&&(n.addMonitor(o,"memory",{max:s.jsHeapSizeLimit/i,min:0,view:"graph"}),c=setInterval((()=>{o.memory=s.usedJSHeapSize/i}),3e3));const p=()=>{const t=d;t.end(),t.begin()};return oi(p),()=>{n.dispose(),clearInterval(h),clearInterval(c),ri(p)}})(i),$s(r,o,a)),n.append(i),document.body.append(n),{addPane:l,disposers:e}},qs=document.createElement("style");qs.textContent='*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.visible{visibility:visible}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.bottom-0{bottom:0}.left-0{left:0}.right-0{right:0}.top-0{top:0}.z-10{z-index:10}.z-50{z-index:50}.z-\\[100\\]{z-index:100}.inline{display:inline}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-\\[105px\\]{height:105px}.h-screen{height:100vh}.w-6{width:1.5rem}.w-\\[350px\\]{width:350px}.w-full{width:100%}.w-screen{width:100vw}.grow{flex-grow:1}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.resize{resize:both}.flex-col{flex-direction:column}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.bg-\\[\\#28292e\\]{--tw-bg-opacity: 1;background-color:rgb(40 41 46 / var(--tw-bg-opacity))}.bg-\\[\\#333\\]{--tw-bg-opacity: 1;background-color:rgb(51 51 51 / var(--tw-bg-opacity))}.bg-zinc-400{--tw-bg-opacity: 1;background-color:rgb(161 161 170 / var(--tw-bg-opacity))}.bg-zinc-600{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity))}.fill-zinc-100{fill:#f4f4f5}.fill-zinc-400{fill:#a1a1aa}.p-1{padding:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\\.5{padding-top:.375rem;padding-bottom:.375rem}.font-mono{font-family:var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace)}.text-\\[11px\\]{font-size:11px}.text-zinc-400{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity))}.text-zinc-800{--tw-text-opacity: 1;color:rgb(39 39 42 / var(--tw-text-opacity))}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}*{--bs-br: 0px !important;scrollbar-width:none}*::-webkit-scrollbar{display:none}.tp-grlv_g{height:30px!important}.tp-imgv{height:20px!important;transition:.2s!important}.tp-imgv:hover{height:80px!important}.tp-rotv_c{height:0!important;padding:0!important;margin-top:5px;width:100%!important}.stats .tp-rotv_c{height:auto!important}.orbit-controls-gizmo{position:absolute;top:10px;left:-90px;z-index:10}.hover\\:bg-\\[rgba\\(255\\,255\\,255\\,0\\.05\\)\\]:hover{background-color:#ffffff0d}.hover\\:bg-zinc-600:hover{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity))}.hover\\:fill-zinc-100:hover{fill:#f4f4f5}.hover\\:fill-zinc-300:hover{fill:#d4d4d8}\n',document.head.append(qs);const{scene:Ys,camera:Xs,renderer:Ws}=be(),Zs=new class{constructor({scene:t,camera:n,renderer:i,composer:s,options:o={}}){if(e(this,"disposers",[]),e(this,"addPane"),e(this,"dispose",(()=>{cancelAnimationFrame(ni);for(let t=this.disposers.length-1;t>-1;t-=1)this.disposers[t]();this.disposers.slice(0,this.disposers.length)})),!t){throw new Error("three-inspect constructor arguments have changed. Consult docs for new args: https://www.npmjs.com/package/three-inspect")}Qn.scene=t,Qn.camera=n,Qn.renderer=i,Qn.composer=s??void 0;const{disposers:r,addPane:a}=Gs({location:"right",...o});this.addPane=a,this.disposers.push(...r,(()=>{const{scene:t}=Qn;return Hs.axes=new h(1e3),Hs.axes.name="Axes helper",Hs.axes.userData.THREE_INSPECT_OMIT=!0,Hs.grid.name="Grid helper",Hs.grid.userData.THREE_INSPECT_OMIT=!0,Fs.grid&&t.add(Hs.grid),Fs.axes&&t.add(Hs.axes),()=>{t.remove(Hs.grid,Hs.axes)}})());const l=$n("three-inspect.controls");null!==l&&ei(l,n),ni=requestAnimationFrame(si)}registerPlugin(t){this.disposers.push(t(this))}}({scene:Ys,camera:Xs.current,renderer:Ws});export{Zs as d};
