<title>ThreeJS Experiments: Responsive Rendering | Micheal Parks</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel='stylesheet' href='css/index.css' />

<a class='button' href='/threejs-experiments'>Back</a>

<canvas></canvas>

<script type='module'>
import * as THREE from 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r119/three.module.js'
import { createRenderer, createCamera, createCube } from './js/core.js'

/**
 * Introduced here. Found in core.js for future experiments.
 */
const renderToDisplaySize = (canvas, renderer, camera) => {
  const pixelRatio = window.devicePixelRatio
  const width = canvas.clientWidth * pixelRatio | 0
  const height = canvas.clientHeight * pixelRatio | 0
  
  if (canvas.width === width && canvas.height === height) {
    return
  }

  renderer.setSize(width, height, false)
  camera.aspect = width / height
  camera.updateProjectionMatrix()
}

const main = () => {
  const canvas = document.querySelector('canvas')

  const renderer = createRenderer(canvas)

  const camera = createCamera({})
  camera.position.z = 2

  const scene = new THREE.Scene()

  const cube = createCube()
  scene.add(cube)

  {
    const color = 0xFFFFFF
    const intensity = 1
    const light = new THREE.DirectionalLight(color, intensity)
    light.position.set(-1, 2, 4)
    scene.add(light)
  }

  const render = (time) => {
    const seconds = time * 0.001

    renderToDisplaySize(canvas, renderer, camera)

    cube.rotation.x = seconds
    cube.rotation.y = seconds

    renderer.render(scene, camera)
    requestAnimationFrame(render)
  }

  requestAnimationFrame(render)
}

main()
</script>
